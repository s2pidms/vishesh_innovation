"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3017],{93017:(S,f,c)=>{c.r(f),c.d(f,{AssetMasterModule:()=>ut});var u=c(96814),h=c(1076),C=c(43818),v=c(25116),d=c(13107),b=c(28402);let Z="Asset Master",g=[{header:"Asset Class",key:"assetType",...d.t},{header:"Asset No.",key:"assetCode",...d.t},{header:"Asset Name",key:"assetName",...d.t},{header:"Asset Description",key:"assetDescription",...d.t},{header:"Purchase Cost",key:"assetPurchaseCost",...d.t},{header:"Purchase Date",key:"assetPurchaseDateS",...d.t},{header:"Depreciation Start Date",key:"depreciationStartDateS",...d.t},{header:"Location",key:"location",...d.t},{header:"Life (Yr)",key:"estimatedUsefulLifeInYear",...d.t},{header:"Asset Cost/Hr",key:"totalAssetCostPerHr",...d.t},{header:"Status",key:"status",...d.t}];var x=c(77203),t=c(65879),p=c(2742),U=c(2498),T=c(37285),N=c(88059),Y=c(53421),I=c(83344);function q(a,l){if(1&a){const o=t.EpF();t.TgZ(0,"th",20),t.NdJ("sort",function(e){t.CHM(o);const i=t.oxw();return t.KtG(i.onSort(e))}),t._uU(1," Asset Cost/Hr "),t.qZA()}}function w(a,l){1&a&&t._UZ(0,"div",39)}function J(a,l){1&a&&t._UZ(0,"div",40)}function L(a,l){1&a&&t._UZ(0,"div",41)}function O(a,l){1&a&&(t.TgZ(0,"span",46),t._uU(1),t.ALo(2,"companyCurrency"),t._UZ(3,"div",47),t.qZA()),2&a&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"INR")," "))}function k(a,l){if(1&a&&(t.TgZ(0,"td",42)(1,"div",43),t.YNc(2,O,4,3,"span",44),t.TgZ(3,"span",45),t._uU(4),t.ALo(5,"number"),t.qZA()()()),2&a){const o=t.oxw().$implicit;t.xp6(2),t.Q6J("ngIf",null==o?null:o.totalAssetCostPerHr),t.xp6(2),t.hij(" ",t.xi3(5,2,null==o?null:o.totalAssetCostPerHr,"1.2-2")," ")}}function E(a,l){1&a&&t._UZ(0,"div",48)}function R(a,l){1&a&&t._UZ(0,"div",49)}function H(a,l){if(1&a){const o=t.EpF();t.TgZ(0,"a",50),t.NdJ("click",function(){t.CHM(o);const e=t.oxw().$implicit,i=t.oxw();return t.KtG(i.openConfirmModal(null==e?null:e._id,null==e?null:e.assetCode))}),t._UZ(1,"i",51),t._uU(2," Delete "),t.qZA()}}function Q(a,l){if(1&a){const o=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",21,22)(5,"span",23),t._uU(6),t.qZA()(),t.TgZ(7,"td",21,24)(9,"span",23),t._uU(10),t.qZA()(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td")(16,"span",25),t.YNc(17,w,1,0,"div",26),t.YNc(18,J,1,0,"div",27),t.YNc(19,L,1,0,"div",28),t.qZA()(),t.YNc(20,k,6,5,"td",29),t.TgZ(21,"td")(22,"span",25),t.YNc(23,E,1,0,"div",30),t.YNc(24,R,1,0,"div",31),t.qZA()(),t.TgZ(25,"td")(26,"div",32),t._UZ(27,"button",33),t.TgZ(28,"div",34)(29,"a",35),t.NdJ("click",function(){const i=t.CHM(o).$implicit,r=t.oxw();return t.KtG(r.navigateTo("../form",i,"view"))}),t._UZ(30,"i",36),t._uU(31," View "),t.qZA(),t.TgZ(32,"a",35),t.NdJ("click",function(){const i=t.CHM(o).$implicit,r=t.oxw();return t.KtG(r.navigateTo("../form",i,"edit"))}),t._UZ(33,"i",37),t._uU(34," Edit "),t.qZA(),t.YNc(35,H,3,0,"a",38),t.qZA()()()()}if(2&a){const o=l.$implicit,s=t.MAs(4),e=t.MAs(8),i=t.oxw();t.xp6(2),t.Oqu(null==o?null:o.assetCode),t.xp6(1),t.Udp("width",s.clientWidth),t.xp6(2),t.Q6J("positionTarget",s)("ngbTooltip",o.assetName),t.xp6(1),t.hij(" ",o.assetName," "),t.xp6(1),t.Udp("width",e.clientWidth),t.xp6(2),t.Q6J("positionTarget",e)("ngbTooltip",o.assetDescription),t.xp6(1),t.hij(" ",o.assetDescription," "),t.xp6(2),t.Oqu(o.assetPurchaseDateS),t.xp6(2),t.Oqu(o.estimatedUsefulLifeInYear),t.xp6(3),t.Q6J("ngIf","green"==o.expiryStatus),t.xp6(1),t.Q6J("ngIf","red"==o.expiryStatus),t.xp6(1),t.Q6J("ngIf","orange"==o.expiryStatus),t.xp6(1),t.Q6J("ngIf",i.menuItemId==i.financeMenuItemId),t.xp6(3),t.Q6J("ngIf","Active"==o.status),t.xp6(1),t.Q6J("ngIf","Inactive"==o.status),t.xp6(5),t.Q6J("accessType",i.rolePermissionActions.viewAction),t.xp6(3),t.Q6J("accessType",i.rolePermissionActions.editAction),t.xp6(3),t.Q6J("ngIf",i.user==i.superAdminId)}}const V=function(a,l,o,s){return{page:a,pageSize:l,collection:o,search:s,type:"list"}};let j=(()=>{var a;class l{constructor(s,e,i,r,m,_,A,P,D,dt){this.exportExcelService=s,this.router=e,this.spinner=i,this.activatedRoute=r,this.assetMasterService=m,this.exportToPDFService=_,this.appGlobalService=A,this.storageService=P,this.toastService=D,this.modalService=dt,this.page=1,this.pageSize=8,this.collection=0,this.column="assetCode",this.direction=1,this.search="",this.tableData=[],this.menuItemId="",this.superAdminId=v.dA,this.user="",this.financeMenuItemId="64a6c1e33339d4dc9d8141ad",this.rolePermissionActions=v.a1}ngOnInit(){this.user=this.storageService.get("IDMSAUser")?.roles?.find(s=>s==this.superAdminId),this.menuItemId=this.appGlobalService.menuItemId,this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}getAll(s=!1,e=""){this.spinner.show();let i={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:s};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.assetMasterService.getAll(i).subscribe(r=>{"EXCEL"==e?this.excelDownload(r?.rows):"PDF"==e?this.pdfDownload(r?.rows):(this.tableData=r?.rows,this.collection=r?.count),this.spinner.hide()})}delete(s){this.spinner.show(),this.assetMasterService.delete(s).subscribe(e=>{this.spinner.hide(),this.toastService.success(e.message),this.getAll()})}openConfirmModal(s,e){const i=this.modalService.open(x.hn,{centered:!0,size:"md",backdrop:"static",keyboard:!1});i.componentInstance.heading="Confirm Deletion",i.componentInstance.confirmText=`Confirm Deletion of Asset Number ${e} ?`,i.result.then(r=>{"Yes"==r.title&&this.delete(s)},r=>{})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}navigateTo(s,e,i){this.router.navigate([s],{relativeTo:this.activatedRoute,queryParams:{id:e?._id,action:i}})}eventHeader(s){switch(s.key){case"SEARCH":this.search=s.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=s.value,this.getAll()}}trackByFn(s,e){return e?._id}pdfDownload(s){let e=(a=>(0,b.J)({data:a,headers:g,title:Z}))(s);this.exportToPDFService.generatePdf(e.tableData,e.title)}excelDownload(s){this.exportExcelService.exportExcel((a=>({title:Z,csvData:a,headers:g}))(s))}onSort({column:s,direction:e}){this.headers.forEach(i=>{i.sortable!==s&&(i.direction="")}),this.column=s,this.direction="asc"==e?1:-1,this.getAll()}}return(a=l).\u0275fac=function(s){return new(s||a)(t.Y36(p.Ol),t.Y36(h.F0),t.Y36(p.V),t.Y36(h.gz),t.Y36(U.Z9),t.Y36(p.$L),t.Y36(p.P0),t.Y36(p.V1),t.Y36(p.kl),t.Y36(T.FF))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-asset-master-list"]],viewQuery:function(s,e){if(1&s&&t.Gf(C.j,5),2&s){let i;t.iGM(i=t.CRH())&&(e.headers=i)}},decls:33,vars:10,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],["appAccessControl","",1,"text-center",3,"accessType"],[1,"plusIconSvg","btn","btn-primary","me-1"],["type","button",1,"btn","btn-primary","btn-add","px-5",3,"click"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-secondary"],[1,"text-white"],["sortable","assetCode",3,"sort"],["sortable","assetName",1,"text-start",3,"sort"],["sortable","assetDescription",1,"text-start",3,"sort"],["sortable","assetPurchaseDate",3,"sort"],["sortable","estimatedUsefulLifeInYear",3,"sort"],["sortable","location",3,"sort"],["class","text-start","sortable","assetPurchaseDateS",3,"sort",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["sortable","assetPurchaseDateS",1,"text-start",3,"sort"],[1,"text-start"],["assetName",""],[1,"pointer",3,"positionTarget","ngbTooltip"],["assetDescription",""],[1,"d-flex","justify-content-center"],["class","flaggreen",4,"ngIf"],["class","flagred",4,"ngIf"],["class","flagYellow",4,"ngIf"],["class","text-start","class","py-0 text-center",4,"ngIf"],["class","statusActive",4,"ngIf"],["class","statusInActive",4,"ngIf"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"],["href","javascript:void(0)",3,"click",4,"ngIf"],[1,"flaggreen"],[1,"flagred"],[1,"flagYellow"],[1,"py-0","text-center"],[1,"d-flex","justify-content-start","align-items-center"],["class","input-group-text text-secondary combine-INR border border-0",4,"ngIf"],[1,"total-cost-color"],[1,"input-group-text","text-secondary","combine-INR","border","border-0"],[1,"vr","ms-3"],[1,"statusActive"],[1,"statusInActive"],["href","javascript:void(0)",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-primary"]],template:function(s,e){1&s&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3,"Asset Summary"),t.qZA()(),t.TgZ(4,"div",3),t._UZ(5,"button",4),t.TgZ(6,"button",5),t.NdJ("click",function(){return e.navigateTo("../form",{},"create")}),t._uU(7," Asset "),t.qZA()(),t._UZ(8,"hr",6),t.TgZ(9,"div",7)(10,"app-setting-header",8),t.NdJ("dataChange",function(r){return e.eventHeader(r)}),t.qZA(),t.TgZ(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th",12),t.NdJ("sort",function(r){return e.onSort(r)}),t._uU(15,"Asset No."),t.qZA(),t.TgZ(16,"th",13),t.NdJ("sort",function(r){return e.onSort(r)}),t._uU(17,"Asset Name"),t.qZA(),t.TgZ(18,"th",14),t.NdJ("sort",function(r){return e.onSort(r)}),t._uU(19,"Asset Description"),t.qZA(),t.TgZ(20,"th",15),t.NdJ("sort",function(r){return e.onSort(r)}),t._uU(21,"Purchase Date"),t.qZA(),t.TgZ(22,"th",16),t.NdJ("sort",function(r){return e.onSort(r)}),t._uU(23,"Life (Yr)"),t.qZA(),t.TgZ(24,"th",17),t.NdJ("sort",function(r){return e.onSort(r)}),t._uU(25,"Aging"),t.qZA(),t.YNc(26,q,2,0,"th",18),t.TgZ(27,"th"),t._uU(28,"Status"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Action"),t.qZA()()(),t.TgZ(31,"tbody"),t.YNc(32,Q,36,22,"tr",19),t.qZA()()()()),2&s&&(t.xp6(4),t.Q6J("accessType",e.rolePermissionActions.createAction),t.xp6(6),t.Q6J("data",t.l5B(5,V,e.page,e.pageSize,e.collection,e.search)),t.xp6(16),t.Q6J("ngIf",e.menuItemId==e.financeMenuItemId),t.xp6(6),t.Q6J("ngForOf",e.tableData)("ngForTrackBy",e.trackByFn))},dependencies:[u.sg,u.O5,N.P,T._L,C.j,Y.J,u.JJ,I.f],styles:[".total-cost-color[_ngcontent-%COMP%]{font-size:1.2rem!important;color:#000}"]}),l})();var n=c(60095),G=c(21631),z=c(22096);const K=[{message:"Asset Class is Required",key:"assetClassId"},{message:"Asset Code is Required",key:"assetCode"},{message:"Asset Name is Required",key:"assetName"},{message:"Asset Description is Required",key:"assetDescription"},{message:"Purchase Cost is Required",key:"assetPurchaseCost"},{message:"Status  is Required",key:"status"}];function B(a,l){1&a&&t._UZ(0,"hr",24)}function X(a,l){if(1&a){const o=t.EpF();t.TgZ(0,"div",31)(1,"button",32),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.dismissModel())}),t._uU(2," Save & Close "),t.qZA()()}}const M=function(){return["create","edit"]};let $=(()=>{var a;class l{constructor(s,e){this.activeModal=s,this.toastService=e,this.action="",this.assetPurchaseCost=null,this.totalAssetCostPerHr=null,this.totalAssetCostPerShift=null,this.costingInput={},this.assetConfiguration=[],this.estimatedResidualPercentage=0,this.maintenanceDownTime=0,this.btnDisable=!1,this.page=1,this.pageSize=4,this.collection=0,this.search="",this.column="createdAt",this.direction=-1,this.numberOfDaysOfYear=365,this.numberOfSundays=52,this.companyHoliday=10,this.noOfMonths=12,this.shiftHr=8,this.form=new n.nJ({assetPurchaseCost:new n.p4(null),financeCost:new n.p4(null),totalAssetClass:new n.p4(null),estimatedUsefulLifeInYear:new n.p4(null),depreciatedAssetCostPerYear:new n.p4(null),noOfOperationalDaysPerYear:new n.p4(null),noOfShiftsRunPerDays:new n.p4(null),machineEfficiencyPercentage:new n.p4(null),totalAssetCostPerHr:new n.p4(null),totalAssetCostPerShift:new n.p4(null)})}setFormField(s,e){this.form.controls[s].setValue(Number(e).toFixed(2))}getFormField(s){return+this.form.controls[s].value||0}setConfigurableData(){this.form.controls.totalAssetCostPerHr.setValue(this.totalAssetCostPerHr),this.form.controls.totalAssetCostPerShift.setValue(this.totalAssetCostPerShift),this.assetConfiguration.length>0&&(this.estimatedResidualPercentage=this.getParamsValue(this.assetConfiguration,"ESTIMATED_RESIDUAL"),this.maintenanceDownTime=this.getParamsValue(this.assetConfiguration,"MAINT_DOWN_TIME"),this.form.controls.noOfShiftsRunPerDays.setValue(Number(this.getParamsValue(this.assetConfiguration,"NO_OF_SHIFTS_RPD")).toFixed(2)),this.setFormField("machineEfficiencyPercentage",this.getParamsValue(this.assetConfiguration,"MACHINE_EFFICIENCY")),this.setFormField("noOfOperationalDaysPerYear",this.getParamsValue(this.assetConfiguration,"NO_OPS_DAYS_PER_YEAR"))),this.form.patchValue(this.costingInput),this.form.controls.assetPurchaseCost.setValue(this.assetPurchaseCost),this.setFormField("financeCost",+this.form.controls.assetPurchaseCost.value/100*35),this.setTotalAsset()}ngOnInit(){this.setConfigurableData(),"view"==this.action&&this.form.disable()}getParamsValue(s,e){return s.find(i=>i?.parameterLabel==e)?.parameterName??0}reset(){this.form.reset(),this.setConfigurableData()}dismissModel(){this.form.enable(),this.activeModal.close(this.form.value)}setTotalAsset(){let s=this.getFormField("assetPurchaseCost"),e=this.getFormField("financeCost"),i=this.getFormField("estimatedUsefulLifeInYear");this.setFormField("totalAssetClass",+s+ +e),s&&i&&this.setDepreciatedCostPerYear()}setDepreciatedCostPerYear(){let s=this.getFormField("estimatedUsefulLifeInYear"),e=this.getFormField("totalAssetClass");s?this.setFormField("depreciatedAssetCostPerYear",+e/+s):(this.setFormField("depreciatedAssetCostPerYear",0),this.setFormField("totalAssetCostPerHr",0)),this.setDepreciationCostPerHour()}setDepreciationCostPerHour(){let s=this.getFormField("assetPurchaseCost"),e=this.getFormField("estimatedUsefulLifeInYear"),i=this.getFormField("noOfShiftsRunPerDays"),r=this.getFormField("machineEfficiencyPercentage"),m=this.getFormField("noOfOperationalDaysPerYear"),_=this.getFormField("depreciatedAssetCostPerYear");if(!s)return void this.toastService.warning("Pls first enter the value of Purchase Cost and Finance Cost");if(!e)return void this.toastService.warning("Pls enter the value of Estimated Useful Life (Years)");m>366&&(this.toastService.warning("No. of Operational Days/Year Should be less than 366 Days "),this.setFormField("noOfOperationalDaysPerYear",0),m=this.getFormField("noOfOperationalDaysPerYear")),+_&&m&&+i&&this.shiftHr&&+r?this.setFormField("totalAssetCostPerHr",+_/+m/(+i*+this.shiftHr*+r)):(this.setFormField("totalAssetCostPerHr",0),this.setFormField("totalAssetCostPerShift",0));let A=this.getFormField("totalAssetCostPerHr");this.setFormField("totalAssetCostPerShift",A?+A*+this.shiftHr:0)}changeEstimatedResidual(){this.getFormField("assetPurchaseCost")||this.toastService.warning("Pls first enter the value of Actual Machine Cost and Finance Cost")}}return(a=l).\u0275fac=function(s){return new(s||a)(t.Y36(T.Kz),t.Y36(p.kl))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-asset-costing-modal"]],inputs:{action:"action",assetPurchaseCost:"assetPurchaseCost",totalAssetCostPerHr:"totalAssetCostPerHr",totalAssetCostPerShift:"totalAssetCostPerShift",costingInput:"costingInput",assetConfiguration:"assetConfiguration"},decls:111,vars:23,consts:[[3,"formGroup"],[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid","mt-4","mb-3"],[1,"row"],[1,"col-12","px-0"],[1,"row","px-5","mb-4"],[1,"col-6"],[1,"form-label"],[1,"text-danger"],[1,"d-flex"],[1,"input-group-text","combine-INR","text-secondary"],[1,"vr","ms-3"],["type","number","formControlName","assetPurchaseCost","readonly","",1,"form-control","border-start-0",3,"input"],["type","number","formControlName","financeCost",1,"form-control","border-start-0",3,"input"],["type","number","formControlName","totalAssetClass","readonly","",1,"form-control","border-start-0"],["type","number","formControlName","estimatedUsefulLifeInYear",1,"form-control",3,"input"],["type","number","formControlName","depreciatedAssetCostPerYear","readonly","",1,"form-control","border-start-0"],["type","number","formControlName","machineEfficiencyPercentage",1,"form-control",3,"input"],["type","number","formControlName","noOfOperationalDaysPerYear",1,"form-control",3,"input"],["type","number","formControlName","noOfShiftsRunPerDays",1,"form-control",3,"input"],[1,"line-border"],["type","number","formControlName","totalAssetCostPerHr","readonly","",1,"form-control","border-start-0"],["type","number","formControlName","totalAssetCostPerShift","readonly","",1,"form-control","border-start-0"],["class","line-border",4,"ngIf"],[1,"row","px-5","d-flex","justify-content-center","mt-4","mb-3"],[1,"col-md-auto"],["class","d-grid gap-2 d-md-block",4,"ngIf"],[1,"d-grid","gap-2","d-md-block"],["type","button",1,"btn","btn-primary","px-3",3,"click"]],template:function(s,e){1&s&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4,"Asset Cost"),t.qZA(),t.TgZ(5,"div")(6,"button",4),t.NdJ("click",function(){return e.activeModal.close()}),t._UZ(7,"i",5),t.qZA()()(),t.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"label",11),t._uU(14," Purchase Cost"),t.TgZ(15,"span",12),t._uU(16,"*"),t.qZA()(),t.TgZ(17,"div",13)(18,"span",14),t._uU(19),t.ALo(20,"companyCurrency"),t._UZ(21,"div",15),t.qZA(),t.TgZ(22,"input",16),t.NdJ("input",function(){return e.setTotalAsset()}),t.qZA()()(),t.TgZ(23,"div",10)(24,"label",11),t._uU(25," Finance Cost"),t.TgZ(26,"span",12),t._uU(27,"*"),t.qZA()(),t.TgZ(28,"div",13)(29,"span",14),t._uU(30),t.ALo(31,"companyCurrency"),t._UZ(32,"div",15),t.qZA(),t.TgZ(33,"input",17),t.NdJ("input",function(){return e.setTotalAsset()}),t.qZA()()()(),t.TgZ(34,"div",9)(35,"div",10)(36,"label",11),t._uU(37," Total Asset Cost"),t.TgZ(38,"span",12),t._uU(39,"*"),t.qZA()(),t.TgZ(40,"div",13)(41,"span",14),t._uU(42),t.ALo(43,"companyCurrency"),t._UZ(44,"div",15),t.qZA(),t._UZ(45,"input",18),t.qZA()(),t.TgZ(46,"div",10)(47,"label",11),t._uU(48," Estimated Useful Life (Years) "),t.TgZ(49,"span",12),t._uU(50,"*"),t.qZA()(),t.TgZ(51,"input",19),t.NdJ("input",function(){return e.setDepreciatedCostPerYear()}),t.qZA()()(),t.TgZ(52,"div",9)(53,"div",10)(54,"label",11),t._uU(55," Depreciated Asset Cost/Year "),t.TgZ(56,"span",12),t._uU(57,"*"),t.qZA()(),t.TgZ(58,"div",13)(59,"span",14),t._uU(60),t.ALo(61,"companyCurrency"),t._UZ(62,"div",15),t.qZA(),t._UZ(63,"input",20),t.qZA()(),t.TgZ(64,"div",10)(65,"label",11),t._uU(66," Machine Efficiency % "),t.TgZ(67,"span",12),t._uU(68,"*"),t.qZA()(),t.TgZ(69,"input",21),t.NdJ("input",function(){return e.setDepreciationCostPerHour()}),t.qZA()()(),t.TgZ(70,"div",9)(71,"div",10)(72,"label",11),t._uU(73," No. of Operational Days/Year "),t.TgZ(74,"span",12),t._uU(75,"*"),t.qZA()(),t.TgZ(76,"input",22),t.NdJ("input",function(){return e.setDepreciationCostPerHour()}),t.qZA()(),t.TgZ(77,"div",10)(78,"label",11),t._uU(79," No. of shifts/Day "),t.TgZ(80,"span",12),t._uU(81,"*"),t.qZA()(),t.TgZ(82,"input",23),t.NdJ("input",function(){return e.setDepreciationCostPerHour()}),t.qZA()()(),t._UZ(83,"hr",24),t.TgZ(84,"div",9)(85,"div",10)(86,"label",11),t._uU(87," Total Cost/Hr"),t.TgZ(88,"span",12),t._uU(89,"*"),t.qZA()(),t.TgZ(90,"div",13)(91,"span",14),t._uU(92),t.ALo(93,"companyCurrency"),t._UZ(94,"div",15),t.qZA(),t._UZ(95,"input",25),t.qZA()(),t.TgZ(96,"div",10)(97,"label",11),t._uU(98," Total Cost/Shift"),t.TgZ(99,"span",12),t._uU(100,"*"),t.qZA()(),t.TgZ(101,"div",13)(102,"span",14),t._uU(103),t.ALo(104,"companyCurrency"),t._UZ(105,"div",15),t.qZA(),t._UZ(106,"input",26),t.qZA()()(),t.YNc(107,B,1,0,"hr",27),t.TgZ(108,"div",28)(109,"div",29),t.YNc(110,X,3,0,"div",30),t.qZA()()()()()()()),2&s&&(t.Q6J("formGroup",e.form),t.xp6(19),t.hij(" ",t.lcZ(20,9,"INR")," "),t.xp6(11),t.hij(" ",t.lcZ(31,11,"INR")," "),t.xp6(12),t.hij(" ",t.lcZ(43,13,"INR")," "),t.xp6(18),t.hij(" ",t.lcZ(61,15,"INR")," "),t.xp6(32),t.hij(" ",t.lcZ(93,17,"INR")," "),t.xp6(11),t.hij(" ",t.lcZ(104,19,"INR")," "),t.xp6(4),t.Q6J("ngIf",t.DdM(21,M).includes(e.action)),t.xp6(3),t.Q6J("ngIf",t.DdM(22,M).includes(e.action)))},dependencies:[u.O5,n._Y,n.Fj,n.wV,n.JJ,n.JL,n.sg,n.u,I.f],encapsulation:2}),l})();var W=c(16897),tt=c(50363);function et(a,l){if(1&a&&(t.TgZ(0,"option",36),t._uU(1),t.qZA()),2&a){const o=l.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ",null==o?null:o.label," ")}}function st(a,l){if(1&a){const o=t.EpF();t.TgZ(0,"div",37),t._UZ(1,"button",38),t.TgZ(2,"button",39),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openInfoModal())}),t._uU(3," Costing Input "),t.qZA()()}if(2&a){const o=t.oxw();t.xp6(1),t.Q6J("disabled",!o.f.assetPurchaseCost.value),t.xp6(1),t.Q6J("disabled",!o.f.assetPurchaseCost.value)}}function at(a,l){1&a&&t._UZ(0,"div",40)}function it(a,l){1&a&&t._UZ(0,"div",41)}function ot(a,l){if(1&a){const o=t.EpF();t.TgZ(0,"div",42)(1,"button",43),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.reset())}),t._uU(2,"Reset"),t.qZA(),t.TgZ(3,"button",44),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.submit())}),t._uU(4,"Save"),t.qZA()()}if(2&a){const o=t.oxw();t.Q6J("ngClass",o.menuItemId==o.financeMenuItemId?"col-7 text-end":"col-9 text-end")}}let nt=(()=>{var a;class l{constructor(s,e,i,r,m,_,A,P,D){this.router=s,this.activatedRoute=e,this.spinner=i,this.toastService=r,this.assetMasterService=m,this.validationService=_,this.utilityService=A,this.modalService=P,this.appGlobalService=D,this.assetTypeArr=[],this.autoIncValues={},this.submitted=!1,this.action="create",this.menuItemId="",this.financeMenuItemId="64a6c1e33339d4dc9d8141ad",this.masterData={assetClassOptions:[],assetConfigurationOptions:[],locationOptions:[]},this.form=new n.nJ({_id:new n.p4(null),assetType:new n.p4(null),assetClassId:new n.p4(null,[n.kI.required]),assetCode:new n.p4(null,[n.kI.required]),assetName:new n.p4(null,[n.kI.required]),assetDescription:new n.p4(null,[n.kI.required]),assetPurchaseDate:new n.p4(null),assetPurchaseCost:new n.p4(null,[n.kI.required]),location:new n.p4(null),depreciationStartDate:new n.p4(null),costingInput:new n.p4({}),status:new n.p4("Active",[n.kI.required]),totalAssetCostPerHr:new n.p4(null),totalAssetCostPerShift:new n.p4(null)})}get f(){return this.form.controls}ngOnInit(){this.menuItemId=this.appGlobalService.menuItemId,this.getInitialData()}navigateTo(s,e,i){this.router.navigate([s],{queryParams:{id:e,action:i}})}reset(){this.form.reset(),this.getInitialData()}submit(){if(this.submitted=!0,this.validationService.checkErrors(this.form,K))return;this.form.enable();let s=this.form.value;s._id?this.update(s):(delete s._id,this.create(s))}create(s){this.spinner.show(),this.assetMasterService.create(s).subscribe(e=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(e.message),this.router.navigate(["/default/finance/master/cost_sheet/asset_master/list"])})}update(s){this.spinner.show(),this.assetMasterService.update(s._id,s).subscribe(e=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(e.message),this.router.navigate(["/default/finance/master/cost_sheet/asset_master/list"])})}getInitialData(){this.spinner.show(),this.assetMasterService.getAllMasterData({}).subscribe(s=>{this.masterData=s,this.autoIncValues=s?.autoIncValues,this.form.controls.assetPurchaseDate.setValue(this.utilityService.getTodayDate("YYYY-MM-DD")),this.setDepreciationStartDate(),this.form.controls.status.setValue("Active"),this.activatedRoute.queryParams.pipe((0,G.z)(e=>(this.action=e.action,this.utilityService.accessDenied(this.action),e.id?this.assetMasterService.getById(e.id):(0,z.of)({})))).subscribe(e=>{this.spinner.hide(),0!=Object.keys(e).length&&(e.assetClassId&&this.masterData?.assetClassOptions.find(r=>r._id==e?.assetClassId),e.costingInput&&e.costingInput.depreciationStartDate&&(e.costingInput.depreciationStartDate=this.utilityService.getFormatDate(e.costingInput.depreciationStartDate,"YYYY-MM-DD")),e.assetPurchaseDate&&(e.assetPurchaseDate=this.utilityService.getFormatDate(e.assetPurchaseDate,"YYYY-MM-DD")),e.depreciationStartDate&&(e.depreciationStartDate=this.utilityService.getFormatDate(e.depreciationStartDate,"YYYY-MM-DD")),this.form.patchValue(e),"view"==this.action&&this.form.disable())})})}setDepreciationStartDate(){let e=this.utilityService.setFutureDateInDays(this.f.assetPurchaseDate.value,15);this.f.depreciationStartDate.setValue(e)}setAssetClassDetails(s){this.form.controls.assetType.setValue(s?.assetClassName),"create"==this.action&&s.assetClassName&&this.form.controls.assetCode.setValue(this.autoIncValues[s.assetClassName])}openInfoModal(){const s=this.modalService.open($,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});s.componentInstance.action=this.action,s.componentInstance.assetConfiguration=this.masterData?.assetConfigurationOptions,s.componentInstance.assetPurchaseCost=this.form.controls.assetPurchaseCost.value,s.componentInstance.costingInput=this.form.controls.costingInput.value,s.componentInstance.totalAssetCostPerHr=this.form.controls.totalAssetCostPerHr.value,s.componentInstance.totalAssetCostPerShift=this.form.controls.totalAssetCostPerShift.value,s.result.then(e=>{e&&["create","edit"].includes(this.action)&&(this.form.controls.costingInput.patchValue(e),this.form.controls.totalAssetCostPerHr.setValue(e?.totalAssetCostPerHr),this.form.controls.totalAssetCostPerShift.setValue(e?.totalAssetCostPerShift))},e=>{})}}return(a=l).\u0275fac=function(s){return new(s||a)(t.Y36(h.F0),t.Y36(h.gz),t.Y36(p.V),t.Y36(p.kl),t.Y36(U.Z9),t.Y36(W.RJ),t.Y36(p.tI),t.Y36(T.FF),t.Y36(p.P0))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-asset-master-form"]],decls:85,vars:16,consts:[[1,"formCard","card",3,"formGroup"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,"form-body"],[1,"row"],[1,"col-md-3"],[1,"form-label"],[1,"text-danger"],["bindLabel","assetClassName","bindValue","_id","formControlName","assetClassId",3,"items","clearable","change"],["type","text","formControlName","assetCode","readonly","",1,"form-control"],["type","text","formControlName","assetName",1,"form-control"],["type","text","formControlName","assetDescription",1,"form-control"],[1,"d-flex"],[1,"input-group-text","text-secondary","combine-INR"],[1,"vr","ms-3"],["formControlName","assetPurchaseCost","type","number",1,"form-control","border-start-0"],["type","date","formControlName","assetPurchaseDate",1,"form-control",3,"change"],["type","date","formControlName","depreciationStartDate",1,"form-control"],["formControlName","location",1,"form-select"],["selected","","disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"row","line-border","my-4"],[1,"row","my-4"],["class","col-2 pe-0",4,"ngIf"],[1,"col-3","ps-3"],[1,"d-flex","align-items-center"],[1,"col-md-auto","text-nowrap"],["type","button",1,"btn","btn-primary","px-3"],["formControlName","status",1,"form-select","statusSelectBorder"],["value","Active"],["value","Inactive"],[1,"input-group-text","statusSpanHeight"],["class","statusActive","class","statusActive",4,"ngIf"],["class","statusInActive",4,"ngIf"],[3,"ngClass",4,"ngIf"],[3,"value"],[1,"col-2","pe-0"],[1,"plusIconSvg","btn","btn-primary","me-1",3,"disabled"],["type","button",1,"btn","btn-primary","px-3",3,"disabled","click"],[1,"statusActive"],[1,"statusInActive"],[3,"ngClass"],["type","button",1,"btn","btn-primary","px-5","me-5",3,"click"],["type","button",1,"btn","btn-primary","px-5",3,"click"]],template:function(s,e){1&s&&(t.TgZ(0,"Form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label"),t._uU(5),t.ALo(6,"titlecase"),t.qZA()()(),t.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"label",7),t._uU(11," Asset Class "),t.TgZ(12,"span",8),t._uU(13,"*"),t.qZA()(),t.TgZ(14,"ng-select",9),t.NdJ("change",function(r){return e.setAssetClassDetails(r)}),t.qZA()(),t.TgZ(15,"div",6)(16,"label",7),t._uU(17," Asset No. "),t.TgZ(18,"span",8),t._uU(19,"*"),t.qZA()(),t._UZ(20,"input",10),t.qZA(),t.TgZ(21,"div",6)(22,"label",7),t._uU(23," Asset Name "),t.TgZ(24,"span",8),t._uU(25,"*"),t.qZA()(),t._UZ(26,"input",11),t.qZA(),t.TgZ(27,"div",6)(28,"label",7),t._uU(29," Asset Description "),t.TgZ(30,"span",8),t._uU(31,"*"),t.qZA()(),t._UZ(32,"input",12),t.qZA()(),t.TgZ(33,"div",5)(34,"div",6)(35,"label",7),t._uU(36," Purchase Cost "),t.TgZ(37,"span",8),t._uU(38,"*"),t.qZA()(),t.TgZ(39,"div",13)(40,"span",14),t._uU(41),t.ALo(42,"companyCurrency"),t._UZ(43,"div",15),t.qZA(),t._UZ(44,"input",16),t.qZA()(),t.TgZ(45,"div",6)(46,"label",7),t._uU(47," Purchase Date "),t.TgZ(48,"span",8),t._uU(49,"*"),t.qZA()(),t.TgZ(50,"input",17),t.NdJ("change",function(){return e.setDepreciationStartDate()}),t.qZA()(),t.TgZ(51,"div",6)(52,"label",7),t._uU(53," Depreciation Start Date "),t.TgZ(54,"span",8),t._uU(55,"*"),t.qZA()(),t._UZ(56,"input",18),t.qZA(),t.TgZ(57,"div",6)(58,"label",7),t._uU(59," Location"),t.TgZ(60,"span",8),t._uU(61,"*"),t.qZA()(),t.TgZ(62,"select",19)(63,"option",20),t._uU(64,"Select Location"),t.qZA(),t.YNc(65,et,2,2,"option",21),t.qZA()()()(),t._UZ(66,"hr",22),t.TgZ(67,"div",23),t.YNc(68,st,4,2,"div",24),t.TgZ(69,"div",25)(70,"div",26)(71,"div",27)(72,"button",28),t._uU(73,"Status"),t.qZA()(),t.TgZ(74,"select",29)(75,"option",20),t._uU(76,"Select Status"),t.qZA(),t.TgZ(77,"option",30),t._uU(78,"Active"),t.qZA(),t.TgZ(79,"option",31),t._uU(80,"Inactive"),t.qZA()(),t.TgZ(81,"span",32),t.YNc(82,at,1,0,"div",33),t.YNc(83,it,1,0,"div",34),t.qZA()()(),t.YNc(84,ot,5,1,"div",35),t.qZA()()()),2&s&&(t.Q6J("formGroup",e.form),t.xp6(5),t.hij(" Asset (",t.lcZ(6,12,e.action),")"),t.xp6(9),t.Q6J("items",e.masterData.assetClassOptions)("clearable",!1),t.xp6(27),t.hij(" ",t.lcZ(42,14,"INR")," "),t.xp6(22),t.Q6J("value",null),t.xp6(2),t.Q6J("ngForOf",e.masterData.locationOptions),t.xp6(3),t.Q6J("ngIf",e.menuItemId==e.financeMenuItemId),t.xp6(7),t.Q6J("value","null"),t.xp6(7),t.Q6J("ngIf","Active"==e.form.value.status),t.xp6(1),t.Q6J("ngIf","Inactive"==e.form.value.status),t.xp6(1),t.Q6J("ngIf","view"!==e.action))},dependencies:[u.mk,u.sg,u.O5,n.YN,n.Kr,n.Fj,n.wV,n.EJ,n.JJ,n.JL,n.sg,n.u,tt.w9,u.rS,I.f],encapsulation:2}),l})();var rt=c(19964),lt=c(56208);const ct=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:j},{path:"form",component:nt,resolve:{accessScreen:rt.xr}}];let ut=(()=>{var a;class l{}return(a=l).\u0275fac=function(s){return new(s||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[u.ez,h.Bz.forChild(ct),lt.m]}),l})()},13107:(S,f,c)=>{c.d(f,{t:()=>u});const u={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}}},28402:(S,f,c)=>{c.d(f,{J:()=>u});const u=({data:h,headers:C,widths:v,title:d})=>({tableData:{widths:v,headerRows:1,body:[C.map(g=>({text:g.header,style:"header"})),...h.map(g=>C.map(y=>({style:"subheader",text:g[y.key]})))]},title:d})}}]);