"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6680],{16680:(E,g,l)=>{l.r(g),l.d(g,{AttendanceReviewModule:()=>L});var p=l(96814),m=l(1076),f=l(43818),A=l(25116),e=l(65879),v=l(37285),c=l(2742),d=l(60095);let y=(()=>{var s;class r{constructor(n,t){this.activeModal=n,this.utilityService=t,this.attendanceData={}}ngOnInit(){}setAttendance(){this.attendanceData.LOPDiff=this.attendanceData.monthDays-(this.attendanceData.paidLeaves+this.attendanceData.presentDays+this.attendanceData.weeklyOff+this.attendanceData.ODDays+this.attendanceData.paidHolidays)}dismissModel(){this.activeModal.close(this.attendanceData)}}return(s=r).\u0275fac=function(n){return new(n||s)(e.Y36(v.Kz),e.Y36(c.tI))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-attendance-review-edit-model"]],inputs:{attendanceData:"attendanceData"},decls:52,vars:7,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,""],[1,"row","my-4","px-5"],[1,"col-3"],[1,"form-label","mb-1"],[1,"text-danger"],["type","number","readonly","",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"col-3","ps-0"],["type","number",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"col-4","pe-3"],[1,"col-4","px-3"],[1,"col-4","ps-3"],["type","number",1,"form-control",3,"ngModel","ngModelChange"],[1,"line-border","my-4"],[1,"row","px-5"],[1,"ps-0","d-flex","justify-content-center"],[1,"mb-4"],["type","button",1,"btn","bg-primary","px-2",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Update Attendance Review"),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return t.activeModal.close()}),e._UZ(6,"i",4),e.qZA()()(),e.TgZ(7,"div",5),e.ynx(8),e.TgZ(9,"div",6)(10,"div",7)(11,"label",8),e._uU(12," Month Days "),e._UZ(13,"span",9),e.qZA(),e.TgZ(14,"input",10),e.NdJ("ngModelChange",function(o){return t.attendanceData.monthDays=o})("input",function(){return t.setAttendance()}),e.qZA()(),e.TgZ(15,"div",11)(16,"label",8),e._uU(17," Weekly Off "),e._UZ(18,"span",9),e.qZA(),e.TgZ(19,"input",12),e.NdJ("ngModelChange",function(o){return t.attendanceData.weeklyOff=o})("input",function(){return t.setAttendance()}),e.qZA()(),e.TgZ(20,"div",11)(21,"label",8),e._uU(22," Paid Holidays "),e._UZ(23,"span",9),e.qZA(),e.TgZ(24,"input",12),e.NdJ("ngModelChange",function(o){return t.attendanceData.paidHolidays=o})("input",function(){return t.setAttendance()}),e.qZA()(),e.TgZ(25,"div",11)(26,"label",8),e._uU(27," Paid Leaves/Comp off "),e._UZ(28,"span",9),e.qZA(),e.TgZ(29,"input",12),e.NdJ("ngModelChange",function(o){return t.attendanceData.paidLeaves=o})("input",function(){return t.setAttendance()}),e.qZA()()(),e.TgZ(30,"div",6)(31,"div",13)(32,"label",8),e._uU(33," OD Days "),e._UZ(34,"span",9),e.qZA(),e.TgZ(35,"input",12),e.NdJ("ngModelChange",function(o){return t.attendanceData.ODDays=o})("input",function(){return t.setAttendance()}),e.qZA()(),e.TgZ(36,"div",14)(37,"label",8),e._uU(38," Present Days "),e._UZ(39,"span",9),e.qZA(),e.TgZ(40,"input",12),e.NdJ("ngModelChange",function(o){return t.attendanceData.presentDays=o})("input",function(){return t.setAttendance()}),e.qZA()(),e.TgZ(41,"div",15)(42,"label",8),e._uU(43," LOP/Diff "),e._UZ(44,"span",9),e.qZA(),e.TgZ(45,"input",16),e.NdJ("ngModelChange",function(o){return t.attendanceData.LOPDiff=o}),e.qZA()()(),e.BQk(),e._UZ(46,"hr",17),e.TgZ(47,"div",18)(48,"div",19)(49,"div",20)(50,"button",21),e.NdJ("click",function(){return t.dismissModel()}),e._uU(51,"Save & Close"),e.qZA()()()()()()),2&n&&(e.xp6(14),e.Q6J("ngModel",t.attendanceData.monthDays),e.xp6(5),e.Q6J("ngModel",t.attendanceData.weeklyOff),e.xp6(5),e.Q6J("ngModel",t.attendanceData.paidHolidays),e.xp6(5),e.Q6J("ngModel",t.attendanceData.paidLeaves),e.xp6(6),e.Q6J("ngModel",t.attendanceData.ODDays),e.xp6(5),e.Q6J("ngModel",t.attendanceData.presentDays),e.xp6(5),e.Q6J("ngModel",t.attendanceData.LOPDiff))},dependencies:[d.Fj,d.wV,d.JJ,d.On],encapsulation:2}),r})();var D=l(68187),Z=l(88059),T=l(53421),C=l(95346);function w(s,r){if(1&s&&(e.TgZ(0,"option",36),e._uU(1),e.ALo(2,"date"),e.qZA()),2&s){const i=r.$implicit;e.Q6J("value",i.value),e.xp6(1),e.hij(" ",e.xi3(2,2,i.value,"MMMM YYYY")," ")}}function b(s,r){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(i.paidLeaves)}}function M(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"input",47),e.NdJ("ngModelChange",function(t){e.CHM(i);const a=e.oxw().$implicit;return e.KtG(a.paidLeaves=t)})("input",function(){e.CHM(i);const t=e.oxw().$implicit,a=e.oxw();return e.KtG(a.setLOP(t._id,t))}),e.qZA()}if(2&s){const i=e.oxw().$implicit;e.Q6J("ngModel",i.paidLeaves)}}function O(s,r){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const i=e.oxw().$implicit;e.xp6(1),e.Oqu(i.presentDays)}}function R(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"input",47),e.NdJ("ngModelChange",function(t){e.CHM(i);const a=e.oxw().$implicit;return e.KtG(a.presentDays=t)})("input",function(){e.CHM(i);const t=e.oxw().$implicit,a=e.oxw();return e.KtG(a.setLOP(t._id,t))}),e.qZA()}if(2&s){const i=e.oxw().$implicit;e.Q6J("ngModel",i.presentDays)}}const J=function(){return["Approved",null]};function U(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"a",44),e.NdJ("click",function(){e.CHM(i);const t=e.oxw().$implicit,a=e.oxw();return e.KtG(a.openAttendanceModal(t))}),e._UZ(1,"i",45),e._uU(2," Update "),e.qZA()}if(2&s){const i=e.oxw().$implicit,n=e.oxw();e.ekj("disable",e.DdM(3,J).includes(i.status)),e.Q6J("accessType",n.rolePermissionActions.editAction)}}function q(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",37),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"div",38),e.YNc(13,b,2,1,"span",39),e.YNc(14,M,1,1,"input",40),e.qZA()(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td")(18,"div",38),e.YNc(19,O,2,1,"span",39),e.YNc(20,R,1,1,"input",40),e.qZA()(),e.TgZ(21,"td"),e._uU(22),e.qZA(),e.TgZ(23,"td"),e._uU(24),e.qZA(),e.TgZ(25,"td")(26,"div",41),e._UZ(27,"button",42),e.TgZ(28,"div",43)(29,"a",44),e.NdJ("click",function(){const a=e.CHM(i).$implicit,o=e.oxw();return e.KtG(o.flag=a._id)}),e._UZ(30,"i",45),e._uU(31," Edit "),e.qZA(),e.YNc(32,U,3,4,"a",46),e.qZA()()()()}if(2&s){const i=r.$implicit,n=e.oxw();e.xp6(2),e.Oqu(null==i?null:i.employeeCode),e.xp6(2),e.Oqu(null==i?null:i.employeeName),e.xp6(2),e.Oqu(null==i?null:i.monthDays),e.xp6(2),e.Oqu(null==i?null:i.weeklyOff),e.xp6(2),e.Oqu(null==i?null:i.paidHolidays),e.xp6(3),e.Q6J("ngIf",i.status&&!("Draft"==i.status&&i._id==n.flag)),e.xp6(1),e.Q6J("ngIf",!i.status||"Draft"==i.status&&i._id==n.flag),e.xp6(2),e.Oqu(null==i?null:i.ODDays),e.xp6(3),e.Q6J("ngIf",i.status&&!("Draft"==i.status&&i._id==n.flag)),e.xp6(1),e.Q6J("ngIf",!i.status||"Draft"==i.status&&i._id==n.flag),e.xp6(2),e.Oqu(null==i?null:i.LOPDiff),e.xp6(2),e.Oqu(null==i?null:i.status),e.xp6(5),e.Q6J("accessType",n.rolePermissionActions.editAction),e.xp6(3),e.Q6J("ngIf",n.user==n.superAdminId)}}const k=function(s,r,i,n){return{page:s,pageSize:r,collection:i,search:n}};let S=(()=>{var s;class r{constructor(n,t,a,o,u,_,h){this.router=n,this.spinner=t,this.attendanceService=a,this.toastService=o,this.exportExcelService=u,this.modalService=_,this.storageService=h,this.page=1,this.pageSize=9,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.originTableData=[],this.user={},this.fromDate="",this.toDate="",this.attendanceForMonthYear=null,this.submitted=!1,this.date=new Date,this.flag=-1,this.month=new Date(this.date.getFullYear(),this.date.getMonth()+1,1).toISOString().slice(0,7),this.monthOptions=[{value:new Date(this.date.getFullYear(),this.date.getMonth()+1,1).toISOString().slice(0,7)},{value:new Date(this.date.getFullYear(),this.date.getMonth(),1).toISOString().slice(0,7)},{value:new Date(this.date.getFullYear(),this.date.getMonth()-1,1).toISOString().slice(0,7)}],this.btnFlag=!0,this.rolePermissionActions=A.a1,this.superAdminId="64a687b4e9143bffd820fb3d"}ngOnInit(){this.user=this.storageService.get("IDMSAUser")?.roles?.find(n=>n==this.superAdminId)}trackByFn(n,t){return t?._id}reset(){this.attendanceForMonthYear=null,this.tableData=[],this.collection=this.tableData.length}setLOP(n,t){let a=this.tableData.map(o=>o._id).indexOf(n);this.tableData[a].LOPDiff=t.monthDays-(t.paidLeaves+t.presentDays+t.weeklyOff+t.ODDays+t.paidHolidays)}create(n){this.spinner.show(),this.tableData=this.tableData.map(t=>(t.status=n,t)),this.attendanceService.create(this.tableData).subscribe(t=>{this.spinner.hide(),this.submitted=!1,this.tableData=[],this.attendanceForMonthYear=null,this.flag=-1,this.toastService.success(t.message)})}navigateTo(n,t,a){this.router.navigate([n],{queryParams:{id:t,action:a}})}eventHeader(n){switch(n.key){case"SEARCH":this.search=n.value,this.flag=-1;break;case"EXCEL":this.excelDownload(this.tableData);break;case"PAGE":this.page=n.value}}getAllData(){this.spinner.show(),this.attendanceService.getAllMasterData(this.attendanceForMonthYear).subscribe(n=>{this.tableData=n.attendanceOfMonth,this.collection=n.attendanceOfMonth.length,this.btnFlag=this.tableData.every(t=>"Approved"==t.status),this.spinner.hide()})}openAttendanceModal(n){if("Draft"==n?.status){let t=this.tableData.map(o=>o.employeeId).indexOf(n.employeeId);const a=this.modalService.open(y,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});a.componentInstance.attendanceData={monthDays:n.monthDays,weeklyOff:n.weeklyOff,paidHolidays:n.paidHolidays,paidLeaves:n.paidLeaves,ODDays:n.ODDays,presentDays:n.presentDays,LOPDiff:n.LOPDiff},a.result.then(o=>{o&&(this.tableData[t].weeklyOff=o.weeklyOff,this.tableData[t].paidHolidays=o.paidHolidays,this.tableData[t].paidLeaves=o.paidLeaves,this.tableData[t].ODDays=o.ODDays,this.tableData[t].presentDays=o.presentDays,this.tableData[t].LOPDiff=o.LOPDiff)},o=>{})}}onSort({column:n,direction:t}){this.headers.forEach(a=>{a.sortable!==n&&(a.direction="")}),this.tableData=""===t||""===n?this.tableData:[...this.tableData].sort((a,o)=>{let u="string"==typeof a[n]?a[n].toLowerCase():a[n],_="string"==typeof o[n]?o[n].toLowerCase():o[n];const h=u<_?-1:u>_?1:0;return"asc"===t?h:-h})}excelDownload(n){let t={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}},a={title:"Attendance Review",csvData:n,headers:[{header:"Employee Code",key:"employeeCode",...t},{header:"Employee Name",key:"employeeName",...t},{header:"Month Days",key:"monthDays",...t},{header:"Weekly Off",key:"weeklyOff",...t},{header:"Paid Holidays",key:"paidHolidays",...t},{header:"Paid Leaves",key:"paidLeaves",...t},{header:"OD Days",key:"ODDays",...t},{header:"Present Days",key:"presentDays",...t},{header:"LOP/Diff",key:"LOPDiff",...t},{header:"Status",key:"status",...t}]};this.exportExcelService.exportExcel(a)}}return(s=r).\u0275fac=function(n){return new(n||s)(e.Y36(m.F0),e.Y36(c.V),e.Y36(D.VG),e.Y36(c.kl),e.Y36(c.Ol),e.Y36(v.FF),e.Y36(c.V1))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-attendance-review"]],viewQuery:function(n,t){if(1&n&&e.Gf(f.j,5),2&n){let a;e.iGM(a=e.CRH())&&(t.headers=a)}},decls:58,vars:21,consts:[[1,"listCard","card","mb-4"],[1,"table-header"],[1,"heading"],[1,"row","justify-content-center","mt-4"],[1,"col-4"],[1,"row"],[1,"col-6","mt-1","pe-1"],[1,"form-label","text-nowrap"],[1,"text-danger"],[1,"col-1","ps-3","pe-0"],[1,"fa","fa-caret-right","mt-1","text-secondary"],[1,"col-5","ps-0"],[1,"form-select",3,"ngModel","ngModelChange","change"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"row","mt-3","line-border"],[1,"table-responsive",2,"min-height","33rem"],[3,"data","dataChange"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],["sortable","employeeCode",3,"sort"],["sortable","employeeName",1,"text-start",3,"sort"],["sortable","monthDays",3,"sort"],["sortable","weeklyOff",3,"sort"],["sortable","paidHolidays",3,"sort"],["sortable","paidLeaves",3,"sort"],["sortable","ODDays",3,"sort"],["sortable","presentDays",3,"sort"],["sortable","LOPDiff",3,"sort"],["sortable","isActive",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"line-border"],["appAccessControl","",1,"text-center","mt-3",3,"accessType"],["type","button",1,"btn","bg-primary","px-5","mx-2",3,"click"],["type","button",1,"btn","bg-primary","px-5","mx-2",3,"disabled","click"],[3,"value"],[1,"text-start"],[1,"d-flex","justify-content-center"],[4,"ngIf"],["class","form-control form-control-sm w-25","type","number",3,"ngModel","ngModelChange","input",4,"ngIf"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"],["appAccessControl","","href","javascript:void(0)",3,"disable","accessType","click",4,"ngIf"],["type","number",1,"form-control","form-control-sm","w-25",3,"ngModel","ngModelChange","input"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"Attendance Review"),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),e._uU(9,"Attendance for Month'Year"),e._UZ(10,"span",8),e.qZA()(),e.TgZ(11,"div",9),e._UZ(12,"i",10),e.qZA(),e.TgZ(13,"div",11)(14,"select",12),e.NdJ("ngModelChange",function(o){return t.attendanceForMonthYear=o})("change",function(){return t.getAllData()}),e.TgZ(15,"option",13),e._uU(16,"Select Month"),e.qZA(),e.YNc(17,w,3,5,"option",14),e.qZA()()()()(),e._UZ(18,"hr",15),e.TgZ(19,"div",16)(20,"app-setting-header",17),e.NdJ("dataChange",function(o){return t.eventHeader(o)}),e.qZA(),e.TgZ(21,"table",18)(22,"thead",19)(23,"tr",20)(24,"th",21),e.NdJ("sort",function(o){return t.onSort(o)}),e._uU(25,"Employee Code"),e.qZA(),e.TgZ(26,"th",22),e.NdJ("sort",function(o){return t.onSort(o)}),e._uU(27,"Employee Name"),e.qZA(),e.TgZ(28,"th",23),e.NdJ("sort",function(o){return t.onSort(o)}),e._uU(29,"Month Days"),e.qZA(),e.TgZ(30,"th",24),e.NdJ("sort",function(o){return t.onSort(o)}),e._uU(31,"Weekly Off"),e.qZA(),e.TgZ(32,"th",25),e.NdJ("sort",function(o){return t.onSort(o)}),e._uU(33,"Paid Holidays"),e.qZA(),e.TgZ(34,"th",26),e.NdJ("sort",function(o){return t.onSort(o)}),e._uU(35,"Paid Leaves/Comp off"),e.qZA(),e.TgZ(36,"th",27),e.NdJ("sort",function(o){return t.onSort(o)}),e._uU(37,"OD Days"),e.qZA(),e.TgZ(38,"th",28),e.NdJ("sort",function(o){return t.onSort(o)}),e._uU(39,"Present Days"),e.qZA(),e.TgZ(40,"th",29),e.NdJ("sort",function(o){return t.onSort(o)}),e._uU(41,"LOP/Diff"),e.qZA(),e.TgZ(42,"th",30),e.NdJ("sort",function(o){return t.onSort(o)}),e._uU(43,"Status"),e.qZA(),e.TgZ(44,"th"),e._uU(45,"Action"),e.qZA()()(),e.TgZ(46,"tbody"),e.YNc(47,q,33,14,"tr",31),e.ALo(48,"slice"),e.ALo(49,"searchFi1ter"),e.qZA()()(),e._UZ(50,"hr",32),e.TgZ(51,"div",33)(52,"button",34),e.NdJ("click",function(){return t.reset()}),e._uU(53,"Reset"),e.qZA(),e.TgZ(54,"button",35),e.NdJ("click",function(){return t.create("Draft")}),e._uU(55," Save "),e.qZA(),e.TgZ(56,"button",35),e.NdJ("click",function(){return t.create("Approved")}),e._uU(57," Approve "),e.qZA()()()),2&n&&(e.xp6(14),e.Q6J("ngModel",t.attendanceForMonthYear),e.xp6(1),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",t.monthOptions),e.xp6(3),e.Q6J("data",e.l5B(16,k,t.page,t.pageSize,t.collection,t.search)),e.xp6(27),e.Q6J("ngForOf",e.Dn7(48,9,e.xi3(49,13,t.tableData,t.search),(t.page-1)*t.pageSize,(t.page-1)*t.pageSize+t.pageSize))("ngForTrackBy",t.trackByFn),e.xp6(4),e.Q6J("accessType",t.rolePermissionActions.createAction),e.xp6(3),e.Q6J("disabled",t.btnFlag),e.xp6(2),e.Q6J("disabled",t.btnFlag))},dependencies:[p.sg,p.O5,Z.P,d.YN,d.Kr,d.Fj,d.wV,d.EJ,d.JJ,d.On,f.j,T.J,p.OU,p.uU,C.G],styles:[".fa-caret-right[_ngcontent-%COMP%]{font-size:2rem!important;margin-right:4rem!important}"]}),r})();var x=l(56208);const N=[{path:"",redirectTo:"attendance-review",pathMatch:"full"},{path:"attendance-review",component:S}];let L=(()=>{var s;class r{}return(s=r).\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[p.ez,m.Bz.forChild(N),x.m]}),r})()}}]);