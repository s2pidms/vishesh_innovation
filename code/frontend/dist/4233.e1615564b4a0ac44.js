"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[4233],{64233:(G,h,s)=>{s.r(h),s.d(h,{PayrollModule:()=>H});var _=s(96814),d=s(1076),m=s(43818),y=s(25116),t=s(65879),c=s(98977),f=s(68187),T=s(88059),p=s(60095),C=s(53421),Z=s(95346);function x(a,i){if(1&a&&(t.TgZ(0,"option",39),t._uU(1),t.ALo(2,"date"),t.qZA()),2&a){const e=i.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",t.xi3(2,2,e.value,"MMMM YYYY")," ")}}function b(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"th",40),t.NdJ("sort",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.onSort(n))}),t._uU(1,"Department"),t.qZA()}}function P(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"th",41),t.NdJ("sort",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.onSort(n))}),t._uU(1,"Paid Days"),t.qZA()}}function A(a,i){if(1&a&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(null==e?null:e.department)}}function v(a,i){if(1&a&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(null==e?null:e.paidDays)}}function w(a,i){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,null==e?null:e.PF,"1.2-2"),"")}}function S(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"input",51),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.PF=n)})("input",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.setNetPayable(n.employeeId,n))}),t.qZA()}if(2&a){const e=t.oxw().$implicit;t.Q6J("ngModel",e.PF)}}function M(a,i){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,null==e?null:e.ESIC,"1.2-2"),"")}}function J(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"input",51),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.ESIC=n)})("input",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.setNetPayable(n.employeeId,n))}),t.qZA()}if(2&a){const e=t.oxw().$implicit;t.Q6J("ngModel",e.ESIC)}}function F(a,i){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.TDS,"1.2-2"))}}function N(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"input",51),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.TDS=n)})("input",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.setNetPayable(n.employeeId,n))}),t.qZA()}if(2&a){const e=t.oxw().$implicit;t.Q6J("ngModel",e.TDS)}}function D(a,i){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,null==e?null:e.PT,"1.2-2"),"")}}function q(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"input",51),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.PT=n)})("input",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.setNetPayable(n.employeeId,n))}),t.qZA()}if(2&a){const e=t.oxw().$implicit;t.Q6J("ngModel",e.PT)}}function U(a,i){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,null==e?null:e.advSalary,"1.2-2"),"")}}function I(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"input",51),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.advSalary=n)})("input",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.setNetPayable(n.employeeId,n))}),t.qZA()}if(2&a){const e=t.oxw().$implicit;t.Q6J("ngModel",e.advSalary)}}function Y(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"a",48),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.update(n))}),t._UZ(1,"i",49),t._uU(2," Update "),t.qZA()}if(2&a){const e=t.oxw().$implicit,o=t.oxw();t.ekj("disable","Approved"==e.status),t.Q6J("accessType",o.rolePermissionActions.editAction)}}function Q(a,i){if(1&a){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",42),t._uU(4),t.qZA(),t.YNc(5,A,2,1,"td",43),t.YNc(6,v,2,1,"td",43),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"number"),t.qZA(),t.TgZ(10,"td"),t.YNc(11,w,3,4,"span",43),t.YNc(12,S,1,1,"input",44),t.qZA(),t.TgZ(13,"td"),t.YNc(14,M,3,4,"span",43),t.YNc(15,J,1,1,"input",44),t.qZA(),t.TgZ(16,"td"),t.YNc(17,F,3,4,"span",43),t.YNc(18,N,1,1,"input",44),t.qZA(),t.TgZ(19,"td")(20,"span"),t.YNc(21,D,3,4,"span",43),t.qZA(),t.YNc(22,q,1,1,"input",44),t.qZA(),t.TgZ(23,"td")(24,"span"),t.YNc(25,U,3,4,"span",43),t.qZA(),t.YNc(26,I,1,1,"input",44),t.qZA(),t.TgZ(27,"td"),t._uU(28),t.ALo(29,"number"),t.qZA(),t.TgZ(30,"td"),t._uU(31),t.qZA(),t.TgZ(32,"td")(33,"div",45),t._UZ(34,"button",46),t.TgZ(35,"div",47)(36,"a",48),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.flag=r._id)}),t._UZ(37,"i",49),t._uU(38," Edit "),t.qZA(),t.YNc(39,Y,3,3,"a",50),t.qZA()()()()}if(2&a){const e=i.$implicit,o=t.oxw();t.xp6(2),t.Oqu(null==e?null:e.employeeCode),t.xp6(2),t.Oqu(null==e?null:e.employeeName),t.xp6(1),t.Q6J("ngIf",o.showHeader),t.xp6(1),t.Q6J("ngIf",o.showHeader),t.xp6(2),t.Oqu(t.xi3(9,21,null==e?null:e.gross,"1.2-2")),t.xp6(3),t.Q6J("ngIf",!e.showFields),t.xp6(1),t.Q6J("ngIf",e.showFields),t.xp6(2),t.Q6J("ngIf",!e.showFields),t.xp6(1),t.Q6J("ngIf",e.showFields),t.xp6(2),t.Q6J("ngIf",e.status&&!("Draft"==e.status&&e._id==o.flag)&&!e.showFields),t.xp6(1),t.Q6J("ngIf",!e.status||"Draft"==e.status&&e._id==o.flag||e.showFields),t.xp6(3),t.Q6J("ngIf",!e.showFields),t.xp6(1),t.Q6J("ngIf",e.showFields),t.xp6(3),t.Q6J("ngIf",!e.showFields),t.xp6(1),t.Q6J("ngIf",e.showFields),t.xp6(2),t.Oqu(t.xi3(29,24,null==e?null:e.netPayable,"1.2-2")),t.xp6(3),t.Oqu(null==e?null:e.status),t.xp6(5),t.ekj("disable","Approved"==e.status),t.Q6J("accessType",o.rolePermissionActions.editAction),t.xp6(3),t.Q6J("ngIf",o.user==o.superAdminId)}}const E=function(a,i,e,o){return{page:a,pageSize:i,collection:e,search:o}},k=[{path:"",component:(()=>{class a{constructor(e,o,n,r,l,u){this.router=e,this.storageService=o,this.spinner=n,this.toastService=r,this.payrollService=l,this.exportExcelService=u,this.page=1,this.pageSize=9,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.originTableData=[],this.user={},this.fromDate="",this.toDate="",this.payrollForMonthYear=null,this.submitted=!1,this.date=new Date,this.flag=-1,this.superAdminId="64a687b4e9143bffd820fb3d",this.month=new Date(this.date.getFullYear(),this.date.getMonth()+1,1).toISOString().slice(0,7),this.monthOptions=[{value:new Date(this.date.getFullYear(),this.date.getMonth()+1,1).toISOString().slice(0,7)},{value:new Date(this.date.getFullYear(),this.date.getMonth(),1).toISOString().slice(0,7)},{value:new Date(this.date.getFullYear(),this.date.getMonth()-1,1).toISOString().slice(0,7)}],this.btnFlag=!0,this.showHeader=!0,this.rolePermissionActions=y.a1}ngOnInit(){this.user=this.storageService.get("IDMSAUser")?.roles?.find(e=>e==this.superAdminId)}trackByFn(e,o){return o?._id}reset(){this.showHeader=!0,this.payrollForMonthYear=null,this.tableData=[],this.collection=this.tableData.length}setNetPayable(e,o){let n=this.tableData.map(r=>r.employeeId).indexOf(e);this.tableData[n].netPayable=o.gross-(o.PF+o.ESIC+o.TDS+o.advSalary+o.PT)}create(e){this.spinner.show(),this.tableData=this.tableData.map(o=>(o.status=e,o)),this.payrollService.create(this.tableData).subscribe(o=>{this.spinner.hide(),this.submitted=!1,this.tableData=[],this.payrollForMonthYear=null,this.flag=-1,this.showHeader=!0,this.toastService.success(o.message)})}navigateTo(e,o,n){this.router.navigate([e],{queryParams:{id:o,action:n}})}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value,this.flag=-1;break;case"EXCEL":this.excelDownload(this.tableData);break;case"PAGE":this.page=e.value}}getAllData(){this.spinner.show(),this.payrollService.getAllMasterData(this.payrollForMonthYear).subscribe(e=>{this.spinner.hide(),this.tableData=e?.salaryPayrollOfMonth?.map(o=>(o.showFields=!1,o)),this.collection=e.salaryPayrollOfMonth.length,this.btnFlag=this.tableData.every(o=>"Approved"==o.status)})}onSort({column:e,direction:o}){this.headers.forEach(n=>{n.sortable!==e&&(n.direction="")}),this.tableData=""===o||""===e?this.tableData:[...this.tableData].sort((n,r)=>{let l="string"==typeof n[e]?n[e].toLowerCase():n[e],u="string"==typeof r[e]?r[e].toLowerCase():r[e];const g=l<u?-1:l>u?1:0;return"asc"===o?g:-g})}update(e){"Draft"==e?.status&&(e.showFields=!0,this.showHeader=!1)}excelDownload(e){let o={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}},n={title:"Payroll List",csvData:e,headers:[{header:"Employee Code",key:"employeeCode",...o},{header:"Employee Name",key:"employeeName",...o},{header:"Department",key:"department",...o},{header:"Paid Days",key:"paidDays",...o},{header:"Gross",key:"gross",...o},{header:"PF",key:"PF",...o},{header:"ESIC",key:"ESIC",...o},{header:"TDS",key:"TDS",...o},{header:"PT",key:"PT",...o},{header:"Adv. Salary",key:"advSalary",...o},{header:"Net Payable",key:"netPayable",...o},{header:"Status",key:"status",...o}]};this.exportExcelService.exportExcel(n)}static#t=this.\u0275fac=function(o){return new(o||a)(t.Y36(d.F0),t.Y36(c.V1),t.Y36(c.V),t.Y36(c.kl),t.Y36(f.Et),t.Y36(c.Ol))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-payroll"]],viewQuery:function(o,n){if(1&o&&t.Gf(m.j,5),2&o){let r;t.iGM(r=t.CRH())&&(n.headers=r)}},decls:60,vars:23,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],[1,"row","justify-content-center","mt-4"],[1,"col-4"],[1,"row"],[1,"col-5","mt-1","pe-1"],[1,"form-label","text-nowrap"],[1,"text-danger"],[1,"col-1","ps-3","pe-0"],[1,"fa","fa-caret-right","mt-1","text-secondary"],[1,"col-6","ps-0"],[1,"form-select",3,"ngModel","ngModelChange","change"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"row","mt-3","line-border"],[1,"table-responsive",2,"min-height","33rem"],[3,"data","dataChange"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],["sortable","employeeCode",3,"sort"],["sortable","employeeName",1,"text-start",3,"sort"],["sortable","department",3,"sort",4,"ngIf"],["sortable","paidDays",3,"sort",4,"ngIf"],["sortable","gross",3,"sort"],["sortable","PF",3,"sort"],["sortable","ESIC",3,"sort"],["sortable","TDS",3,"sort"],["sortable","PT",3,"sort"],["sortable","advSalary",3,"sort"],["sortable","netPayable",3,"sort"],["sortable","isActive",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"line-border"],["appAccessControl","",1,"text-center","mt-2",3,"accessType"],["type","button",1,"btn","bg-primary","px-5","mx-2",3,"click"],[1,"btn","bg-primary","px-5","mx-2",3,"disabled","click"],["type","button",1,"btn","bg-primary","px-5","mx-2",3,"disabled","click"],[3,"value"],["sortable","department",3,"sort"],["sortable","paidDays",3,"sort"],[1,"text-start"],[4,"ngIf"],["class","form-control form-control-xs w-25","type","number",3,"ngModel","ngModelChange","input",4,"ngIf"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"],["appAccessControl","","href","javascript:void(0)",3,"disable","accessType","click",4,"ngIf"],["type","number",1,"form-control","form-control-xs","w-25",3,"ngModel","ngModelChange","input"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3,"Payroll Management Staff"),t.qZA()(),t.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),t._uU(9,"Payroll for Month'Year"),t._UZ(10,"span",8),t.qZA()(),t.TgZ(11,"div",9),t._UZ(12,"i",10),t.qZA(),t.TgZ(13,"div",11)(14,"select",12),t.NdJ("ngModelChange",function(l){return n.payrollForMonthYear=l})("change",function(){return n.getAllData()}),t.TgZ(15,"option",13),t._uU(16,"Select Month"),t.qZA(),t.YNc(17,x,3,5,"option",14),t.qZA()()()()(),t._UZ(18,"hr",15),t.TgZ(19,"div",16)(20,"app-setting-header",17),t.NdJ("dataChange",function(l){return n.eventHeader(l)}),t.qZA(),t.TgZ(21,"table",18)(22,"thead",19)(23,"tr",20)(24,"th",21),t.NdJ("sort",function(l){return n.onSort(l)}),t._uU(25,"Employee Code"),t.qZA(),t.TgZ(26,"th",22),t.NdJ("sort",function(l){return n.onSort(l)}),t._uU(27,"Employee Name"),t.qZA(),t.YNc(28,b,2,0,"th",23),t.YNc(29,P,2,0,"th",24),t.TgZ(30,"th",25),t.NdJ("sort",function(l){return n.onSort(l)}),t._uU(31,"Gross"),t.qZA(),t.TgZ(32,"th",26),t.NdJ("sort",function(l){return n.onSort(l)}),t._uU(33,"PF"),t.qZA(),t.TgZ(34,"th",27),t.NdJ("sort",function(l){return n.onSort(l)}),t._uU(35,"ESIC"),t.qZA(),t.TgZ(36,"th",28),t.NdJ("sort",function(l){return n.onSort(l)}),t._uU(37,"TDS"),t.qZA(),t.TgZ(38,"th",29),t.NdJ("sort",function(l){return n.onSort(l)}),t._uU(39,"PT"),t.qZA(),t.TgZ(40,"th",30),t.NdJ("sort",function(l){return n.onSort(l)}),t._uU(41,"Adv. Salary"),t.qZA(),t.TgZ(42,"th",31),t.NdJ("sort",function(l){return n.onSort(l)}),t._uU(43,"Net Payable"),t.qZA(),t.TgZ(44,"th",32),t.NdJ("sort",function(l){return n.onSort(l)}),t._uU(45,"Status"),t.qZA(),t.TgZ(46,"th"),t._uU(47,"Action"),t.qZA()()(),t.TgZ(48,"tbody"),t.YNc(49,Q,40,27,"tr",33),t.ALo(50,"slice"),t.ALo(51,"searchFi1ter"),t.qZA()()(),t._UZ(52,"hr",34),t.TgZ(53,"div",35)(54,"button",36),t.NdJ("click",function(){return n.reset()}),t._uU(55,"Reset"),t.qZA(),t.TgZ(56,"button",37),t.NdJ("click",function(){return n.create("Draft")}),t._uU(57,"Save"),t.qZA(),t.TgZ(58,"button",38),t.NdJ("click",function(){return n.create("Approved")}),t._uU(59," Approve "),t.qZA()()()),2&o&&(t.xp6(14),t.Q6J("ngModel",n.payrollForMonthYear),t.xp6(1),t.Q6J("value",null),t.xp6(2),t.Q6J("ngForOf",n.monthOptions),t.xp6(3),t.Q6J("data",t.l5B(18,E,n.page,n.pageSize,n.collection,n.search)),t.xp6(8),t.Q6J("ngIf",n.showHeader),t.xp6(1),t.Q6J("ngIf",n.showHeader),t.xp6(20),t.Q6J("ngForOf",t.Dn7(50,11,t.xi3(51,15,n.tableData,n.search),(n.page-1)*n.pageSize,(n.page-1)*n.pageSize+n.pageSize))("ngForTrackBy",n.trackByFn),t.xp6(4),t.Q6J("accessType",n.rolePermissionActions.createAction),t.xp6(3),t.Q6J("disabled",n.btnFlag),t.xp6(2),t.Q6J("disabled",n.btnFlag))},dependencies:[_.sg,_.O5,T.P,p.YN,p.Kr,p.Fj,p.wV,p.EJ,p.JJ,p.On,m.j,C.J,_.OU,_.JJ,_.uU,Z.G],styles:[".fa-caret-right[_ngcontent-%COMP%]{font-size:2rem!important;margin-right:4rem!important}"]})}return a})()}];let O=(()=>{class a{static#t=this.\u0275fac=function(o){return new(o||a)};static#e=this.\u0275mod=t.oAB({type:a});static#n=this.\u0275inj=t.cJS({imports:[d.Bz.forChild(k),d.Bz]})}return a})();var $=s(56208);let H=(()=>{class a{static#t=this.\u0275fac=function(o){return new(o||a)};static#e=this.\u0275mod=t.oAB({type:a});static#n=this.\u0275inj=t.cJS({imports:[_.ez,O,$.m]})}return a})()}}]);