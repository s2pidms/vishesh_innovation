"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3632],{63632:(U,u,r)=>{r.r(u),r.d(u,{AttendanceReviewModule:()=>R});var d=r(96814),h=r(1076),_=r(43818),f=r(25116),t=r(65879),p=r(99328),v=r(68187),A=r(88059),c=r(60095),y=r(53421),Z=r(95346);function T(s,l){if(1&s&&(t.TgZ(0,"option",36),t._uU(1),t.ALo(2,"date"),t.qZA()),2&s){const e=l.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",t.xi3(2,2,e.value,"MMMM YYYY")," ")}}function D(s,l){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&s){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.paidLeaves)}}function w(s,l){if(1&s){const e=t.EpF();t.TgZ(0,"input",45),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.paidLeaves=n)})("input",function(){t.CHM(e);const n=t.oxw().$implicit,i=t.oxw();return t.KtG(i.setLOP(n._id,n))}),t.qZA()}if(2&s){const e=t.oxw().$implicit;t.Q6J("ngModel",e.paidLeaves)}}function b(s,l){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&s){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.presentDays)}}function C(s,l){if(1&s){const e=t.EpF();t.TgZ(0,"input",45),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.presentDays=n)})("input",function(){t.CHM(e);const n=t.oxw().$implicit,i=t.oxw();return t.KtG(i.setLOP(n._id,n))}),t.qZA()}if(2&s){const e=t.oxw().$implicit;t.Q6J("ngModel",e.presentDays)}}function O(s,l){if(1&s){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",37),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t.YNc(12,D,2,1,"span",38),t.YNc(13,w,1,1,"input",39),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t.YNc(17,b,2,1,"span",38),t.YNc(18,C,1,1,"input",39),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.qZA(),t.TgZ(23,"td")(24,"div",40),t._UZ(25,"button",41),t.TgZ(26,"div",42)(27,"a",43),t.NdJ("click",function(){const i=t.CHM(e).$implicit,o=t.oxw();return t.KtG(o.flag=i._id)}),t._UZ(28,"i",44),t._uU(29," Edit "),t.qZA()()()()()}if(2&s){const e=l.$implicit,a=t.oxw();t.xp6(2),t.Oqu(null==e?null:e.employeeCode),t.xp6(2),t.Oqu(null==e?null:e.employeeName),t.xp6(2),t.Oqu(null==e?null:e.monthDays),t.xp6(2),t.Oqu(null==e?null:e.weeklyOff),t.xp6(2),t.Oqu(null==e?null:e.paidHolidays),t.xp6(2),t.Q6J("ngIf",e.status&&!("Draft"==e.status&&e._id==a.flag)),t.xp6(1),t.Q6J("ngIf",!e.status||"Draft"==e.status&&e._id==a.flag),t.xp6(2),t.Oqu(null==e?null:e.ODDays),t.xp6(2),t.Q6J("ngIf",e.status&&!("Draft"==e.status&&e._id==a.flag)),t.xp6(1),t.Q6J("ngIf",!e.status||"Draft"==e.status&&e._id==a.flag),t.xp6(2),t.Oqu(null==e?null:e.LOPDiff),t.xp6(2),t.Oqu(null==e?null:e.status),t.xp6(5),t.Q6J("accessType",a.rolePermissionActions.editAction)}}const M=function(s,l,e,a){return{page:s,pageSize:l,collection:e,search:a}};let x=(()=>{class s{constructor(e,a,n,i,o){this.router=e,this.spinner=a,this.attendanceService=n,this.toastService=i,this.exportExcelService=o,this.page=1,this.pageSize=9,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.originTableData=[],this.user={},this.fromDate="",this.toDate="",this.attendanceForMonthYear=null,this.submitted=!1,this.date=new Date,this.flag=-1,this.month=new Date(this.date.getFullYear(),this.date.getMonth()+1,1).toISOString().slice(0,7),this.monthOptions=[{value:new Date(this.date.getFullYear(),this.date.getMonth()+1,1).toISOString().slice(0,7)},{value:new Date(this.date.getFullYear(),this.date.getMonth(),1).toISOString().slice(0,7)},{value:new Date(this.date.getFullYear(),this.date.getMonth()-1,1).toISOString().slice(0,7)}],this.btnFlag=!0,this.rolePermissionActions=f.a1}ngOnInit(){}trackByFn(e,a){return a?._id}reset(){this.attendanceForMonthYear=null,this.tableData=[],this.collection=this.tableData.length}setLOP(e,a){let n=this.tableData.map(i=>i._id).indexOf(e);this.tableData[n].LOPDiff=a.monthDays-(a.paidLeaves+a.presentDays+a.weeklyOff+a.ODDays+a.paidHolidays)}create(e){this.spinner.show(),this.tableData=this.tableData.map(a=>(a.status=e,a)),this.attendanceService.create(this.tableData).subscribe(a=>{this.spinner.hide(),this.submitted=!1,this.tableData=[],this.attendanceForMonthYear=null,this.flag=-1,this.toastService.success(a.message)})}navigateTo(e,a,n){this.router.navigate([e],{queryParams:{id:a,action:n}})}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value,this.flag=-1;break;case"EXCEL":this.excelDownload(this.tableData);break;case"PAGE":this.page=e.value}}getAllData(){this.spinner.show(),this.attendanceService.getAllMasterData(this.attendanceForMonthYear).subscribe(e=>{this.tableData=e.attendanceOfMonth,this.collection=e.attendanceOfMonth.length,this.btnFlag=this.tableData.every(a=>"Approved"==a.status),this.spinner.hide()})}onSort({column:e,direction:a}){this.headers.forEach(n=>{n.sortable!==e&&(n.direction="")}),this.tableData=""===a||""===e?this.tableData:[...this.tableData].sort((n,i)=>{let o="string"==typeof n[e]?n[e].toLowerCase():n[e],g="string"==typeof i[e]?i[e].toLowerCase():i[e];const m=o<g?-1:o>g?1:0;return"asc"===a?m:-m})}excelDownload(e){let a={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}},n={title:"Attendance Review",csvData:e,headers:[{header:"Employee Code",key:"employeeCode",...a},{header:"Employee Name",key:"employeeName",...a},{header:"Month Days",key:"monthDays",...a},{header:"Weekly Off",key:"weeklyOff",...a},{header:"Paid Holidays",key:"paidHolidays",...a},{header:"Paid Leaves",key:"paidLeaves",...a},{header:"OD Days",key:"ODDays",...a},{header:"Present Days",key:"presentDays",...a},{header:"LOP/Diff",key:"LOPDiff",...a},{header:"Status",key:"status",...a}]};this.exportExcelService.exportExcel(n)}static#t=this.\u0275fac=function(a){return new(a||s)(t.Y36(h.F0),t.Y36(p.V),t.Y36(v.VG),t.Y36(p.kl),t.Y36(p.Ol))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-attendance-review"]],viewQuery:function(a,n){if(1&a&&t.Gf(_.j,5),2&a){let i;t.iGM(i=t.CRH())&&(n.headers=i)}},decls:58,vars:21,consts:[[1,"listCard","card","mb-4"],[1,"table-header"],[1,"heading"],[1,"row","justify-content-center","mt-4"],[1,"col-4"],[1,"row"],[1,"col-6","mt-1","pe-1"],[1,"form-label","text-nowrap"],[1,"text-danger"],[1,"col-1","ps-3","pe-0"],[1,"fa","fa-caret-right","mt-1","text-secondary"],[1,"col-5","ps-0"],[1,"form-select",3,"ngModel","ngModelChange","change"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"row","mt-3","line-border"],[1,"table-responsive",2,"min-height","33rem"],[3,"data","dataChange"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],["sortable","employeeCode",3,"sort"],["sortable","employeeName",1,"text-start",3,"sort"],["sortable","monthDays",3,"sort"],["sortable","weeklyOff",3,"sort"],["sortable","paidHolidays",3,"sort"],["sortable","paidLeaves",3,"sort"],["sortable","ODDays",3,"sort"],["sortable","presentDays",3,"sort"],["sortable","LOPDiff",3,"sort"],["sortable","isActive",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"line-border"],["appAccessControl","",1,"text-center","mt-3",3,"accessType"],["type","button",1,"btn","bg-primary","px-5","mx-2",3,"click"],["type","button",1,"btn","bg-primary","px-5","mx-2",3,"disabled","click"],[3,"value"],[1,"text-start"],[4,"ngIf"],["class","form-control form-control-sm w-25","type","number",3,"ngModel","ngModelChange","input",4,"ngIf"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"],["type","number",1,"form-control","form-control-sm","w-25",3,"ngModel","ngModelChange","input"]],template:function(a,n){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3,"Attendance Review"),t.qZA()(),t.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),t._uU(9,"Attendance for Month'Year"),t._UZ(10,"span",8),t.qZA()(),t.TgZ(11,"div",9),t._UZ(12,"i",10),t.qZA(),t.TgZ(13,"div",11)(14,"select",12),t.NdJ("ngModelChange",function(o){return n.attendanceForMonthYear=o})("change",function(){return n.getAllData()}),t.TgZ(15,"option",13),t._uU(16,"Select Month"),t.qZA(),t.YNc(17,T,3,5,"option",14),t.qZA()()()()(),t._UZ(18,"hr",15),t.TgZ(19,"div",16)(20,"app-setting-header",17),t.NdJ("dataChange",function(o){return n.eventHeader(o)}),t.qZA(),t.TgZ(21,"table",18)(22,"thead",19)(23,"tr",20)(24,"th",21),t.NdJ("sort",function(o){return n.onSort(o)}),t._uU(25,"Employee Code"),t.qZA(),t.TgZ(26,"th",22),t.NdJ("sort",function(o){return n.onSort(o)}),t._uU(27,"Employee Name"),t.qZA(),t.TgZ(28,"th",23),t.NdJ("sort",function(o){return n.onSort(o)}),t._uU(29,"Month Days"),t.qZA(),t.TgZ(30,"th",24),t.NdJ("sort",function(o){return n.onSort(o)}),t._uU(31,"Weekly Off"),t.qZA(),t.TgZ(32,"th",25),t.NdJ("sort",function(o){return n.onSort(o)}),t._uU(33,"Paid Holidays"),t.qZA(),t.TgZ(34,"th",26),t.NdJ("sort",function(o){return n.onSort(o)}),t._uU(35,"Paid Leaves"),t.qZA(),t.TgZ(36,"th",27),t.NdJ("sort",function(o){return n.onSort(o)}),t._uU(37,"OD Days"),t.qZA(),t.TgZ(38,"th",28),t.NdJ("sort",function(o){return n.onSort(o)}),t._uU(39,"Present Days"),t.qZA(),t.TgZ(40,"th",29),t.NdJ("sort",function(o){return n.onSort(o)}),t._uU(41,"LOP/Diff"),t.qZA(),t.TgZ(42,"th",30),t.NdJ("sort",function(o){return n.onSort(o)}),t._uU(43,"Status"),t.qZA(),t.TgZ(44,"th"),t._uU(45,"Action"),t.qZA()()(),t.TgZ(46,"tbody"),t.YNc(47,O,30,13,"tr",31),t.ALo(48,"slice"),t.ALo(49,"searchFi1ter"),t.qZA()()(),t._UZ(50,"hr",32),t.TgZ(51,"div",33)(52,"button",34),t.NdJ("click",function(){return n.reset()}),t._uU(53,"Reset"),t.qZA(),t.TgZ(54,"button",35),t.NdJ("click",function(){return n.create("Draft")}),t._uU(55," Save "),t.qZA(),t.TgZ(56,"button",35),t.NdJ("click",function(){return n.create("Approved")}),t._uU(57," Approve "),t.qZA()()()),2&a&&(t.xp6(14),t.Q6J("ngModel",n.attendanceForMonthYear),t.xp6(1),t.Q6J("value",null),t.xp6(2),t.Q6J("ngForOf",n.monthOptions),t.xp6(3),t.Q6J("data",t.l5B(16,M,n.page,n.pageSize,n.collection,n.search)),t.xp6(27),t.Q6J("ngForOf",t.Dn7(48,9,t.xi3(49,13,n.tableData,n.search),(n.page-1)*n.pageSize,(n.page-1)*n.pageSize+n.pageSize))("ngForTrackBy",n.trackByFn),t.xp6(4),t.Q6J("accessType",n.rolePermissionActions.createAction),t.xp6(3),t.Q6J("disabled",n.btnFlag),t.xp6(2),t.Q6J("disabled",n.btnFlag))},dependencies:[d.sg,d.O5,A.P,c.YN,c.Kr,c.Fj,c.wV,c.EJ,c.JJ,c.On,_.j,y.J,d.OU,d.uU,Z.G],styles:[".fa-caret-right[_ngcontent-%COMP%]{font-size:2rem!important;margin-right:4rem!important}"]})}return s})();var J=r(56208);const S=[{path:"",redirectTo:"attendance-review",pathMatch:"full"},{path:"attendance-review",component:x}];let R=(()=>{class s{static#t=this.\u0275fac=function(a){return new(a||s)};static#e=this.\u0275mod=t.oAB({type:s});static#n=this.\u0275inj=t.cJS({imports:[d.ez,h.Bz.forChild(S),J.m]})}return s})()}}]);