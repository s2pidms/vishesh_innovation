"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3837],{83837:(Kt,C,d)=>{d.r(C),d.d(C,{StockPreparationModule:()=>Bt});var p=d(96814),S=d(1076),c=d(60095),Z=d(43818),y=d(25116);const I=[{message:"Process Name is Required",key:"processName"},{message:"Machine Name is Required",key:"machineName"},{message:"Prod. Date is Required",key:"processDate"},{message:"Prod. Shift is Required",key:"productionShift"},{message:"Production Staff is Required",key:"productionStaff"}];var t=d(65879),h=d(98977),g=d(99007),q=d(16897),R=d(88059),m=d(37285),w=d(50363),k=d(53421),M=d(95346),T=d(59103);function Q(l,s){1&l&&t._UZ(0,"div",59)}function J(l,s){1&l&&t._UZ(0,"div",60)}function F(l,s){1&l&&t._UZ(0,"div",61)}function P(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",49,50)(7,"span",51),t._uU(8),t.qZA()(),t.TgZ(9,"td",49,52)(11,"span",51),t._uU(12),t.qZA()(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"UOMUnitsMaster"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"number"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.TgZ(21,"span",53),t._uU(22," | "),t.qZA(),t._uU(23," mm "),t.qZA(),t.TgZ(24,"td"),t._uU(25),t.TgZ(26,"span",53),t._uU(27," | "),t.qZA(),t._uU(28," m "),t.qZA(),t.TgZ(29,"td"),t._uU(30),t.qZA(),t.TgZ(31,"td"),t._uU(32),t.qZA(),t.TgZ(33,"td")(34,"span",54),t.YNc(35,Q,1,0,"div",55),t.YNc(36,J,1,0,"div",56),t.YNc(37,F,1,0,"div",57),t.qZA()(),t.TgZ(38,"td")(39,"input",58),t.NdJ("change",function(){const i=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.setSelectData(i))}),t.qZA()()()}if(2&l){const e=s.$implicit,n=t.MAs(6),o=t.MAs(10),i=t.oxw(2);t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",n),t.xp6(1),t.hij(" ",null==e?null:e.itemName," "),t.xp6(1),t.Udp("width",o.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",o),t.xp6(1),t.hij(" ",null==e?null:e.itemDescription," "),t.xp6(2),t.Oqu(t.lcZ(15,22,null==e?null:e.UOM)),t.xp6(3),t.hij(" ",t.xi3(18,24,null==e?null:e.closedIRQty,"1.2-2")," "),t.xp6(3),t.hij(" ",null==e?null:e.width," "),t.xp6(5),t.hij(" ",null==e?null:e.length," "),t.xp6(5),t.hij(" ",null==e?null:e.SQM," "),t.xp6(2),t.hij(" ",null==e?null:e.roll," "),t.xp6(3),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status)),t.xp6(2),t.Q6J("checked",e._id==i.selectedData._id)}}function O(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"table",33)(1,"thead",34)(2,"tr",35)(3,"th",36),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(4,"MRN No."),t.qZA(),t.TgZ(5,"th",37),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(6,"Item Code"),t.qZA(),t.TgZ(7,"th",38),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(8,"Item Name"),t.qZA(),t.TgZ(9,"th",39),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(10,"Item Description"),t.qZA(),t.TgZ(11,"th",40),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(12,"UoM"),t.qZA(),t.TgZ(13,"th",41),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(14,"PPIC Qty"),t.qZA(),t.TgZ(15,"th",42),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(16,"Width"),t.qZA(),t.TgZ(17,"th",43),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(18,"Length"),t.qZA(),t.TgZ(19,"th",44),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(20,"sqm/roll"),t.qZA(),t.TgZ(21,"th",45),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(22,"Roll/s #"),t.qZA(),t.TgZ(23,"th",46),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(24,"Aging"),t.qZA(),t.TgZ(25,"th",47),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(26,"Select"),t.qZA()()(),t.TgZ(27,"tbody"),t.YNc(28,P,40,27,"tr",48),t.ALo(29,"slice"),t.ALo(30,"searchFi1ter"),t.qZA()()}if(2&l){const e=t.oxw();t.xp6(28),t.Q6J("ngForOf",t.Dn7(29,2,t.xi3(30,6,e.RMTableData,e.search),(e.page-1)*e.pageSize,(e.page-1)*e.pageSize+e.pageSize))("ngForTrackBy",e.trackByFn)}}function L(l,s){1&l&&t._UZ(0,"div",59)}function Y(l,s){1&l&&t._UZ(0,"div",60)}function j(l,s){1&l&&t._UZ(0,"div",61)}function G(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",49,50)(7,"span",51),t._uU(8),t.qZA()(),t.TgZ(9,"td",49,52)(11,"span",51),t._uU(12),t.qZA()(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"UOMUnitsMaster"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"number"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.TgZ(21,"span",53),t._uU(22," | "),t.qZA(),t._uU(23," mm "),t.qZA(),t.TgZ(24,"td"),t._uU(25),t.TgZ(26,"span",53),t._uU(27," | "),t.qZA(),t._uU(28," mm "),t.qZA(),t.TgZ(29,"td"),t._uU(30),t.qZA(),t.TgZ(31,"td"),t._uU(32),t.qZA(),t.TgZ(33,"td")(34,"span",54),t.YNc(35,L,1,0,"div",55),t.YNc(36,Y,1,0,"div",56),t.YNc(37,j,1,0,"div",57),t.qZA()(),t.TgZ(38,"td")(39,"input",58),t.NdJ("change",function(){const i=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.setSelectData(i))}),t.qZA()()()}if(2&l){const e=s.$implicit,n=t.MAs(6),o=t.MAs(10),i=t.oxw(2);t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",n),t.xp6(1),t.hij(" ",null==e?null:e.itemName," "),t.xp6(1),t.Udp("width",o.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",o),t.xp6(1),t.hij(" ",null==e?null:e.itemDescription," "),t.xp6(2),t.Oqu(t.lcZ(15,22,null==e?null:e.UOM)),t.xp6(3),t.hij(" ",t.xi3(18,24,null==e?null:e.closedIRQty,"1.2-2")," "),t.xp6(3),t.hij(" ",null==e?null:e.width," "),t.xp6(5),t.hij(" ",null==e?null:e.length," "),t.xp6(5),t.hij(" ",null==e?null:e.SQM," "),t.xp6(2),t.hij(" ",null==e?null:e.roll," "),t.xp6(3),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status)),t.xp6(2),t.Q6J("checked",e._id==i.selectedData._id)}}function B(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"table",33)(1,"thead",34)(2,"tr",35)(3,"th",36),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(4,"MRN No."),t.qZA(),t.TgZ(5,"th",37),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(6,"Item Code"),t.qZA(),t.TgZ(7,"th",38),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(8,"Item Name"),t.qZA(),t.TgZ(9,"th",39),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(10,"Item Description"),t.qZA(),t.TgZ(11,"th",40),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(12,"UoM"),t.qZA(),t.TgZ(13,"th",41),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(14,"PPIC Qty"),t.qZA(),t.TgZ(15,"th",42),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(16,"Width"),t.qZA(),t.TgZ(17,"th",43),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(18,"Length"),t.qZA(),t.TgZ(19,"th",44),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(20,"sqm/sheet"),t.qZA(),t.TgZ(21,"th",45),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(22,"Sheet #"),t.qZA(),t.TgZ(23,"th",46),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(24,"Aging"),t.qZA(),t.TgZ(25,"th",47),t.NdJ("sort",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onSort(o))}),t._uU(26,"Select"),t.qZA()()(),t.TgZ(27,"tbody"),t.YNc(28,G,40,27,"tr",48),t.ALo(29,"slice"),t.ALo(30,"searchFi1ter"),t.qZA()()}if(2&l){const e=t.oxw();t.xp6(28),t.Q6J("ngForOf",t.Dn7(29,2,t.xi3(30,6,e.sheetToSheetData,e.search),(e.page-1)*e.pageSize,(e.page-1)*e.pageSize+e.pageSize))("ngForTrackBy",e.trackByFn)}}const H=function(l,s,e,n){return{page:l,pageSize:s,collection:e,search:n,excelDisplay:"none"}},K=function(){return["Roll To Sheet","Roll To Roll","",null]},W=function(){return["Sheet To Sheet"]};let E=(()=>{class l{trackByFn(e,n){return n?._id}constructor(e,n,o,i,r,a,_){this.router=e,this.spinner=n,this.sfgStockService=o,this.wipInventoryService=i,this.validationService=r,this.utilityService=a,this.toastService=_,this.page=1,this.pageSize=5,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.submitted=!1,this.action="create",this.isPreview=!1,this.isESCPreview=!1,this.selectedData={},this.RMTableData=[],this.ESCPreviewArr=[],this.rolePermissionActions=y.a1,this.masterData={autoIncrementNo:"",processNames:[],machineNames:[],productionShifts:[],jobCardList:[]},this.sheetToSheetData=[],this.form=new c.nJ({SFGStockCode:new c.p4(null),processName:new c.p4(null,[c.kI.required]),machineName:new c.p4(null,[c.kI.required]),processDate:new c.p4(this.utilityService.getTodayDate("YYYY-MM-DD"),[c.kI.required]),productionShift:new c.p4(null,[c.kI.required]),productionStaff:new c.p4(null,[c.kI.required]),jobCardRef:new c.p4(null)})}ngOnInit(){this.getInitialData()}get f(){return this.form.controls}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value,this.page=1;break;case"EXCEL":default:break;case"PAGE":this.page=e.value}}setSelectData(e){this.selectedData=e}navigateTo(){if(this.validationService.checkErrors(this.form,I))return;let e="",n={};["Roll To Roll"].includes(this.f.processName.value)?(e="default/planning/transactions/pre_press/stock_preparation/roll_to_roll",n.stage="Roll To Roll"):["Roll To Sheet"].includes(this.f.processName.value)?(e="default/planning/transactions/pre_press/stock_preparation/roll_to_sheet",n.stage="Roll To Sheet"):["Sheet To Sheet"].includes(this.f.processName.value)&&(e="default/planning/transactions/pre_press/stock_preparation/sheet_to_sheet",n.stage="Sheet To Sheet"),n.type=this.selectedData?.type,n._id=this.selectedData?._id,this.router.navigate([e],{state:{data:JSON.stringify(n),formData:JSON.stringify(this.form.value)}})}setSheetToSheetData(){["Sheet To Sheet"].includes(this.f.processName.value)&&0==this.sheetToSheetData.length?(this.spinner.show(),this.sfgStockService.getSheetToSheetList({}).subscribe(e=>{console.log("success",e),this.sheetToSheetData=e,this.collection=this.sheetToSheetData.length,this.spinner.hide()})):this.collection=this.RMTableData.length}reset(){this.form.reset(),this.selectedData={},this.getInitialData()}preview(){this.isESCPreview=!0,this.search="",["Roll To Sheet","Roll To Roll"].includes(this.f.processName.value)?(this.ESCPreviewArr=this.RMTableData,this.RMTableData=this.RMTableData.filter(e=>e._id==this.selectedData._id),this.RMTableData.length>0?this.isPreview=!0:(this.toastService.warning("At least One Row is Required"),this.isPreview=!1),this.collection=this.RMTableData.length):(this.ESCPreviewArr=this.sheetToSheetData,this.sheetToSheetData=this.sheetToSheetData.filter(e=>e._id==this.selectedData._id),this.sheetToSheetData.length>0?this.isPreview=!0:(this.toastService.warning("At least One Row is Required"),this.isPreview=!1),this.collection=this.sheetToSheetData.length)}ESCPreview(){this.search="",this.isPreview=!1,["Roll To Sheet","Roll To Roll"].includes(this.f.processName.value)?(this.RMTableData=this.ESCPreviewArr,this.collection=this.RMTableData.length):(this.sheetToSheetData=this.ESCPreviewArr,this.collection=this.sheetToSheetData.length)}getInitialData(){this.spinner.show(),this.sfgStockService.getAllMasterData({}).subscribe(e=>{this.masterData=e,this.f.SFGStockCode.setValue(e.autoIncrementNo),this.f.processDate.setValue(this.utilityService.getTodayDate("YYYY-MM-DD")),this.setTableData(),this.spinner.hide()})}setTableData(){this.spinner.show(),this.sfgStockService.getAll({}).subscribe(e=>{e&&(this.RMTableData=e),this.collection=this.RMTableData.length,this.spinner.hide()})}onSort({column:e,direction:n}){this.headers.forEach(o=>{o.sortable!==e&&(o.direction="")}),this.RMTableData=""===n||""===e?this.RMTableData:[...this.RMTableData].sort((o,i)=>{let r="string"==typeof o[e]?o[e].toLowerCase():o[e],a="string"==typeof i[e]?i[e].toLowerCase():i[e];const _=r<a?-1:r>a?1:0;return"asc"===n?_:-_})}static#t=this.\u0275fac=function(n){return new(n||l)(t.Y36(S.F0),t.Y36(h.V),t.Y36(g.dV),t.Y36(g.w2),t.Y36(q.RJ),t.Y36(h.tI),t.Y36(h.kl))};static#e=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-stock-preparation-form"]],viewQuery:function(n,o){if(1&n&&t.Gf(Z.j,5),2&n){let i;t.iGM(i=t.CRH())&&(o.headers=i)}},decls:67,vars:20,consts:[[1,"formCard","card",3,"formGroup"],[1,"container"],[1,"row","form-header"],[1,"col","heading"],[1,""],[1,"form-body"],[1,"row","mb-0"],[1,"col-6"],[1,"row"],[1,"col-5","pe-0"],[1,"form-label","mb-0"],[1,"text-danger"],["bindValue","parameterName","bindLabel","parameterLabel","formControlName","processName",3,"items","clearable","change"],[1,"col-4","pe-0"],["bindValue","parameterName","bindLabel","parameterLabel","formControlName","machineName",3,"items","clearable"],[1,"col-3","pe-0"],["type","date","formControlName","processDate",1,"form-control"],["bindValue","parameterName","bindLabel","parameterLabel","formControlName","productionShift",3,"items","clearable"],["type","text","formControlName","productionStaff",1,"form-control"],[1,"col-4"],["type","text","formControlName","jobCardRef",1,"form-control"],[1,"mt-3","line-border-with-title"],[1,"px-4"],[3,"data","dataChange"],[1,"table-responsive","text-wrap",2,"min-height","19rem"],["class","table table-bordered mt-0 table-sm",4,"ngIf"],[1,"row","line-border"],["appAccessControl","",1,"col","text-center",3,"accessType"],[1,"d-grid","gap-2","d-md-block"],["type","button",1,"btn","btn-primary","px-5","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-3","me-1",3,"disabled","click"],["type","button",1,"btn","btn-primary","px-3","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-5",3,"disabled","click"],[1,"table","table-bordered","mt-0","table-sm"],[1,"bg-info"],[1,"text-white"],["sortable","MRNNumber",3,"sort"],["sortable","itemCode",3,"sort"],["sortable","itemName",1,"text-start",3,"sort"],["sortable","itemDescription",1,"text-start",3,"sort"],["sortable","UOM",3,"sort"],["sortable","closedIRQty",3,"sort"],["sortable","width",3,"sort"],["sortable","length",3,"sort"],["sortable","SQM",3,"sort"],["sortable","roll",3,"sort"],["sortable","status",3,"sort"],["sortable","select",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["itemName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["itemDescription",""],[1,"mx-2"],[1,"d-flex","justify-content-center"],["class","flaggreen",4,"ngIf"],["class","flagred",4,"ngIf"],["class","flagYellow",4,"ngIf"],["name","isSelect","type","radio",1,"form-check-input","pointer",3,"checked","change"],[1,"flaggreen"],[1,"flagred"],[1,"flagYellow"]],template:function(n,o){1&n&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5,"Stock Preparation (Pre-press)"),t.qZA()()(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"label",10),t._uU(12," Process Name"),t.TgZ(13,"span",11),t._uU(14,"*"),t.qZA()(),t.TgZ(15,"ng-select",12),t.NdJ("change",function(){return o.setSheetToSheetData()}),t.qZA()(),t.TgZ(16,"div",13)(17,"label",10),t._uU(18," Machine Name"),t.TgZ(19,"span",11),t._uU(20,"*"),t.qZA()(),t._UZ(21,"ng-select",14),t.qZA(),t.TgZ(22,"div",15)(23,"label",10),t._uU(24," Prod. Date"),t.TgZ(25,"span",11),t._uU(26,"*"),t.qZA()(),t._UZ(27,"input",16),t.qZA()()(),t.TgZ(28,"div",7)(29,"div",8)(30,"div",13)(31,"label",10),t._uU(32,"Prod. Shift "),t.TgZ(33,"span",11),t._uU(34,"*"),t.qZA()(),t._UZ(35,"ng-select",17),t.qZA(),t.TgZ(36,"div",13)(37,"label",10),t._uU(38," Production Staff"),t.TgZ(39,"span",11),t._uU(40,"*"),t.qZA()(),t._UZ(41,"input",18),t.qZA(),t.TgZ(42,"div",19)(43,"label",10),t._uU(44," Job Card Ref."),t._UZ(45,"span",11),t.qZA(),t._UZ(46,"input",20),t.qZA()()()()(),t.TgZ(47,"div",6)(48,"div",21)(49,"span",22),t._uU(50," Select Input for Process "),t.qZA()()(),t.TgZ(51,"app-setting-header",23),t.NdJ("dataChange",function(r){return o.eventHeader(r)}),t.qZA(),t.TgZ(52,"div",24),t.YNc(53,O,31,9,"table",25),t.YNc(54,B,31,9,"table",25),t.qZA(),t._UZ(55,"hr",26),t.TgZ(56,"div",8)(57,"div",27)(58,"div",28)(59,"button",29),t.NdJ("click",function(){return o.reset()}),t._uU(60,"Reset"),t.qZA(),t.TgZ(61,"button",30),t.NdJ("click",function(){return o.ESCPreview()}),t._uU(62," Esc "),t.qZA(),t.TgZ(63,"button",31),t.NdJ("click",function(){return o.preview()}),t._uU(64,"Preview"),t.qZA(),t.TgZ(65,"button",32),t.NdJ("click",function(){return o.navigateTo()}),t._uU(66," Process "),t.qZA()()()()()()),2&n&&(t.Q6J("formGroup",o.form),t.xp6(15),t.Q6J("items",o.masterData.processNames)("clearable",!1),t.xp6(6),t.Q6J("items",o.masterData.machineNames)("clearable",!1),t.xp6(14),t.Q6J("items",o.masterData.productionShifts)("clearable",!1),t.xp6(16),t.Q6J("data",t.l5B(13,H,o.page,o.pageSize,o.collection,o.search)),t.xp6(2),t.Q6J("ngIf",t.DdM(18,K).includes(o.f.processName.value)),t.xp6(1),t.Q6J("ngIf",t.DdM(19,W).includes(o.f.processName.value)),t.xp6(3),t.Q6J("accessType",o.rolePermissionActions.createAction),t.xp6(4),t.Q6J("disabled",!o.isESCPreview),t.xp6(4),t.Q6J("disabled",!o.selectedData._id))},dependencies:[p.sg,p.O5,R.P,m._L,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,w.w9,Z.j,k.J,p.OU,p.JJ,M.G,T.S],encapsulation:2})}return l})(),U=(()=>{class l{get f(){return this.form.controls}constructor(e,n,o){this.activeModal=e,this.validationService=n,this.utilityService=o,this.remarksDetails={},this.action="",this.form=new c.nJ({productionRemarks:new c.nJ({prodRemarks:new c.p4(null),checkedBy:new c.p4(null),approvedBy:new c.p4(null),approvedDate:new c.p4(this.utilityService.getTodayDate("YYYY-MM-DD"))}),QARemarks:new c.nJ({QARemark:new c.p4(null),checkedBy:new c.p4(null),approvedBy:new c.p4(null),approvedDate:new c.p4(this.utilityService.getTodayDate("YYYY-MM-DD"))})})}ngOnInit(){this.remarksDetails&&this.form.patchValue(this.remarksDetails),"view"==this.action&&this.form.disable()}dismissModel(){this.activeModal.close(this.form.value)}static#t=this.\u0275fac=function(n){return new(n||l)(t.Y36(m.Kz),t.Y36(q.RJ),t.Y36(h.tI))};static#e=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-roll-to-roll-remarks"]],inputs:{remarksDetails:"remarksDetails",action:"action"},decls:75,vars:1,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,""],[3,"formGroup"],["formGroupName","productionRemarks"],[1,"mt-0","line-border-with-title"],[1,"px-3"],[1,"row","px-5"],[1,"col-12"],[1,"form-label","mb-1"],[1,"text-danger"],[1,"d-flex"],["type","text","formControlName","prodRemarks",1,"form-control"],[1,"row","mt-4","px-5"],[1,"col-4"],["type","text","formControlName","checkedBy",1,"form-control"],["type","text","formControlName","approvedBy",1,"form-control"],["type","date","formControlName","approvedDate",1,"form-control"],["formGroupName","QARemarks"],[1,"line-border-with-title"],[1,"px-4"],["type","text","formControlName","QARemark",1,"form-control"],[1,"line-border","my-4"],[1,"col-12","d-flex","justify-content-center"],[1,"mb-4"],["type","button",1,"btn","bg-primary","px-4",3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Remarks"),t.qZA(),t.TgZ(4,"div")(5,"button",3),t.NdJ("click",function(){return o.activeModal.close()}),t._UZ(6,"i",4),t.qZA()()(),t.TgZ(7,"div",5)(8,"form",6),t.ynx(9,7),t.TgZ(10,"div",8)(11,"span",9),t._uU(12," Production Remarks "),t.qZA()(),t.TgZ(13,"div",10)(14,"div",11)(15,"label",12),t._uU(16," Prod. Remarks "),t._UZ(17,"span",13),t.qZA(),t.TgZ(18,"div",14),t._UZ(19,"input",15),t.qZA()()(),t.TgZ(20,"div",16)(21,"div",17)(22,"label",12),t._uU(23,"Checked by "),t._UZ(24,"span",13),t.qZA(),t.TgZ(25,"div",14),t._UZ(26,"input",18),t.qZA()(),t.TgZ(27,"div",17)(28,"label",12),t._uU(29," Approved by "),t._UZ(30,"span",13),t.qZA(),t.TgZ(31,"div",14),t._UZ(32,"input",19),t.qZA()(),t.TgZ(33,"div",17)(34,"label",12),t._uU(35," Approved Date "),t._UZ(36,"span",13),t.qZA(),t.TgZ(37,"div",14),t._UZ(38,"input",20),t.qZA()()(),t.BQk(),t.ynx(39,21),t.TgZ(40,"div",22)(41,"span",23),t._uU(42," \xa0 QA/QC Remarks \xa0 "),t.qZA()(),t.TgZ(43,"div",10)(44,"div",11)(45,"label",12),t._uU(46," QA/QC Remarks "),t._UZ(47,"span",13),t.qZA(),t.TgZ(48,"div",14),t._UZ(49,"input",24),t.qZA()()(),t.TgZ(50,"div",16)(51,"div",17)(52,"label",12),t._uU(53,"Checked by "),t._UZ(54,"span",13),t.qZA(),t.TgZ(55,"div",14),t._UZ(56,"input",18),t.qZA()(),t.TgZ(57,"div",17)(58,"label",12),t._uU(59," Approved by "),t._UZ(60,"span",13),t.qZA(),t.TgZ(61,"div",14),t._UZ(62,"input",19),t.qZA()(),t.TgZ(63,"div",17)(64,"label",12),t._uU(65," Approved Date "),t._UZ(66,"span",13),t.qZA(),t.TgZ(67,"div",14),t._UZ(68,"input",20),t.qZA()()(),t.BQk(),t._UZ(69,"hr",25),t.qZA(),t.TgZ(70,"div",10)(71,"div",26)(72,"div",27)(73,"button",28),t.NdJ("click",function(){return o.dismissModel()}),t._uU(74,"Save & Close"),t.qZA()()()()()()),2&n&&(t.xp6(8),t.Q6J("formGroup",o.form))},dependencies:[c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,c.x0],encapsulation:2})}return l})();function $(l,s){1&l&&t._UZ(0,"div",59)}function z(l,s){1&l&&t._UZ(0,"div",60)}function V(l,s){1&l&&t._UZ(0,"div",61)}function X(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",14,52)(7,"span",53),t._uU(8),t.qZA()(),t.TgZ(9,"td",14,54)(11,"span",53),t._uU(12),t.qZA()(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"UOMUnitsMaster"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"number"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.qZA(),t.TgZ(23,"td"),t._uU(24),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.qZA(),t.TgZ(27,"td")(28,"span",55),t.YNc(29,$,1,0,"div",56),t.YNc(30,z,1,0,"div",57),t.YNc(31,V,1,0,"div",58),t.qZA()()()),2&l){const e=s.$implicit,n=t.MAs(6),o=t.MAs(10);t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",n),t.xp6(1),t.hij(" ",e.itemName," "),t.xp6(1),t.Udp("width",o.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",o),t.xp6(1),t.hij(" ",null==e?null:e.itemDescription," "),t.xp6(2),t.Oqu(t.lcZ(15,21,null==e?null:e.UOM)),t.xp6(3),t.hij(" ",t.xi3(18,23,null==e?null:e.closedIRQty,"1.2-2")," "),t.xp6(3),t.hij("",null==e?null:e.width," | mm"),t.xp6(2),t.hij("",null==e?null:e.length," | m"),t.xp6(2),t.hij(" ",null==e?null:e.SQM," "),t.xp6(2),t.hij(" ",null==e?null:e.roll," "),t.xp6(3),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status))}}function tt(l,s){1&l&&t._UZ(0,"div",59)}function et(l,s){1&l&&t._UZ(0,"div",60)}function ot(l,s){1&l&&t._UZ(0,"div",61)}function nt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",14,52)(7,"span",53),t._uU(8),t.qZA()(),t.TgZ(9,"td",14)(10,"input",62),t.NdJ("ngModelChange",function(o){const r=t.CHM(e).$implicit;return t.KtG(r.itemDescription=o)}),t.qZA()(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"UOMUnitsMaster"),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.ALo(16,"number"),t.qZA(),t.TgZ(17,"td")(18,"div",19)(19,"input",63),t.NdJ("ngModelChange",function(o){const r=t.CHM(e).$implicit;return t.KtG(r.width=o)})("input",function(){const o=t.CHM(e),i=o.$implicit,r=o.index,a=t.oxw();return t.KtG(a.setRecoveryDetails(i,r))}),t.qZA(),t.TgZ(20,"span",64),t._uU(21," | "),t.qZA(),t._uU(22," mm "),t.qZA()(),t.TgZ(23,"td")(24,"div",19)(25,"input",63),t.NdJ("ngModelChange",function(o){const r=t.CHM(e).$implicit;return t.KtG(r.length=o)})("input",function(){const o=t.CHM(e),i=o.$implicit,r=o.index,a=t.oxw();return t.KtG(a.setRecoveryDetails(i,r))}),t.qZA(),t.TgZ(26,"span",64),t._uU(27," | "),t.qZA(),t._uU(28," m "),t.qZA()(),t.TgZ(29,"td"),t._uU(30),t.qZA(),t.TgZ(31,"td")(32,"div",19)(33,"input",63),t.NdJ("ngModelChange",function(o){const r=t.CHM(e).$implicit;return t.KtG(r.roll=o)})("input",function(){const o=t.CHM(e),i=o.$implicit,r=o.index,a=t.oxw();return t.KtG(a.setRecoveryDetails(i,r))}),t.qZA()()(),t.TgZ(34,"td")(35,"span",55),t.YNc(36,tt,1,0,"div",56),t.YNc(37,et,1,0,"div",57),t.YNc(38,ot,1,0,"div",58),t.qZA()()()}if(2&l){const e=s.$implicit,n=t.MAs(6);t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",n),t.xp6(1),t.hij(" ",e.itemName," "),t.xp6(2),t.Q6J("ngModel",e.itemDescription),t.xp6(2),t.Oqu(t.lcZ(13,17,null==e?null:e.UOM)),t.xp6(3),t.hij(" ",t.xi3(16,19,null==e?null:e.closedIRQty,"1.2-2")," "),t.xp6(4),t.Q6J("ngModel",e.width),t.xp6(6),t.Q6J("ngModel",e.length),t.xp6(5),t.hij(" ",null==e?null:e.SQM," "),t.xp6(3),t.Q6J("ngModel",e.roll),t.xp6(3),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status))}}let it=(()=>{class l{trackByFn(e,n){return n?._id}constructor(e,n,o,i,r,a,_,f){this.location=e,this.router=n,this.toastService=o,this.modalService=i,this.activatedRoute=r,this.sfgStockService=a,this.rollToRollConversionService=_,this.spinner=f,this.action="create",this.rollsQty=0,this.stockPreparation={},this.noOfRollsToBeSlit=0,this.outputDetails=[],this.selectedMRNDetails=[],this.totalRecoveryUsage=0,this.totalUsage=0,this.sqmToBeProcessed=0,this.recovery=0,this.recoveryPercentage=0,this.wastage=0,this.wastagePercentage=0,this.remarksDetails={},this.processNames="slit"}ngOnInit(){let e=this.location.getState();this.stockPreparation=JSON.parse(e.formData);let n=JSON.parse(e.data);this.sfgStockService.getStockPreparationByIdAndType(n).subscribe(o=>{this.selectedMRNDetails=JSON.parse(JSON.stringify(o?.output)).map(i=>(i.totalRoll=i.roll,i.totalClosedIRQty=i.closedIRQty,i.shelfLife=i.shelfLife,i)),this.outputDetails=o?.output.map(i=>(i.closedIRQty=0,i.width=0,i.length=0,i.SQM=0,i.roll=0,i.shelfLife=i.shelfLife,i.stage="Roll",i))})}deleteTableRow(){this.outputDetails.length>1&&(this.outputDetails.pop(),this.calTotalFn(),this.setRowSQMPerRoll())}addTableRow(){this.outputDetails=[...this.outputDetails,...JSON.parse(JSON.stringify(this.selectedMRNDetails)).map(e=>(e.closedIRQty=0,e.width=0,e.length=0,e.SQM=0,e.roll=0,e.shelfLife=e.shelfLife,e))]}setRowSQMPerRoll(){if(0!=this.selectedMRNDetails.length)return+this.noOfRollsToBeSlit>+this.selectedMRNDetails[0]?.totalRoll?(this.toastService.warning("No. of Rolls to be Processed Should be less than Selected Input Roll/s # !"),this.noOfRollsToBeSlit=0,this.sqmToBeProcessed=0,this.selectedMRNDetails[0].roll=this.selectedMRNDetails[0]?.totalRoll,void(this.selectedMRNDetails[0].closedIRQty=this.selectedMRNDetails[0].totalClosedIRQty)):(this.noOfRollsToBeSlit&&(this.sqmToBeProcessed=+this.noOfRollsToBeSlit*+this.selectedMRNDetails[0]?.SQM,this.selectedMRNDetails[0].closedIRQty=+this.selectedMRNDetails[0].totalClosedIRQty-+this.sqmToBeProcessed,this.selectedMRNDetails[0].roll=+(this.selectedMRNDetails[0]?.totalRoll-this.noOfRollsToBeSlit).toFixed(2)),void this.calTotalFn());this.toastService.warning("Selected Input Atleast one Data !")}setRecoveryDetails(e,n){if(this.noOfRollsToBeSlit)return e.width>this.selectedMRNDetails[0]?.width?(this.toastService.error("Width must be less than Selected Input width "),void(this.outputDetails[n].width=0)):e.length>this.selectedMRNDetails[0]?.length?(this.toastService.error("Length must be less than Selected Input length "),void(this.outputDetails[n].length=0)):(this.outputDetails[n].closedIRQty=+(+e?.roll*+e?.SQM).toFixed(2),this.outputDetails[n].SQM=+(+e?.width/1e3*+e?.length).toFixed(2),void this.calTotalFn());this.toastService.error(" No. of Rolls to be Processed must be greater than zero ")}totalAddition(e,n){return e.reduce((o,i)=>+o+ +i,0).toFixed(+n)}calTotalFn(){this.recovery=this.totalAddition(this.outputDetails.map(e=>+e.closedIRQty),2),this.recoveryPercentage=0==this.sqmToBeProcessed?0:+(100*+this.recovery/this.sqmToBeProcessed).toFixed(2),+this.recoveryPercentage>100&&this.toastService.error("Recovery should not be greater than 100% !!"),this.wastage=+(+this.sqmToBeProcessed-+this.recovery).toFixed(2),this.wastagePercentage=0==this.sqmToBeProcessed?0:+(100*this.wastage/this.sqmToBeProcessed).toFixed(2),+this.wastagePercentage>100&&this.toastService.error("Wastage should not be greater than 100% !!")}submit(){if(this.calTotalFn(),+this.recoveryPercentage>100||+this.recoveryPercentage<0)return void this.toastService.error("Recovery must be between 0 and 100% !!");if(+this.wastagePercentage>100||+this.wastagePercentage<0)return void this.toastService.error("Wastage must be between 0 and 100% !!");if(0==this.outputDetails.length)return void this.toastService.error("Output Details must be atleast one row!!");if(this.noOfRollsToBeSlit<1)return void this.toastService.error("No. of Rolls to be Processed must be greater than zero !!");let e={selectedMRNDetails:this.selectedMRNDetails,outputDetails:this.outputDetails,stockPreparation:this.stockPreparation,remarksDetails:this.remarksDetails,noOfRollsToBeSlit:this.noOfRollsToBeSlit,sqmToBeProcessed:this.sqmToBeProcessed,recovery:this.recovery,recoveryPercentage:this.recoveryPercentage,wastage:this.wastage,wastagePercentage:this.wastagePercentage};e&&(this.spinner.show(),this.rollToRollConversionService.create(e).subscribe(n=>{this.spinner.hide(),this.toastService.success(n.message),this.location.back()}))}reset(){this.outputDetails=JSON.parse(JSON.stringify(this.selectedMRNDetails)).map(e=>(e.closedIRQty=0,e.width=0,e.length=0,e.SQM=0,e.roll=0,e.shelfLife=e.shelfLife,e)),this.noOfRollsToBeSlit=0,this.sqmToBeProcessed=0,this.calTotalFn()}openRemarksDetailsModal(){const e=this.modalService.open(U,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});e.componentInstance.action=this.action,e.componentInstance.remarksDetails=this.remarksDetails,e.result.then(n=>{n&&(this.remarksDetails=n)},n=>{})}static#t=this.\u0275fac=function(n){return new(n||l)(t.Y36(p.S$),t.Y36(S.F0),t.Y36(h.kl),t.Y36(m.FF),t.Y36(S.gz),t.Y36(g.dV),t.Y36(g.bZ),t.Y36(h.V))};static#e=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-roll-to-roll-form"]],viewQuery:function(n,o){if(1&n&&t.Gf(Z.j,5),2&n){let i;t.iGM(i=t.CRH())&&(o.headers=i)}},decls:135,vars:8,consts:[[1,"formCard","card"],[1,"container"],[1,"row","form-header"],[1,"col","heading","ms-2"],[1,""],[1,"form-body"],[1,"row","mb-0"],[1,"col-12"],[1,"form-label"],[1,"row","d-flex","justify-content-center"],[1,"table-responsive"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],[1,"text-start"],[4,"ngFor","ngForOf"],[1,"row","line-border"],[1,"row","mb-4","justify-content-start"],[1,"col-4","pe-3"],[1,"d-flex","align-items-center"],[1,"form-label","text-nowrap"],[1,"ms-1","me-2"],["type","number",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"fs-3","ms-3"],[1,"col-2","ps-0"],[1,"d-flex"],["type","number","disabled","",1,"form-control","border-end-0",3,"ngModel","ngModelChange"],[1,"input-group-text","border","border-1","combine-INR","border-start-0"],[1,"vr","me-3"],[1,"table-responsive",2,"min-height","17rem"],[1,"border-0","seperator-row"],["colspan","6",1,"border-0"],[1,"add-icon"],["src","./assets/new_icons/add_row.svg","width","14","alt","",1,"pointer",3,"click"],[1,"minus-icon"],["src","./assets/new_icons/delete_row.svg","width","14","alt","",1,"pointer",3,"click"],[1,"row","mb-3"],[1,"col-3","pe-0"],[1,"plusIconSvg","btn","btn-primary","me-1"],["type","button",1,"btn","btn-primary","px-5",3,"click"],[1,"col-3","ps-0","pe-3","d-flex","align-items-center"],[1,"col-7","d-flex"],["type","number","readonly","",1,"form-control","ps-2","pe-0","border-end-0",3,"ngModel","ngModelChange"],[1,"input-group-text","combine-INR","border-start-0"],[1,"col-4"],["type","text","readonly","",1,"form-control","ps-2","pe-0",3,"value"],[1,"col-1","ms-4"],["src","./assets/new_icons/redstroke.svg","alt","","height","27","width","8"],[1,"col-3","ps-3","pe-0","d-flex","align-items-center"],["type","text","readonly","",1,"form-control","ps-2",3,"value"],[1,"col-3","mb-0","d-flex","align-self-end","justify-content-end"],["type","button",1,"btn","btn-primary","px-5","me-5",3,"click"],["itemName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["itemDescription",""],[1,"d-flex","justify-content-center"],["class","flaggreen",4,"ngIf"],["class","flagred",4,"ngIf"],["class","flagYellow",4,"ngIf"],[1,"flaggreen"],[1,"flagred"],[1,"flagYellow"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["type","number",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","input"],[1,"mx-2"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5," Roll-to-Roll "),t.qZA()()(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),t._uU(10," Selected Input "),t.qZA()()()(),t.TgZ(11,"div",9)(12,"div",7)(13,"div",10)(14,"table",11)(15,"thead",12)(16,"tr",13)(17,"th"),t._uU(18,"MRN No."),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Item Code"),t.qZA(),t.TgZ(21,"th",14),t._uU(22,"Item Name"),t.qZA(),t.TgZ(23,"th",14),t._uU(24,"Item Description"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"UoM"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"PPIC Qty"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Width"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"Length"),t.qZA(),t.TgZ(33,"th"),t._uU(34,"sqm/roll"),t.qZA(),t.TgZ(35,"th"),t._uU(36,"Roll/s #"),t.qZA(),t.TgZ(37,"th"),t._uU(38,"Aging"),t.qZA()()(),t.TgZ(39,"tbody"),t.YNc(40,X,32,26,"tr",15),t.qZA()()()()(),t._UZ(41,"hr",16),t.TgZ(42,"div",17)(43,"div",18)(44,"div",19)(45,"label",20),t._uU(46," No. of Rolls to be Processed "),t.TgZ(47,"span",21),t._uU(48,"\u25b6"),t.qZA()(),t.TgZ(49,"input",22),t.NdJ("ngModelChange",function(r){return o.noOfRollsToBeSlit=r})("input",function(){return o.setRowSQMPerRoll()}),t.qZA(),t.TgZ(50,"span",23),t._uU(51," = "),t.qZA()()(),t.TgZ(52,"div",24)(53,"div",25)(54,"input",26),t.NdJ("ngModelChange",function(r){return o.sqmToBeProcessed=r}),t.qZA(),t.TgZ(55,"span",27),t._UZ(56,"div",28),t._uU(57," sqm "),t.qZA()()()(),t.TgZ(58,"div",9)(59,"div",7)(60,"div",29)(61,"table",11)(62,"thead",12)(63,"tr",13)(64,"th"),t._uU(65,"MRN No."),t.qZA(),t.TgZ(66,"th"),t._uU(67,"Item Code"),t.qZA(),t.TgZ(68,"th",14),t._uU(69,"Item Name"),t.qZA(),t.TgZ(70,"th",14),t._uU(71,"Item Description"),t.qZA(),t.TgZ(72,"th"),t._uU(73,"UoM"),t.qZA(),t.TgZ(74,"th"),t._uU(75,"PPIC Qty"),t.qZA(),t.TgZ(76,"th"),t._uU(77,"Width"),t.qZA(),t.TgZ(78,"th"),t._uU(79,"Length"),t.qZA(),t.TgZ(80,"th"),t._uU(81,"sqm/roll"),t.qZA(),t.TgZ(82,"th"),t._uU(83,"Roll/s #"),t.qZA(),t.TgZ(84,"th"),t._uU(85,"Aging"),t.qZA()()(),t.TgZ(86,"tbody"),t.YNc(87,nt,39,22,"tr",15),t.TgZ(88,"tr",30)(89,"td",31)(90,"div",32)(91,"img",33),t.NdJ("click",function(){return o.addTableRow()}),t.qZA()()(),t.TgZ(92,"td",31)(93,"div",34)(94,"img",35),t.NdJ("click",function(){return o.deleteTableRow()}),t.qZA()()()()()()()()(),t._UZ(95,"hr",16),t.TgZ(96,"div",36)(97,"div",37),t._UZ(98,"button",38),t.TgZ(99,"button",39),t.NdJ("click",function(){return o.openRemarksDetailsModal()}),t._uU(100,"Remarks"),t.qZA()(),t.TgZ(101,"div",40)(102,"label",20),t._uU(103," Recovery "),t.TgZ(104,"span",21),t._uU(105,"\u25b6"),t.qZA()(),t.TgZ(106,"div",25)(107,"div",41)(108,"input",42),t.NdJ("ngModelChange",function(r){return o.recovery=r}),t.qZA(),t.TgZ(109,"span",43),t._UZ(110,"div",28),t._uU(111," sqm "),t.qZA()(),t.TgZ(112,"div",44),t._UZ(113,"input",45),t.qZA(),t.TgZ(114,"div",46)(115,"span",4),t._UZ(116,"img",47),t.qZA()()()(),t.TgZ(117,"div",48)(118,"label",20),t._uU(119," Wastage "),t.TgZ(120,"span",21),t._uU(121,"\u25b6"),t.qZA()(),t.TgZ(122,"div",25)(123,"div",41)(124,"input",42),t.NdJ("ngModelChange",function(r){return o.wastage=r}),t.qZA(),t.TgZ(125,"span",43),t._UZ(126,"div",28),t._uU(127," sqm "),t.qZA()(),t.TgZ(128,"div",44),t._UZ(129,"input",49),t.qZA()()(),t.TgZ(130,"div",50)(131,"button",51),t.NdJ("click",function(){return o.reset()}),t._uU(132,"Reset"),t.qZA(),t.TgZ(133,"button",39),t.NdJ("click",function(){return o.submit()}),t._uU(134,"Save"),t.qZA()()()()()),2&n&&(t.xp6(40),t.Q6J("ngForOf",o.selectedMRNDetails),t.xp6(9),t.Q6J("ngModel",o.noOfRollsToBeSlit),t.xp6(5),t.Q6J("ngModel",o.sqmToBeProcessed),t.xp6(33),t.Q6J("ngForOf",o.outputDetails),t.xp6(21),t.Q6J("ngModel",o.recovery),t.xp6(5),t.Q6J("value",o.recoveryPercentage+" %"),t.xp6(11),t.Q6J("ngModel",o.wastage),t.xp6(5),t.Q6J("value",o.wastagePercentage+" %"))},dependencies:[p.sg,p.O5,m._L,c.Fj,c.wV,c.JJ,c.On,p.JJ,T.S],styles:[".seperator-row[_ngcontent-%COMP%]{position:relative}.seperator-row[_ngcontent-%COMP%]   .add-icon[_ngcontent-%COMP%]{position:absolute;left:-1.2rem;top:-.9rem}.seperator-row[_ngcontent-%COMP%]   .minus-icon[_ngcontent-%COMP%]{position:absolute;right:-1.2rem;top:-.9rem}"]})}return l})();var lt=d(56208);function rt(l,s){1&l&&(t.TgZ(0,"span"),t._uU(1,"| mm"),t.qZA())}function st(l,s){1&l&&(t.TgZ(0,"span"),t._uU(1,"| mm"),t.qZA())}function at(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",28,29)(5,"span",30),t._uU(6),t.qZA()(),t.TgZ(7,"td",28,31)(9,"span",30),t._uU(10),t.qZA()(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"UOMUnitsMaster"),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.YNc(16,rt,2,0,"span",32),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.YNc(19,st,2,0,"span",32),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.qZA(),t.TgZ(22,"td")(23,"input",33),t.NdJ("change",function(){const i=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.setSelectData(i))}),t.qZA()()()}if(2&l){const e=s.$implicit,n=s.index,o=t.MAs(4),i=t.MAs(8),r=t.oxw();t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",o.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",o),t.xp6(1),t.hij(" ",e.itemName," "),t.xp6(1),t.Udp("width",i.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",null==e?null:e.itemDescription)("positionTarget",i),t.xp6(1),t.hij(" ",null==e?null:e.itemDescription," "),t.xp6(2),t.Oqu(t.lcZ(13,20,null==e?null:e.UOM)),t.xp6(3),t.hij("",null==e?null:e.widthInMM," "),t.xp6(1),t.Q6J("ngIf",e.widthInMM),t.xp6(2),t.hij("",null==e?null:e.lengthInM," "),t.xp6(1),t.Q6J("ngIf",e.widthInMM),t.xp6(2),t.Oqu(null==e?null:e.SQM),t.xp6(2),t.MGl("name","formValue",r.childItemList[n],""),t.Q6J("disabled","view"==r.action)("checked",e.select)}}const ct=function(l,s,e,n){return{page:l,pageSize:s,collection:e,search:n,excelDisplay:"none"}};let v=(()=>{class l{constructor(e){this.activeModal=e,this.action="edit",this.HSNCode="",this.editScreen="",this.childItemList=[],this.outputDetails={},this.btnDisable=!1,this.page=1,this.pageSize=9,this.collection=0,this.search="",this.column="createdAt",this.direction=-1,this.HSNSelect=null,this.HSNSelectCode=null,this.selectedChildItem={}}ngOnInit(){this.collection=this.childItemList.length}setSelectData(e){this.selectedChildItem=e,console.log("this.selectedChildItem",this.selectedChildItem)}dismissModel(){this.outputDetails=this.outputDetails.map(e=>(e.closedIRQty=0,e.width=this.selectedChildItem.widthInMM,e.length=this.selectedChildItem.lengthInM,e.SQM=this.selectedChildItem.SQM,e.UOM="SQM",e.roll=0,e.item=this.selectedChildItem._id,e.referenceModel="ChildItem",e.itemCode=this.selectedChildItem.itemCode,e.itemName=this.selectedChildItem.itemName,e.itemDescription=this.selectedChildItem.itemDescription,e)),this.activeModal.close(this.outputDetails)}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value;break;case"EXCEL":default:break;case"PAGE":this.page=e.value}}onSort({column:e,direction:n}){this.headers.forEach(o=>{o.sortable!==e&&(o.direction="")}),this.childItemList=""===n||""===e?this.childItemList:[...this.childItemList].sort((o,i)=>{let r="string"==typeof o[e]?o[e].toLowerCase():o[e],a="string"==typeof i[e]?i[e].toLowerCase():i[e];const _=r<a?-1:r>a?1:0;return"asc"===n?_:-_})}static#t=this.\u0275fac=function(n){return new(n||l)(t.Y36(m.Kz))};static#e=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-item-roll-to-sheet"]],viewQuery:function(n,o){if(1&n&&t.Gf(Z.j,5),2&n){let i;t.iGM(i=t.CRH())&&(o.headers=i)}},inputs:{action:"action",HSNCode:"HSNCode",editScreen:"editScreen",childItemList:"childItemList",outputDetails:"outputDetails"},decls:43,vars:14,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,""],[1,"container-fluid"],[1,"row","justify-content-center"],[1,"col-12","px-0","mt-4"],[1,"px-5","mt-0"],[3,"data","dataChange"],[1,"table-responsive","px-5",2,"min-height","33rem"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],["sortable","itemCode",3,"sort"],["sortable","itemName",1,"text-start",3,"sort"],["sortable","itemDescription",1,"text-start",3,"sort"],["sortable","UOM",3,"sort"],["sortable","widthInMM",3,"sort"],["sortable","lengthInM",3,"sort"],["sortable","SQM",3,"sort"],[4,"ngFor","ngForOf"],[1,"row"],[1,"col","px-0","mb-3"],[1,"line-border"],[1,"text-center","mb-2"],["type","button",1,"btn","bg-primary","px-5","mb-4",3,"click"],[1,"text-start"],["itemName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["itemDescription",""],[4,"ngIf"],["type","radio",1,"form-check-input","pointer",3,"disabled","name","checked","change"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Select Child Item"),t.qZA(),t.TgZ(4,"div")(5,"button",3),t.NdJ("click",function(){return o.activeModal.close()}),t._UZ(6,"i",4),t.qZA()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"app-setting-header",10),t.NdJ("dataChange",function(r){return o.eventHeader(r)}),t.qZA()(),t.TgZ(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr",14)(17,"th",15),t.NdJ("sort",function(r){return o.onSort(r)}),t._uU(18,"Item Code"),t.qZA(),t.TgZ(19,"th",16),t.NdJ("sort",function(r){return o.onSort(r)}),t._uU(20,"Item Name"),t.qZA(),t.TgZ(21,"th",17),t.NdJ("sort",function(r){return o.onSort(r)}),t._uU(22," Item Description "),t.qZA(),t.TgZ(23,"th",18),t.NdJ("sort",function(r){return o.onSort(r)}),t._uU(24,"UoM"),t.qZA(),t.TgZ(25,"th",19),t.NdJ("sort",function(r){return o.onSort(r)}),t._uU(26,"Width"),t.qZA(),t.TgZ(27,"th",20),t.NdJ("sort",function(r){return o.onSort(r)}),t._uU(28,"Length"),t.qZA(),t.TgZ(29,"th",21),t.NdJ("sort",function(r){return o.onSort(r)}),t._uU(30,"sqm/sheet"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"Select"),t.qZA()()(),t.TgZ(33,"tbody"),t.YNc(34,at,24,22,"tr",22),t.ALo(35,"slice"),t.ALo(36,"searchFi1ter"),t.qZA()()()()(),t.TgZ(37,"div",23)(38,"div",24),t._UZ(39,"hr",25),t.qZA()(),t.TgZ(40,"div",26)(41,"button",27),t.NdJ("click",function(){return o.dismissModel()}),t._uU(42,"Save & Close"),t.qZA()()()()()),2&n&&(t.xp6(12),t.Q6J("data",t.l5B(9,ct,o.page,o.pageSize,o.collection,o.search)),t.xp6(22),t.Q6J("ngForOf",t.Dn7(35,2,t.xi3(36,6,o.childItemList,o.search),(o.page-1)*o.pageSize,(o.page-1)*o.pageSize+o.pageSize)))},dependencies:[p.sg,p.O5,R.P,m._L,Z.j,p.OU,M.G,T.S],encapsulation:2})}return l})();function ut(l,s){1&l&&t._UZ(0,"div",33)}function pt(l,s){1&l&&t._UZ(0,"div",34)}function dt(l,s){1&l&&t._UZ(0,"div",35)}function _t(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",14,26)(7,"span",27),t._uU(8),t.qZA()(),t.TgZ(9,"td",14,28)(11,"span",27),t._uU(12),t.qZA()(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"UOMUnitsMaster"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"number"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.qZA(),t.TgZ(23,"td"),t._uU(24),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.qZA(),t.TgZ(27,"td")(28,"span",29),t.YNc(29,ut,1,0,"div",30),t.YNc(30,pt,1,0,"div",31),t.YNc(31,dt,1,0,"div",32),t.qZA()()()),2&l){const e=s.$implicit,n=t.MAs(6),o=t.MAs(10);t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",n),t.xp6(1),t.hij(" ",e.itemName," "),t.xp6(1),t.Udp("width",o.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",o),t.xp6(1),t.hij(" ",e.itemDescription," "),t.xp6(2),t.Oqu(t.lcZ(15,21,null==e?null:e.UOM)),t.xp6(3),t.hij(" ",t.xi3(18,23,null==e?null:e.closedIRQty,"1.2-2")," "),t.xp6(3),t.hij("",null==e?null:e.width," | mm"),t.xp6(2),t.hij("",null==e?null:e.length," | m"),t.xp6(2),t.hij(" ",null==e?null:e.SQM," "),t.xp6(2),t.hij(" ",null==e?null:e.roll," "),t.xp6(3),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status))}}function ht(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"a",40),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.openChildItemModal())}),t._uU(1," Click here"),t.qZA()}}function mt(l,s){1&l&&t._UZ(0,"div",33)}function gt(l,s){1&l&&t._UZ(0,"div",34)}function Zt(l,s){1&l&&t._UZ(0,"div",35)}function Tt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.YNc(5,ht,2,0,"a",36),t.qZA(),t.TgZ(6,"td",14,26)(8,"span",27),t._uU(9),t.qZA()(),t.TgZ(10,"td",14,28)(12,"span",27),t._uU(13),t.qZA()(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"number"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.TgZ(21,"span",37),t._uU(22," | "),t.qZA(),t._uU(23," mm "),t.qZA(),t.TgZ(24,"td"),t._uU(25),t.TgZ(26,"span",37),t._uU(27," | "),t.qZA(),t._uU(28," mm "),t.qZA(),t.TgZ(29,"td"),t._uU(30),t.qZA(),t.TgZ(31,"td")(32,"div",38)(33,"input",39),t.NdJ("ngModelChange",function(o){const r=t.CHM(e).$implicit;return t.KtG(r.roll=o)})("input",function(){const o=t.CHM(e),i=o.$implicit,r=o.index,a=t.oxw();return t.KtG(a.setSheetDetails(i,r))}),t.qZA()()(),t.TgZ(34,"td")(35,"span",29),t.YNc(36,mt,1,0,"div",30),t.YNc(37,gt,1,0,"div",31),t.YNc(38,Zt,1,0,"div",32),t.qZA()()()}if(2&l){const e=s.$implicit,n=t.MAs(7),o=t.MAs(11);t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.hij(" ",e.itemCode?e.itemCode:null," "),t.xp6(1),t.Q6J("ngIf",!e.itemCode),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",n),t.xp6(1),t.hij(" ",e.itemName," "),t.xp6(1),t.Udp("width",o.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",o),t.xp6(1),t.hij(" ",e.itemDescription," "),t.xp6(2),t.Oqu(null==e?null:e.UOM),t.xp6(2),t.hij(" ",t.xi3(18,22,null==e?null:e.closedIRQty,"1.2-2")," "),t.xp6(3),t.hij(" ",null==e?null:e.width," "),t.xp6(5),t.hij(" ",null==e?null:e.length," "),t.xp6(5),t.hij(" ",null==e?null:e.SQM," "),t.xp6(3),t.Q6J("ngModel",e.roll),t.xp6(3),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status))}}function ft(l,s){if(1&l&&(t.TgZ(0,"span",43),t._uU(1),t.qZA()),2&l){const e=t.oxw().$implicit,n=t.MAs(10);t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",n),t.xp6(1),t.hij(" ",null==e?null:e.itemDescription," ")}}function St(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"input",44),t.NdJ("ngModelChange",function(o){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.itemDescription=o)}),t.qZA()}if(2&l){const e=t.oxw().$implicit;t.Q6J("ngModel",e.itemDescription)}}function bt(l,s){1&l&&t._UZ(0,"div",33)}function Ut(l,s){1&l&&t._UZ(0,"div",34)}function vt(l,s){1&l&&t._UZ(0,"div",35)}function At(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",14,26)(7,"span",27),t._uU(8),t.qZA()(),t.TgZ(9,"td",14,28),t.YNc(11,ft,2,3,"span",41),t.YNc(12,St,1,1,"input",42),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"UOMUnitsMaster"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"number"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.qZA(),t.TgZ(23,"td"),t._uU(24),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.qZA(),t.TgZ(27,"td")(28,"span",29),t.YNc(29,bt,1,0,"div",30),t.YNc(30,Ut,1,0,"div",31),t.YNc(31,vt,1,0,"div",32),t.qZA()()()),2&l){const e=s.$implicit,n=s.index,o=t.MAs(6),i=t.MAs(10);t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",o.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",o),t.xp6(1),t.hij(" ",null==e?null:e.itemName," "),t.xp6(1),t.Udp("width",i.clientWidth),t.xp6(2),t.Q6J("ngIf",0==n),t.xp6(1),t.Q6J("ngIf",1==n),t.xp6(2),t.Oqu(t.lcZ(15,20,null==e?null:e.UOM)),t.xp6(3),t.hij(" ",t.xi3(18,22,null==e?null:e.closedIRQty,"1.2-2")," "),t.xp6(3),t.hij("",null==e?null:e.width," | mm"),t.xp6(2),t.hij("",null==e?null:e.length," | m"),t.xp6(2),t.hij(" ",null==e?null:e.SQM," "),t.xp6(2),t.hij(" ",null==e?null:e.roll," "),t.xp6(3),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status))}}function Ct(l,s){if(1&l&&(t.ynx(0),t.TgZ(1,"div",6)(2,"div",16)(3,"span",17),t._uU(4,"Balance Roll Qty "),t.qZA()()(),t.TgZ(5,"div",9)(6,"div",7)(7,"div",10)(8,"table",11)(9,"thead",12)(10,"tr",13)(11,"th"),t._uU(12,"MRN No."),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Item Code"),t.qZA(),t.TgZ(15,"th",14),t._uU(16,"Item Name"),t.qZA(),t.TgZ(17,"th",14),t._uU(18,"Item Description"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"UoM"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"PPIC Qty"),t.qZA(),t.TgZ(23,"th"),t._uU(24,"Width"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Length"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"sqm/roll"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Roll/s #"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"Aging"),t.qZA()()(),t.TgZ(33,"tbody"),t.YNc(34,At,32,25,"tr",15),t.qZA()()()()(),t.BQk()),2&l){const e=t.oxw();t.xp6(34),t.Q6J("ngForOf",e.balanceDetails)}}let qt=(()=>{class l{constructor(e,n,o,i,r,a){this.location=e,this.toastService=n,this.modalService=o,this.sfgStockService=i,this.rollToRollConversionService=r,this.spinner=a,this.action="create",this.stockPreparation={},this.outputDetails=[],this.selectedMRNDetails=[],this.remarksDetails={},this.childItemList=[],this.balanceDetails=[],this.showBalanceDetails=!1}ngOnInit(){let e=this.location.getState();this.stockPreparation=JSON.parse(e.formData);let n=JSON.parse(e.data);this.sfgStockService.getStockPreparationByIdAndType(n).subscribe(o=>{this.selectedMRNDetails=JSON.parse(JSON.stringify(o?.output)),this.outputDetails=o?.output.map(i=>(i.closedIRQty=null,i.width=null,i.length=null,i.SQM=null,i.roll=null,i.itemCode=null,i.itemName=null,i.itemDescription=null,i.stage="Sheet",i.shelfLife=i.shelfLife,i)),this.childItemList=o?.childItemList})}trackByFn(e,n){return n?._id}setSheetDetails(e,n){if(!e.itemCode)return this.toastService.error("First Select Item Code"),void(this.outputDetails[n].roll=0);if(this.outputDetails[n].closedIRQty=+(+e?.SQM*+e?.roll).toFixed(2),this.showBalanceDetails=this.outputDetails[n].closedIRQty>0,this.outputDetails[n].closedIRQty>this.selectedMRNDetails[0]?.closedIRQty)return this.toastService.error("Select Output PPIC Qty must be less than Selected Input PPIC Qty "),this.outputDetails[n].closedIRQty=0,this.outputDetails[n].roll=0,this.balanceDetails=[],void(this.showBalanceDetails=!1);let i=this.selectedMRNDetails[0].SQM,a=this.selectedMRNDetails[0].closedIRQty-this.outputDetails[n].closedIRQty,_=i<=0?0:a/i,f=[],A=Math.trunc(+_)||0;f.push(A),_-A>0&&f.push(1);let u=JSON.parse(JSON.stringify(this.selectedMRNDetails[0]));this.balanceDetails=f.map((N,b)=>{const x=a-A*i,D=x/(u.width/1e3)||0,Ht=u.width/1e3*D||0;return{MRN:u?.MRN,MRNNumber:u?.MRNNumber,GIN:u?.GIN,GINDate:u?.GINDate,itemCode:u?.itemCode,itemName:u?.itemName,itemDescription:u?.itemDescription,UOM:u?.UOM,status:u?.status,shelfLife:u?.shelfLife,item:u?.item,width:u?.width,closedIRQty:0===b?N*i:x,length:0===b?u.length:+D.toFixed(2),SQM:0===b?u.SQM:+Ht.toFixed(2),roll:0==b?N:1,type:"SFGStock",referenceModel:"Items",stage:"Roll",department:u?.department,expiryDate:u?.expiryDate,conversionOfUnits:u?.conversionOfUnits,primaryToSecondaryConversion:u?.primaryToSecondaryConversion,secondaryToPrimaryConversion:u?.secondaryToPrimaryConversion,primaryUnit:u?.primaryUnit,secondaryUnit:u?.secondaryUnit,deliveryLocation:u?.deliveryLocation,supplier:u?.supplier,itemType:u?.itemType,standardRate:u?.standardRate,purchaseRate:u?.purchaseRate,purchaseRateUSD:u?.purchaseRateUSD,purchaseRatINR:u?.purchaseRatINR,lineValueINR:u?.lineValueINR,batchDate:u?.batchDate,storageLocationMapping:u?.storageLocationMapping,MRNDate:u?.MRNDate}})}submit(){if(0==this.outputDetails.length)return void this.toastService.error("Output Details must be atleast one row!!");if(0==this.balanceDetails.length)return void this.toastService.error("Balance Details Required !!");delete this.outputDetails[0]?._id,this.selectedMRNDetails[0].roll=0,this.selectedMRNDetails[0].closedIRQty=0;let e={selectedMRNDetails:this.selectedMRNDetails,outputDetails:[...this.outputDetails,...this.balanceDetails],remarksDetails:this.remarksDetails,stockPreparation:this.stockPreparation};e&&(this.spinner.show(),this.rollToRollConversionService.create(e).subscribe(n=>{this.spinner.hide(),this.toastService.success(n.message),this.location.back()}))}reset(){this.outputDetails=JSON.parse(JSON.stringify(this.selectedMRNDetails)).map(e=>(e.closedIRQty=null,e.width=null,e.length=null,e.SQM=null,e.roll=null,e.itemCode=null,e.itemName=null,e.itemDescription=null,e.stage="Sheet",e.shelfLife=e.shelfLife,e)),this.balanceDetails=[],this.showBalanceDetails=!1}openRemarksDetailsModal(){const e=this.modalService.open(U,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});e.componentInstance.action=this.action,e.componentInstance.remarksDetails=this.remarksDetails,e.result.then(n=>{n&&(this.remarksDetails=n)},n=>{})}openChildItemModal(){const e=this.modalService.open(v,{centered:!0,size:"xl",backdrop:"static",keyboard:!1});e.componentInstance.childItemList=this.childItemList,e.componentInstance.outputDetails=this.outputDetails,e.result.then(n=>{n&&(this.outputDetails=n)},n=>{})}static#t=this.\u0275fac=function(n){return new(n||l)(t.Y36(p.S$),t.Y36(h.kl),t.Y36(m.FF),t.Y36(g.dV),t.Y36(g.bZ),t.Y36(h.V))};static#e=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-roll-to-sheet-form"]],viewQuery:function(n,o){if(1&n&&t.Gf(Z.j,5),2&n){let i;t.iGM(i=t.CRH())&&(o.headers=i)}},decls:87,vars:3,consts:[[1,"formCard","card"],[1,"container"],[1,"row","form-header"],[1,"col","heading","ms-2"],[1,""],[1,"form-body"],[1,"row","mb-0"],[1,"col-12"],[1,"form-label"],[1,"row","mb-0","d-flex","justify-content-center"],[1,"table-responsive"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],[1,"text-start"],[4,"ngFor","ngForOf"],[1,"mb-4","mt-3","line-border-with-title"],[1,"px-5"],[4,"ngIf"],[1,"row","line-border"],[1,"row","mt-2","mb-3"],[1,"col-3","pe-0"],[1,"plusIconSvg","btn","btn-primary","me-1"],["type","button",1,"btn","btn-primary","px-5",3,"click"],[1,"col-9","mb-0","d-flex","align-self-end","justify-content-end"],["type","button",1,"btn","btn-primary","px-5","me-5",3,"click"],["itemName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["itemDescription",""],[1,"d-flex","justify-content-center"],["class","flaggreen",4,"ngIf"],["class","flagred",4,"ngIf"],["class","flagYellow",4,"ngIf"],[1,"flaggreen"],[1,"flagred"],[1,"flagYellow"],["class","pointer",3,"click",4,"ngIf"],[1,"mx-2"],[1,"d-flex","justify-content-center","align-items-center"],["type","number",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","input"],[1,"pointer",3,"click"],["class","pointer ps-2",3,"ngbTooltip","positionTarget",4,"ngIf"],["class","form-control form-control-xl","type","text",3,"ngModel","ngModelChange",4,"ngIf"],[1,"pointer","ps-2",3,"ngbTooltip","positionTarget"],["type","text",1,"form-control","form-control-xl",3,"ngModel","ngModelChange"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5," Roll-to-Sheet "),t.qZA()()(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),t._uU(10," Selected Input "),t.qZA()()()(),t.TgZ(11,"div",9)(12,"div",7)(13,"div",10)(14,"table",11)(15,"thead",12)(16,"tr",13)(17,"th"),t._uU(18,"MRN No."),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Item Code"),t.qZA(),t.TgZ(21,"th",14),t._uU(22,"Item Name"),t.qZA(),t.TgZ(23,"th",14),t._uU(24,"Item Description"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"UoM"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"PPIC Qty"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Width"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"Length"),t.qZA(),t.TgZ(33,"th"),t._uU(34,"sqm/roll"),t.qZA(),t.TgZ(35,"th"),t._uU(36,"Roll/s #"),t.qZA(),t.TgZ(37,"th"),t._uU(38,"Aging"),t.qZA()()(),t.TgZ(39,"tbody"),t.YNc(40,_t,32,26,"tr",15),t.qZA()()()()(),t.TgZ(41,"div",6)(42,"div",16)(43,"span",17),t._uU(44," Select Output "),t.qZA()()(),t.TgZ(45,"div",9)(46,"div",7)(47,"div",10)(48,"table",11)(49,"thead",12)(50,"tr",13)(51,"th"),t._uU(52,"MRN No."),t.qZA(),t.TgZ(53,"th"),t._uU(54,"Item Code"),t.qZA(),t.TgZ(55,"th",14),t._uU(56,"Item Name"),t.qZA(),t.TgZ(57,"th",14),t._uU(58,"Item Description"),t.qZA(),t.TgZ(59,"th"),t._uU(60,"UoM"),t.qZA(),t.TgZ(61,"th"),t._uU(62,"O/P Qty"),t.qZA(),t.TgZ(63,"th"),t._uU(64,"Width"),t.qZA(),t.TgZ(65,"th"),t._uU(66,"Length"),t.qZA(),t.TgZ(67,"th"),t._uU(68,"sqm/sheet"),t.qZA(),t.TgZ(69,"th"),t._uU(70,"Sheets #"),t.qZA(),t.TgZ(71,"th"),t._uU(72,"Aging"),t.qZA()()(),t.TgZ(73,"tbody"),t.YNc(74,Tt,39,25,"tr",15),t.qZA()()()()(),t.YNc(75,Ct,35,1,"ng-container",18),t._UZ(76,"hr",19),t.TgZ(77,"div",20)(78,"div",21),t._UZ(79,"button",22),t.TgZ(80,"button",23),t.NdJ("click",function(){return o.openRemarksDetailsModal()}),t._uU(81,"Remarks"),t.qZA()(),t.TgZ(82,"div",24)(83,"button",25),t.NdJ("click",function(){return o.reset()}),t._uU(84,"Reset"),t.qZA(),t.TgZ(85,"button",23),t.NdJ("click",function(){return o.submit()}),t._uU(86,"Save"),t.qZA()()()()()),2&n&&(t.xp6(40),t.Q6J("ngForOf",o.selectedMRNDetails),t.xp6(34),t.Q6J("ngForOf",o.outputDetails),t.xp6(1),t.Q6J("ngIf",o.showBalanceDetails))},dependencies:[p.sg,p.O5,m._L,c.Fj,c.wV,c.JJ,c.On,p.JJ,T.S],encapsulation:2})}return l})();var Rt=d(69205);function Mt(l,s){1&l&&t._UZ(0,"div",33)}function Nt(l,s){1&l&&t._UZ(0,"div",34)}function xt(l,s){1&l&&t._UZ(0,"div",35)}function Dt(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",14,26)(7,"span",27),t._uU(8),t.qZA()(),t.TgZ(9,"td",14,28)(11,"span",27),t._uU(12),t.qZA()(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"UOMUnitsMaster"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"number"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.qZA(),t.TgZ(23,"td"),t._uU(24),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.qZA(),t.TgZ(27,"td")(28,"span",29),t.YNc(29,Mt,1,0,"div",30),t.YNc(30,Nt,1,0,"div",31),t.YNc(31,xt,1,0,"div",32),t.qZA()()()),2&l){const e=s.$implicit,n=t.MAs(6),o=t.MAs(10);t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",n),t.xp6(1),t.hij(" ",e.itemName," "),t.xp6(1),t.Udp("width",o.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",o),t.xp6(1),t.hij(" ",e.itemDescription," "),t.xp6(2),t.Oqu(t.lcZ(15,21,null==e?null:e.UOM)),t.xp6(3),t.hij(" ",t.xi3(18,23,null==e?null:e.closedIRQty,"1.2-2")," "),t.xp6(3),t.hij("",null==e?null:e.width," | mm"),t.xp6(2),t.hij("",null==e?null:e.length," | mm"),t.xp6(2),t.hij(" ",null==e?null:e.SQM," "),t.xp6(2),t.hij(" ",null==e?null:e.roll," "),t.xp6(3),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status))}}function yt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"a",40),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.openChildItemModal())}),t._uU(1," Click here"),t.qZA()}}function It(l,s){1&l&&t._UZ(0,"div",33)}function wt(l,s){1&l&&t._UZ(0,"div",34)}function kt(l,s){1&l&&t._UZ(0,"div",35)}function Qt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.YNc(5,yt,2,0,"a",36),t.qZA(),t.TgZ(6,"td",14,26)(8,"span",27),t._uU(9),t.qZA()(),t.TgZ(10,"td",14,28)(12,"span",27),t._uU(13),t.qZA()(),t.TgZ(14,"td"),t._uU(15),t.ALo(16,"UOMUnitsMaster"),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.ALo(19,"number"),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.TgZ(22,"span",37),t._uU(23," | "),t.qZA(),t._uU(24," mm "),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.TgZ(27,"span",37),t._uU(28," | "),t.qZA(),t._uU(29," mm "),t.qZA(),t.TgZ(30,"td"),t._uU(31),t.qZA(),t.TgZ(32,"td")(33,"div",38)(34,"input",39),t.NdJ("ngModelChange",function(o){const r=t.CHM(e).$implicit;return t.KtG(r.roll=o)})("input",function(){const o=t.CHM(e),i=o.$implicit,r=o.index,a=t.oxw();return t.KtG(a.setSheetDetails(i,r))}),t.qZA()()(),t.TgZ(35,"td")(36,"span",29),t.YNc(37,It,1,0,"div",30),t.YNc(38,wt,1,0,"div",31),t.YNc(39,kt,1,0,"div",32),t.qZA()()()}if(2&l){const e=s.$implicit,n=t.MAs(7),o=t.MAs(11);t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.hij(" ",e.itemCode?e.itemCode:null," "),t.xp6(1),t.Q6J("ngIf",!e.itemCode),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",n),t.xp6(1),t.hij(" ",e.itemName," "),t.xp6(1),t.Udp("width",o.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",o),t.xp6(1),t.hij(" ",e.itemDescription," "),t.xp6(2),t.Oqu(t.lcZ(16,22,null==e?null:e.UOM)),t.xp6(3),t.hij(" ",t.xi3(19,24,null==e?null:e.closedIRQty,"1.2-2")," "),t.xp6(3),t.hij(" ",null==e?null:e.width," "),t.xp6(5),t.hij(" ",null==e?null:e.length," "),t.xp6(5),t.hij(" ",null==e?null:e.SQM," "),t.xp6(3),t.Q6J("ngModel",e.roll),t.xp6(3),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status))}}function Jt(l,s){if(1&l&&(t.TgZ(0,"span",44),t._uU(1),t.ALo(2,"truncate"),t.qZA()),2&l){const e=t.oxw().$implicit,n=t.MAs(11);t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",n),t.xp6(1),t.hij(" ",t.xi3(2,3,null==e?null:e.itemDescription,20)," ")}}function Ft(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"input",45),t.NdJ("ngModelChange",function(o){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.itemDescription=o)}),t.qZA()}if(2&l){const e=t.oxw().$implicit;t.Q6J("ngModel",e.itemDescription)}}function Pt(l,s){1&l&&t._UZ(0,"div",33)}function Ot(l,s){1&l&&t._UZ(0,"div",34)}function Lt(l,s){1&l&&t._UZ(0,"div",35)}function Yt(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",14,26)(7,"span",27),t._uU(8),t.ALo(9,"truncate"),t.qZA()(),t.TgZ(10,"td",14,28),t.YNc(12,Jt,3,6,"span",42),t.YNc(13,Ft,1,1,"input",43),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.ALo(16,"UOMUnitsMaster"),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.ALo(19,"number"),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.qZA(),t.TgZ(22,"td"),t._uU(23),t.qZA(),t.TgZ(24,"td"),t._uU(25),t.qZA(),t.TgZ(26,"td"),t._uU(27),t.qZA(),t.TgZ(28,"td")(29,"span",29),t.YNc(30,Pt,1,0,"div",30),t.YNc(31,Ot,1,0,"div",31),t.YNc(32,Lt,1,0,"div",32),t.qZA()()()),2&l){const e=s.$implicit,n=s.index,o=t.MAs(6),i=t.MAs(11);t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",o.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",o),t.xp6(1),t.hij(" ",t.xi3(9,20,null==e?null:e.itemName,50)," "),t.xp6(2),t.Udp("width",i.clientWidth),t.xp6(2),t.Q6J("ngIf",0==n),t.xp6(1),t.Q6J("ngIf",1==n),t.xp6(2),t.Oqu(t.lcZ(16,23,null==e?null:e.UOM)),t.xp6(3),t.hij(" ",t.xi3(19,25,null==e?null:e.closedIRQty,"1.2-2")," "),t.xp6(3),t.hij("",null==e?null:e.width," | mm"),t.xp6(2),t.hij("",null==e?null:e.length," | mm"),t.xp6(2),t.hij(" ",null==e?null:e.SQM," "),t.xp6(2),t.hij(" ",null==e?null:e.roll," "),t.xp6(3),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status))}}function jt(l,s){if(1&l&&(t.ynx(0),t.TgZ(1,"div",6)(2,"div",16)(3,"span",17),t._uU(4," Balance Stock "),t.qZA()()(),t.TgZ(5,"div",41)(6,"div",7)(7,"div",10)(8,"table",11)(9,"thead",12)(10,"tr",13)(11,"th"),t._uU(12,"MRN No."),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Item Code"),t.qZA(),t.TgZ(15,"th",14),t._uU(16,"Item Name"),t.qZA(),t.TgZ(17,"th",14),t._uU(18,"Item Description"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"UoM"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"PPIC Qty"),t.qZA(),t.TgZ(23,"th"),t._uU(24,"Width"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Length"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"sqm/sheet"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Sheets #"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"Aging"),t.qZA()()(),t.TgZ(33,"tbody"),t.YNc(34,Yt,33,28,"tr",15),t.qZA()()()()(),t.BQk()),2&l){const e=t.oxw();t.xp6(34),t.Q6J("ngForOf",e.balanceDetails)}}const Gt=[{path:"",redirectTo:"stock_preparation_form",pathMatch:"full"},{path:"stock_preparation_form",component:E},{path:"roll_to_roll",component:it},{path:"roll_to_sheet",component:qt},{path:"item_roll_to_sheet",component:v},{path:"sheet_to_sheet",component:(()=>{class l{constructor(e,n,o,i,r,a){this.location=e,this.toastService=n,this.modalService=o,this.sfgStockService=i,this.rollToRollConversionService=r,this.spinner=a,this.action="create",this.stockPreparation={},this.outputDetails=[],this.selectedMRNDetails=[],this.remarksDetails={},this.childItemList=[],this.balanceDetails=[],this.showBalanceDetails=!1}ngOnInit(){let e=this.location.getState();this.stockPreparation=JSON.parse(e.formData);let n=JSON.parse(e.data);this.sfgStockService.getStockPreparationByIdAndType(n).subscribe(o=>{this.selectedMRNDetails=JSON.parse(JSON.stringify(o?.output)),this.outputDetails=o?.output.map(i=>(i.closedIRQty=null,i.width=null,i.length=null,i.SQM=null,i.roll=null,i.itemCode=null,i.itemName=null,i.itemDescription=null,i.stage="Sheet",i.shelfLife=i.shelfLife,i)),this.childItemList=o?.childItemList})}trackByFn(e,n){return n?._id}setSheetDetails(e,n){if(!e.itemCode)return this.toastService.error("First Select Item Code"),void(this.outputDetails[n].roll=0);if(this.outputDetails[n].closedIRQty=+(+e?.SQM*+e?.roll).toFixed(2),this.showBalanceDetails=this.outputDetails[n].closedIRQty>0,this.outputDetails[n].closedIRQty>this.selectedMRNDetails[0]?.closedIRQty)return this.toastService.error("Select Output PPIC Qty must be less than Selected Input PPIC Qty "),this.outputDetails[n].closedIRQty=0,this.outputDetails[n].roll=0,this.balanceDetails=[],void(this.showBalanceDetails=!1);let r=this.selectedMRNDetails[0].closedIRQty-this.outputDetails[n].closedIRQty,a=JSON.parse(JSON.stringify(this.selectedMRNDetails[0]));const _=+(a.width*a.length/1e6).toFixed(4);this.balanceDetails=[{MRN:a?.MRN,MRNNumber:a?.MRNNumber,GIN:a?.GIN,GINDate:a?.GINDate,itemCode:a?.itemCode,itemName:a?.itemName,itemDescription:a?.itemDescription,UOM:a?.UOM,status:a?.status,shelfLife:a?.shelfLife,item:a?.item,width:a?.width,length:a.length,closedIRQty:r,SQM:_,roll:+(r/_).toFixed(2),type:"SFGStock",referenceModel:"Items",stage:"Sheet",department:a?.department,expiryDate:a?.expiryDate,conversionOfUnits:a?.conversionOfUnits,primaryToSecondaryConversion:a?.primaryToSecondaryConversion,secondaryToPrimaryConversion:a?.secondaryToPrimaryConversion,primaryUnit:a?.primaryUnit,secondaryUnit:a?.secondaryUnit,deliveryLocation:a?.deliveryLocation,supplier:a?.supplier,itemType:a?.itemType,standardRate:a?.standardRate,purchaseRate:a?.purchaseRate,purchaseRateUSD:a?.purchaseRateUSD,purchaseRatINR:a?.purchaseRatINR,lineValueINR:a?.lineValueINR,batchDate:a?.batchDate,storageLocationMapping:a?.storageLocationMapping,MRNDate:a?.MRNDate}]}submit(){if(0==this.outputDetails.length)return void this.toastService.error("Output Details must be atleast one row!!");if(0==this.balanceDetails.length)return void this.toastService.error("Balance Details Required !!");delete this.outputDetails[0]?._id,this.selectedMRNDetails[0].roll=0,this.selectedMRNDetails[0].closedIRQty=0;let e={selectedMRNDetails:this.selectedMRNDetails,outputDetails:[...this.outputDetails,...this.balanceDetails],remarksDetails:this.remarksDetails,stockPreparation:this.stockPreparation};e&&(this.spinner.show(),this.rollToRollConversionService.create(e).subscribe(n=>{this.spinner.hide(),this.toastService.success(n.message),this.location.back()}))}reset(){this.outputDetails=JSON.parse(JSON.stringify(this.selectedMRNDetails)).map(e=>(e.closedIRQty=null,e.width=null,e.length=null,e.SQM=null,e.roll=null,e.itemCode=null,e.itemName=null,e.itemDescription=null,e.stage="Sheet",e.shelfLife=e.shelfLife,e)),this.balanceDetails=[],this.showBalanceDetails=!1}openRemarksDetailsModal(){const e=this.modalService.open(U,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});e.componentInstance.action=this.action,e.componentInstance.remarksDetails=this.remarksDetails,e.result.then(n=>{n&&(this.remarksDetails=n)},n=>{})}openChildItemModal(){const e=this.modalService.open(v,{centered:!0,size:"xl",backdrop:"static",keyboard:!1});e.componentInstance.childItemList=this.childItemList,e.componentInstance.outputDetails=this.outputDetails,e.result.then(n=>{n&&(this.outputDetails=n)},n=>{})}static#t=this.\u0275fac=function(n){return new(n||l)(t.Y36(p.S$),t.Y36(h.kl),t.Y36(m.FF),t.Y36(g.dV),t.Y36(g.bZ),t.Y36(h.V))};static#e=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-sheet-to-sheet-form"]],viewQuery:function(n,o){if(1&n&&t.Gf(Z.j,5),2&n){let i;t.iGM(i=t.CRH())&&(o.headers=i)}},decls:87,vars:3,consts:[[1,"formCard","card"],[1,"container"],[1,"row","form-header"],[1,"col","heading","ms-2"],[1,""],[1,"form-body"],[1,"row","mb-0"],[1,"col-12"],[1,"form-label"],[1,"row","mb-0","d-flex","justify-content-center"],[1,"table-responsive"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],[1,"text-start"],[4,"ngFor","ngForOf"],[1,"mb-4","mt-3","line-border-with-title"],[1,"px-5"],[4,"ngIf"],[1,"row","line-border"],[1,"row","mt-2","mb-3"],[1,"col-3","pe-0"],[1,"plusIconSvg","btn","btn-primary","me-1"],["type","button",1,"btn","btn-primary","px-5",3,"click"],[1,"col-9","d-flex","align-self-end","justify-content-end"],["type","button",1,"btn","btn-primary","px-5","me-5",3,"click"],["itemName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["itemDescription",""],[1,"d-flex","justify-content-center"],["class","flaggreen",4,"ngIf"],["class","flagred",4,"ngIf"],["class","flagYellow",4,"ngIf"],[1,"flaggreen"],[1,"flagred"],[1,"flagYellow"],["class","pointer",3,"click",4,"ngIf"],[1,"mx-2"],[1,"d-flex","justify-content-center","align-items-center"],["type","number",1,"form-control","form-control-sm",3,"ngModel","ngModelChange","input"],[1,"pointer",3,"click"],[1,"row","d-flex","justify-content-center"],["class","pointer ps-2",3,"ngbTooltip","positionTarget",4,"ngIf"],["class","form-control form-control-sm","type","text",3,"ngModel","ngModelChange",4,"ngIf"],[1,"pointer","ps-2",3,"ngbTooltip","positionTarget"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5," Sheet-to-Sheet "),t.qZA()()(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),t._uU(10," Selected Input "),t.qZA()()()(),t.TgZ(11,"div",9)(12,"div",7)(13,"div",10)(14,"table",11)(15,"thead",12)(16,"tr",13)(17,"th"),t._uU(18,"MRN No."),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Item Code"),t.qZA(),t.TgZ(21,"th",14),t._uU(22,"Item Name"),t.qZA(),t.TgZ(23,"th",14),t._uU(24,"Item Description"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"UoM"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"PPIC Qty"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Width"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"Length"),t.qZA(),t.TgZ(33,"th"),t._uU(34,"sqm/sheet"),t.qZA(),t.TgZ(35,"th"),t._uU(36,"Sheets #"),t.qZA(),t.TgZ(37,"th"),t._uU(38,"Aging"),t.qZA()()(),t.TgZ(39,"tbody"),t.YNc(40,Dt,32,26,"tr",15),t.qZA()()()()(),t.TgZ(41,"div",6)(42,"div",16)(43,"span",17),t._uU(44," Select Output "),t.qZA()()(),t.TgZ(45,"div",9)(46,"div",7)(47,"div",10)(48,"table",11)(49,"thead",12)(50,"tr",13)(51,"th"),t._uU(52,"MRN No."),t.qZA(),t.TgZ(53,"th"),t._uU(54,"Item Code"),t.qZA(),t.TgZ(55,"th",14),t._uU(56,"Item Name"),t.qZA(),t.TgZ(57,"th",14),t._uU(58,"Item Description"),t.qZA(),t.TgZ(59,"th"),t._uU(60,"UoM"),t.qZA(),t.TgZ(61,"th"),t._uU(62,"O/P Qty"),t.qZA(),t.TgZ(63,"th"),t._uU(64,"Width"),t.qZA(),t.TgZ(65,"th"),t._uU(66,"Length"),t.qZA(),t.TgZ(67,"th"),t._uU(68,"sqm/sheet"),t.qZA(),t.TgZ(69,"th"),t._uU(70,"Sheets #"),t.qZA(),t.TgZ(71,"th"),t._uU(72,"Aging"),t.qZA()()(),t.TgZ(73,"tbody"),t.YNc(74,Qt,40,27,"tr",15),t.qZA()()()()(),t.YNc(75,jt,35,1,"ng-container",18),t._UZ(76,"hr",19),t.TgZ(77,"div",20)(78,"div",21),t._UZ(79,"button",22),t.TgZ(80,"button",23),t.NdJ("click",function(){return o.openRemarksDetailsModal()}),t._uU(81,"Remarks"),t.qZA()(),t.TgZ(82,"div",24)(83,"button",25),t.NdJ("click",function(){return o.reset()}),t._uU(84,"Reset"),t.qZA(),t.TgZ(85,"button",23),t.NdJ("click",function(){return o.submit()}),t._uU(86,"Save"),t.qZA()()()()()),2&n&&(t.xp6(40),t.Q6J("ngForOf",o.selectedMRNDetails),t.xp6(34),t.Q6J("ngForOf",o.outputDetails),t.xp6(1),t.Q6J("ngIf",o.showBalanceDetails))},dependencies:[p.sg,p.O5,m._L,c.Fj,c.wV,c.JJ,c.On,p.JJ,Rt.W,T.S],encapsulation:2})}return l})()}];let Bt=(()=>{class l{static#t=this.\u0275fac=function(n){return new(n||l)};static#e=this.\u0275mod=t.oAB({type:l});static#o=this.\u0275inj=t.cJS({imports:[p.ez,S.Bz.forChild(Gt),lt.m]})}return l})()}}]);