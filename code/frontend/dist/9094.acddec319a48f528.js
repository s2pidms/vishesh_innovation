"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9094],{79094:(k,g,d)=>{d.r(g),d.d(g,{DispatchRequestNoteModule:()=>Ue});var s=d(96814),p=d(1076),y=d(43818),R=d(25116),f=d(79250),e=d(65879),m=d(99328),D=d(59840),T=d(88059),_=d(37285),S=d(53421);function O(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",18,19)(9,"span",20),e._uU(10),e.qZA()(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td")(14,"div",21),e._UZ(15,"button",22),e.TgZ(16,"div",23)(17,"a",24),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.navigateTo("../form",n,"view"))}),e._UZ(18,"i",25),e._uU(19," View "),e.qZA(),e.TgZ(20,"a",24),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.navigateTo("../form",n,"rejection"))}),e._UZ(21,"i",26),e._uU(22," Reject "),e.qZA(),e.TgZ(23,"a",24),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.navigateTo("../form",n,"approval"))}),e._UZ(24,"i",27),e._uU(25," Approve "),e.qZA()()()()()}if(2&r){const t=u.$implicit,i=e.MAs(8),o=e.oxw();e.xp6(2),e.Oqu(null==t?null:t.DRNNumber),e.xp6(2),e.Oqu(null==t?null:t.DRNDateS),e.xp6(2),e.Oqu(null==t?null:t.salesCategory),e.xp6(1),e.Udp("width",i.clientWidth),e.xp6(2),e.Q6J("positionTarget",i)("ngbTooltip",t.customerName),e.xp6(1),e.hij(" ",t.customerName," "),e.xp6(2),e.Oqu(t.DRNStatus),e.xp6(5),e.Q6J("accessType",o.rolePermissionActions.viewAction),e.xp6(3),e.ekj("disable","Approved"===(null==t?null:t.DRNStatus)||"Rejected"===(null==t?null:t.DRNStatus)),e.Q6J("accessType",o.rolePermissionActions.approveAction),e.xp6(3),e.ekj("disable","Approved"===(null==t?null:t.DRNStatus)||"Rejected"===(null==t?null:t.DRNStatus)),e.Q6J("accessType",o.rolePermissionActions.approveAction)}}const x=function(r,u,t,i){return{page:r,pageSize:u,collection:t,search:i,type:"list"}};let A=(()=>{class r{constructor(t,i,o,n,l,h){this.exportExcelService=t,this.dispatchRequestNoteService=i,this.spinner=o,this.activatedRoute=n,this.exportToPDFService=l,this.utilityService=h,this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.rolePermissionActions=R.a1}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}navigateTo(t,i,o){this.utilityService.navigateToForm({path:t,status:i.DRNStatus,action:o,id:i._id,activatedRoute:this.activatedRoute})}trackByFn(t,i){return i?._id}eventHeader(t){switch(t.key){case"SEARCH":this.search=t.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=t.value,this.getAll()}}getAll(t=!1,i=""){this.spinner.show();let o={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:t};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.dispatchRequestNoteService.getAll(o).subscribe(n=>{"EXCEL"==i?this.excelDownload(n.rows):"PDF"==i?this.pdfDownload(n.rows):(this.tableData=n.rows,this.collection=n.count,this.spinner.hide())})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}pdfDownload(t){let i=(0,f.Kr)(t);this.exportToPDFService.generatePdf(i.tableData,i.title)}excelDownload(t){this.exportExcelService.exportExcel((0,f.n8)(t))}onSort({column:t,direction:i}){this.headers.forEach(o=>{o.sortable!==t&&(o.direction="")}),this.column=t,this.direction="asc"==i?1:-1,this.getAll()}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(m.Ol),e.Y36(D.lM),e.Y36(m.V),e.Y36(p.gz),e.Y36(m.$L),e.Y36(m.tI))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-dispatch-request-note-list"]],viewQuery:function(i,o){if(1&i&&e.Gf(y.j,5),2&i){let n;e.iGM(n=e.CRH())&&(o.headers=n)}},decls:28,vars:9,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],["appAccessControl","",1,"text-center",3,"accessType"],["type","button",1,"btn","btn-primary","btn-add",3,"click"],["aria-hidden","true",1,"fa","fa-plus-square","fa-lg","me-2"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-info"],[1,"text-white"],["sortable","DRNNumber",3,"sort"],["sortable","DRNDateS",3,"sort"],["sortable","salesCategory",3,"sort"],["sortable","customerName",1,"text-start",3,"sort"],["sortable","DRNStatus",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["customerName",""],[1,"pointer",3,"positionTarget","ngbTooltip"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa","fa-times","fa-lg","me-3","text-primary"],["aria-hidden","true",1,"fa","fa-check","fa-lg","text-success"]],template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"DRN Summary"),e.qZA()(),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return o.navigateTo("../form",{},"create")}),e._UZ(6,"i",5),e._uU(7," Dispatch Request Note [DRN] "),e.qZA()(),e._UZ(8,"hr",6),e.TgZ(9,"div",7)(10,"app-setting-header",8),e.NdJ("dataChange",function(l){return o.eventHeader(l)}),e.qZA(),e.TgZ(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th",12),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(15,"DRN No."),e.qZA(),e.TgZ(16,"th",13),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(17,"DRN Date"),e.qZA(),e.TgZ(18,"th",14),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(19,"Customer Category"),e.qZA(),e.TgZ(20,"th",15),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(21,"Customer Name"),e.qZA(),e.TgZ(22,"th",16),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(23,"DRN Status"),e.qZA(),e.TgZ(24,"th"),e._uU(25,"Action"),e.qZA()()(),e.TgZ(26,"tbody"),e.YNc(27,O,26,16,"tr",17),e.qZA()()()()),2&i&&(e.xp6(4),e.Q6J("accessType",o.rolePermissionActions.createAction),e.xp6(6),e.Q6J("data",e.l5B(4,x,o.page,o.pageSize,o.collection,o.search)),e.xp6(17),e.Q6J("ngForOf",o.tableData)("ngForTrackBy",o.trackByFn))},dependencies:[s.sg,T.P,_._L,y.j,S.J],encapsulation:2})}return r})();var a=d(60095),U=d(21631),F=d(22096),N=d(4092),v=d(14906),Z=d(59103);function I(r,u){1&r&&e._UZ(0,"div",33)}function w(r,u){1&r&&e._UZ(0,"div",34)}function oe(r,u){1&r&&e._UZ(0,"div",35)}function M(r,u){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,null==t?null:t.dispatchQty,".2-2")," ")}}function J(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"input",36),e.NdJ("ngModelChange",function(o){e.CHM(t);const n=e.oxw().$implicit;return e.KtG(n.dispatchQty=o)})("input",function(){e.CHM(t);const o=e.oxw(),n=o.$implicit,l=o.index,h=e.oxw();return e.KtG(h.checkDispatchQty(n,l))}),e.qZA()}if(2&r){const t=e.oxw().$implicit;e.Q6J("ngModel",t.dispatchQty)}}const b=function(){return["approval","rejection","view","generate","cancel"]};function ie(r,u){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"td")(10,"span",27),e.YNc(11,I,1,0,"div",28),e.YNc(12,w,1,0,"div",29),e.YNc(13,oe,1,0,"div",30),e.qZA()(),e.TgZ(14,"td"),e._uU(15),e.qZA(),e.TgZ(16,"td")(17,"div",27),e.YNc(18,M,3,4,"span",31),e.YNc(19,J,1,1,"input",32),e.qZA()()()),2&r){const t=u.$implicit,i=e.oxw();e.xp6(2),e.Oqu(null==t?null:t.FGBatchNo),e.xp6(2),e.Oqu(e.xi3(5,9,null==t?null:t.FGBatchDate,"dd-MM-YYYY")),e.xp6(3),e.hij(" ",t.FGExpiryDate?e.xi3(8,12,null==t?null:t.FGExpiryDate,"dd-MM-YYYY"):"-"," "),e.xp6(4),e.Q6J("ngIf","green"==(null==t?null:t.aging)),e.xp6(1),e.Q6J("ngIf","red"==(null==t?null:t.aging)),e.xp6(1),e.Q6J("ngIf","orange"==(null==t?null:t.aging)),e.xp6(2),e.Oqu(null==t?null:t.FGINQuantity),e.xp6(3),e.Q6J("ngIf",e.DdM(15,b).includes(i.action)),e.xp6(1),e.Q6J("ngIf",!e.DdM(16,b).includes(i.action))}}let se=(()=>{class r{constructor(t,i,o){this.activeModal=t,this.toastService=i,this.utilityService=o,this.data=[],this.action="",this.totalDispatchQty=0,this.tBatchNo=""}ngOnInit(){this.data&&1==this.data.FGStockDetails.length&&this.data.FGStockDetails[0].FGBatchDate&&(this.tBatchNo=this.utilityService.getFormatDate(this.data?.FGStockDetails[0]?.FGBatchDate,"YYYY-MM-DD"))}dismissModel(){this.activeModal.close({FGStockDetails:this.data.FGStockDetails,tBatchNo:this.tBatchNo,totalDispatchQty:this.totalDispatchQty})}checkDispatchQty(t,i){let o=this.data.FGStockDetails.map(n=>+n.dispatchQty).reduce((n,l)=>+n+ +l,0);if(t.dispatchQty>this.data.SOBalancedQty&&(this.toastService.error("Dispatch Qty should not be greater then SO Balanced Qty"),this.data.FGStockDetails[i].dispatchQty=0),t.dispatchQty>t.FGINQuantity&&(this.toastService.error("Dispatch Qty should not be greater then FGIN Qty"),this.data.FGStockDetails[i].dispatchQty=0),o>this.data.SOBalancedQty)return this.data.FGStockDetails[i].dispatchQty=0,this.data.FGStockDetails=[...this.data.FGStockDetails],void this.toastService.error("Dispatch Qty. should not be greater than FGIN Qty.");this.totalDispatchQty=o}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(_.Kz),e.Y36(m.kl),e.Y36(m.tI))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-fg-stock-details-modal"]],inputs:{data:"data",action:"action",totalDispatchQty:"totalDispatchQty",tBatchNo:"tBatchNo"},decls:77,vars:19,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid"],[1,"row","justify-content-center"],[1,"col-12","my-3"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],[1,"text-start"],[1,"row"],[1,"line-border","my-3"],[4,"ngFor","ngForOf"],[1,"row","mb-3","justify-content-center"],[1,"col-12"],[1,"col-5"],[1,"d-flex","align-items-center"],[1,"col-form-label","text-nowrap"],[1,"fa","fa-caret-right","fs-4","mx-1"],["type","text","readonly","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-4"],["type","text",1,"form-control",3,"disabled","ngModel","ngModelChange"],[1,"col-3","d-flex","justify-content-end"],["type","button",1,"btn","btn-primary","px-2","me-0","py-0",3,"disabled","click"],[1,"d-flex","justify-content-center"],["class","flaggreen",4,"ngIf"],["class","flagred",4,"ngIf"],["class","flagYellow",4,"ngIf"],[4,"ngIf"],["type","number","class","form-control form-control-sm w-25",3,"ngModel","ngModelChange","input",4,"ngIf"],[1,"flaggreen"],[1,"flagred"],[1,"flagYellow"],["type","number",1,"form-control","form-control-sm","w-25",3,"ngModel","ngModelChange","input"]],template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"FG Stock Details"),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return o.activeModal.close()}),e._UZ(6,"i",4),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th"),e._uU(15,"SKU NO."),e.qZA(),e.TgZ(16,"th",12),e._uU(17),e.ALo(18,"labelTranslate"),e.qZA(),e.TgZ(19,"th",12),e._uU(20),e.ALo(21,"labelTranslate"),e.qZA(),e.TgZ(22,"th"),e._uU(23,"UoM"),e.qZA()()(),e.TgZ(24,"tbody")(25,"tr")(26,"td"),e._uU(27),e.qZA(),e.TgZ(28,"td",12),e._uU(29),e.qZA(),e.TgZ(30,"td",12),e._uU(31),e.qZA(),e.TgZ(32,"td"),e._uU(33),e.ALo(34,"UOMUnitsMaster"),e.qZA()()()()()()(),e.TgZ(35,"div",13),e._UZ(36,"hr",14),e.qZA(),e.TgZ(37,"div",6)(38,"div",7)(39,"div",8)(40,"table",9)(41,"thead",10)(42,"tr",11)(43,"th"),e._uU(44,"FG Batch No"),e.qZA(),e.TgZ(45,"th"),e._uU(46,"FG Batch Date"),e.qZA(),e.TgZ(47,"th"),e._uU(48,"FG B/B Date"),e.qZA(),e.TgZ(49,"th"),e._uU(50,"Aging"),e.qZA(),e.TgZ(51,"th"),e._uU(52,"FGI Qty."),e.qZA(),e.TgZ(53,"th"),e._uU(54,"Disp. Qty."),e.qZA()()(),e.TgZ(55,"tbody"),e.YNc(56,ie,20,17,"tr",15),e.qZA()()()()(),e.TgZ(57,"div",13),e._UZ(58,"hr",14),e.qZA(),e.TgZ(59,"div",16)(60,"div",17)(61,"div",13)(62,"div",18)(63,"div",19)(64,"div",20),e._uU(65," Total Dispatch. Qty. "),e._UZ(66,"i",21),e.qZA(),e.TgZ(67,"input",22),e.NdJ("ngModelChange",function(l){return o.totalDispatchQty=l}),e.qZA()()(),e.TgZ(68,"div",23)(69,"div",19)(70,"div",20),e._uU(71," T/Batch No. "),e._UZ(72,"i",21),e.qZA(),e.TgZ(73,"input",24),e.NdJ("ngModelChange",function(l){return o.tBatchNo=l}),e.qZA()()(),e.TgZ(74,"div",25)(75,"button",26),e.NdJ("click",function(){return o.dismissModel()}),e._uU(76," Save & close "),e.qZA()()()()()()()),2&i&&(e.xp6(17),e.Oqu(e.lcZ(18,11,"SKU Name")),e.xp6(3),e.hij(" ",e.lcZ(21,13,"SKU Description")," "),e.xp6(7),e.Oqu(null==o.data?null:o.data.SKUNo),e.xp6(2),e.Oqu(null==o.data?null:o.data.SKUName),e.xp6(2),e.Oqu(null==o.data?null:o.data.SKUDescription),e.xp6(2),e.Oqu(e.lcZ(34,15,null==o.data?null:o.data.UOM)),e.xp6(23),e.Q6J("ngForOf",o.data.FGStockDetails),e.xp6(11),e.Q6J("ngModel",o.totalDispatchQty),e.xp6(6),e.Q6J("disabled",e.DdM(17,b).includes(o.action))("ngModel",o.tBatchNo),e.xp6(2),e.Q6J("disabled",e.DdM(18,b).includes(o.action)))},dependencies:[s.sg,s.O5,a.Fj,a.wV,a.JJ,a.On,s.JJ,s.uU,v.c,Z.S],encapsulation:2})}return r})();var C=d(16897);let Q=(()=>{class r{constructor(t,i,o,n){this.activeModal=t,this.validationService=i,this.modalService=o,this.toastService=n,this.customerShippingAddress={},this.action="",this.form=new a.nJ({line1:new a.p4(null),line2:new a.p4(null),line3:new a.p4(null),line4:new a.p4(null),pinCode:new a.p4(null),city:new a.p4(null),state:new a.p4(null),country:new a.p4(null)})}ngOnInit(){this.form.patchValue(this.customerShippingAddress),("view"==this.action||"cancel"==this.action||"approve"==this.action)&&this.form.disable()}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(_.Kz),e.Y36(C.RJ),e.Y36(_.FF),e.Y36(m.kl))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-drn-ship-to-address"]],inputs:{customerShippingAddress:"customerShippingAddress",action:"action"},decls:57,vars:1,consts:[[3,"formGroup"],[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid","mt-5","mb-3"],[1,"row"],[1,"col-12","px-0"],[1,"row","mb-4","px-5"],[1,"col-6"],[1,"form-label"],[1,"text-danger"],["type","text","formControlName","line1","readonly","",1,"form-control"],["type","text","formControlName","line2","readonly","",1,"form-control"],["type","text","formControlName","line3","readonly","",1,"form-control"],["type","text","formControlName","line4","readonly","",1,"form-control"],["type","text","formControlName","city","readonly","",1,"form-control"],["type","text","formControlName","state","readonly","",1,"form-control"],[1,"row","my-4","px-5"],["oninput","javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);","type","number","maxlength","6","formControlName","pinCode","readonly","",1,"form-control"],[1,"row","justify-content-between"],[1,"col"],["type","text","formControlName","country","readonly","",1,"form-control"]],template:function(i,o){1&i&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4,"Ship To Address"),e.qZA(),e.TgZ(5,"div")(6,"button",4),e.NdJ("click",function(){return o.activeModal.close(o.form.value)}),e._UZ(7,"i",5),e.qZA()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"label",11),e._uU(14," Address Line 1 "),e._UZ(15,"span",12),e.qZA(),e._UZ(16,"input",13),e.qZA(),e.TgZ(17,"div",10)(18,"label",11),e._uU(19," Address Line 2 "),e._UZ(20,"span",12),e.qZA(),e._UZ(21,"input",14),e.qZA()(),e.TgZ(22,"div",9)(23,"div",10)(24,"label",11),e._uU(25," Address Line 3 "),e._UZ(26,"span",12),e.qZA(),e._UZ(27,"input",15),e.qZA(),e.TgZ(28,"div",10)(29,"label",11),e._uU(30," Address Line 4 "),e._UZ(31,"span",12),e.qZA(),e._UZ(32,"input",16),e.qZA()(),e.TgZ(33,"div",9)(34,"div",10)(35,"label",11),e._uU(36," City/District "),e._UZ(37,"span",12),e.qZA(),e._UZ(38,"input",17),e.qZA(),e.TgZ(39,"div",10)(40,"label",11),e._uU(41," State/Province "),e._UZ(42,"span",12),e.qZA(),e._UZ(43,"input",18),e.qZA()(),e.TgZ(44,"div",19)(45,"div",10)(46,"label",11),e._uU(47," Pin Code "),e._UZ(48,"span",12),e.qZA(),e._UZ(49,"input",20),e.qZA(),e.TgZ(50,"div",10)(51,"div",21)(52,"div",22)(53,"label",11),e._uU(54,"Country "),e._UZ(55,"span",12),e.qZA(),e._UZ(56,"input",23),e.qZA()()()()()()()()()),2&i&&e.Q6J("formGroup",o.form)},dependencies:[a._Y,a.Fj,a.wV,a.JJ,a.JL,a.nD,a.sg,a.u],encapsulation:2})}return r})();function re(r,u){if(1&r&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&r){const t=u.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.label," ")}}function ae(r,u){if(1&r&&(e.TgZ(0,"div",18)(1,"select",32)(2,"option",20),e._uU(3,"Select Payment Terms"),e.qZA(),e.YNc(4,re,2,2,"option",21),e.qZA()()),2&r){const t=e.oxw();e.xp6(2),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",t.SOTermsArr.paymentTermsArr)}}function ne(r,u){1&r&&(e.TgZ(0,"div",18),e._UZ(1,"input",34),e.qZA())}function P(r,u){if(1&r&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&r){const t=u.$implicit;e.Q6J("value",t.parameterName),e.xp6(1),e.hij(" ",t.parameterLabel," ")}}function G(r,u){if(1&r&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&r){const t=u.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.label," ")}}function le(r,u){if(1&r&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&r){const t=u.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.label," ")}}function ce(r,u){1&r&&e._UZ(0,"hr",35)}function ue(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.dismissModel())}),e._uU(1," Save "),e.qZA()}}const E=function(){return["create"]};let Y=(()=>{class r{get f(){return this.form.controls}constructor(t,i){this.activeModal=t,this.validationService=i,this.action="",this.POTerms={},this.SOTermsArr={},this.SOTermsData={},this.otherCharges={},this.clickCount=1,this.showSelect=!1,this.form=new a.nJ({paymentTerms:new a.p4(null,[a.kI.required]),frightTerms:new a.p4("FOR - Free On Road"),transporter:new a.p4(null,[a.kI.required]),destination:new a.p4(null,[a.kI.required]),modeOfTransport:new a.p4(null,[a.kI.required])})}ngOnInit(){this.SOTermsArr?.paymentTermsArr.some(i=>i.label==this.SOTermsData.changedPaymentTerms)||(this.showSelect=!0,this.clickCount=0),"create"==this.action&&(this.showSelect=!1,this.clickCount=1),this.form.patchValue(this.SOTermsData),["approval","rejection","view","generate","cancel"].includes(this.action)&&this.form.disable()}dismissModel(){this.validationService.checkErrors(this.form,N.RS)||this.activeModal.close(this.form.value)}enablePaymentTerms(){this.clickCount++,this.showSelect=this.clickCount%2==0}enableFreightTerms(){["create","edit"].includes(this.action)&&this.form.controls.frightTerms.enable()}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(_.Kz),e.Y36(C.RJ))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-drn-review-terms"]],inputs:{action:"action",POTerms:"POTerms",SOTermsArr:"SOTermsArr",SOTermsData:"SOTermsData",otherCharges:"otherCharges"},decls:78,vars:14,consts:[[3,"formGroup"],[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid"],[1,"row","justify-content-center"],[1,"col-10","px-5","mt-5"],[1,"row"],[1,"col-3","mt-1","pe-0"],[1,"form-label"],[1,"text-danger"],[1,"col-auto","mt-1","px-0"],[1,"fa","fa-caret-right","text-secondary"],["class","col-7 ps-0",4,"ngIf"],[1,"col-1","assetChange","mt-1","pointer",3,"click"],[1,"row","mt-5"],[1,"col-7","ps-0"],["type","text","formControlName","frightTerms",1,"form-select","fs-5"],["selected","","disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"col-1","ps-0"],[1,"form-label","text-nowrap"],[1,"fa","fa-caret-right","mt-1","text-secondary"],["type","text","formControlName","modeOfTransport",1,"form-select","fs-5"],["type","text","formControlName","transporter",1,"form-select","fs-5"],["type","text","formControlName","destination",1,"form-control"],[1,"col","px-0","mt-5","mb-4"],["class","line-border",4,"ngIf"],[1,"text-center","my-2"],["class","btn bg-primary px-5 mb-4","type","button",3,"click",4,"ngIf"],["type","text","formControlName","paymentTerms",1,"form-select","fs-5"],[3,"value"],["type","text","formControlName","paymentTerms",1,"form-control"],[1,"line-border"],["type","button",1,"btn","bg-primary","px-5","mb-4",3,"click"]],template:function(i,o){1&i&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4,"SO Terms"),e.qZA(),e.TgZ(5,"div")(6,"button",4),e.NdJ("click",function(){return o.activeModal.close(null)}),e._UZ(7,"i",5),e.qZA()()(),e.TgZ(8,"form",0)(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"label",11),e._uU(15,"Payment Terms "),e.TgZ(16,"span",12),e._uU(17,"*"),e.qZA()()(),e.TgZ(18,"div",13),e._UZ(19,"i",14),e.qZA(),e.YNc(20,ae,5,2,"div",15),e.YNc(21,ne,2,0,"div",15),e.TgZ(22,"div",16),e.NdJ("click",function(){return o.enablePaymentTerms()}),e.qZA()(),e.TgZ(23,"div",17)(24,"div",10)(25,"label",11),e._uU(26," Freight Terms "),e.TgZ(27,"span",12),e._uU(28,"*"),e.qZA()()(),e.TgZ(29,"div",13),e._UZ(30,"i",14),e.qZA(),e.TgZ(31,"div",18)(32,"select",19)(33,"option",20),e._uU(34,"Select Freight Terms"),e.qZA(),e.YNc(35,P,2,2,"option",21),e.qZA()(),e._UZ(36,"div",22),e.qZA(),e.TgZ(37,"div",17)(38,"div",10)(39,"label",23),e._uU(40,"Mode of transport "),e.TgZ(41,"span",12),e._uU(42,"*"),e.qZA()()(),e.TgZ(43,"div",13),e._UZ(44,"i",24),e.qZA(),e.TgZ(45,"div",18)(46,"select",25)(47,"option",20),e._uU(48,"Select Mode of transport"),e.qZA(),e.YNc(49,G,2,2,"option",21),e.qZA()()(),e.TgZ(50,"div",17)(51,"div",10)(52,"label",23),e._uU(53,"Transporter Name "),e.TgZ(54,"span",12),e._uU(55,"*"),e.qZA()()(),e.TgZ(56,"div",13),e._UZ(57,"i",14),e.qZA(),e.TgZ(58,"div",18)(59,"select",26)(60,"option",20),e._uU(61,"Select Transporter Name"),e.qZA(),e.YNc(62,le,2,2,"option",21),e.qZA()()(),e.TgZ(63,"div",17)(64,"div",10)(65,"label",23),e._uU(66,"Destination/Port "),e.TgZ(67,"span",12),e._uU(68,"*"),e.qZA()()(),e.TgZ(69,"div",13),e._UZ(70,"i",14),e.qZA(),e.TgZ(71,"div",18),e._UZ(72,"input",27),e.qZA()()()(),e.TgZ(73,"div",9)(74,"div",28),e.YNc(75,ce,1,0,"hr",29),e.qZA()(),e.TgZ(76,"div",30),e.YNc(77,ue,2,0,"button",31),e.qZA()()()()()),2&i&&(e.Q6J("formGroup",o.form),e.xp6(8),e.Q6J("formGroup",o.form),e.xp6(12),e.Q6J("ngIf",!o.showSelect),e.xp6(1),e.Q6J("ngIf",o.showSelect),e.xp6(12),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",o.SOTermsArr.freightTerms),e.xp6(12),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",o.SOTermsArr.modeOfTransport),e.xp6(11),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",o.SOTermsArr.transporterArr),e.xp6(13),e.Q6J("ngIf",e.DdM(12,E).includes(o.action)),e.xp6(2),e.Q6J("ngIf",e.DdM(13,E).includes(o.action)))},dependencies:[s.sg,s.O5,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u],styles:[".fa-caret-right[_ngcontent-%COMP%]{font-size:2rem!important;margin-right:2rem!important;margin-left:2rem!important}.assetChange[_ngcontent-%COMP%]{background-color:transparent;background-image:url(Asset_change.a4234ac185c40591.svg);background-size:100% 100%;border:0;color:#fff;height:2.2rem;width:2.2rem}"]})}return r})();var de=d(83344);function pe(r,u){if(1&r&&(e.TgZ(0,"option",29),e._uU(1),e.qZA()),2&r){const t=u.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.label," ")}}function me(r,u){if(1&r&&(e.TgZ(0,"option",29),e._uU(1),e.qZA()),2&r){const t=u.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.label," ")}}function L(r,u){1&r&&e._UZ(0,"hr",30)}function K(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"div",31)(1,"button",32),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.reset())}),e._uU(2,"Reset"),e.qZA(),e.TgZ(3,"button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.dismissModel())}),e._uU(4," Save & Close "),e.qZA()()}}const he=function(){return["create"]};let Se=(()=>{class r{constructor(t,i,o){this.activeModal=t,this.validationService=i,this.utilityService=o,this.ExportDetailsData={},this.exportDetailsArray=[],this.action="",this.customerCurrency="",this.form=new a.nJ({exportsInvoiceNo:new a.p4(null,[a.kI.required]),exportsInvoiceDate:new a.p4(this.utilityService.getTodayDate("YYYY-MM-DD"),[a.kI.required]),exportsInvoiceTotalValue:new a.p4(null,[a.kI.required]),exchangeRate:new a.p4(null,[a.kI.required]),modeOfTransport:new a.p4(null,[a.kI.required]),frightTerms:new a.p4(null,[a.kI.required]),destination:new a.p4(null,[a.kI.required]),finalDestination:new a.p4(null,[a.kI.required])})}ngOnInit(){this.form.patchValue(this.ExportDetailsData),"create"!=this.action&&this.form.disable()}reset(){this.form.patchValue(this.ExportDetailsData)}dismissModel(){this.validationService.checkErrors(this.form,N.OV)||this.activeModal.close(this.form.value)}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(_.Kz),e.Y36(C.RJ),e.Y36(m.tI))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-drn-export-details"]],inputs:{ExportDetailsData:"ExportDetailsData",exportDetailsArray:"exportDetailsArray",action:"action",customerCurrency:"customerCurrency"},decls:80,vars:13,consts:[[3,"formGroup"],[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid","mt-4","mb-3"],[1,"row"],[1,"col-12","px-0"],[1,"row","mb-4","px-5"],[1,"col-3"],[1,"form-label"],[1,"text-danger"],["type","text","formControlName","exportsInvoiceNo",1,"form-control"],["type","date","formControlName","exportsInvoiceDate",1,"form-control"],[1,"d-flex"],[1,"input-group-text","text-secondary","combine-INR"],[1,"vr","ms-3"],["type","number","formControlName","exportsInvoiceTotalValue",1,"form-control","border-start-0"],["type","number","formControlName","exchangeRate",1,"form-control","border-start-0"],["type","text","formControlName","modeOfTransport",1,"form-select","fs-5"],["selected","","disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","frightTerms",1,"form-select","fs-5"],["type","text","formControlName","destination",1,"form-control"],["type","text","formControlName","finalDestination",1,"form-control"],[1,"col","px-0"],["class","line-border",4,"ngIf"],["class","text-center my-4",4,"ngIf"],[3,"value"],[1,"line-border"],[1,"text-center","my-4"],[1,"btn","btn-primary","px-5","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-3",3,"click"]],template:function(i,o){1&i&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4,"Export Details"),e.qZA(),e.TgZ(5,"div")(6,"button",4),e.NdJ("click",function(){return o.activeModal.close()}),e._UZ(7,"i",5),e.qZA()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"label",11),e._uU(14," Export Invoice No. "),e.TgZ(15,"span",12),e._uU(16,"*"),e.qZA()(),e._UZ(17,"input",13),e.qZA(),e.TgZ(18,"div",10)(19,"label",11),e._uU(20," Export Invoice Date "),e.TgZ(21,"span",12),e._uU(22,"*"),e.qZA()(),e._UZ(23,"input",14),e.qZA(),e.TgZ(24,"div",10)(25,"label",11),e._uU(26," Export Invoice Total Value "),e.TgZ(27,"span",12),e._uU(28,"*"),e.qZA()(),e.TgZ(29,"div",15)(30,"span",16),e._uU(31),e._UZ(32,"div",17),e.qZA(),e._UZ(33,"input",18),e.qZA()(),e.TgZ(34,"div",10)(35,"label",11),e._uU(36," Exchange Rate "),e.TgZ(37,"span",12),e._uU(38,"*"),e.qZA()(),e.TgZ(39,"div",15)(40,"span",16),e._uU(41),e.ALo(42,"companyCurrency"),e._UZ(43,"div",17),e.qZA(),e._UZ(44,"input",19),e.qZA()()(),e.TgZ(45,"div",9)(46,"div",10)(47,"label",11),e._uU(48," Mode of transport"),e.TgZ(49,"span",12),e._uU(50,"*"),e.qZA()(),e.TgZ(51,"select",20)(52,"option",21),e._uU(53,"Select Mode of transport"),e.qZA(),e.YNc(54,pe,2,2,"option",22),e.qZA()(),e.TgZ(55,"div",10)(56,"label",11),e._uU(57," Freight Terms "),e.TgZ(58,"span",12),e._uU(59,"*"),e.qZA()(),e.TgZ(60,"select",23)(61,"option",21),e._uU(62,"Select Freight Terms"),e.qZA(),e.YNc(63,me,2,2,"option",22),e.qZA()(),e.TgZ(64,"div",10)(65,"label",11),e._uU(66," Port of Destination"),e.TgZ(67,"span",12),e._uU(68,"*"),e.qZA()(),e._UZ(69,"input",24),e.qZA(),e.TgZ(70,"div",10)(71,"label",11),e._uU(72," Final Destination "),e.TgZ(73,"span",12),e._uU(74,"*"),e.qZA()(),e._UZ(75,"input",25),e.qZA()(),e.TgZ(76,"div",7)(77,"div",26),e.YNc(78,L,1,0,"hr",27),e.qZA()(),e.YNc(79,K,5,0,"div",28),e.qZA()()()()()),2&i&&(e.Q6J("formGroup",o.form),e.xp6(31),e.hij(" ",o.customerCurrency," "),e.xp6(10),e.hij(" ",e.lcZ(42,9,"INR")," "),e.xp6(11),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",o.exportDetailsArray.modeOfTransport),e.xp6(7),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",o.exportDetailsArray.freightTerms),e.xp6(15),e.Q6J("ngIf",e.DdM(11,he).includes(o.action)),e.xp6(1),e.Q6J("ngIf",e.DdM(12,he).includes(o.action)))},dependencies:[s.sg,s.O5,a._Y,a.YN,a.Kr,a.Fj,a.wV,a.EJ,a.JJ,a.JL,a.sg,a.u,de.f],encapsulation:2})}return r})();var V=d(77609),B=d(50363),j=d(95346),_e=d(84231);function ge(r,u){if(1&r&&(e.TgZ(0,"option",57),e._uU(1),e.qZA()),2&r){const t=u.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.label," ")}}function ye(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td",58,59)(10,"span",60),e._uU(11),e.qZA()(),e.TgZ(12,"td",58,61)(14,"span",60),e._uU(15),e.qZA()(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"SalesUOMUnitMaster"),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.ALo(23,"number"),e.qZA(),e.TgZ(24,"td"),e._uU(25),e.ALo(26,"date"),e.qZA(),e.TgZ(27,"td",62)(28,"Button",63),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.openFGStockModal(n))}),e._uU(29," Select "),e.qZA()(),e.TgZ(30,"td"),e._uU(31),e.ALo(32,"number"),e.qZA()()}if(2&r){const t=u.$implicit,i=e.MAs(9),o=e.MAs(13);e.xp6(2),e.Oqu(null==t?null:t.SONumber),e.xp6(2),e.Oqu(e.xi3(5,18,null==t?null:t.SODate,"dd-MM-YYYY")),e.xp6(3),e.Oqu(null==t?null:t.SKUNo),e.xp6(1),e.Udp("width",i.clientWidth),e.xp6(2),e.Q6J("positionTarget",i)("ngbTooltip",t.SKUName),e.xp6(1),e.hij(" ",null==t?null:t.SKUName," "),e.xp6(1),e.Udp("width",o.clientWidth),e.xp6(2),e.Q6J("positionTarget",o)("ngbTooltip",t.SKUDescription),e.xp6(1),e.hij(" ",null==t?null:t.SKUDescription," "),e.xp6(2),e.Oqu(e.lcZ(18,21,null==t?null:t.UOM)),e.xp6(3),e.Oqu(null==t?null:t.DRNLineNumber),e.xp6(2),e.Oqu(e.xi3(23,23,null==t?null:t.SOBalancedQty,".2-2")),e.xp6(3),e.Oqu(e.xi3(26,26,null==t?null:t.plannedDispatchDt,"dd-MM-YYYY")),e.xp6(6),e.hij(" ",e.xi3(32,29,null==t?null:t.dispatchQty,".2-2")," ")}}function H(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"button",64),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openDRNReviewTermsModal())}),e._uU(1," Review Terms "),e.qZA()}}function z(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"button",65),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openExportDetailsModal())}),e._uU(1," Export Details "),e.qZA()}}function fe(r,u){1&r&&e._UZ(0,"div",66)}function De(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"div",69)(1,"div",70)(2,"button",71),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.reset())}),e._uU(3,"Reset"),e.qZA(),e.TgZ(4,"button",72),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.ESCPreview())}),e._uU(5," Esc "),e.qZA(),e.TgZ(6,"button",73),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.preview())}),e._uU(7,"Preview"),e.qZA(),e.TgZ(8,"button",74),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.submit())}),e._uU(9," Save "),e.qZA()()()}if(2&r){const t=e.oxw(2);e.xp6(4),e.Q6J("disabled",!t.isESCPreview),e.xp6(4),e.Q6J("disabled",!t.isPreview)}}const $=function(){return["create"]};function X(r,u){if(1&r&&(e.TgZ(0,"div",67),e.YNc(1,De,10,2,"div",68),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.DdM(1,$).includes(t.action))}}function W(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"div",67)(1,"div",69)(2,"div",70)(3,"button",75),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.submit())}),e._uU(4,"Approve"),e.qZA()()()()}}function Te(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"div",76)(1,"button",75),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.submit())}),e._uU(2,"Save"),e.qZA()()}}function Re(r,u){1&r&&(e.TgZ(0,"div",77)(1,"span",78),e._uU(2,"Reason for Cancellation"),e.qZA(),e._UZ(3,"input",79),e.qZA())}function Ne(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"div",80)(1,"button",75),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openCancelModal())}),e._uU(2,"Cancel"),e.qZA()()}}function ee(r,u){1&r&&(e.TgZ(0,"div",81)(1,"span",78),e._uU(2," Remark"),e.qZA(),e._UZ(3,"input",82),e.qZA())}function te(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"div",83)(1,"button",75),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.submit())}),e._uU(2,"Reject"),e.qZA()()}}const ve=function(r,u,t,i){return{page:r,pageSize:u,collection:t,search:i,excelDisplay:"none"}},Ce=function(){return["cancel","rejection"]},c=function(){return["view"]},Ae=function(){return["approval"]};let Ze=(()=>{class r{constructor(t,i,o,n,l,h,q,Fe){this.dispatchRequestNoteService=t,this.activatedRoute=i,this.spinner=o,this.toastService=n,this.validationService=l,this.modalService=h,this.utilityService=q,this.location=Fe,this.DRNDetailsArray=[],this.customerOptions=[],this.customers=[],this.page=1,this.pageSize=6,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.submitted=!1,this.isPreview=!1,this.action="create",this.ESCPreviewArr=[],this.shipToArr=[],this.isESCPreview=!1,this.statusArr={create:"Created",edit:"Created",approval:"Approved",cancel:"Cancelled",rejection:"Rejected"},this.customerCurrency="INR",this.masterData={autoIncrementNo:"",freightTermsOptions:[],modeOfTransportOptions:[],paymentTermsOptions:[],salesCategoryOptions:[],transporterOptions:[],customersOptions:[]},this.selectedCustomerDetails={},this.form=new a.nJ({_id:new a.p4(null),DRNNumber:new a.p4(null),DRNDate:new a.p4(""),salesCategory:new a.p4(null,[a.kI.required]),customer:new a.p4(null,[a.kI.required]),DRNDetails:new a.p4([]),remarks:new a.p4(null),DRNStatus:new a.p4("Created"),customerShippingAddress:new a.nJ({contactPersonName:new a.p4(null),line1:new a.p4(null),line2:new a.p4(null),line3:new a.p4(null),line4:new a.p4(null),pinCode:new a.p4(null),city:new a.p4(null),state:new a.p4(null),country:new a.p4(null)}),exportsInfo:new a.nJ({exportsInvoiceNo:new a.p4(null),exportsInvoiceDate:new a.p4(this.utilityService.getTodayDate("YYYY-MM-DD")),exportsInvoiceTotalValue:new a.p4(null),exchangeRate:new a.p4(null),finalDestination:new a.p4(null)}),paymentTerms:new a.p4(null),modeOfTransport:new a.p4(null,[a.kI.required]),frightTerms:new a.p4("FOR - Free On Road"),transporter:new a.p4(null),destination:new a.p4(null,[a.kI.required]),cancellationReason:new a.p4(null)})}get f(){return this.form.controls}get shipToAddress(){return this.form.get("customerShippingAddress")}get exportsInfo(){return this.form.get("exportsInfo")}trackByFn(t,i){return i?._id}submit(){if(this.submitted=!0,this.isPreview=!1,"cancel"==this.action&&!this.f.cancellationReason.value)return void this.toastService.warning("Reason for Cancellation is Required");if(this.form.enable(),this.validationService.checkErrors(this.form,N.HQ))return;if("rejection"==this.action&&!this.form.controls.remarks.value)return void this.toastService.warning("Reject Remark is Required");if(0==this.DRNDetailsArray.length)return void this.toastService.warning("Atleast one row is Required");let t=this.form.value;t.DRNDetails=this.DRNDetailsArray.filter(i=>i.dispatchQty>0),t._id?this.update(t):(delete t._id,this.create(t))}ngOnInit(){this.getInitialData()}update(t){this.spinner.show(),this.dispatchRequestNoteService.update(t._id,t).subscribe(i=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(i.message),this.location.back()})}create(t){this.spinner.show(),this.dispatchRequestNoteService.create(t).subscribe(i=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(i.message),this.location.back()})}ESCPreview(){this.search="",this.isPreview=!1,this.DRNDetailsArray=this.ESCPreviewArr,this.collection=this.DRNDetailsArray.length}preview(){this.search="",this.isESCPreview=!0,this.ESCPreviewArr=this.DRNDetailsArray,this.DRNDetailsArray=this.DRNDetailsArray.filter(t=>t.dispatchQty>0),this.DRNDetailsArray.length&&(this.isPreview=!0),this.collection=this.DRNDetailsArray.length}reset(){this.form.reset(),this.customerOptions=[],this.DRNDetailsArray=[],this.shipToArr=[],this.collection=this.DRNDetailsArray.length,this.getInitialData()}getInitialData(){this.spinner.show(),this.dispatchRequestNoteService.getAllMasterData({}).subscribe(t=>{this.masterData=t,this.form.controls.DRNNumber.setValue(this.masterData?.autoIncrementNo),this.form.controls.frightTerms.setValue("FOR - Free On Road"),this.f.DRNDate.setValue(this.utilityService.getTodayDate("YYYY-MM-DD")),this.form.controls.DRNStatus.setValue(this.statusArr[this.action]),this.activatedRoute.queryParams.pipe((0,U.z)(i=>(this.action=i.action,this.utilityService.accessDenied(this.action),i.id?this.dispatchRequestNoteService.getById(i.id):(0,F.of)({})))).subscribe(i=>{this.spinner.hide(),0!=Object.keys(i).length&&(this.DRNDetailsArray=i.DRNDetails,i.DRNDate&&(i.DRNDate=this.utilityService.getFormatDate(i.DRNDate,"YYYY-MM-DD")),i.exportsInfo&&i.exportsInfo.exportsInvoiceDate&&(i.exportsInfo.exportsInvoiceDate=this.utilityService.getFormatDate(i.exportsInfo.exportsInvoiceDate,"YYYY-MM-DD")),this.customerCurrency=this.masterData?.customersOptions.find(o=>o?.customerName==i?.customer?.customerName)?.customerCurrency,i.customer=i.customer._id,this.customerOptions=this.masterData?.customersOptions.filter(o=>o.salesCategory==i.customerCategory),this.collection=this.DRNDetailsArray.length,i.DRNStatus=this.statusArr[this.action],this.form.patchValue(i),("edit"==this.action||"view"==this.action||"rejection"==this.action||"approval"==this.action||"cancel"==this.action)&&(this.form.disable(),this.form.controls.remarks.enable(),this.f.cancellationReason.enable()))})})}eventHeader(t){switch(t.key){case"SEARCH":this.search=t.value,this.page=1;break;case"EXCEL":default:break;case"PAGE":this.page=t.value}}onSort({column:t,direction:i}){this.headers.forEach(o=>{o.sortable!==t&&(o.direction="")}),this.DRNDetailsArray=""===i||""===t?this.DRNDetailsArray:[...this.DRNDetailsArray].sort((o,n)=>{let l="string"==typeof o[t]?o[t].toLowerCase():o[t],h="string"==typeof n[t]?n[t].toLowerCase():n[t];const q=l<h?-1:l>h?1:0;return"asc"===i?q:-q})}customerValueChange(t){this.form.controls.paymentTerms.setValue(t?.customerPaymentTerms),this.shipToAddress.controls.contactPersonName.setValue(null),this.customerCurrency=t?.customerCurrency??"INR",this.shipToArr=t?.customerShippingAddress,this.spinner.show(),this.dispatchRequestNoteService.getDRNDetailsByCustomerId(t._id).subscribe(i=>{this.DRNDetailsArray=i,this.collection=this.DRNDetailsArray.length,this.spinner.hide()})}getCustomers(){this.f.customer.setValue(null),this.DRNDetailsArray=[],this.customerOptions=this.masterData?.customersOptions.filter(t=>t.customerCategory==this.f.salesCategory.value)}checkDispatchQty(t){let i=this.DRNDetailsArray.map(n=>n.DRNLineNumber).indexOf(t.DRNLineNumber);if(this.DRNDetailsArray.filter(n=>n.FGINId==t?.FGINId).map(n=>n.dispatchQty).reduce((n,l)=>n+l,0)>t?.FGINQty)return this.DRNDetailsArray[i].FGINMfgDate="",this.DRNDetailsArray[i].dispatchQty=0,this.DRNDetailsArray=[...this.DRNDetailsArray],void this.toastService.error("Dispatch Qty. should not be greater than FGIN Qty.");t.dispatchQty>t.SOBalancedQty&&(this.toastService.error("Dispatch Qty should not be greater then SO Balanced Qty"),this.DRNDetailsArray[i].dispatchQty=0),t.dispatchQty>t.FGINQty&&(this.toastService.error("Dispatch Qty should not be greater then FGIN Qty"),this.DRNDetailsArray[i].dispatchQty=0)}setFGINQty(t,i){let o=i.FGINOptions.find(h=>h._id==t.target.value),n=this.DRNDetailsArray.map(h=>h.DRNLineNumber).indexOf(i.DRNLineNumber);if(this.DRNDetailsArray.filter(h=>h.FGINId==o?._id).map(h=>h.dispatchQty).reduce((h,q)=>h+q,0)>o?.FGINQuantity)return this.DRNDetailsArray[n].FGINMfgDate="",void this.toastService.error("FGIN Qty should not be greater then Dispatch Qty of that batch.");this.DRNDetailsArray[n].FGINId=o?._id,this.DRNDetailsArray[n].FGINQty=o?.FGINQuantity,this.DRNDetailsArray[n].FGINMfgDate=o?.manufacturingDate}setShipToAddress(t){this.shipToAddress.patchValue(t)}openShipToAddressModal(){const t=this.modalService.open(Q,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});t.componentInstance.action=this.action,t.componentInstance.customerShippingAddress=this.shipToAddress.value,t.result.then(i=>{i&&["create","edit"].includes(this.action)},i=>{})}openDRNReviewTermsModal(){const t=this.modalService.open(Y,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});t.componentInstance.action=this.action,t.componentInstance.SOTermsArr={transporterArr:this.masterData?.transporterOptions,freightTerms:this.masterData?.freightTermsOptions,modeOfTransport:this.masterData?.modeOfTransportOptions,paymentTermsArr:this.masterData?.paymentTermsOptions},t.componentInstance.SOTermsData={paymentTerms:this.form.controls.paymentTerms.value,modeOfTransport:this.form.controls.modeOfTransport.value,frightTerms:this.form.controls.frightTerms.value,transporter:this.form.controls.transporter.value,destination:this.form.controls.destination.value},t.result.then(i=>{i&&["create","edit"].includes(this.action)&&this.form.patchValue(i)},i=>{})}openExportDetailsModal(){const t=this.modalService.open(Se,{centered:!0,size:"xl",backdrop:"static",keyboard:!1});t.componentInstance.action=this.action,t.componentInstance.customerCurrency=this.customerCurrency,t.componentInstance.exportDetailsArray={freightTerms:this.masterData?.freightTermsOptions,modeOfTransport:this.masterData?.modeOfTransportOptions},t.componentInstance.ExportDetailsData={...this.exportsInfo.value,modeOfTransport:this.form.controls.modeOfTransport.value,frightTerms:this.form.controls.frightTerms.value,destination:this.form.controls.destination.value},t.result.then(i=>{i&&["create","edit"].includes(this.action)&&(this.form.patchValue(i),this.exportsInfo.patchValue(i))},i=>{})}openFGStockModal(t){let i=this.DRNDetailsArray.findIndex(n=>n.DRNLineNumber==t.DRNLineNumber&&n.SONumber==t.SONumber&&n.SKUNo==t.SKUNo);const o=this.modalService.open(se,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});o.componentInstance.action=this.action,o.componentInstance.data=t,o.componentInstance.totalDispatchQty=t.totalDispatchQty,o.componentInstance.tBatchNo=t.tBatchNo,o.result.then(n=>{n&&(this.DRNDetailsArray[i].FGStockDetails=n.FGStockDetails,this.DRNDetailsArray[i].tBatchNo=n.tBatchNo,this.DRNDetailsArray[i].totalDispatchQty=n.totalDispatchQty,this.DRNDetailsArray[i].dispatchQty=n.totalDispatchQty)},n=>{})}openCustomersDetailsModal(){const t=this.modalService.open(V.e7,{centered:!0,size:"xl",backdrop:"static",keyboard:!1});t.componentInstance.action=this.action,t.componentInstance.selectedCustomerDetails=this.selectedCustomerDetails,t.componentInstance.customerOptions=this.customerOptions,t.componentInstance.customer=this.form.controls.customer.value,t.result.then(i=>{i&&(console.log("success",i),this.selectedCustomerDetails=i?.selectedCustomerDetails,this.form.controls.customer.setValue(i?.selectedCustomerDetails?._id),this.customerValueChange(this.selectedCustomerDetails))},i=>{})}openCancelModal(){const t=this.modalService.open(V.er,{centered:!0,size:"sm",backdrop:"static",keyboard:!1});t.componentInstance.action=this.action,t.componentInstance.heading="DRN Cancellation",t.componentInstance.cancelText="Do You Want to Cancel DRN ?",t.result.then(i=>{"Yes"==i&&this.submit()},i=>{})}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(D.lM),e.Y36(p.gz),e.Y36(m.V),e.Y36(m.kl),e.Y36(C.RJ),e.Y36(_.FF),e.Y36(m.tI),e.Y36(s.Ye))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-dispatch-request-note-form"]],viewQuery:function(i,o){if(1&i&&e.Gf(y.j,5),2&i){let n;e.iGM(n=e.CRH())&&(o.headers=n)}},decls:109,vars:46,consts:[[1,"formCard","card",3,"formGroup"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,"form-body"],[1,"row","mb-2"],[1,"col-6"],[1,"row"],[1,"col-4","pe-0"],[1,"form-label","mb-0"],[1,"text-danger"],["type","text","formControlName","DRNNumber","readonly","",1,"form-control"],[1,"col-3","pe-0"],["type","date","formControlName","DRNDate","readonly","",1,"form-control"],[1,"col-5"],["formControlName","salesCategory",1,"form-select",3,"change"],["selected","","disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"col-3","ps-0","pe-5"],[1,"d-flex","align-items-center"],[1,"col-11"],["bindLabel","customerName","bindValue","_id","formControlName","customer",3,"items","clearable","change"],["id","basic-addon1",1,"input-group-text","bg-primary","pointer","col-auto","fs-4",2,"height","2.9rem",3,"click"],["aria-hidden","true",1,"fa","fa-search","text-white"],["formGroupName","customerShippingAddress",1,"col-3","ps-0"],[1,"form-label","mb-0","d-flex","justify-content-between"],["type","button",1,"btn","btn-primary","px-3","form-btn-sm","py-0","mb-1",3,"click"],["bindLabel","contactPersonName","bindValue","contactPersonName","formControlName","contactPersonName",3,"items","clearable","change"],[1,"row","line-border"],[1,""],[3,"data","dataChange"],[1,"table-responsive","mt-0","text-wrap",2,"min-height","22rem"],[1,"table","table-bordered","mt-0","table-sticky"],[1,"bg-info"],[1,"text-white"],["sortable","SONumber",3,"sort"],["sortable","SODate",3,"sort"],["sortable","SKUNo",3,"sort"],["sortable","SKUName",1,"text-start",3,"sort"],["sortable","SKUDescription",1,"text-start",3,"sort"],["sortable","UOM",3,"sort"],["sortable","SOBalancedQty",3,"sort"],["sortable","",3,"sort"],["sortable","dispatchQty",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"row","d-flex","justify-content-center"],[3,"ngClass"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["class","btn btn-primary px-3","type","button",3,"click",4,"ngIf"],[1,"plusIconSvg","btn","btn-primary","ms-1"],["class","col-7",4,"ngIf"],["class","col-7 text-end",4,"ngIf"],["class","d-flex justify-content-center",4,"ngIf"],["class","d-flex inputGroup col-6 text-center",4,"ngIf"],["class","content-end col-3",4,"ngIf"],["class","d-flex inputGroup col-3 text-center",4,"ngIf"],["class","col-6 text-end",4,"ngIf"],[3,"value"],[1,"text-start"],["SKUName",""],[1,"pointer",3,"positionTarget","ngbTooltip"],["SKUDescription",""],[1,"align-self-center"],[1,"btn","btn-primary","btn-sm",2,"--bs-btn-padding-y","0rem",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-primary","px-3",3,"click"],[1,"col-7"],[1,"col-7","text-end"],["class","col-md-auto",4,"ngIf"],[1,"col-md-auto"],[1,"d-grid","gap-2","d-md-block"],["type","button",1,"btn","btn-primary","px-5","me-4",3,"click"],["type","button",1,"btn","btn-primary","me-1",3,"disabled","click"],["type","button",1,"btn","btn-primary","px-4","me-4",3,"click"],["type","button",1,"btn","btn-primary","px-5",3,"disabled","click"],["type","button",1,"btn","btn-primary","px-5",3,"click"],[1,"d-flex","justify-content-center"],[1,"d-flex","inputGroup","col-6","text-center"],[1,"input-group-text","text-white","bg-primary"],["type","text","formControlName","cancellationReason",1,"form-control"],[1,"content-end","col-3"],[1,"d-flex","inputGroup","col-3","text-center"],["type","text","formControlName","remarks",1,"form-control"],[1,"col-6","text-end"]],template:function(i,o){1&i&&(e.TgZ(0,"Form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label"),e._uU(5),e.ALo(6,"titlecase"),e.qZA()()(),e.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"label",9),e._uU(13," DRN No. "),e._UZ(14,"span",10),e.qZA(),e._UZ(15,"input",11),e.qZA(),e.TgZ(16,"div",12)(17,"label",9),e._uU(18," DRN Date "),e._UZ(19,"span",10),e.qZA(),e._UZ(20,"input",13),e.qZA(),e.TgZ(21,"div",14)(22,"label",9),e._uU(23," Customer Category "),e.TgZ(24,"span",10),e._uU(25,"*"),e.qZA()(),e.TgZ(26,"select",15),e.NdJ("change",function(){return o.getCustomers()}),e.TgZ(27,"option",16),e._uU(28,"Select Category"),e.qZA(),e.YNc(29,ge,2,2,"option",17),e.qZA()()()(),e.TgZ(30,"div",18)(31,"label",9),e._uU(32," Customer Name/Bill To "),e.TgZ(33,"span",10),e._uU(34,"*"),e.qZA()(),e.TgZ(35,"div",19)(36,"div",20)(37,"ng-select",21),e.NdJ("change",function(l){return o.customerValueChange(l)}),e.qZA()(),e.TgZ(38,"div",22),e.NdJ("click",function(){return o.openCustomersDetailsModal()}),e._UZ(39,"i",23),e.qZA()()(),e.TgZ(40,"div",24)(41,"label",25),e._uU(42," Ship To "),e.TgZ(43,"span",10),e._uU(44,"*"),e.qZA(),e._UZ(45,"span")(46,"span")(47,"span")(48,"span")(49,"span")(50,"span")(51,"span")(52,"span")(53,"span")(54,"span")(55,"span")(56,"span"),e.TgZ(57,"button",26),e.NdJ("click",function(){return o.openShipToAddressModal()}),e._uU(58," Address "),e.qZA()(),e.TgZ(59,"ng-select",27),e.NdJ("change",function(l){return o.setShipToAddress(l)}),e.qZA()()()(),e._UZ(60,"hr",28),e.TgZ(61,"div",29)(62,"app-setting-header",30),e.NdJ("dataChange",function(l){return o.eventHeader(l)}),e.qZA()(),e.TgZ(63,"div",31)(64,"table",32)(65,"thead",33)(66,"tr",34)(67,"th",35),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(68,"SO No."),e.qZA(),e.TgZ(69,"th",36),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(70,"SO Date"),e.qZA(),e.TgZ(71,"th",37),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(72,"SKU No."),e.qZA(),e.TgZ(73,"th",38),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(74),e.ALo(75,"labelTranslate"),e.qZA(),e.TgZ(76,"th",39),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(77),e.ALo(78,"labelTranslate"),e.qZA(),e.TgZ(79,"th",40),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(80,"UoM"),e.qZA(),e.TgZ(81,"th",40),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(82,"D/S"),e.qZA(),e.TgZ(83,"th",41),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(84,"SO Bal Qty"),e.qZA(),e.TgZ(85,"th",40),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(86,"Plan Disp Dt"),e.qZA(),e.TgZ(87,"th",42),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(88,"FG Stock"),e.qZA(),e.TgZ(89,"th",43),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(90,"Disp. Qty."),e.qZA()()(),e.TgZ(91,"tbody"),e.YNc(92,ye,33,32,"tr",44),e.ALo(93,"slice"),e.ALo(94,"searchFi1ter"),e.qZA()()(),e._UZ(95,"hr",28),e.TgZ(96,"div",45)(97,"div",46),e.YNc(98,H,2,0,"button",47),e.YNc(99,z,2,0,"button",48),e._UZ(100,"button",49),e.qZA(),e.YNc(101,fe,1,0,"div",50),e.YNc(102,X,2,2,"div",51),e.YNc(103,W,5,0,"div",51),e.YNc(104,Te,3,0,"div",52),e.YNc(105,Re,4,0,"div",53),e.YNc(106,Ne,3,0,"div",54),e.YNc(107,ee,4,0,"div",55),e.YNc(108,te,3,0,"div",56),e.qZA()()()),2&i&&(e.Q6J("formGroup",o.form),e.xp6(5),e.hij(" ",e.lcZ(6,24,o.action)," DRN"),e.xp6(22),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",null==o.masterData?null:o.masterData.salesCategoryOptions),e.xp6(8),e.Q6J("items",o.customerOptions)("clearable",!1),e.xp6(22),e.Q6J("items",o.shipToArr)("clearable",!1),e.xp6(3),e.Q6J("data",e.l5B(37,ve,o.page,o.pageSize,o.collection,o.search)),e.xp6(12),e.hij(" ",e.lcZ(75,26,"SKU Name")," "),e.xp6(3),e.hij(" ",e.lcZ(78,28,"SKU Description")," "),e.xp6(15),e.Q6J("ngForOf",e.Dn7(93,30,e.xi3(94,34,o.DRNDetailsArray,o.search),(o.page-1)*o.pageSize,(o.page-1)*o.pageSize+o.pageSize))("ngForTrackBy",o.trackByFn),e.xp6(5),e.Q6J("ngClass",e.DdM(42,Ce).includes(o.action)?"col-3":"col-5"),e.xp6(1),e.Q6J("ngIf",!o.form.controls.salesCategory.value||(null==o.form.controls.salesCategory||null==o.form.controls.salesCategory.value?null:o.form.controls.salesCategory.value.includes("Domestic"))),e.xp6(1),e.Q6J("ngIf",null==o.form.controls.salesCategory||null==o.form.controls.salesCategory.value?null:o.form.controls.salesCategory.value.includes("Exports")),e.xp6(2),e.Q6J("ngIf",e.DdM(43,c).includes(o.action)),e.xp6(1),e.Q6J("ngIf",e.DdM(44,$).includes(o.action)),e.xp6(1),e.Q6J("ngIf",e.DdM(45,Ae).includes(o.action)),e.xp6(1),e.Q6J("ngIf","edit"==o.action),e.xp6(1),e.Q6J("ngIf","cancel"==o.action),e.xp6(1),e.Q6J("ngIf","cancel"==o.action),e.xp6(1),e.Q6J("ngIf","rejection"==o.action),e.xp6(1),e.Q6J("ngIf","rejection"==o.action))},dependencies:[s.mk,s.sg,s.O5,T.P,_._L,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u,a.x0,B.w9,y.j,s.OU,s.JJ,s.rS,s.uU,j.G,v.c,_e.Q],encapsulation:2})}return r})();var be=d(56208),qe=d(65876);function ke(r,u){if(1&r){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",15,16)(9,"span",17),e._uU(10),e.qZA()(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td")(14,"div",18),e._UZ(15,"button",19),e.TgZ(16,"div",20)(17,"a",21),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.navigateTo("../form",n,"cancel"))}),e._UZ(18,"i",22),e._uU(19," Cancel "),e.qZA()()()()()}if(2&r){const t=u.$implicit,i=e.MAs(8),o=e.oxw();e.xp6(2),e.Oqu(null==t?null:t.DRNNumber),e.xp6(2),e.Oqu(null==t?null:t.DRNDateS),e.xp6(2),e.Oqu(null==t?null:t.salesCategory),e.xp6(1),e.Udp("width",i.clientWidth),e.xp6(2),e.Q6J("positionTarget",i)("ngbTooltip",t.customerName),e.xp6(1),e.hij(" ",t.customerName," "),e.xp6(2),e.Oqu(t.DRNStatus),e.xp6(5),e.ekj("disable","Cancelled"==(null==t?null:t.DRNStatus)),e.Q6J("accessType",o.rolePermissionActions.approveAction)}}const Oe=function(r,u,t,i){return{page:r,pageSize:u,collection:t,search:i,type:"list"}},xe=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:A},{path:"cancel_drn",component:(()=>{class r{constructor(t,i,o,n,l,h){this.exportExcelService=t,this.dispatchRequestNoteService=i,this.router=o,this.spinner=n,this.activatedRoute=l,this.exportToPDFService=h,this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.rolePermissionActions=R.a1}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}navigateTo(t,i,o){this.router.navigate([t],{relativeTo:this.activatedRoute,queryParams:{id:i?._id,action:o}})}trackByFn(t,i){return i?._id}eventHeader(t){switch(t.key){case"SEARCH":this.search=t.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=t.value,this.getAll()}}getAll(t=!1,i=""){this.spinner.show();let o={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:t};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.dispatchRequestNoteService.getAllForCancel(o).subscribe(n=>{"EXCEL"==i?this.excelDownload(n.rows):"PDF"==i?this.pdfDownload(n.rows):(this.tableData=n.rows,this.collection=n.count,this.spinner.hide())})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}pdfDownload(t){let i=(0,f.Kr)(t);this.exportToPDFService.generatePdf(i.tableData,i.title)}excelDownload(t){this.exportExcelService.exportExcel((0,f.n8)(t))}onSort({column:t,direction:i}){this.headers.forEach(o=>{o.sortable!==t&&(o.direction="")}),this.column=t,this.direction="asc"==i?1:-1,this.getAll()}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(m.Ol),e.Y36(D.lM),e.Y36(p.F0),e.Y36(m.V),e.Y36(p.gz),e.Y36(m.$L))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-cancel-drn"]],viewQuery:function(i,o){if(1&i&&e.Gf(y.j,5),2&i){let n;e.iGM(n=e.CRH())&&(o.headers=n)}},decls:24,vars:8,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-info"],[1,"text-white"],["sortable","DRNNumber",3,"sort"],["sortable","DRNDateS",3,"sort"],["sortable","salesCategory",3,"sort"],["sortable","customerName",1,"text-start",3,"sort"],["sortable","DRNStatus",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["customerName",""],[1,"pointer",3,"positionTarget","ngbTooltip"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-close","fa-lg","text-primary"]],template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"Cancellation DRN Summary"),e.qZA()(),e._UZ(4,"hr",3),e.TgZ(5,"div",4)(6,"app-setting-header",5),e.NdJ("dataChange",function(l){return o.eventHeader(l)}),e.qZA(),e.TgZ(7,"table",6)(8,"thead",7)(9,"tr",8)(10,"th",9),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(11,"DRN No."),e.qZA(),e.TgZ(12,"th",10),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(13,"DRN Date"),e.qZA(),e.TgZ(14,"th",11),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(15,"Customer Category"),e.qZA(),e.TgZ(16,"th",12),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(17,"Customer Name"),e.qZA(),e.TgZ(18,"th",13),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(19,"DRN Status"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Action"),e.qZA()()(),e.TgZ(22,"tbody"),e.YNc(23,ke,20,12,"tr",14),e.qZA()()()()),2&i&&(e.xp6(6),e.Q6J("data",e.l5B(3,Oe,o.page,o.pageSize,o.collection,o.search)),e.xp6(17),e.Q6J("ngForOf",o.tableData)("ngForTrackBy",o.trackByFn))},dependencies:[s.sg,T.P,_._L,y.j,S.J],encapsulation:2})}return r})()},{path:"form",component:Ze,resolve:{accessScreen:qe.x}}];let Ue=(()=>{class r{static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275mod=e.oAB({type:r});static#o=this.\u0275inj=e.cJS({imports:[s.ez,p.Bz.forChild(xe),be.m]})}return r})()},13107:(k,g,d)=>{d.d(g,{t:()=>s});const s={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}}},28402:(k,g,d)=>{d.d(g,{J:()=>s});const s=({data:p,headers:y,widths:R,title:f})=>({tableData:{widths:R,headerRows:1,body:[y.map(D=>({text:D.header,style:"header"})),...p.map(D=>y.map(T=>({style:"subheader",text:D[T.key]})))]},title:f})},79250:(k,g,d)=>{d.d(g,{p3:()=>m,U$:()=>e,S$:()=>F,B6:()=>U,mx:()=>ce,mI:()=>le,sb:()=>ie,PW:()=>b,Kr:()=>O,n8:()=>S,TP:()=>ae,_y:()=>re,i7:()=>Re,G4:()=>Te,EY:()=>Ce,X1:()=>ve,zF:()=>ge,D$:()=>_e,ti:()=>De,_g:()=>fe,Rb:()=>pe,xi:()=>de,zm:()=>w,ji:()=>I});var s=d(13107),p=d(28402);let y=["*","*","*","*","*","*","*","*","*","*","*"],R="Book Sales Order",f=[{header:"SO No.",key:"SONumber",...s.t},{header:"SO Date",key:"SODateS",...s.t},{header:"Bill From Location",key:"billFromLocation",...s.t},{header:"Customer Category",key:"salesCategory",...s.t},{header:"Customer Name",key:"customerName",...s.t},{header:"PO Date.",key:"PODate",...s.t},{header:"Currency",key:"currency",...s.t},{header:"SO Type",key:"SOType",...s.t},{header:"SO Value",key:"SOTotalAmount",...s.t},{header:"Status",key:"SOStatus",...s.t}];const e=c=>({title:R,csvData:c,headers:f}),m=c=>(0,p.J)({data:c,headers:f,widths:y,title:R});let D=["*","*","*","*","*","*","*"],T="DispatchRequestNote Report",_=[{header:"DRN No.",key:"DRNNumber",...s.t},{header:"DRN Date",key:"DRNDateS",...s.t},{header:"Customer Category",key:"salesCategory",...s.t},{header:"Customer Name",key:"customerName",...s.t},{header:"DRN Status",key:"DRNStatus",...s.t}];const S=c=>({title:T,csvData:c,headers:_}),O=c=>(0,p.J)({data:c,headers:_,widths:D,title:T});let x=["*","*","*","*","*","*","*","*","*","*"],A="Cancel SO",a=[{header:"SO No.",key:"SONumber",...s.t},{header:"SO Date",key:"SODateS",...s.t},{header:"PO No.",key:"PONumber",...s.t},{header:"Sales Category",key:"salesCategory",...s.t},{header:"Customer Name",key:"customerName",...s.t},{header:"Currency",key:"currency",...s.t},{header:"SO Value",key:"SOTotalAmount",...s.t},{header:"Status",key:"SOStatus",...s.t}];const U=c=>({title:A,csvData:c,headers:a}),F=c=>(0,p.J)({data:c,headers:a,widths:x,title:A});let N=["*","*","*","*","*","*","*","*","*","*","*","*"],v="Short SO Closing",Z=[{header:"SO Date",key:"SODate",...s.t},{header:"SO #",key:"SONumber",...s.t},{header:"Line #",key:"SOLineNumber",...s.t},{header:"SKU #",key:"SKUNo",...s.t},{header:"SKU Name",key:"SKUName",...s.t},{header:"SKU Description",key:"SKUDescription",...s.t},{header:"Bal Qty",key:"balancedQty",...s.t},{header:"Customer Name",key:"customer",...s.t}];const I=c=>({title:v,csvData:c,headers:Z}),w=c=>(0,p.J)({data:c,headers:Z,widths:N,title:v});let oe=["*","*","*","*","*","*","*","*","*"],M="Direct Tax Invoice",J=[{header:"Invoice #",key:"DTINumber",...s.t},{header:"Invoice Date",key:"salesInvoiceDateS",...s.t},{header:"Customer Category",key:"salesCategory",...s.t},{header:"Customer Name",key:"customerName",...s.t},{header:"Product Value",key:"DTITotalAmount",...s.t},{header:"Invoice Value",key:"DTIValue",...s.t},{header:"Status",key:"DTIStatus",...s.t}];const b=c=>({title:M,csvData:c,headers:J}),ie=c=>(0,p.J)({data:c,headers:J,widths:oe,title:M});let se=["*","*","*","*","*","*","*","*","*","*","*","*","*"],C="Proforma Invoice",Q=[{header:"PI No.",key:"PINumber",...s.t},{header:"PI Date",key:"PIDateS",...s.t},{header:"Bill From Location",key:"billFromLocation",...s.t},{header:"Customer Category",key:"salesCategory",...s.t},{header:"Customer Name",key:"customerName",...s.t},{header:"PO No.",key:"PONumber",...s.t},{header:"PO Date",key:"PODate",...s.t},{header:"Currency",key:"currency",...s.t},{header:"PI Validity Date",key:"PIValidityDate",...s.t},{header:"PI Amount",key:"PITotalAmount",...s.t},{header:"PI Status",key:"PIStatus",...s.t}];const re=c=>({title:C,csvData:c,headers:Q}),ae=c=>(0,p.J)({data:c,headers:Q,widths:se,title:C});let ne=["*","*","*","*","*","*","*","*","*","*"],P="Credit Note",G=[{header:"CN No.",key:"CNNumber",...s.t},{header:"CN Date",key:"CNDateS",...s.t},{header:"Customer Category",key:"salesCategory",...s.t},{header:"Customer Name",key:"customerName",...s.t},{header:"Debit Note No.",key:"invoiceNo",...s.t},{header:"Invoice Date",key:"invoiceDateS",...s.t},{header:"Currency",key:"currency",...s.t},{header:"Net CN Value",key:"netCNValue",...s.t},{header:"Reason For CN",key:"reasonForCN",...s.t},{header:"CN Status.",key:"CNStatus",...s.t}];const le=c=>({title:P,csvData:c,headers:G}),ce=c=>(0,p.J)({data:c,headers:G,widths:ne,title:P});let ue=["*","*","*","*","*","*","*","*","*","*","*","*"],E="ServiceInvoice Report",Y=[{header:"Invoice #",key:"serviceInvoiceNumber",...s.t},{header:"Invoice Date",key:"serviceInvoiceDate",...s.t},{header:"Customer Category",key:"customerCategory",...s.t},{header:"Customer Name",key:"customerName",...s.t},{header:"PO No.",key:"PONo",...s.t},{header:"PO Date",key:"PODate",...s.t},{header:"Currency",key:"currency",...s.t},{header:"Bill From Location",key:"billFromLocation",...s.t},{header:"Total Value",key:"totalValue",...s.t},{header:"Remarks",key:"remarks",...s.t},{header:"Status",key:"status",...s.t}];const de=c=>({title:E,csvData:c,headers:Y}),pe=c=>(0,p.J)({data:c,headers:Y,widths:ue,title:E});let V=["*","*","*","*","*","*","*","*"],B="Sales Forecast",j=[{header:"FC No.",key:"FCNo",...s.t},{header:"FC Date",key:"FCDate",...s.t},{header:"Customer Category",key:"customerCategory",...s.t},{header:"Customer Name",key:"customerName",...s.t},{header:"Currency",key:"currency",...s.t},{header:"FC Type",key:"FCType",...s.t},{header:"FC Value",key:"netFCValue",...s.t},{header:"Status",key:"status",...s.t}];const _e=c=>({title:B,csvData:c,headers:j}),ge=c=>(0,p.J)({data:c,headers:j,widths:V,title:B});let ye=["*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"],H="Debit Note",z=[{header:"DN No.",key:"DNNumber",...s.t},{header:"DN Date",key:"DNDateS",...s.t},{header:"Sale Category",key:"salesCategory",...s.t},{header:"Customer Name",key:"customerName",...s.t},{header:"Invoice No.",key:"invoiceNo",...s.t},{header:"Invoice Date",key:"invoiceDateS",...s.t},{header:"Currency",key:"currency",...s.t},{header:"DN Net Value",key:"netDNValue",...s.t},{header:"Reason For Debit Note",key:"reasonForDN",...s.t},{header:"DN Status",key:"DNStatus",...s.t}];const fe=c=>({title:H,csvData:c,headers:z}),De=c=>(0,p.J)({data:c,headers:z,widths:ye,title:H});let $=["*","*","*","*","*","*","*"],X="Quotation Of D-SKU",W=[{header:"Qtn. No.",key:"quotationNo",...s.t},{header:"Rev No.",key:"revNo",...s.t},{header:"Qtn. Date",key:"quotationDate",...s.t},{header:"Customer/Prospect Category",key:"customerCategory",...s.t},{header:"Customer/Prospect Name",key:"customerName",...s.t},{header:"Ccy",key:"currency",...s.t},{header:"Status",key:"status",...s.t}];const Te=c=>({title:X,csvData:c,headers:W}),Re=c=>(0,p.J)({data:c,headers:W,widths:$,title:X});let Ne=["*","*","*","*","*","*","*"],ee="Quotation Of SKU",te=[{header:"Qtn. No.",key:"quotationNo",...s.t},{header:"Rev No.",key:"revNo",...s.t},{header:"Qtn. Date",key:"quotationDate",...s.t},{header:"Customer Category",key:"customerCategory",...s.t},{header:"Customer Name",key:"customerName",...s.t},{header:"Ccy",key:"currency",...s.t},{header:"Status",key:"status",...s.t}];const ve=c=>({title:ee,csvData:c,headers:te}),Ce=c=>(0,p.J)({data:c,headers:te,widths:Ne,title:ee})},49580:(k,g,d)=>{d.d(g,{D:()=>s});const s=[{message:"HSN Code is Required",key:"hsnCode"},{message:"Description of Goods is Required",key:"goodsDescription"},{message:"GST Rate % is Required",key:"gstRate"},{message:"IGST Rate % is Required",key:"igstRate"},{message:"CGST Rate % is Required",key:"cgstRate"},{message:"SGST Rate % is Required",key:"sgstRate"},{message:"UTGST Rate % is Required",key:"ugstRate"},{message:"Revision No. is Required",key:"revisionNo"},{message:"Revision Date is Required",key:"revisionDate"}]},4092:(k,g,d)=>{d.d(g,{tm:()=>T,Kb:()=>s,lR:()=>S,jH:()=>p,y5:()=>O,OV:()=>A,HQ:()=>x,RS:()=>a,vc:()=>U,Nj:()=>v,rw:()=>Z,Uh:()=>F,J4:()=>w,ff:()=>R,BC:()=>I,JY:()=>f,Dd:()=>N,Sy:()=>e,tH:()=>m,se:()=>_,RH:()=>D});const s=[{message:"Customer Name is Required",key:"customerName"},{message:"Mobile No. is Required",key:"mobileNo"},{message:"stateOfSupply is Required",key:"stateOfSupply"}],p=[{message:"Customer Code is Required",key:"customerCode"},{message:"Customer Name is Required",key:"customerName"},{message:"Sales Category is Required",key:"customerCategory"},{message:"PAN No. is Required",key:"customerPAN"},{message:"GSTIN is Required",key:"GSTIN"},{message:"GST Classification is Required",key:"GSTClassification"},{message:"Customer Category is Required",key:"customerType"},{message:"Customer Currency is Required",key:"customerCurrency"},{message:"Payment Terms is Required",key:"customerPaymentTerms"}];d(49580);const R=[{message:"SAC Code is Required",key:"sacCode"},{message:"Description of Service is Required",key:"serviceDescription"},{message:"GST Rate % is Required",key:"gstRate"},{message:"IGST Rate % is Required",key:"igstRate"},{message:"CGST Rate % is Required",key:"cgstRate"},{message:"SGST Rate % is Required",key:"sgstRate"},{message:"UTGST Rate % is Required",key:"ugstRate"},{message:"Revision Date is Required",key:"revisionNo"},{message:"Revision Date is Required",key:"revisionDate"}],f=[{message:"Service Description is Required",key:"serviceDescription"}],e=[{message:"SKU Stage is Required",key:"SKUStage"},{message:"Product Category is Required",key:"productCategory"},{message:"SKU No is Required",key:"SKUNo"},{message:"SKU Name is Required",key:"SKUName"},{message:"SKU Description is Required",key:"SKUDescription"},{message:"HSN Code is Required",key:"hsn"},{message:"Unit of Measurement is Required",key:"primaryUnit"}],m=[{message:"Shelf Life [Months] is required",key:"shelfLife"},{message:"Storage Temperature [\xb0C] is required",key:"storageTemp"},{message:"Storage Humidity [RH] is required",key:"storageHumidity"},{message:"Special Storage Instruction is required",key:"specialStorageInstruction"}],D=[{message:"Type is Required",key:"transporterType"}],T=[{message:"Bill From Location is Required",key:"billFromLocation"},{message:"Customer Category is Required",key:"salesCategory"},{message:"Customer Name is Required",key:"customer"},{message:"Purchase Order No. is Required",key:"PONumber"},{message:"Purchase Order Date is Required",key:"PODate"},{message:"Net SO Value is Required",key:"SOTotalAmount"},{message:"Status is Required",key:"SOStatus"},{message:"Customer Shipping Address is Required",key:"customerShippingAddress"},{message:"Freight Terms is Required",key:"frightTerms"},{message:"Transporter is Required",key:"transporter"},{message:"Destination is Required",key:"destination"}],_=[{message:"Freight Terms is Required",key:"frightTerms"},{message:"Transporter is Required",key:"transporter"},{message:"Mode of transport is Required",key:"modeOfTransport"},{message:"Destination is Required",key:"destination"}],S=[{message:"Customer Category is Required",key:"salesCategory"},{message:"Customer Name is Required",key:"customer"}],O=[{message:"Customer Category is Required",key:"salesCategory"},{message:"Customer Name is Required",key:"customer"}],x=[{message:"Customer Category is Required",key:"salesCategory"},{message:"Customer Name is Required",key:"customer"},{message:"Fright Terms is Required",key:"frightTerms"},{message:"Destination Terms is Required",key:"destination"},{message:"Mode of Transport is Required",key:"modeOfTransport"}],A=[{message:"Export Invoice No. is Required",key:"exportsInvoiceNo"},{message:"Export Invoice Date is Required",key:"exportsInvoiceDate"},{message:"Export Invoice Total Value is Required",key:"exportsInvoiceTotalValue"},{message:"Exchange Rate is Required",key:"exchangeRate"},{message:"Mode of Transport is Required",key:"modeOfTransport"},{message:"Fright Terms is Required",key:"frightTerms"},{message:"Port of Destination Terms is Required",key:"destination"},{message:"Final Destination Terms is Required",key:"finalDestination"}],a=[{message:"Payment Terms is Required",key:"paymentTerms"},{message:"Fright Terms is Required",key:"frightTerms"},{message:"Transporter Terms is Required",key:"transporter"},{message:"Destination Terms is Required",key:"destination"},{message:"Mode of Transport is Required",key:"modeOfTransport"}],U=[{message:"Supply Type is Required",key:"supplyType"},{message:"Sub Supply Type is Required",key:"subSupplyType"},{message:"Document Type is Required",key:"docType"},{message:"Document No. is Required of 16 Digits",key:"docNo"},{message:"Document Date is Required",key:"docDate"},{message:"From GSTIN is Required of 15 Digits",key:"fromGstin"},{message:"From Pin Code is Required",key:"fromPincode"},{message:"Act From State Code is Required",key:"actFromStateCode"},{message:"From State Code is Required",key:"fromStateCode"},{message:"To GSTIN is Required of 15 Digits",key:"toGstin"},{message:"To Pin Code is Required",key:"toPincode"},{message:"To State Code is Required",key:"toStateCode"},{message:"Act To State Code is Required",key:"actToStateCode"},{message:"Transaction Type is Required of 4 Digits",key:"transactionType"},{message:"Tot Inv Value is Required",key:"totInvValue"},{message:"Trans Distance is Required",key:"transDistance"}],F=[{message:"Bill From Location is Required",key:"billFromLocation"},{message:"Customer Category is Required",key:"salesCategory"},{message:"Customer Name is Required",key:"customer"},{message:"PO No. is Required",key:"PONumber"},{message:"Net SO Value is Required",key:"PITotalAmount"},{message:"Status is Required",key:"PIStatus"},{message:"Customer Shipping Address is Required",key:"customerShippingAddress"},{message:"Mode Of Transport is Required",key:"modeOfTransport"},{message:"frightTerms is Required",key:"frightTerms"},{message:"transporter is Required",key:"transporter"},{message:"destination is Required",key:"destination"}],N=[{message:"Invoice # is Required",key:"serviceInvoiceNumber"},{message:"Invoice Date is Required",key:"serviceInvoiceDate"},{message:"Customer/Sales Category is Required",key:"customerCategory"},{message:"Customer Name is Required",key:"customer"},{message:"Purchase Order No. is Required",key:"PONo"},{message:"Purchase Order Date is Required",key:"PODate"},{message:"Currency is Required",key:"currency"},{message:"Bill From Location is Required",key:"billFromLocation"}],v=[{message:"Product Category is Required",key:"productCategory"},{message:"HSN Code is Required",key:"HSN"},{message:"Description is Required",key:"description"},{message:"IGST Rate % is Required",key:"igstRate"},{message:"CGST Rate % is Required",key:"cgstRate"},{message:"SGST Rate % is Required",key:"sgstRate"}],Z=[{message:"Order is Required",key:"order"},{message:"Payment Terms Description is Required",key:"paymentDescription"}],I=[{message:"Customer Category is Required",key:"customerCategory"},{message:"Customer Name is Required",key:"customer"},{message:"FC Type is Required",key:"FCType"},{message:"Net FC Value is Required",key:"netFCValue"}],w=[{message:"Quotation No. is Required",key:"quotationNo"},{message:"Customer Category is Required",key:"customerCategory"},{message:"Customer Name  is Required",key:"customerName"}]}}]);