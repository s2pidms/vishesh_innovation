"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9958],{89958:(pe,v,c)=>{c.r(v),c.d(v,{RaiseTicketModule:()=>re});var d=c(96814),g=c(1076),_=c(43818),e=c(65879),b=c(32197),p=c(98977),Z=c(88059),u=c(37285);function y(s,a){if(1&s){const o=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",18,19)(7,"span",20),e._uU(8),e.qZA()(),e.TgZ(9,"td",18,21)(11,"span",20),e._uU(12),e.qZA()(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td")(16,"div",22),e._UZ(17,"button",23),e.TgZ(18,"div",24)(19,"a",25),e.NdJ("click",function(){const n=e.CHM(o).$implicit,r=e.oxw();return e.KtG(r.navigateTo("/default/supports/master/raise-ticket/raise-ticket-form",n,"view"))}),e._UZ(20,"i",26),e._uU(21," View "),e.qZA(),e.TgZ(22,"a",25),e.NdJ("click",function(){const n=e.CHM(o).$implicit,r=e.oxw();return e.KtG(r.navigateTo("/default/supports/master/raise-ticket/raise-ticket-form",n,"edit"))}),e._UZ(23,"i",27),e._uU(24," Edit "),e.qZA()()()()()}if(2&s){const o=a.$implicit,i=e.MAs(6),t=e.MAs(10);e.xp6(2),e.Oqu(o.issueNumber),e.xp6(2),e.Oqu(o.issueDate),e.xp6(1),e.Udp("width",i.clientWidth),e.xp6(2),e.Q6J("ngbTooltip",o.issueDescription)("positionTarget",i),e.xp6(1),e.hij(" ",o.issueDescription," "),e.xp6(1),e.Udp("width",t.clientWidth),e.xp6(2),e.Q6J("ngbTooltip",o.issueResolution)("positionTarget",t),e.xp6(1),e.hij(" ",o.issueResolution," "),e.xp6(2),e.Oqu(o.issueStatus),e.xp6(8),e.ekj("disable","Closed"==(null==o?null:o.issueStatus))}}const C=function(s,a,o,i){return{page:s,pageSize:a,collection:o,search:i}};let A=(()=>{var s;class a{constructor(i,t,n,r,h){this.supportService=i,this.router=t,this.spinner=n,this.menuTitleService=r,this.exportExcelService=h,this.page=1,this.pageSize=8,this.collection=0,this.column="issueNumber",this.direction=-1,this.search="",this.tableData=[]}ngOnInit(){this.getAll(),this.menuTitleService.set({title:"Raise a Ticket",subTitle:null,type:null})}navigateTo(i,t,n){if("Closed"==t?.issueStatus&&"edit"==n)return null;this.router.navigate([i],{queryParams:{id:t?._id,action:n}})}eventHeader(i){switch(i.key){case"SEARCH":this.search=i.value,this.getAll();break;case"EXCEL":this.getAll(!0);break;case"PAGE":this.page=i.value,this.getAll()}}getAll(i=!1){this.spinner.show();let t={dummy:"1",page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:i};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.supportService.getAll(t).subscribe(n=>{i?this.excelDownload(n.rows):(this.tableData=n.rows,this.collection=n.count,this.spinner.hide())})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}trackByFn(i,t){return t?._id}excelDownload(i){let t={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}},n={title:"Raise a Ticket",csvData:i,headers:[{header:"Ticket#",key:"issueNumber",...t},{header:"Ticket Date",key:"issueDate",...t},{header:"Title",key:"issueTitle",...t},{header:"Sub Module Name",key:"subModuleName",...t},{header:"Ticket Type",key:"ticketType",...t},{header:"Priority",key:"priority",...t},{header:"Severity",key:"severity",...t},{header:"Description",key:"issueDescription",...t},{header:"Resolution",key:"issueResolution",...t},{header:"Status",key:"issueStatus",...t}]};this.exportExcelService.exportExcel(n)}onSort({column:i,direction:t}){this.headers.forEach(n=>{n.sortable!==i&&(n.direction="")}),this.column=i,this.direction="asc"==t?1:-1,this.getAll()}}return(s=a).\u0275fac=function(i){return new(i||s)(e.Y36(b.a),e.Y36(g.F0),e.Y36(p.V),e.Y36(p.Uh),e.Y36(p.Ol))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-raise-ticket-list"]],viewQuery:function(i,t){if(1&i&&e.Gf(_.j,5),2&i){let n;e.iGM(n=e.CRH())&&(t.headers=n)}},decls:28,vars:8,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],[1,"text-center"],["type","button",1,"btn","btn-primary","btn-add",3,"click"],["aria-hidden","true",1,"fa","fa-plus-square","fa-lg","me-2"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","issueNumber",3,"sort"],["sortable","createdAt",3,"sort"],["sortable","issueDescription",1,"text-start",3,"sort"],["sortable","issueResolution",1,"text-start",3,"sort"],["sortable","issueStatus",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["issueDescription",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["issueResolution",""],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["href","javascript:void(0)",3,"click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"Ticket Summary"),e.qZA()(),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return t.navigateTo("/default/supports/master/raise-ticket/raise-ticket-form",null,"create")}),e._UZ(6,"i",5),e._uU(7," Generate Ticket "),e.qZA()(),e._UZ(8,"hr",6),e.TgZ(9,"div",7)(10,"app-setting-header",8),e.NdJ("dataChange",function(r){return t.eventHeader(r)}),e.qZA(),e.TgZ(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th",12),e.NdJ("sort",function(r){return t.onSort(r)}),e._uU(15,"Ticket#"),e.qZA(),e.TgZ(16,"th",13),e.NdJ("sort",function(r){return t.onSort(r)}),e._uU(17,"Ticket Date"),e.qZA(),e.TgZ(18,"th",14),e.NdJ("sort",function(r){return t.onSort(r)}),e._uU(19,"Description"),e.qZA(),e.TgZ(20,"th",15),e.NdJ("sort",function(r){return t.onSort(r)}),e._uU(21,"Resolution"),e.qZA(),e.TgZ(22,"th",16),e.NdJ("sort",function(r){return t.onSort(r)}),e._uU(23,"Status"),e.qZA(),e.TgZ(24,"th"),e._uU(25,"Action"),e.qZA()()(),e.TgZ(26,"tbody"),e.YNc(27,y,25,15,"tr",17),e.qZA()()()()),2&i&&(e.xp6(10),e.Q6J("data",e.l5B(3,C,t.page,t.pageSize,t.collection,t.search)),e.xp6(17),e.Q6J("ngForOf",t.tableData)("ngForTrackBy",t.trackByFn))},dependencies:[d.sg,Z.P,u._L,_.j],encapsulation:2}),a})();var l=c(60095),D=c(21631),R=c(22096),w=c(25116),x=c(95346),S=c(69205);function U(s,a){if(1&s&&(e.TgZ(0,"span",21),e._uU(1),e.ALo(2,"truncate"),e.qZA()),2&s){const o=e.oxw().$implicit;e.Q6J("ngbTooltip",o.issueDescription),e.xp6(1),e.hij(" ",o.issueDescription?e.xi3(2,2,o.issueDescription,40):"-"," ")}}function M(s,a){if(1&s&&(e.TgZ(0,"span",21),e._uU(1),e.ALo(2,"truncate"),e.qZA()),2&s){const o=e.oxw().$implicit;e.Q6J("ngbTooltip",o.issueResolution),e.xp6(1),e.hij(" ",o.issueResolution?e.xi3(2,2,o.issueResolution,40):"-"," ")}}function N(s,a){if(1&s&&(e.TgZ(0,"a",22),e._UZ(1,"i",23),e.qZA()),2&s){const o=e.oxw().$implicit;e.Q6J("href",o.url,e.LSH)}}const k=function(){return["Open","Reopened"]};function q(s,a){if(1&s&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td",18),e.YNc(9,U,3,5,"span",19),e.YNc(10,M,3,5,"span",19),e.qZA(),e.TgZ(11,"td"),e.YNc(12,N,2,1,"a",20),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA()()),2&s){const o=a.$implicit;e.xp6(2),e.Oqu(e.xi3(3,7,o.issueDate,"dd-MM-YYYY")),e.xp6(3),e.Oqu(o.action),e.xp6(2),e.Oqu(o.issueStatus),e.xp6(2),e.Q6J("ngIf",e.DdM(10,k).includes(o.issueStatus)),e.xp6(1),e.Q6J("ngIf",!e.DdM(11,k).includes(o.issueStatus)),e.xp6(2),e.Q6J("ngIf",o.url),e.xp6(2),e.Oqu(o.raisedBy)}}const J=function(s,a,o,i){return{page:s,pageSize:a,collection:o,search:i,excelDisplay:"none"}};let F=(()=>{var s;class a{constructor(i){this.activeModal=i,this.page=1,this.pageSize=8,this.collection=0,this.column="issueNumber",this.direction=-1,this.search="",this.historyData=[]}ngOnInit(){this.collection=this.historyData.length}onSort({column:i,direction:t}){this.headers.forEach(n=>{n.sortable!==i&&(n.direction="")}),this.historyData=""===t||""===i?this.historyData:[...this.historyData].sort((n,r)=>{let h="string"==typeof n[i]?n[i].toLowerCase():n[i],f="string"==typeof r[i]?r[i].toLowerCase():r[i];const T=h<f?-1:h>f?1:0;return"asc"===t?T:-T})}eventHeader(i){switch(i.key){case"SEARCH":this.search=i.value;break;case"EXCEL":default:break;case"PAGE":this.page=i.value}}trackByFn(i,t){return t?._id}}return(s=a).\u0275fac=function(i){return new(i||s)(e.Y36(u.Kz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-view-ticket-history"]],viewQuery:function(i,t){if(1&i&&e.Gf(_.j,5),2&i){let n;e.iGM(n=e.CRH())&&(t.headers=n)}},inputs:{historyData:"historyData"},decls:30,vars:15,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"row","px-5"],[1,"table-responsive",2,"min-height","38rem"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","issueDate",3,"sort"],["sortable","action",3,"sort"],["sortable","issueStatus",3,"sort"],["sortable","issueDescription",1,"text-start",3,"sort"],["sortable","url",3,"sort"],["sortable","raisedBy",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["class","pointer","placement","right",3,"ngbTooltip",4,"ngIf"],["target","_blank",3,"href",4,"ngIf"],["placement","right",1,"pointer",3,"ngbTooltip"],["target","_blank",3,"href"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Review History"),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return t.activeModal.close()}),e._UZ(6,"i",4),e.qZA()()()(),e.TgZ(7,"div",0)(8,"div",5)(9,"div",6)(10,"app-setting-header",7),e.NdJ("dataChange",function(r){return t.eventHeader(r)}),e.qZA(),e.TgZ(11,"table",8)(12,"thead",9)(13,"tr",10)(14,"th",11),e.NdJ("sort",function(r){return t.onSort(r)}),e._uU(15,"Date"),e.qZA(),e.TgZ(16,"th",12),e.NdJ("sort",function(r){return t.onSort(r)}),e._uU(17,"Action"),e.qZA(),e.TgZ(18,"th",13),e.NdJ("sort",function(r){return t.onSort(r)}),e._uU(19,"Status"),e.qZA(),e.TgZ(20,"th",14),e.NdJ("sort",function(r){return t.onSort(r)}),e._uU(21," Description/Resolution "),e.qZA(),e.TgZ(22,"th",15),e.NdJ("sort",function(r){return t.onSort(r)}),e._uU(23,"Attachment"),e.qZA(),e.TgZ(24,"th",16),e.NdJ("sort",function(r){return t.onSort(r)}),e._uU(25,"User"),e.qZA()()(),e.TgZ(26,"tbody"),e.YNc(27,q,15,12,"tr",17),e.ALo(28,"slice"),e.ALo(29,"searchFi1ter"),e.qZA()()()()()),2&i&&(e.xp6(10),e.Q6J("data",e.l5B(10,J,t.page,t.pageSize,t.collection,t.search)),e.xp6(17),e.Q6J("ngForOf",e.Dn7(28,3,e.xi3(29,7,t.historyData,t.search),(t.page-1)*t.pageSize,(t.page-1)*t.pageSize+t.pageSize))("ngForTrackBy",t.trackByFn))},dependencies:[d.sg,d.O5,Z.P,u._L,_.j,d.OU,d.uU,x.G,S.W],encapsulation:2}),a})(),Y=(()=>{var s;class a{constructor(i,t){this.activeModal=i,this.toastService=t,this.action="",this.issueDescription={},this.saveData=new e.vpe,this.btnDisable=!1,this.page=1,this.pageSize=4,this.collection=0,this.search="",this.column="createdAt",this.direction=-1}ngOnInit(){}eventHeader(i){switch(i.key){case"SEARCH":this.search=i.value;break;case"EXCEL":default:break;case"PAGE":this.page=i.value}}reset(){this.issueDescription=this.issueDescription}dismissModel(){this.saveData.emit({data:this.issueDescription,key:"issueDescription"}),this.toastService.success("Remarks Saved")}}return(s=a).\u0275fac=function(i){return new(i||s)(e.Y36(u.Kz),e.Y36(p.kl))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-ticket-description-modal"]],inputs:{action:"action",issueDescription:"issueDescription"},outputs:{saveData:"saveData"},decls:15,vars:1,consts:[[1,"modelPage"],[1,""],[1,"container-fluid"],[1,"row",2,"min-height","28.5rem"],[1,"row","px-5","mt-4","mb-5","form-page"],[1,"col-2"],[1,"col-8","card-form"],[1,"row"],[1,"col-12","px-0"],[1,"form-header","mb-1"],[1,"col","ps-3","heading"],[1,"col","pt-2","px-3"],["rows","11","readonly","",1,"form-control","form-text-area",3,"ngModel","ngModelChange"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"div",5),e.TgZ(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10),e._uU(11,"Ticket Description"),e.qZA()(),e.TgZ(12,"div",11)(13,"textarea",12),e.NdJ("ngModelChange",function(r){return t.issueDescription=r}),e.qZA()()()()(),e._UZ(14,"div",5),e.qZA()()()()()),2&i&&(e.xp6(13),e.Q6J("ngModel",t.issueDescription))},dependencies:[l.Fj,l.JJ,l.On],encapsulation:2}),a})(),O=(()=>{var s;class a{constructor(i,t){this.activeModal=i,this.toastService=t,this.action="",this.issueResolution={},this.saveData=new e.vpe,this.btnDisable=!1,this.page=1,this.pageSize=4,this.collection=0,this.search="",this.column="createdAt",this.direction=-1}ngOnInit(){}eventHeader(i){switch(i.key){case"SEARCH":this.search=i.value;break;case"EXCEL":default:break;case"PAGE":this.page=i.value}}reset(){this.issueResolution=this.issueResolution}dismissModel(){this.saveData.emit({data:this.issueResolution,key:"issueResolution"}),this.toastService.success("Remarks Saved")}}return(s=a).\u0275fac=function(i){return new(i||s)(e.Y36(u.Kz),e.Y36(p.kl))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-ticket-resolution-modal"]],inputs:{action:"action",issueResolution:"issueResolution"},outputs:{saveData:"saveData"},decls:15,vars:1,consts:[[1,"modelPage"],[1,""],[1,"container-fluid"],[1,"row",2,"min-height","28.5rem"],[1,"row","px-5","mt-4","mb-5","form-page"],[1,"col-2"],[1,"col-8","card-form"],[1,"row"],[1,"col-12","px-0"],[1,"form-header","mb-1"],[1,"col","ps-3","heading"],[1,"col","pt-2","px-3"],["rows","11","readonly","",1,"form-control","form-text-area",3,"ngModel","ngModelChange"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"div",5),e.TgZ(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10),e._uU(11,"Ticket Resolution"),e.qZA()(),e.TgZ(12,"div",11)(13,"textarea",12),e.NdJ("ngModelChange",function(r){return t.issueResolution=r}),e.qZA()()()()(),e._UZ(14,"div",5),e.qZA()()()()()),2&i&&(e.xp6(13),e.Q6J("ngModel",t.issueResolution))},dependencies:[l.Fj,l.JJ,l.On],encapsulation:2}),a})();function I(s,a){if(1&s){const o=e.EpF();e.TgZ(0,"app-ticket-description-modal",15),e.NdJ("saveData",function(t){e.CHM(o);const n=e.oxw();return e.KtG(n.saveData(t))}),e.qZA()}if(2&s){const o=e.oxw();e.Q6J("issueDescription",o.issueDescription)("action",o.action)}}function Q(s,a){if(1&s){const o=e.EpF();e.TgZ(0,"app-ticket-resolution-modal",16),e.NdJ("saveData",function(t){e.CHM(o);const n=e.oxw();return e.KtG(n.saveData(t))}),e.qZA()}if(2&s){const o=e.oxw();e.Q6J("issueResolution",o.issueResolution)("action",o.action)}}let V=(()=>{var s;class a{constructor(i){this.activeModal=i,this.action="edit",this.issueDescription={},this.issueResolution={},this.storage={},this.bomDimData={},this.isPreview=!1,this.resetData=[],this.ESCPreviewArr=[],this.btnDisable=!1,this.page=1,this.pageSize=8,this.collection=0,this.search="",this.column="createdAt",this.direction=-1,this.isESCPreview=!1,this.attributes="dimensions",this.active=1}ngOnInit(){}saveData(i){"issueDescription"==i.key&&(this.issueDescription=i.data),"issueResolution"==i.key&&(this.issueResolution=i.data)}dismissModel(){let i={};i.issueDescription=this.issueDescription,i.issueResolution=this.issueResolution,this.activeModal.close(i)}}return(s=a).\u0275fac=function(i){return new(i||s)(e.Y36(u.Kz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-view-resolution-comments"]],viewQuery:function(i,t){if(1&i&&e.Gf(_.j,5),2&i){let n;e.iGM(n=e.CRH())&&(t.headers=n)}},inputs:{action:"action",issueDescription:"issueDescription",issueResolution:"issueResolution",storage:"storage",bomDimData:"bomDimData"},decls:22,vars:4,consts:[[1,"modelPage",2,"min-height","53.7rem"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid","mt-5","mb-3"],[1,"row"],[1,"col-12","px-0"],["ngbNav","",1,"nav-pills","tabs-card","row","justify-content-start","ms-5","align-items-end",3,"activeId","activeIdChange"],["nav","ngbNav"],[1,"col-auto","px-0","d-grid","btn-border-radius",3,"ngbNavItem"],["ngbNavLink","",1,"mb-0","ps-4","pe-5","pt-1"],["ngbNavContent",""],[1,"line-border","mt-0"],[1,"mt-2",3,"ngbNavOutlet"],[3,"issueDescription","action","saveData"],[3,"issueResolution","action","saveData"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"View Resolution Comments"),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return t.dismissModel()}),e._UZ(6,"i",4),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"ul",8,9),e.NdJ("activeIdChange",function(r){return t.active=r}),e.TgZ(12,"li",10)(13,"a",11),e._uU(14,"Ticket Description "),e.qZA(),e.YNc(15,I,1,2,"ng-template",12),e.qZA(),e.TgZ(16,"li",10)(17,"a",11),e._uU(18,"Ticket Resolution "),e.qZA(),e.YNc(19,Q,1,2,"ng-template",12),e.qZA()(),e._UZ(20,"hr",13)(21,"div",14),e.qZA()()()()),2&i){const n=e.MAs(11);e.xp6(10),e.Q6J("activeId",t.active),e.xp6(2),e.Q6J("ngbNavItem",1),e.xp6(4),e.Q6J("ngbNavItem",2),e.xp6(5),e.Q6J("ngbNavOutlet",n)}},dependencies:[u.uN,u.Pz,u.nv,u.Is,u.Vx,u.tO,u.Dy,Y,O],styles:[".tabs-card[_ngcontent-%COMP%]{box-shadow:none;display:flex;justify-content:center;text-align:center;background-color:transparent}.tabs-card[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{display:grid!important}.tabs-card[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{flex:1 0;font-weight:500;font-size:1.4rem;border-radius:2px;margin-bottom:1rem;color:var(--bs-white)!important;background-color:#fd99d5!important;border:1px solid var(--bs-white)}.tabs-card[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{color:var(--bs-white)!important;background-color:var(--bs-primary)!important;border:1px solid var(--bs-white)}.tabs-card[_ngcontent-%COMP%]   .btn-border-radius[_ngcontent-%COMP%]{clip-path:polygon(0 0,85% 0,100% 100%,0% 100%)!important;width:16rem!important;height:2.6rem!important}"]}),a})();var H=c(25866),L=c(50363);function E(s,a){1&s&&e.GkF(0)}function P(s,a){if(1&s&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&s){const o=a.$implicit;e.Q6J("value",o.title),e.xp6(1),e.hij(" ",o.title," ")}}function j(s,a){if(1&s&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&s){const o=a.$implicit;e.Q6J("value",o.value),e.xp6(1),e.hij(" ",o.label," ")}}function z(s,a){if(1&s&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&s){const o=a.$implicit;e.Q6J("value",o.value),e.xp6(1),e.hij(" ",o.label," ")}}function G(s,a){if(1&s&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&s){const o=a.$implicit;e.Q6J("value",o.value),e.xp6(1),e.hij(" ",o.label," ")}}function B(s,a){1&s&&(e.TgZ(0,"div",34)(1,"label",9),e._uU(2,"Ticket Resolution"),e._UZ(3,"span",10),e.qZA(),e._UZ(4,"textarea",35),e.qZA())}function K(s,a){1&s&&(e.TgZ(0,"div",29)(1,"label",9),e._uU(2,"Raised By"),e._UZ(3,"span",10),e.qZA(),e._UZ(4,"input",36),e.qZA())}function $(s,a){if(1&s&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&s){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.hij(" ",o," ")}}function X(s,a){if(1&s){const o=e.EpF();e.ynx(0),e.TgZ(1,"label",9),e._uU(2," Status"),e.TgZ(3,"span",10),e._uU(4,"*"),e.qZA()(),e.TgZ(5,"select",37),e.NdJ("change",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.setFormField())}),e.TgZ(6,"option",38),e._uU(7,"Select Module Name"),e.qZA(),e.YNc(8,$,2,2,"option",18),e.qZA(),e.BQk()}if(2&s){const o=e.oxw();e.xp6(8),e.Q6J("ngForOf",o.issueStatus)}}function W(s,a){1&s&&(e.ynx(0),e.TgZ(1,"label",9),e._uU(2," Closed on"),e.TgZ(3,"span",10),e._uU(4,"*"),e.qZA()(),e._UZ(5,"input",39),e.BQk())}function ee(s,a){1&s&&(e.TgZ(0,"div",29)(1,"label",9),e._uU(2,"Raised By"),e._UZ(3,"span",10),e.qZA(),e._UZ(4,"input",36),e.qZA())}function te(s,a){if(1&s){const o=e.EpF();e.ynx(0),e.TgZ(1,"button",40),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.openRevisionReview())}),e._uU(2,"History"),e.qZA(),e.TgZ(3,"button",41),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.openViewResolutionComments())}),e._uU(4," View Resolution Comments "),e.qZA(),e.BQk()}}function ie(s,a){if(1&s){const o=e.EpF();e.TgZ(0,"div",42)(1,"div",43)(2,"button",44),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.reset())}),e._uU(3,"Reset"),e.qZA()(),e.TgZ(4,"div",45)(5,"button",46),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.submit())}),e._uU(6,"Save"),e.qZA()()()}}const m=function(){return["edit","view"]},se=function(){return["view"]};let oe=(()=>{var s;class a{get f(){return this.form.controls}constructor(i,t,n,r,h,f,T,le,ce,ue){this.supportService=i,this.router=t,this.activatedRoute=n,this.spinner=r,this.menuTitleService=h,this.toastService=f,this.utilityService=T,this.appGlobalService=le,this.storageService=ce,this.modalService=ue,this.submitted=!1,this.action="create",this.issueAttachmentFile=null,this.subModuleNames=[],this.priority=[],this.severity=[],this.ticketType=[],this.moduleList=[],this.menuItems=[],this.issueStatus=w._1,this.subModuleList=[],this.historyData=[],this.userName="",this.form=new l.nJ({_id:new l.p4(null),issueNumber:new l.p4(null),issueTitle:new l.p4(null),subModuleName:new l.p4(null),menuItemId:new l.p4(null),issueDescription:new l.p4(null),issueResolution:new l.p4(null),issueAttachment:new l.p4(null),issueDate:new l.p4(this.utilityService.getTodayDate("YYYY-MM-DD")),ticketType:new l.p4(null),priority:new l.p4(null),severity:new l.p4(null),issueStatus:new l.p4(null),url:new l.p4(null),raisedBy:new l.p4(null),closedOn:new l.p4(null)})}ngOnInit(){this.getInitialData(),this.appGlobalService.getData(["menuItems"]).subscribe(i=>{this.menuItems=i.menuItems}),this.userName=this.storageService.get("IDMSAUser")?.name,this.f.raisedBy.setValue(this.userName)}reset(){this.getInitialData(),this.form.reset()}submit(){if(this.submitted=!0,this.form.enable(),this.form.invalid)return void this.toastService.warning("Please fill all required field !");let i=this.form.value,t=new FormData;t.append("key","issueAttachment");for(let n=0;n<Object.keys(i).length;n++){const r=Object.keys(i)[n];i[r]&&t.append(r,i[r])}this.issueAttachmentFile&&t.append("issueAttachment",this.issueAttachmentFile,this.issueAttachmentFile.name),i._id?this.update(i._id,t):(delete i._id,this.create(t))}create(i){this.spinner.show(),this.supportService.create(i).subscribe(t=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(t.message),this.router.navigate(["/default/supports/master/raise-ticket/raise-ticket-list"])})}update(i,t){this.spinner.show(),this.supportService.update(i,t).subscribe(n=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(n.message),this.router.navigate(["/default/supports/master/raise-ticket/raise-ticket-list"])})}getInitialData(){this.spinner.show(),this.supportService.getAllMasterData({}).subscribe(i=>{this.form.controls.issueNumber.setValue(i.autoIncrementNo),this.priority=i.priority,this.severity=i.severity,this.ticketType=i.ticketType,this.moduleList=i.moduleList,this.activatedRoute.queryParams.pipe((0,D.z)(t=>(this.action=t.action,t.id?this.supportService.getById(t.id):(0,R.of)({})))).subscribe(t=>{0!=Object.keys(t).length&&(t.issueDate&&(t.issueDate=t.issueDate.split("T")[0]),t.oldHistory&&t.oldHistory.length&&(this.historyData=t.oldHistory),t.menuItemId&&this.supportService.getAllSubModuleListByMenuId(t.menuItemId).subscribe(n=>{this.subModuleNames=n}),this.form.patchValue(t),"Open"!=t.issueStatus&&(this.form.disable(),this.form.controls.issueStatus.enable(),this.form.controls.issueResolution.enable(),this.form.controls.issueDescription.enable()),"Closed"==t.issueStatus?t.closedOn&&this.form.controls.closedOn.setValue(this.utilityService.getFormatDate(t.closedOn,"YYYY-MM-DD")):this.setFormField(),"view"==this.action&&this.form.disable())}),this.menuTitleService.set({title:"Ticket",subTitle:null,type:null})}),this.spinner.hide()}setFormField(){let t=this.form.controls.closedOn.value;"Closed"==this.form.controls.issueStatus.value?(this.form.controls.closedOn.enable(),(!t||"undefined"==t)&&this.form.controls.closedOn.setValue(this.utilityService.getTodayDate("YYYY-MM-DD"))):(t||!t||"undefined"==t)&&(this.form.controls.closedOn.setValue(null),this.form.controls.closedOn.disable())}setModule(i){this.supportService.getAllSubModuleListByMenuId(i._id).subscribe(t=>{this.subModuleNames=t,this.form.controls.menuItemId.setValue(i._id)})}openRevisionReview(){this.historyData.length>0&&(this.modalService.open(F,{centered:!0,size:"xl",backdrop:"static",keyboard:!1}).componentInstance.historyData=this.historyData)}openViewResolutionComments(){const i=this.modalService.open(V,{centered:!0,size:"xl",backdrop:"static",keyboard:!1});i.componentInstance.action=this.action,i.componentInstance.issueDescription=this.form.controls.issueDescription.value,i.componentInstance.issueResolution=this.form.controls.issueResolution.value,i.result.then(t=>{t&&["create","edit"].includes(this.action)&&(this.form.controls.issueDescription.setValue(t.issueDescription),this.form.controls.issueResolution.setValue(t.issueResolution))},t=>{})}}return(s=a).\u0275fac=function(i){return new(i||s)(e.Y36(b.a),e.Y36(g.F0),e.Y36(g.gz),e.Y36(p.V),e.Y36(p.Uh),e.Y36(p.kl),e.Y36(p.tI),e.Y36(p.P0),e.Y36(p.V1),e.Y36(u.FF))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-raise-ticket-form"]],decls:89,vars:39,consts:[[1,"formCard","card",3,"formGroup"],[1,"container"],[1,"row","form-header"],[1,"col","heading"],[1,"form-body"],[1,"row","mb-4"],[1,"col-md-4"],[1,"row"],[1,"col-6"],[1,"form-label"],[1,"text-danger"],["formControlName","issueNumber","type","text","readonly","",1,"form-control"],["formControlName","issueDate","readonly","","type","date",1,"form-control"],[4,"ngIf"],[3,"ngClass"],["bindLabel","title","bindValue","title","formControlName","issueTitle",3,"items","clearable","change"],["formControlName","subModuleName",1,"form-select"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["formControlName","ticketType",1,"form-select"],["selected","","disabled","",3,"value"],["formControlName","priority",1,"form-select"],["formControlName","severity",1,"form-select"],["formControlName","issueDescription","rows","3",1,"form-control","form-text-area"],["class","col-md-6 mb-4",4,"ngIf"],[1,"col-md-6","px-0"],[3,"fileName","url","label","file","fileChange"],[1,"col-md-6"],["class","col-4",4,"ngIf"],[1,"col-4"],[1,"row","line-border"],[1,"row","mb-0"],["class","d-flex justify-content-end mb-3",4,"ngIf"],[3,"value"],[1,"col-md-6","mb-4"],["formControlName","issueResolution","rows","3",1,"form-control","form-text-area"],["formControlName","raisedBy","type","text","readonly","",1,"form-control"],["formControlName","issueStatus",1,"form-select",3,"change"],["value","","disabled",""],["formControlName","closedOn","type","date",1,"form-control"],[1,"btn","btn-primary","px-4","me-4","mb-3",3,"click"],[1,"btn","btn-primary","px-4","mb-3",3,"click"],[1,"d-flex","justify-content-end","mb-3"],[1,"d-grid","col-md-2","me-5"],["type","button",1,"btn","btn-primary",3,"click"],[1,"d-grid","col-md-2"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(i,t){1&i&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label"),e._uU(5),e.ALo(6,"titlecase"),e.qZA()()(),e.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"label",9),e._uU(13,"Ticket#"),e.TgZ(14,"span",10),e._uU(15,"*"),e.qZA()(),e._UZ(16,"input",11),e.qZA(),e.TgZ(17,"div",8)(18,"label",9),e._uU(19," Date"),e.TgZ(20,"span",10),e._uU(21,"*"),e.qZA()(),e._UZ(22,"input",12),e.qZA()()(),e.YNc(23,E,1,0,"ng-container",13),e.TgZ(24,"div",14)(25,"label",9),e._uU(26,"Module Name"),e.TgZ(27,"span",10),e._uU(28,"*"),e.qZA()(),e.TgZ(29,"ng-select",15),e.NdJ("change",function(r){return t.setModule(r)}),e.qZA()(),e.TgZ(30,"div",14)(31,"label",9),e._uU(32," Sub Module Name"),e.TgZ(33,"span",10),e._uU(34,"*"),e.qZA()(),e.TgZ(35,"select",16)(36,"option",17),e._uU(37,"Select Sub Module Name"),e.qZA(),e.YNc(38,P,2,2,"option",18),e.qZA()()(),e.TgZ(39,"div",5)(40,"div",6)(41,"label",9),e._uU(42," Ticket Type"),e._UZ(43,"span",10),e.qZA(),e.TgZ(44,"select",19)(45,"option",20),e._uU(46,"Select Ticket Type"),e.qZA(),e.YNc(47,j,2,2,"option",18),e.qZA()(),e.TgZ(48,"div",6)(49,"label",9),e._uU(50," Ticket Priority "),e._UZ(51,"span",10),e.qZA(),e.TgZ(52,"select",21)(53,"option",20),e._uU(54,"Select Ticket Priority"),e.qZA(),e.YNc(55,z,2,2,"option",18),e.qZA()(),e.TgZ(56,"div",6)(57,"label",9),e._uU(58," Ticket Severity "),e._UZ(59,"span",10),e.qZA(),e.TgZ(60,"select",22)(61,"option",20),e._uU(62,"Select Ticket Severity"),e.qZA(),e.YNc(63,G,2,2,"option",18),e.qZA()()(),e.TgZ(64,"div",5)(65,"div",14)(66,"label",9),e._uU(67,"Ticket Description"),e.TgZ(68,"span",10),e._uU(69,"*"),e.qZA()(),e._UZ(70,"textarea",23),e.qZA(),e.YNc(71,B,5,0,"div",24),e.qZA(),e.TgZ(72,"div",5)(73,"div",25)(74,"app-file-upload",26),e.NdJ("fileChange",function(r){return t.issueAttachmentFile=r}),e.qZA()(),e.TgZ(75,"div",27)(76,"div",7),e.YNc(77,K,5,0,"div",28),e.TgZ(78,"div",29),e.YNc(79,X,9,1,"ng-container",13),e.qZA(),e.TgZ(80,"div",29),e.YNc(81,W,6,0,"ng-container",13),e.qZA(),e.YNc(82,ee,5,0,"div",28),e.qZA()()()(),e._UZ(83,"hr",30),e.TgZ(84,"div",31)(85,"div",8),e.YNc(86,te,5,0,"ng-container",13),e.qZA(),e.TgZ(87,"div",8),e.YNc(88,ie,7,0,"div",32),e.qZA()()()()),2&i&&(e.Q6J("formGroup",t.form),e.xp6(5),e.hij("Ticket [",e.lcZ(6,27,t.action),"]"),e.xp6(18),e.Q6J("ngIf",e.DdM(29,m).includes(t.action)),e.xp6(1),e.Q6J("ngClass",(e.DdM(30,m).includes(t.action),"col-md-4  ")),e.xp6(5),e.Q6J("items",t.moduleList)("clearable",!1),e.xp6(1),e.Q6J("ngClass",(e.DdM(31,m).includes(t.action),"col-md-4")),e.xp6(6),e.Q6J("value",""),e.xp6(2),e.Q6J("ngForOf",t.subModuleNames),e.xp6(7),e.Q6J("value",""),e.xp6(2),e.Q6J("ngForOf",t.ticketType),e.xp6(6),e.Q6J("value",""),e.xp6(2),e.Q6J("ngForOf",t.priority),e.xp6(6),e.Q6J("value",""),e.xp6(2),e.Q6J("ngForOf",t.severity),e.xp6(2),e.Q6J("ngClass",e.DdM(32,m).includes(t.action)?"col-md-6 mb-3":"col-md-12 mb-3"),e.xp6(6),e.Q6J("ngIf",e.DdM(33,m).includes(t.action)),e.xp6(3),e.Q6J("fileName",t.form.controls.issueAttachment.value)("url",t.form.controls.url.value)("label","Attachment")("file",t.issueAttachmentFile),e.xp6(3),e.Q6J("ngIf",e.DdM(34,m).includes(t.action)),e.xp6(2),e.Q6J("ngIf",e.DdM(35,m).includes(t.action)),e.xp6(2),e.Q6J("ngIf",e.DdM(36,m).includes(t.action)),e.xp6(1),e.Q6J("ngIf","create"===t.action),e.xp6(4),e.Q6J("ngIf",e.DdM(37,m).includes(t.action)),e.xp6(2),e.Q6J("ngIf",!e.DdM(38,se).includes(t.action)))},dependencies:[d.mk,d.sg,d.O5,H.Y,l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,l.sg,l.u,L.w9,d.rS],encapsulation:2}),a})();var ne=c(56208);const ae=[{path:"",redirectTo:"raise-ticket-list",pathMatch:"full"},{path:"raise-ticket-list",component:A},{path:"raise-ticket-form",component:oe}];let re=(()=>{var s;class a{}return(s=a).\u0275fac=function(i){return new(i||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[d.ez,g.Bz.forChild(ae),ne.m]}),a})()}}]);