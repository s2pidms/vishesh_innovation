"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2555],{42555:(I,_,u)=>{u.r(_),u.d(_,{StockIssueToProductionModule:()=>ht});var d=u(96814),m=u(1076),l=u(60095),h=u(43818),Z=u(21631),C=u(22096),A=u(35469),t=u(65879),b=u(99007),p=u(99328),q=u(16897),y=u(88059),P=u(37285),F=u(95346),J=u(69205),S=u(59103);function M(r,a){if(1&r&&(t.TgZ(0,"option",34),t._uU(1),t.qZA()),2&r){const o=a.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ",null==o?null:o.label," ")}}function R(r,a){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&r){const o=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,null==o?null:o.issueQty,"1.2-2")," ")}}const O=function(){return{standalone:!0}};function Q(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"input",40),t.NdJ("input",function(){t.CHM(o);const e=t.oxw().index,i=t.oxw();return t.KtG(i.setIssueQty(e))})("ngModelChange",function(e){t.CHM(o);const i=t.oxw().$implicit;return t.KtG(i.issueQty=e)}),t.qZA()}if(2&r){const o=t.oxw().$implicit;t.Q6J("ngModel",o.issueQty)("ngModelOptions",t.DdM(2,O))}}const D=function(){return["view","approve","reject"]};function L(r,a){if(1&r&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",35)(6,"span",36),t._uU(7),t.ALo(8,"truncate"),t.qZA()(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.ALo(19,"number"),t.ALo(20,"number"),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.ALo(23,"UOMUnitsMaster"),t.qZA(),t.TgZ(24,"td"),t._uU(25),t.ALo(26,"number"),t.qZA(),t.TgZ(27,"td")(28,"div",37),t.YNc(29,R,3,4,"span",38),t.YNc(30,Q,1,3,"input",39),t.qZA()()()),2&r){const o=a.$implicit,n=t.oxw();t.xp6(2),t.Oqu(null==o?null:o.MRNNumber),t.xp6(2),t.Oqu(null==o?null:o.itemCode),t.xp6(2),t.Q6J("ngbTooltip",o.itemName),t.xp6(1),t.hij(" ",t.xi3(8,13,null==o?null:o.itemName,40)," "),t.xp6(3),t.Oqu(null==o?null:o.stage),t.xp6(2),t.Oqu("SFG-Roll"==(null==o?null:o.stage)?"mm x mtr":"mm x mm"),t.xp6(2),t.Oqu(null==o?null:o.width),t.xp6(2),t.Oqu(null==o?null:o.length),t.xp6(2),t.hij(" ","SFG-Sheet"==(null==o?null:o.stage)?t.xi3(19,16,null==o?null:o.sheetQty,"1.2-2"):t.xi3(20,19,null==o?null:o.qty,"1.2-2")," "),t.xp6(4),t.Oqu(t.lcZ(23,22,null==o?null:o.UOM)),t.xp6(3),t.Oqu(t.xi3(26,24,null==o?null:o.PPICIRQty,"0.2-2")),t.xp6(4),t.Q6J("ngIf",t.DdM(27,D).includes(n.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(28,D).includes(n.action))}}function E(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"button",47),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.reset())}),t._uU(1," Reset "),t.qZA()}}function Y(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"button",48),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.ESCPreview())}),t._uU(1," Esc Preview "),t.qZA()}if(2&r){const o=t.oxw(2);t.Q6J("disabled",!o.isESCPreview)}}function G(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"button",47),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.preview())}),t._uU(1," Preview "),t.qZA()}}function j(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.submit())}),t._uU(1," Save "),t.qZA()}if(2&r){const o=t.oxw(2);t.Q6J("disabled",!o.isPreview)}}function H(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.navigateTo())}),t._uU(1," Back "),t.qZA()}}function K(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.submit())}),t._uU(1," Approve "),t.qZA()}}function z(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.submit())}),t._uU(1," Save "),t.qZA()}}const v=function(){return["edit","approve","view"]},B=function(){return["view"]},X=function(){return["approve"]},$=function(){return["edit"]};function V(r,a){if(1&r&&(t.TgZ(0,"div",6)(1,"div",41)(2,"div",42),t.YNc(3,E,2,0,"button",43),t.YNc(4,Y,2,1,"button",44),t.YNc(5,G,2,0,"button",43),t.YNc(6,j,2,1,"button",45),t.YNc(7,H,2,0,"button",46),t.YNc(8,K,2,0,"button",46),t.YNc(9,z,2,0,"button",46),t.qZA()()()),2&r){const o=t.oxw();t.xp6(3),t.Q6J("ngIf",!t.DdM(7,v).includes(o.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(8,v).includes(o.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(9,v).includes(o.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(10,v).includes(o.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(11,B).includes(o.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(12,X).includes(o.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(13,$).includes(o.action))}}function W(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"div",6)(1,"div",51)(2,"div",37)(3,"div",52)(4,"div",53)(5,"label"),t._uU(6,"Remark"),t.qZA()()(),t._UZ(7,"input",54),t.qZA()(),t.TgZ(8,"div",55)(9,"button",50),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.submit())}),t._uU(10,"Reject"),t.qZA()()()}}const tt=function(r,a,o,n){return{page:r,pageSize:a,collection:o,search:n,excelDisplay:"none"}},N=function(){return["reject"]};let et=(()=>{var r;class a{trackByFn(n,e){return e?._id}constructor(n,e,i,s,T,g,f){this.stockIssueToProductionService=n,this.utilityService=e,this.activatedRoute=i,this.spinner=s,this.toastService=T,this.validationService=g,this.location=f,this.page=1,this.pageSize=5,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.stages=[],this.ESCPreviewArr=[],this.filterTableData=[],this.submitted=!1,this.action="create",this.isPreview=!1,this.isESCPreview=!1,this.statusArr={create:"Awaiting Approval",edit:"Awaiting Approval",approve:"Approved",reject:"Rejected"},this.masterData={autoIncrementNo:"",stage:[],SFGList:[]},this.form=new l.nJ({_id:new l.p4(null),stockIssueCode:new l.p4(null),issueDate:new l.p4(this.utilityService.getTodayDate("YYYY-MM-DD"),[l.kI.required]),stage:new l.p4(null,[l.kI.required]),department:new l.p4("Production",[l.kI.required]),jobCardNo:new l.p4(null),stockIssueDetails:new l.p4([]),remarks:new l.p4(null),status:new l.p4("Awaiting Approval")})}ngOnInit(){this.getInitialData()}get f(){return this.form.controls}eventHeader(n){switch(n.key){case"SEARCH":this.search=n.value;break;case"EXCEL":default:break;case"PAGE":this.page=n.value}}submit(){if(this.submitted=!0,this.form.enable(),"reject"==this.action&&!this.form.controls.remarks.value)return void this.toastService.warning("Remark is Required");if(this.validationService.checkErrors(this.form,A.vR))return;let n=this.form.value;n.stockIssueDetails=this.filterTableData,n._id?this.update(n):(delete n._id,this.create(n))}navigateTo(){this.location.back()}create(n){this.spinner.show(),this.stockIssueToProductionService.create(n).subscribe(e=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(e.message),this.location.back()})}update(n){this.spinner.show(),this.stockIssueToProductionService.update(n._id,n).subscribe(e=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(e.message),this.location.back()})}reset(){this.form.reset(),this.filterTableData=[],this.getInitialData(),this.collection=this.filterTableData.length}getInitialData(){this.spinner.show(),this.stockIssueToProductionService.getAllMasterData({}).subscribe(n=>{this.form.controls.stockIssueCode.setValue(n.autoIncrementNo),this.form.controls.department.setValue("Production"),this.form.controls.issueDate.setValue(this.utilityService.getTodayDate("YYYY-MM-DD")),this.form.controls.status.setValue(this.statusArr[this.action]),this.stages=n?.stage,this.tableData=n?.SFGList.map(e=>({MRN:e?.MRN,MRNNumber:e?.MRNNumber,item:e?.item,SFGId:e?._id,itemCode:e?.itemCode,itemName:e?.itemName,stage:e?.stage,width:e?.outputDetails?.width,length:e?.outputDetails?.length,sqmPerRoll:e?.outputDetails?.sqmPerRoll,sheetQty:e?.outputDetails?.sheetQty,qty:e?.outputDetails?.noOfSlits,UOM:e?.UOM,PPICIRQty:e?.outputDetails?.sqmTotal,issueQty:0})),this.activatedRoute.queryParams.pipe((0,Z.z)(e=>(this.action=e.action,this.utilityService.accessDenied(this.action),e.id?this.stockIssueToProductionService.getById(e.id):(0,C.of)({})))).subscribe(e=>{this.spinner.hide(),0!=Object.keys(e).length&&(e.issueDate&&(e.issueDate=this.utilityService.getFormatDate(e.issueDate,"YYYY-MM-DD")),e.status=this.statusArr[this.action],this.filterTableData=e?.stockIssueDetails,this.form.patchValue(e),"create"!=this.action&&(this.form.disable(),this.form.controls.remarks.enable()))})})}setStage(n){this.isESCPreview=!1,this.isPreview=!1,this.filterTableData=this.tableData,this.filterTableData=this.filterTableData.filter(e=>e.stage==n.target.value),this.collection=this.filterTableData.length}preview(){this.search="",this.ESCPreviewArr=this.filterTableData,this.filterTableData=this.filterTableData.filter(n=>n.issueQty>0),this.filterTableData.length&&(this.isPreview=!0,this.isESCPreview=!0),this.collection=this.filterTableData.length}ESCPreview(){this.search="",this.isPreview=!1,this.filterTableData=this.ESCPreviewArr,this.collection=this.filterTableData.length}setIssueQty(n){this.filterTableData[n+=(this.page-1)*this.pageSize].issueQty>+this.filterTableData[n].PPICIRQty.toFixed(2)&&(this.filterTableData[n].issueQty=0,this.toastService.warning("Issue Qty cannot be greater than PPIC-IR Qty. "))}onSort({column:n,direction:e}){this.headers.forEach(i=>{i.sortable!==n&&(i.direction="")}),this.filterTableData=""===e||""===n?this.filterTableData:[...this.filterTableData].sort((i,s)=>{let T="string"==typeof i[n]?i[n].toLowerCase():i[n],g="string"==typeof s[n]?s[n].toLowerCase():s[n];const f=T<g?-1:T>g?1:0;return"asc"===e?f:-f})}}return(r=a).\u0275fac=function(n){return new(n||r)(t.Y36(b.rj),t.Y36(p.tI),t.Y36(m.gz),t.Y36(p.V),t.Y36(p.kl),t.Y36(q.RJ),t.Y36(d.Ye))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-issue-to-production-form"]],viewQuery:function(n,e){if(1&n&&t.Gf(h.j,5),2&n){let i;t.iGM(i=t.CRH())&&(e.headers=i)}},decls:70,vars:24,consts:[[1,"formCard","card",3,"formGroup"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,""],[1,"form-body"],[1,"row"],[1,"col-md-3"],[1,"form-label","mb-0"],[1,"text-danger"],["type","date","formControlName","issueDate","readonly","",1,"form-control"],["formControlName","stage",1,"form-select",3,"change"],["value","null","selected","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","department","readonly","",1,"form-control"],["type","text","formControlName","jobCardNo",1,"form-control"],[1,"row","line-border"],[3,"data","dataChange"],[1,"table-responsive","mt-0","text-wrap",2,"min-height","21rem"],[1,"table","table-bordered","mt-0","table-sm"],[1,"bg-info"],[1,"text-white"],["sortable","MRNNumber",3,"sort"],["sortable","itemCode",3,"sort"],["sortable","itemName",1,"text-start",3,"sort"],["sortable","stage",3,"sort"],["sortable","unitConversion",3,"sort"],["sortable","width",3,"sort"],["sortable","length",3,"sort"],["sortable","UOM",3,"sort"],["sortable","PPICIRQty",3,"sort"],["sortable","issueQty",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","row",4,"ngIf"],[3,"value"],[1,"text-start"],["placement","right",1,"pointer",3,"ngbTooltip"],[1,"d-flex","justify-content-center"],[4,"ngIf"],["type","number","class","form-control form-control-xs w-25",3,"ngModel","ngModelOptions","input","ngModelChange",4,"ngIf"],["type","number",1,"form-control","form-control-xs","w-25",3,"ngModel","ngModelOptions","input","ngModelChange"],[1,"col","text-center"],[1,"d-grid","gap-2","d-md-block"],["type","button","class","btn btn-primary px-5 me-3",3,"click",4,"ngIf"],["type","button","class","btn btn-primary px-3 me-3",3,"disabled","click",4,"ngIf"],["class","btn btn-primary px-5","type","button",3,"disabled","click",4,"ngIf"],["class","btn btn-primary px-5","type","button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary","px-5","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-3","me-3",3,"disabled","click"],["type","button",1,"btn","btn-primary","px-5",3,"disabled","click"],["type","button",1,"btn","btn-primary","px-5",3,"click"],[1,"col-5","px-5"],[1,"col-form-label","text-nowrap","pt-0"],[1,"btn","btn-primary","py-1"],["type","text","formControlName","remarks",1,"form-control"],[1,"col-2","text-center","ms-0"]],template:function(n,e){1&n&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5),t.ALo(6,"titlecase"),t.qZA()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"label",8),t._uU(11," Issue Date"),t.TgZ(12,"span",9),t._uU(13,"*"),t.qZA()(),t._UZ(14,"input",10),t.qZA(),t.TgZ(15,"div",7)(16,"label",8),t._uU(17," Stage/Category "),t.TgZ(18,"span",9),t._uU(19,"*"),t.qZA()(),t.TgZ(20,"select",11),t.NdJ("change",function(s){return e.setStage(s)}),t.TgZ(21,"option",12),t._uU(22,"Select Category"),t.qZA(),t.YNc(23,M,2,2,"option",13),t.qZA()(),t.TgZ(24,"div",7)(25,"label",8),t._uU(26," Department"),t.TgZ(27,"span",9),t._uU(28,"*"),t.qZA()(),t._UZ(29,"input",14),t.qZA(),t.TgZ(30,"div",7)(31,"label",8),t._uU(32," Job Card No. (Optional)"),t._UZ(33,"span",9),t.qZA(),t._UZ(34,"input",15),t.qZA()()(),t._UZ(35,"hr",16),t.TgZ(36,"app-setting-header",17),t.NdJ("dataChange",function(s){return e.eventHeader(s)}),t.qZA(),t.TgZ(37,"div",18)(38,"table",19)(39,"thead",20)(40,"tr",21)(41,"th",22),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(42,"MRN No."),t.qZA(),t.TgZ(43,"th",23),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(44,"Item Code"),t.qZA(),t.TgZ(45,"th",24),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(46,"Item Name"),t.qZA(),t.TgZ(47,"th",25),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(48,"Stage"),t.qZA(),t.TgZ(49,"th",26),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(50,"W X L"),t.qZA(),t.TgZ(51,"th",27),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(52,"Width"),t.qZA(),t.TgZ(53,"th",28),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(54,"Length"),t.qZA(),t.TgZ(55,"th",25),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(56,"Qty (C)"),t.qZA(),t.TgZ(57,"th",29),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(58,"UoM"),t.qZA(),t.TgZ(59,"th",30),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(60,"PPIC-IR Qty."),t.qZA(),t.TgZ(61,"th",31),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(62,"Issue Qty."),t.qZA()()(),t.TgZ(63,"tbody"),t.YNc(64,L,31,29,"tr",32),t.ALo(65,"slice"),t.ALo(66,"searchFi1ter"),t.qZA()()(),t._UZ(67,"hr",16),t.YNc(68,V,10,14,"div",33),t.YNc(69,W,11,0,"div",33),t.qZA()()),2&n&&(t.Q6J("formGroup",e.form),t.xp6(5),t.hij("Stock Issue to Production (",t.lcZ(6,8,e.action),")"),t.xp6(18),t.Q6J("ngForOf",e.stages),t.xp6(13),t.Q6J("data",t.l5B(17,tt,e.page,e.pageSize,e.collection,e.search)),t.xp6(28),t.Q6J("ngForOf",t.Dn7(65,10,t.xi3(66,14,e.filterTableData,e.search),(e.page-1)*e.pageSize,(e.page-1)*e.pageSize+e.pageSize))("ngForTrackBy",e.trackByFn),t.xp6(4),t.Q6J("ngIf",!t.DdM(22,N).includes(e.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(23,N).includes(e.action)))},dependencies:[d.sg,d.O5,y.P,P._L,l._Y,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.JL,l.sg,l.u,l.On,h.j,d.OU,d.JJ,d.rS,F.G,J.W,S.S],encapsulation:2}),a})();var ot=u(25116),c=u(13107),st=u(28402);let it=["*","*","*","*","*","*","*","*",,"*","*","*","*","*"],k="Stock Issue To Production",w=[{header:"Issue Dt.",key:"issueDate",...c.t},{header:"Department",key:"department",...c.t},{header:"Job Card No",key:"jobCardNo",...c.t},{header:"MRN No.",key:"MRNNumber",...c.t},{header:"Item Code",key:"itemCode",...c.t},{header:"Item Name",key:"itemName",...c.t},{header:"Stage",key:"stage",...c.t},{header:"W X L",key:"WxL",...c.t},{header:"Width",key:"width",...c.t},{header:"Length",key:"length",...c.t},{header:"Qty (C)",key:"qty",...c.t},{header:"UoM",key:"UOM",...c.t},{header:"Issue Qty.",key:"issueQty",...c.t}];var ut=u(53421);function lt(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td",24,25)(9,"span",26),t._uU(10),t.qZA()(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.ALo(23,"UOMUnitsMaster"),t.qZA(),t.TgZ(24,"td"),t._uU(25),t.qZA(),t.TgZ(26,"td")(27,"div",27),t._UZ(28,"button",28),t.TgZ(29,"div",29)(30,"a",30),t.NdJ("click",function(){const i=t.CHM(o).$implicit,s=t.oxw();return t.KtG(s.navigateTo("../form",i,"view"))}),t._UZ(31,"i",31),t._uU(32," View "),t.qZA(),t.TgZ(33,"a",30),t.NdJ("click",function(){const i=t.CHM(o).$implicit,s=t.oxw();return t.KtG(s.navigateTo("../form",i,"edit"))}),t._UZ(34,"i",32),t._uU(35," Edit "),t.qZA(),t.TgZ(36,"a",30),t.NdJ("click",function(){const i=t.CHM(o).$implicit,s=t.oxw();return t.KtG(s.navigateTo("../form",i,"approve"))}),t._UZ(37,"i",33),t._uU(38," Approve "),t.qZA(),t.TgZ(39,"a",30),t.NdJ("click",function(){const i=t.CHM(o).$implicit,s=t.oxw();return t.KtG(s.navigateTo("../form",i,"reject"))}),t._UZ(40,"i",34),t._uU(41," Reject "),t.qZA()()()()()}if(2&r){const o=a.$implicit,n=t.MAs(8),e=t.oxw();t.xp6(2),t.Oqu(null==o?null:o.issueDate),t.xp6(2),t.Oqu(null==o?null:o.MRNNumber),t.xp6(2),t.Oqu(null==o?null:o.itemCode),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("positionTarget",n)("ngbTooltip",o.itemName),t.xp6(1),t.hij(" ",o.itemName?o.itemName:null," "),t.xp6(2),t.Oqu(null==o?null:o.stage),t.xp6(2),t.Oqu("SFG-Roll"==(null==o?null:o.stage)?"mm x mtr":"mm x mm"),t.xp6(2),t.Oqu(null==o?null:o.width),t.xp6(2),t.Oqu(null==o?null:o.length),t.xp6(2),t.Oqu("SFG-Roll"==(null==o?null:o.stage)?null==o?null:o.qty:null==o?null:o.sheetQty),t.xp6(2),t.Oqu(t.lcZ(23,25,null==o?null:o.UOM)),t.xp6(3),t.Oqu(null==o?null:o.issueQty),t.xp6(5),t.Q6J("accessType",e.rolePermissionActions.viewAction),t.xp6(3),t.ekj("disable","Approved"===(null==o?null:o.status)||"Rejected"===(null==o?null:o.status)),t.Q6J("accessType",e.rolePermissionActions.editAction),t.xp6(3),t.ekj("disable","Approved"===(null==o?null:o.status)||"Rejected"===(null==o?null:o.status)),t.Q6J("accessType",e.rolePermissionActions.approveAction),t.xp6(3),t.ekj("disable","Approved"===(null==o?null:o.status)||"Rejected"===(null==o?null:o.status)),t.Q6J("accessType",e.rolePermissionActions.approveAction)}}const ct=function(r,a,o,n){return{page:r,pageSize:a,collection:o,search:n,type:"list"}};let dt=(()=>{var r;class a{constructor(n,e,i,s,T,g,f){this.router=n,this.spinner=e,this.stockIssueToProductionService=i,this.exportExcelService=s,this.activatedRoute=T,this.storageService=g,this.exportToPDFService=f,this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.userData={},this.rolePermissionActions=ot.a1}ngOnInit(){this.userData=this.storageService.get("IDMSAUser"),this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}navigateTo(n,e,i){return"Awaiting Approval"==e.status&&"edit"==i||"Awaiting Approval"==e.status&&"approve"==i||"Awaiting Approval"==e.status&&"reject"==i||"Approved"==e.status&&"view"==i||"Rejected"==e.status&&"view"==i||"Awaiting Approval"==e.status&&"view"==i||"create"==i?void this.router.navigate([n],{relativeTo:this.activatedRoute,queryParams:{id:e?._id,action:i}}):null}trackByFn(n,e){return e?._id}eventHeader(n){switch(n.key){case"SEARCH":this.search=n.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=n.value,this.getAll()}}getAll(n=!1,e=""){this.spinner.show();let i={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:n};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.stockIssueToProductionService.getAll(i).subscribe(s=>{"EXCEL"==e?this.excelDownload(s.rows):"PDF"==e?this.pdfDownload(s.rows):(this.tableData=s.rows,this.collection=s.count),this.spinner.hide()})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}excelDownload(n){this.exportExcelService.exportExcel((r=>({title:k,csvData:r,headers:w}))(n))}pdfDownload(n){let e=(r=>(0,st.J)({data:r,headers:w,widths:it,title:k}))(n);this.exportToPDFService.generatePdf(e.tableData,e.title)}onSort({column:n,direction:e}){this.headers.forEach(i=>{i.sortable!==n&&(i.direction="")}),this.column=n,this.direction="asc"==e?1:-1,this.getAll()}}return(r=a).\u0275fac=function(n){return new(n||r)(t.Y36(m.F0),t.Y36(p.V),t.Y36(b.rj),t.Y36(p.Ol),t.Y36(m.gz),t.Y36(p.V1),t.Y36(p.$L))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-issue-to-production-list"]],viewQuery:function(n,e){if(1&n&&t.Gf(h.j,5),2&n){let i;t.iGM(i=t.CRH())&&(e.headers=i)}},decls:41,vars:9,consts:[[1,"listCard","card"],[1,"table-header"],[1,"col"],[1,"heading"],["appAccessControl","",1,"text-center",3,"accessType"],["type","button",1,"btn","bg-primary","btn-add",3,"click"],["aria-hidden","true",1,"fa","fa-plus-square","fa-lg","mx-2"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","issueDate",3,"sort"],["sortable","MRNNumber",3,"sort"],["sortable","itemCode",3,"sort"],["sortable","itemName",1,"text-start",3,"sort"],["sortable","stage",3,"sort"],["sortable","width",3,"sort"],["sortable","length",3,"sort"],["sortable","qty",3,"sort"],["sortable","UOM",3,"sort"],["sortable","issueQty",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["SKUName",""],[1,"pointer",3,"positionTarget","ngbTooltip"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-check","fa-lg","me-2","text-success"],["aria-hidden","true",1,"fa","fa-close","me-3","text-primary"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),t._uU(4,"Summary of Stock Issue to Production"),t.qZA()()(),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return e.navigateTo("../form",{},"create")}),t._UZ(7,"i",6),t._uU(8," Create Stock Issue Entry to Production "),t.qZA()(),t._UZ(9,"hr",7),t.TgZ(10,"div",8)(11,"app-setting-header",9),t.NdJ("dataChange",function(s){return e.eventHeader(s)}),t.qZA(),t.TgZ(12,"table",10)(13,"thead",11)(14,"tr",12)(15,"th",13),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(16,"Issue Dt."),t.qZA(),t.TgZ(17,"th",14),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(18,"MRN No."),t.qZA(),t.TgZ(19,"th",15),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(20,"Item Code"),t.qZA(),t.TgZ(21,"th",16),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(22,"Item Name"),t.qZA(),t.TgZ(23,"th",17),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(24,"Stage"),t.qZA(),t.TgZ(25,"th",17),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(26,"W X L"),t.qZA(),t.TgZ(27,"th",18),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(28,"Width"),t.qZA(),t.TgZ(29,"th",19),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(30,"Length"),t.qZA(),t.TgZ(31,"th",20),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(32,"Qty (C)"),t.qZA(),t.TgZ(33,"th",21),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(34,"UoM"),t.qZA(),t.TgZ(35,"th",22),t.NdJ("sort",function(s){return e.onSort(s)}),t._uU(36,"Issue Qty."),t.qZA(),t.TgZ(37,"th"),t._uU(38,"Action"),t.qZA()()(),t.TgZ(39,"tbody"),t.YNc(40,lt,42,27,"tr",23),t.qZA()()()()),2&n&&(t.xp6(5),t.Q6J("accessType",e.rolePermissionActions.createAction),t.xp6(6),t.Q6J("data",t.l5B(4,ct,e.page,e.pageSize,e.collection,e.search)),t.xp6(29),t.Q6J("ngForOf",e.tableData)("ngForTrackBy",e.trackByFn))},dependencies:[d.sg,y.P,P._L,h.j,ut.J,S.S],encapsulation:2}),a})();var pt=u(56208);const mt=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:dt},{path:"form",component:et,resolve:{accessScreen:u(65876).x}}];let ht=(()=>{var r;class a{}return(r=a).\u0275fac=function(n){return new(n||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[d.ez,m.Bz.forChild(mt),pt.m]}),a})()},13107:(I,_,u)=>{u.d(_,{t:()=>d});const d={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}}},28402:(I,_,u)=>{u.d(_,{J:()=>d});const d=({data:m,headers:l,widths:h,title:Z})=>({tableData:{widths:h,headerRows:1,body:[l.map(t=>({text:t.header,style:"header"})),...m.map(t=>l.map(b=>({style:"subheader",text:t[b.key]})))]},title:Z})}}]);