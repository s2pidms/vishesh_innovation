"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[7371],{69273:(T,m,s)=>{s.r(m),s.d(m,{SalaryComponentsModule:()=>H});var c=s(96814),d=s(1076),g=s(43818),f=s(25116),v=s(83935),Z=s(77609),e=s(65879),h=s(68187),u=s(99328),_=s(37285),y=s(88059),A=s(53421);function S(r,p){if(1&r){const t=e.EpF();e.TgZ(0,"a",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,a=e.oxw();return e.KtG(a.openConfirmModal(null==o?null:o._id,null==o?null:o.earningHead))}),e._UZ(1,"i",27),e._uU(2," Delete "),e.qZA()}}function x(r,p){if(1&r){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td")(14,"div",19),e._UZ(15,"button",20),e.TgZ(16,"div",21)(17,"a",22),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.navigateTo("../sc-form",null==a?null:a._id,"view"))}),e._UZ(18,"i",23),e._uU(19," View "),e.qZA(),e.TgZ(20,"a",22),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.navigateTo("../sc-form",null==a?null:a._id,"edit"))}),e._UZ(21,"i",24),e._uU(22," Edit "),e.qZA(),e.YNc(23,S,3,0,"a",25),e.qZA()()()()}if(2&r){const t=p.$implicit,n=e.oxw();e.xp6(2),e.Oqu(null==t?null:t.earningHead),e.xp6(2),e.Oqu(null==t?null:t.abbreviation),e.xp6(2),e.Oqu(null==t?null:t.earningType),e.xp6(2),e.Oqu(null==t?null:t.calculationFactor),e.xp6(2),e.Oqu(null==t?null:t.earningCycle),e.xp6(2),e.Oqu(null==t?null:t.status),e.xp6(5),e.Q6J("accessType",n.rolePermissionActions.viewAction),e.xp6(3),e.Q6J("accessType",n.rolePermissionActions.editAction),e.xp6(3),e.Q6J("ngIf",n.user==n.superAdminId)}}const U=function(r,p,t,n){return{page:r,pageSize:p,collection:t,search:n,type:"list"}};let q=(()=>{class r{constructor(t,n,o,a,l,C,b,M,V){this.SalaryComponentService=t,this.router=n,this.activatedRoute=o,this.spinner=a,this.exportExcelService=l,this.exportToPDFService=C,this.storageService=b,this.toastService=M,this.modalService=V,this.page=1,this.pageSize=8,this.collection=0,this.column="earningHead",this.direction=1,this.search="",this.tableData=[],this.superAdminId=f.dA,this.user="",this.rolePermissionActions=f.a1}ngOnInit(){this.user=this.storageService.get("IDMSAUser")?.roles?.find(t=>t==this.superAdminId),this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}navigateTo(t,n,o){this.router.navigate([t],{relativeTo:this.activatedRoute,queryParams:{id:n,action:o}})}trackByFn(t,n){return n?._id}eventHeader(t){switch(t.key){case"SEARCH":this.search=t.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=t.value,this.getAll()}}getAll(t=!1,n=""){this.spinner.show();let o={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:t};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.SalaryComponentService.getAll(o).subscribe(a=>{"EXCEL"==n?this.excelDownload(a.rows):"PDF"==n?this.pdfDownload(a.rows):(this.tableData=a.rows,this.collection=a.count),this.spinner.hide()})}delete(t){this.spinner.show(),this.SalaryComponentService.delete(t).subscribe(n=>{this.spinner.hide(),this.toastService.success(n.message),this.getAll()})}openConfirmModal(t,n){const o=this.modalService.open(Z.hn,{centered:!0,size:"md",backdrop:"static",keyboard:!1});o.componentInstance.heading="Confirm Deletion",o.componentInstance.confirmText=`Confirm Deletion of EarningHead ${n} ?`,o.result.then(a=>{"Yes"==a.title&&this.delete(t)},a=>{})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}excelDownload(t){this.exportExcelService.exportExcel((0,v.Kj)(t))}pdfDownload(t){let n=(0,v.ce)(t);this.exportToPDFService.generatePdf(n.tableData,n.title)}onSort({column:t,direction:n}){this.headers.forEach(o=>{o.sortable!==t&&(o.direction="")}),this.column=t,this.direction="asc"==n?1:-1,this.getAll()}static#e=this.\u0275fac=function(n){return new(n||r)(e.Y36(h.Pl),e.Y36(d.F0),e.Y36(d.gz),e.Y36(u.V),e.Y36(u.Ol),e.Y36(u.$L),e.Y36(u.V1),e.Y36(u.kl),e.Y36(_.FF))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-components-list"]],viewQuery:function(n,o){if(1&n&&e.Gf(g.j,5),2&n){let a;e.iGM(a=e.CRH())&&(o.headers=a)}},decls:30,vars:9,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],["appAccessControl","",1,"text-center",3,"accessType"],[1,"plusIconSvg","btn","btn-primary","me-1"],["type","button",1,"btn","btn-primary","btn-add","px-4",3,"click"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","earningHead",3,"sort"],["sortable","abbreviation",3,"sort"],["sortable","earningType",3,"sort"],["sortable","calculationFactor",3,"sort"],["sortable","earningCycle",3,"sort"],["sortable","status",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-primary"]],template:function(n,o){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"Salary Component Setup Summary"),e.qZA()(),e.TgZ(4,"div",3),e._UZ(5,"button",4),e.TgZ(6,"button",5),e.NdJ("click",function(){return o.navigateTo("../sc-form",null,"create")}),e._uU(7," Salary Component "),e.qZA()(),e._UZ(8,"hr",6),e.TgZ(9,"div",7)(10,"app-setting-header",8),e.NdJ("dataChange",function(l){return o.eventHeader(l)}),e.qZA(),e.TgZ(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th",12),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(15,"Earning Head"),e.qZA(),e.TgZ(16,"th",13),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(17,"Abbreviation"),e.qZA(),e.TgZ(18,"th",14),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(19,"Earning Type"),e.qZA(),e.TgZ(20,"th",15),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(21,"Rate %"),e.qZA(),e.TgZ(22,"th",16),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(23,"Eearning Cycle"),e.qZA(),e.TgZ(24,"th",17),e.NdJ("sort",function(l){return o.onSort(l)}),e._uU(25,"Status"),e.qZA(),e.TgZ(26,"th"),e._uU(27,"Action"),e.qZA()()(),e.TgZ(28,"tbody"),e.YNc(29,x,24,9,"tr",18),e.qZA()()()()),2&n&&(e.xp6(4),e.Q6J("accessType",o.rolePermissionActions.createAction),e.xp6(6),e.Q6J("data",e.l5B(4,U,o.page,o.pageSize,o.collection,o.search)),e.xp6(19),e.Q6J("ngForOf",o.tableData)("ngForTrackBy",o.trackByFn))},dependencies:[c.sg,c.O5,y.P,g.j,A.J],encapsulation:2})}return r})();var i=s(60095),k=s(21631),F=s(22096),J=s(68934),w=s(16897),E=s(1551);function N(r,p){if(1&r&&(e.TgZ(0,"option",17),e._uU(1),e.qZA()),2&r){const t=p.$implicit;e.Q6J("value",t.parameterName),e.xp6(1),e.hij(" ",t.parameterLabel," ")}}function I(r,p){1&r&&e._UZ(0,"hr",35)}const D=function(r){return{"d-none":r}};function P(r,p){if(1&r){const t=e.EpF();e.TgZ(0,"div",36)(1,"div",37)(2,"button",38),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.submit())}),e._uU(3,"Save"),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngClass",e.VKq(1,D,"View"==t.action))}}let O=(()=>{class r{get f(){return this.form.controls}constructor(t,n,o,a,l,C,b){this.salaryComponentService=t,this.activatedRoute=n,this.spinner=o,this.toastService=a,this.validationService=l,this.utilityService=C,this.location=b,this.submitted=!1,this.action="create",this.masterData={autoIncrementNo:"",earningHeadOptions:[]},this.form=new i.nJ({_id:new i.p4(null),componentCode:new i.p4("",[i.kI.required]),earningHead:new i.p4(null,[i.kI.required]),abbreviation:new i.p4("",[i.kI.required]),earningType:new i.p4(null,[i.kI.required]),calculationFactor:new i.p4("",[i.kI.required]),earningCycle:new i.p4(null,[i.kI.required]),status:new i.p4(null,[i.kI.required]),isManagementStaffSalary:new i.p4(!1,[i.kI.required]),isOperatingStaffSalary:new i.p4(!1,[i.kI.required]),isPartOfCTC:new i.p4(!1,[i.kI.required]),isCalculateOnProRataBasis:new i.p4(!1,[i.kI.required])})}ngOnInit(){this.getInitialData()}submit(){if(this.submitted=!0,this.validationService.checkErrors(this.form,J.oN))return;this.form.enable();let t=this.form.value;t._id?this.update(t):(delete t._id,this.create(t))}update(t){this.spinner.show(),this.salaryComponentService.update(t._id,t).subscribe(n=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(n.message),this.location.back()})}create(t){this.spinner.show(),this.salaryComponentService.create(t).subscribe(n=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(n.message),this.location.back()})}getInitialData(){this.spinner.show(),this.salaryComponentService.getAllMasterData({}).subscribe(t=>{this.masterData=t,this.form.controls.componentCode.setValue(this.masterData.autoIncrementNo),this.activatedRoute.queryParams.pipe((0,k.z)(n=>(this.action=n.action,this.utilityService.accessDenied(this.action),n.id?this.salaryComponentService.getById(n.id):(0,F.of)({})))).subscribe(n=>{this.spinner.hide(),0!=Object.keys(n).length&&(this.form.patchValue(n),["Fixed Amount","Variable Amount"].includes(n.earningType)?(this.f.calculationFactor.setValue("-"),this.f.calculationFactor.disable()):this.f.calculationFactor.enable(),"edit"!=this.action&&this.form.disable())})})}selectEarningHead(t){if("Basic Pay"==t.target.value)this.form.controls.abbreviation.setValue("Basic");else if("Arrears"==t.target.value)this.form.controls.abbreviation.setValue("Ar");else{let n=t.target.value.match(/\b([A-Za-z0-9])/g).join("").toUpperCase();this.form.controls.abbreviation.setValue(n)}}setEarningType(t){["Fixed Amount","Variable Amount"].includes(t.target.value)?(this.f.calculationFactor.setValue("-"),this.f.calculationFactor.disable()):(this.f.calculationFactor.enable(),this.f.calculationFactor.setValue(null))}static#e=this.\u0275fac=function(n){return new(n||r)(e.Y36(h.Pl),e.Y36(d.gz),e.Y36(u.V),e.Y36(u.kl),e.Y36(w.RJ),e.Y36(u.tI),e.Y36(c.Ye))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-components-form"]],decls:103,vars:22,consts:[[1,"formCard","card",3,"formGroup"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,"form-body"],[1,"row","mb-1"],[1,"col-md-8"],[1,"row","mb-4"],[1,"col-md-6"],[1,"form-label","my-2"],[1,"text-danger"],["formControlName","earningHead",1,"form-select",3,"change"],["disabled","","selected","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"error-left",3,"control"],["type","text","formControlName","abbreviation","readonly","",1,"form-control"],["type","text","formControlName","earningType",1,"form-select",3,"change"],[3,"value"],[1,"d-flex","inputGroup"],["type","text","name","calculationFactor","formControlName","calculationFactor",1,"form-control"],[1,"input-group-text","rounded-0","bg-secondary","text-white"],["type","text","formControlName","earningCycle",1,"form-select"],["formControlName","status",1,"form-select"],["value","Active"],["value","Inactive"],[1,"col-md-4","mt-3"],[1,"text-primary","mb-4"],[1,"form-check","mb-4","d-flex"],["type","checkbox","id","check1","formControlName","isManagementStaffSalary","check","",1,"form-check-input","me-3"],[1,"form-check-label"],["type","checkbox","id","check1","formControlName","isOperatingStaffSalary","check","",1,"form-check-input","me-3"],["type","checkbox","id","check1","formControlName","isPartOfCTC","check","",1,"form-check-input","me-3"],["type","checkbox","id","check1","formControlName","isCalculateOnProRataBasis","check","",1,"form-check-input","text-nowrap","me-3"],["class","row line-border",4,"ngIf"],["class","d-flex justify-content-center my-4",4,"ngIf"],[1,"row","line-border"],[1,"d-flex","justify-content-center","my-4"],[1,"d-grid","col-md-2",3,"ngClass"],[1,"btn","btn-primary",3,"click"]],template:function(n,o){1&n&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label"),e._uU(5),e.ALo(6,"titlecase"),e.qZA()()(),e.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"label",9),e._uU(13," Earning Head "),e.TgZ(14,"span",10),e._uU(15,"*"),e.qZA()(),e.TgZ(16,"select",11),e.NdJ("change",function(l){return o.selectEarningHead(l)}),e.TgZ(17,"option",12),e._uU(18,"Select Earning Head"),e.qZA(),e.YNc(19,N,2,2,"option",13),e.qZA(),e._UZ(20,"validation-messages",14),e.qZA(),e.TgZ(21,"div",8)(22,"label",9),e._uU(23," Abbreviation "),e.TgZ(24,"span",10),e._uU(25,"*"),e.qZA()(),e._UZ(26,"input",15)(27,"validation-messages",14),e.qZA()(),e.TgZ(28,"div",7)(29,"div",8)(30,"label",9),e._uU(31," Earning Type "),e.TgZ(32,"span",10),e._uU(33,"*"),e.qZA()(),e.TgZ(34,"select",16),e.NdJ("change",function(l){return o.setEarningType(l)}),e.TgZ(35,"option",12),e._uU(36,"Select Earning Type"),e.qZA(),e.TgZ(37,"option",17),e._uU(38,"Fixed Amount"),e.qZA(),e.TgZ(39,"option",17),e._uU(40,"Variable Amount"),e.qZA(),e.TgZ(41,"option",17),e._uU(42,"Percentage of Basic"),e.qZA(),e.TgZ(43,"option",17),e._uU(44,"Percentage of CTC"),e.qZA()(),e._UZ(45,"validation-messages",14),e.qZA(),e.TgZ(46,"div",8)(47,"label",9),e._uU(48," Set percentage % rate "),e.TgZ(49,"span",10),e._uU(50,"*"),e.qZA()(),e.TgZ(51,"div",18),e._UZ(52,"input",19),e.TgZ(53,"span",20),e._uU(54," % "),e.qZA()()()(),e.TgZ(55,"div",7)(56,"div",8)(57,"label",9),e._uU(58," Earning Cycle "),e.TgZ(59,"span",10),e._uU(60,"*"),e.qZA()(),e.TgZ(61,"select",21)(62,"option",12),e._uU(63,"Select Earning Cycle"),e.qZA(),e.TgZ(64,"option",17),e._uU(65,"Monthly"),e.qZA(),e.TgZ(66,"option",17),e._uU(67,"During any Payroll"),e.qZA()(),e._UZ(68,"validation-messages",14),e.qZA(),e.TgZ(69,"div",8)(70,"label",9),e._uU(71," Status "),e.TgZ(72,"span",10),e._uU(73,"*"),e.qZA()(),e.TgZ(74,"select",22)(75,"option",12),e._uU(76,"Select Status"),e.qZA(),e.TgZ(77,"option",23),e._uU(78,"Active"),e.qZA(),e.TgZ(79,"option",24),e._uU(80,"Inactive"),e.qZA()(),e._UZ(81,"validation-messages",14),e.qZA()()(),e.TgZ(82,"div",25)(83,"h4",26),e._uU(84,"Check if applicable"),e.qZA(),e.TgZ(85,"div",27),e._UZ(86,"input",28),e.TgZ(87,"label",29),e._uU(88,"Consider for Management Staff Salary"),e.qZA()(),e.TgZ(89,"div",27),e._UZ(90,"input",30),e.TgZ(91,"label",29),e._uU(92,"Consider for Operating Staff (Labour) Salary"),e.qZA()(),e.TgZ(93,"div",27),e._UZ(94,"input",31),e.TgZ(95,"label",29),e._uU(96,"Make this earning Part of CTC"),e.qZA()(),e.TgZ(97,"div",27),e._UZ(98,"input",32),e.TgZ(99,"label",29),e._uU(100,"Make this earning on Pro-rata basis"),e.qZA()()()()(),e.YNc(101,I,1,0,"hr",33),e.YNc(102,P,4,3,"div",34),e.qZA()()),2&n&&(e.Q6J("formGroup",o.form),e.xp6(5),e.hij("Salary Components [",e.lcZ(6,20,o.action),"]"),e.xp6(12),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",o.masterData.earningHeadOptions),e.xp6(1),e.Q6J("control",o.f.earningHead),e.xp6(7),e.Q6J("control",o.f.abbreviation),e.xp6(8),e.Q6J("value",null),e.xp6(2),e.Q6J("value","Fixed Amount"),e.xp6(2),e.Q6J("value","Variable Amount"),e.xp6(2),e.Q6J("value","Percentage Of Basic"),e.xp6(2),e.Q6J("value","Percentage Of CTC"),e.xp6(2),e.Q6J("control",o.f.earningType),e.xp6(17),e.Q6J("value",null),e.xp6(2),e.Q6J("value","Every Month"),e.xp6(2),e.Q6J("value","During any payroll"),e.xp6(2),e.Q6J("control",o.f.earningCycle),e.xp6(7),e.Q6J("value",null),e.xp6(6),e.Q6J("control",o.f.status),e.xp6(20),e.Q6J("ngIf","view"!==o.action),e.xp6(1),e.Q6J("ngIf","view"!==o.action))},dependencies:[c.mk,c.sg,c.O5,E.s,i._Y,i.YN,i.Kr,i.Fj,i.Wl,i.EJ,i.JJ,i.JL,i.sg,i.u,c.rS],encapsulation:2})}return r})();var Q=s(56208);const Y=[{path:"",redirectTo:"sc-list",pathMatch:"full"},{path:"sc-list",component:q},{path:"sc-form",component:O,resolve:{accessScreen:s(65876).x}}];let H=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=e.oAB({type:r});static#n=this.\u0275inj=e.cJS({imports:[c.ez,d.Bz.forChild(Y),Q.m]})}return r})()},13107:(T,m,s)=>{s.d(m,{t:()=>c});const c={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}}},28402:(T,m,s)=>{s.d(m,{J:()=>c});const c=({data:d,headers:g,widths:f,title:v})=>({tableData:{widths:f,headerRows:1,body:[g.map(h=>({text:h.header,style:"header"})),...d.map(h=>g.map(u=>({style:"subheader",text:h[u.key]})))]},title:v})}}]);