"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9069],{99069:(v,h,r)=>{r.r(h),r.d(h,{CostEstimateCalculatorModule:()=>A});var l=r(96814),p=r(1076),C=r(56208),d=r(43818),t=r(65879),S=r(59840),U=r(88354),u=r(98977),c=r(60095),f=r(50363),T=r(95346),D=r(14906);const K=["elementToPrint"],b=function(){return{standalone:!0}},Z=function(){return[4,8,9]};function M(i,m){if(1&i){const n=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",32),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td")(10,"div",33)(11,"input",34),t.NdJ("ngModelChange",function(e){const a=t.CHM(n).$implicit;return t.KtG(a.costPerSKUUnit=e)})("input",function(){t.CHM(n);const e=t.oxw(2);return t.KtG(e.change())}),t.qZA()()(),t.TgZ(12,"td"),t._uU(13),t.qZA()()}if(2&i){const n=m.$implicit,o=m.index;t.xp6(2),t.hij(" ",o+1," "),t.xp6(2),t.Oqu(null==n?null:n.componentType),t.xp6(2),t.Oqu(null==n?null:n.costElement),t.xp6(2),t.Oqu(null==n?null:n.SKUUnit),t.xp6(3),t.Q6J("ngModel",n.costPerSKUUnit)("ngModelOptions",t.DdM(8,b))("readonly",t.DdM(9,Z).includes(o)),t.xp6(2),t.Oqu(null==n?null:n.percentage)}}function y(i,m){if(1&i){const n=t.EpF();t.ynx(0),t._UZ(1,"hr",20),t.TgZ(2,"div",21)(3,"table",22)(4,"thead",23)(5,"tr",24)(6,"th",25),t.NdJ("sort",function(e){t.CHM(n);const s=t.oxw();return t.KtG(s.onSort(e))}),t._uU(7,"SN"),t.qZA(),t.TgZ(8,"th",26),t.NdJ("sort",function(e){t.CHM(n);const s=t.oxw();return t.KtG(s.onSort(e))}),t._uU(9,"Cost Type"),t.qZA(),t.TgZ(10,"th",27),t.NdJ("sort",function(e){t.CHM(n);const s=t.oxw();return t.KtG(s.onSort(e))}),t._uU(11," Cost Element/Particulars "),t.qZA(),t.TgZ(12,"th",28),t.NdJ("sort",function(e){t.CHM(n);const s=t.oxw();return t.KtG(s.onSort(e))}),t._uU(13,"SKU Unit"),t.qZA(),t.TgZ(14,"th",29),t.NdJ("sort",function(e){t.CHM(n);const s=t.oxw();return t.KtG(s.onSort(e))}),t._uU(15,"Cost INR/SKU Unit"),t.qZA(),t.TgZ(16,"th",30),t.NdJ("sort",function(e){t.CHM(n);const s=t.oxw();return t.KtG(s.onSort(e))}),t._uU(17,"%"),t.qZA()()(),t.TgZ(18,"tbody"),t.YNc(19,M,14,10,"tr",31),t.ALo(20,"slice"),t.ALo(21,"searchFi1ter"),t.qZA()()(),t.BQk()}if(2&i){const n=t.oxw();t.xp6(19),t.Q6J("ngForOf",t.Dn7(20,1,t.xi3(21,5,n.masterData.costSheetList,n.search),(n.page-1)*n.pageSize,(n.page-1)*n.pageSize+n.pageSize))}}const E=[{path:"",redirectTo:"cal",pathMatch:"full"},{path:"cal",component:(()=>{class i{constructor(n,o,e,s,a){this.SKUMasterService=n,this.costEstimateService=o,this.router=e,this.spinner=s,this.storageService=a,this.page=1,this.pageSize=10,this.collection=0,this.search="",this.column="createdAt",this.direction=-1,this.tableData=[],this.originTableData=[],this.skuId="",this.SKUName="",this.SKUNo="",this.SKUDescription="",this.primaryUnit="",this.crore="",this.masterData={costSheetList:[],SKUOptions:[]}}ngOnInit(){this.getAllMasterData()}navigateTo(n,o,e){this.router.navigate([n],{queryParams:{id:o,action:e}})}trackByFn(n,o){return o?._id}reset(){this.skuId="",this.SKUDescription="",this.primaryUnit="",this.crore="Cr",this.masterData.costSheetList=[],this.getAllMasterData()}getAllMasterData(){this.spinner.show(),this.costEstimateService.getAllSKUCostEstimateMasterData({}).subscribe(n=>{n&&(this.masterData=n,this.originTableData=this.masterData?.costSheetList),this.spinner.hide()})}getById(n){this.spinner.show(),this.SKUNo=n.SKUNo,this.SKUName=n.SKUName,this.SKUDescription=n.SKUDescription,this.primaryUnit=n.primaryUnit,this.SKUMasterService.getAllSKUMasterBySKUId(this.skuId).subscribe(o=>{this.masterData.costSheetList=o.costSheetInfo&&o.costSheetInfo.length?o?.costSheetInfo:this.originTableData,this.spinner.hide()})}change(){let n=this.masterData?.costSheetList.map(o=>(o.isTotal&&("Direct"==o.componentType&&(o.costPerSKUUnit=+Number(this.masterData?.costSheetList.filter(e=>"Direct"==e.componentType&&!e.isTotal).map(e=>+e.costPerSKUUnit).reduce((e,s)=>e+s)).toFixed(2)),"Indirect"==o.componentType&&(o.costPerSKUUnit=+Number(this.masterData?.costSheetList.filter(e=>"Indirect"==e.componentType&&!e.isTotal).map(e=>+e.costPerSKUUnit).reduce((e,s)=>e+s)).toFixed(2)),"Direct + Indirect"==o.componentType&&(o.costPerSKUUnit=+Number(this.masterData?.costSheetList[this.masterData?.costSheetList.findIndex(e=>"Direct"==e.componentType&&e.isTotal)].costPerSKUUnit+this.masterData?.costSheetList[this.masterData?.costSheetList.findIndex(e=>"Indirect"==e.componentType&&e.isTotal)].costPerSKUUnit).toFixed(2))),o));this.masterData.costSheetList=n.map(o=>(o.percentage=o.costPerSKUUnit&&this.masterData?.costSheetList[this.masterData?.costSheetList.findIndex(e=>"Direct + Indirect"==e.componentType&&e.isTotal)].costPerSKUUnit?+Number(100*o.costPerSKUUnit/this.masterData?.costSheetList[this.masterData?.costSheetList.findIndex(e=>"Direct + Indirect"==e.componentType&&e.isTotal)].costPerSKUUnit).toFixed(2):0,o))}onSort({column:n,direction:o}){this.headers.forEach(e=>{e.sortable!==n&&(e.direction="")}),this.tableData=""===o||""===n?this.tableData:[...this.tableData].sort((e,s)=>{let a="string"==typeof e[n]?e[n].toLowerCase():e[n],g="string"==typeof s[n]?s[n].toLowerCase():s[n];const _=a<g?-1:a>g?1:0;return"asc"===o?_:-_})}printElement(){this.storageService.set("costEstimateCalculateData",{type:"SKU",SKUNo:this.SKUNo,SKUName:this.SKUName,SKUDescription:this.SKUDescription,primaryUnit:this.primaryUnit,costSheetArr:this.masterData?.costSheetList}),window.open(`${window.location.origin}#/print/cost_estimate_cal_print?action=print`,"_blank")}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(S.cG),t.Y36(U.yU),t.Y36(p.F0),t.Y36(u.V),t.Y36(u.V1))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-cost-estimate-calculator"]],viewQuery:function(o,e){if(1&o&&(t.Gf(K,5),t.Gf(d.j,5)),2&o){let s;t.iGM(s=t.CRH())&&(e.elementToPrint=s.first),t.iGM(s=t.CRH())&&(e.headers=s)}},decls:31,vars:15,consts:[[1,"formCard","card"],["elementToPrint",""],[1,"container"],[1,"row","form-header"],[1,"col","heading"],[1,""],[1,"form-body"],[1,"row","mx-0"],[1,"col-3","pe-3","ps-0"],[1,"form-label","mb-2"],["bindLabel","SKUNo","bindValue","_id",3,"items","ngModel","clearable","ngModelChange","change"],[1,"col-3","px-3"],["bindLabel","SKUName","bindValue","_id",3,"items","clearable","ngModel","ngModelChange","change"],[1,"col-3","mt-1","px-3"],[1,"text-danger"],["type","text","readonly","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-3","d-flex","align-items-end","pe-0"],["type","button",1,"btn","btn-primary","px-5","me-5",3,"click"],["type","button",1,"btn","btn-primary","px-5",3,"disabled","click"],[4,"ngIf"],[1,"row","line-border"],[1,"table-responsive","text-wrap"],[1,"table","table-bordered","table-sm"],[1,"bg-primary"],[1,"text-white"],["sortable","seq",3,"sort"],["sortable","specificationCode",3,"sort"],["sortable","characteristic",1,"text-start",3,"sort"],["sortable","UOM",3,"sort"],["sortable","testStandard",3,"sort"],["sortable","measuringInstrument",3,"sort"],[4,"ngFor","ngForOf"],[1,"text-start"],[1,"d-flex","justify-content-center"],["type","number",1,"form-control","form-control-cs","w-25",3,"ngModel","ngModelOptions","readonly","ngModelChange","input"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0,1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),t._uU(6,"Cost Estimate Calculator"),t.qZA()()(),t.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"label",9),t._uU(11," Select SKU"),t.qZA(),t.TgZ(12,"ng-select",10),t.NdJ("ngModelChange",function(a){return e.skuId=a})("change",function(a){return e.getById(a)}),t.qZA()(),t.TgZ(13,"div",11)(14,"label",9),t._uU(15),t.ALo(16,"labelTranslate"),t.qZA(),t.TgZ(17,"ng-select",12),t.NdJ("ngModelChange",function(a){return e.skuId=a})("change",function(a){return e.getById(a)}),t.qZA()(),t.TgZ(18,"div",13)(19,"label",9),t._uU(20),t.ALo(21,"labelTranslate"),t.TgZ(22,"span",14),t._uU(23,"*"),t.qZA()(),t.TgZ(24,"input",15),t.NdJ("ngModelChange",function(a){return e.SKUDescription=a}),t.qZA()(),t.TgZ(25,"div",16)(26,"button",17),t.NdJ("click",function(){return e.reset()}),t._uU(27,"Reset"),t.qZA(),t.TgZ(28,"button",18),t.NdJ("click",function(){return e.printElement()}),t._uU(29," Export "),t.qZA()()()(),t.YNc(30,y,22,8,"ng-container",19),t.qZA()()),2&o&&(t.xp6(12),t.Q6J("items",e.masterData.SKUOptions)("ngModel",e.skuId)("clearable",!1),t.xp6(3),t.hij(" Select ",t.lcZ(16,11,"SKU Name"),""),t.xp6(2),t.Q6J("items",e.masterData.SKUOptions)("clearable",!1)("ngModel",e.skuId),t.xp6(3),t.hij(" ",t.lcZ(21,13,"SKU Description")," "),t.xp6(4),t.Q6J("ngModel",e.SKUDescription),t.xp6(4),t.Q6J("disabled",0==e.masterData.costSheetList.length),t.xp6(2),t.Q6J("ngIf",e.masterData.costSheetList.length))},dependencies:[l.sg,l.O5,c.Fj,c.wV,c.JJ,c.On,f.w9,d.j,l.OU,T.G,D.c],encapsulation:2})}return i})()}];let A=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[l.ez,C.m,p.Bz.forChild(E)]})}return i})()}}]);