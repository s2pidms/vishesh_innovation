"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9094],{79094:(O,y,d)=>{d.r(y),d.d(y,{DispatchRequestNoteModule:()=>Fe});var r=d(96814),p=d(1076),f=d(43818),N=d(25116),D=d(79250),e=d(65879),m=d(2742),T=d(59840),R=d(88059),g=d(37285),A=d(53421);function x(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",18,19)(9,"span",20),e._uU(10),e.qZA()(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td")(14,"div",21),e._UZ(15,"button",22),e.TgZ(16,"div",23)(17,"a",24),e.NdJ("click",function(){const l=e.CHM(s).$implicit,a=e.oxw();return e.KtG(a.navigateTo("../form",l,"view"))}),e._UZ(18,"i",25),e._uU(19," View "),e.qZA(),e.TgZ(20,"a",24),e.NdJ("click",function(){const l=e.CHM(s).$implicit,a=e.oxw();return e.KtG(a.navigateTo("../form",l,"rejection"))}),e._UZ(21,"i",26),e._uU(22," Reject "),e.qZA(),e.TgZ(23,"a",24),e.NdJ("click",function(){const l=e.CHM(s).$implicit,a=e.oxw();return e.KtG(a.navigateTo("../form",l,"approval"))}),e._UZ(24,"i",27),e._uU(25," Approve "),e.qZA()()()()()}if(2&i){const s=c.$implicit,o=e.MAs(8),t=e.oxw();e.xp6(2),e.Oqu(null==s?null:s.DRNNumber),e.xp6(2),e.Oqu(null==s?null:s.DRNDateS),e.xp6(2),e.Oqu(null==s?null:s.salesCategory),e.xp6(1),e.Udp("width",o.clientWidth),e.xp6(2),e.Q6J("positionTarget",o)("ngbTooltip",s.customerName),e.xp6(1),e.hij(" ",s.customerName," "),e.xp6(2),e.Oqu(s.DRNStatus),e.xp6(5),e.Q6J("accessType",t.rolePermissionActions.viewAction),e.xp6(3),e.ekj("disable","Approved"===(null==s?null:s.DRNStatus)||"Rejected"===(null==s?null:s.DRNStatus)),e.Q6J("accessType",t.rolePermissionActions.approveAction),e.xp6(3),e.ekj("disable","Approved"===(null==s?null:s.DRNStatus)||"Rejected"===(null==s?null:s.DRNStatus)),e.Q6J("accessType",t.rolePermissionActions.approveAction)}}const U=function(i,c,s,o){return{page:i,pageSize:c,collection:s,search:o,type:"list"}};let Z=(()=>{var i;class c{constructor(o,t,l,a,_,h){this.exportExcelService=o,this.dispatchRequestNoteService=t,this.spinner=l,this.activatedRoute=a,this.exportToPDFService=_,this.utilityService=h,this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.rolePermissionActions=N.a1}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}navigateTo(o,t,l){this.utilityService.navigateToForm({path:o,status:t.DRNStatus,action:l,id:t._id,activatedRoute:this.activatedRoute})}trackByFn(o,t){return t?._id}eventHeader(o){switch(o.key){case"SEARCH":this.search=o.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=o.value,this.getAll()}}getAll(o=!1,t=""){this.spinner.show();let l={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:o};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.dispatchRequestNoteService.getAll(l).subscribe(a=>{"EXCEL"==t?this.excelDownload(a.rows):"PDF"==t?this.pdfDownload(a.rows):(this.tableData=a.rows,this.collection=a.count,this.spinner.hide())})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}pdfDownload(o){let t=(0,D.Kr)(o);this.exportToPDFService.generatePdf(t.tableData,t.title)}excelDownload(o){this.exportExcelService.exportExcel((0,D.n8)(o))}onSort({column:o,direction:t}){this.headers.forEach(l=>{l.sortable!==o&&(l.direction="")}),this.column=o,this.direction="asc"==t?1:-1,this.getAll()}}return(i=c).\u0275fac=function(o){return new(o||i)(e.Y36(m.Ol),e.Y36(T.lM),e.Y36(m.V),e.Y36(p.gz),e.Y36(m.$L),e.Y36(m.tI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-dispatch-request-note-list"]],viewQuery:function(o,t){if(1&o&&e.Gf(f.j,5),2&o){let l;e.iGM(l=e.CRH())&&(t.headers=l)}},decls:28,vars:9,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],["appAccessControl","",1,"text-center",3,"accessType"],["type","button",1,"btn","btn-primary","btn-add",3,"click"],["aria-hidden","true",1,"fa","fa-plus-square","fa-lg","me-2"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-info"],[1,"text-white"],["sortable","DRNNumber",3,"sort"],["sortable","DRNDateS",3,"sort"],["sortable","salesCategory",3,"sort"],["sortable","customerName",1,"text-start",3,"sort"],["sortable","DRNStatus",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["customerName",""],[1,"pointer",3,"positionTarget","ngbTooltip"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa","fa-times","fa-lg","me-3","text-primary"],["aria-hidden","true",1,"fa","fa-check","fa-lg","text-success"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"DRN Summary"),e.qZA()(),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return t.navigateTo("../form",{},"create")}),e._UZ(6,"i",5),e._uU(7," Dispatch Request Note [DRN] "),e.qZA()(),e._UZ(8,"hr",6),e.TgZ(9,"div",7)(10,"app-setting-header",8),e.NdJ("dataChange",function(a){return t.eventHeader(a)}),e.qZA(),e.TgZ(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th",12),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(15,"DRN No."),e.qZA(),e.TgZ(16,"th",13),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(17,"DRN Date"),e.qZA(),e.TgZ(18,"th",14),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(19,"Customer Category"),e.qZA(),e.TgZ(20,"th",15),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(21,"Customer Name"),e.qZA(),e.TgZ(22,"th",16),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(23,"DRN Status"),e.qZA(),e.TgZ(24,"th"),e._uU(25,"Action"),e.qZA()()(),e.TgZ(26,"tbody"),e.YNc(27,x,26,16,"tr",17),e.qZA()()()()),2&o&&(e.xp6(4),e.Q6J("accessType",t.rolePermissionActions.createAction),e.xp6(6),e.Q6J("data",e.l5B(4,U,t.page,t.pageSize,t.collection,t.search)),e.xp6(17),e.Q6J("ngForOf",t.tableData)("ngForTrackBy",t.trackByFn))},dependencies:[r.sg,R.P,g._L,f.j,A.J],encapsulation:2}),c})();var n=d(60095),F=d(21631),I=d(22096),v=d(43154),C=d(14906),q=d(59103);function w(i,c){1&i&&e._UZ(0,"div",33)}function E(i,c){1&i&&e._UZ(0,"div",34)}function M(i,c){1&i&&e._UZ(0,"div",35)}function Q(i,c){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"number"),e.qZA()),2&i){const s=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,null==s?null:s.dispatchQty,".2-2")," ")}}function P(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"input",36),e.NdJ("ngModelChange",function(t){e.CHM(s);const l=e.oxw().$implicit;return e.KtG(l.dispatchQty=t)})("input",function(){e.CHM(s);const t=e.oxw(),l=t.$implicit,a=t.index,_=e.oxw();return e.KtG(_.checkDispatchQty(l,a))}),e.qZA()}if(2&i){const s=e.oxw().$implicit;e.Q6J("ngModel",s.dispatchQty)}}const b=function(){return["approval","rejection","view","generate","cancel"]};function ie(i,c){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"td")(10,"span",27),e.YNc(11,w,1,0,"div",28),e.YNc(12,E,1,0,"div",29),e.YNc(13,M,1,0,"div",30),e.qZA()(),e.TgZ(14,"td"),e._uU(15),e.qZA(),e.TgZ(16,"td")(17,"div",27),e.YNc(18,Q,3,4,"span",31),e.YNc(19,P,1,1,"input",32),e.qZA()()()),2&i){const s=c.$implicit,o=e.oxw();e.xp6(2),e.Oqu(null==s?null:s.FGBatchNo),e.xp6(2),e.Oqu(e.xi3(5,9,null==s?null:s.FGBatchDate,"dd-MM-YYYY")),e.xp6(3),e.hij(" ",s.FGExpiryDate?e.xi3(8,12,null==s?null:s.FGExpiryDate,"dd-MM-YYYY"):"-"," "),e.xp6(4),e.Q6J("ngIf","green"==(null==s?null:s.aging)),e.xp6(1),e.Q6J("ngIf","red"==(null==s?null:s.aging)),e.xp6(1),e.Q6J("ngIf","orange"==(null==s?null:s.aging)),e.xp6(2),e.Oqu(null==s?null:s.FGINQuantity),e.xp6(3),e.Q6J("ngIf",e.DdM(15,b).includes(o.action)),e.xp6(1),e.Q6J("ngIf",!e.DdM(16,b).includes(o.action))}}let re=(()=>{var i;class c{constructor(o,t,l){this.activeModal=o,this.toastService=t,this.utilityService=l,this.data=[],this.action="",this.totalDispatchQty=0,this.tBatchNo=""}ngOnInit(){this.data&&1==this.data.FGStockDetails.length&&this.data.FGStockDetails[0].FGBatchDate&&(this.tBatchNo=this.utilityService.getFormatDate(this.data?.FGStockDetails[0]?.FGBatchDate,"YYYY-MM-DD"))}dismissModel(){this.activeModal.close({FGStockDetails:this.data.FGStockDetails,tBatchNo:this.tBatchNo,totalDispatchQty:this.totalDispatchQty})}checkDispatchQty(o,t){let l=this.data.FGStockDetails.map(a=>+a.dispatchQty).reduce((a,_)=>+a+ +_,0);if(o.dispatchQty>this.data.SOBalancedQty&&(this.toastService.error("Dispatch Qty should not be greater then SO Balanced Qty"),this.data.FGStockDetails[t].dispatchQty=0),o.dispatchQty>o.FGINQuantity&&(this.toastService.error("Dispatch Qty should not be greater then FGIN Qty"),this.data.FGStockDetails[t].dispatchQty=0),l>this.data.SOBalancedQty)return this.data.FGStockDetails[t].dispatchQty=0,this.data.FGStockDetails=[...this.data.FGStockDetails],void this.toastService.error("Dispatch Qty. should not be greater than FGIN Qty.");this.totalDispatchQty=l}}return(i=c).\u0275fac=function(o){return new(o||i)(e.Y36(g.Kz),e.Y36(m.kl),e.Y36(m.tI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-fg-stock-details-modal"]],inputs:{data:"data",action:"action",totalDispatchQty:"totalDispatchQty",tBatchNo:"tBatchNo"},decls:77,vars:19,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid"],[1,"row","justify-content-center"],[1,"col-12","my-3"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],[1,"text-start"],[1,"row"],[1,"line-border","my-3"],[4,"ngFor","ngForOf"],[1,"row","mb-3","justify-content-center"],[1,"col-12"],[1,"col-5"],[1,"d-flex","align-items-center"],[1,"col-form-label","text-nowrap"],[1,"fa","fa-caret-right","fs-4","mx-1"],["type","text","readonly","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-4"],["type","text",1,"form-control",3,"disabled","ngModel","ngModelChange"],[1,"col-3","d-flex","justify-content-end"],["type","button",1,"btn","btn-primary","px-2","me-0","py-0",3,"disabled","click"],[1,"d-flex","justify-content-center"],["class","flaggreen",4,"ngIf"],["class","flagred",4,"ngIf"],["class","flagYellow",4,"ngIf"],[4,"ngIf"],["type","number","class","form-control form-control-sm w-25",3,"ngModel","ngModelChange","input",4,"ngIf"],[1,"flaggreen"],[1,"flagred"],[1,"flagYellow"],["type","number",1,"form-control","form-control-sm","w-25",3,"ngModel","ngModelChange","input"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"FG Stock Details"),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return t.activeModal.close()}),e._UZ(6,"i",4),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th"),e._uU(15,"SKU NO."),e.qZA(),e.TgZ(16,"th",12),e._uU(17),e.ALo(18,"labelTranslate"),e.qZA(),e.TgZ(19,"th",12),e._uU(20),e.ALo(21,"labelTranslate"),e.qZA(),e.TgZ(22,"th"),e._uU(23,"UoM"),e.qZA()()(),e.TgZ(24,"tbody")(25,"tr")(26,"td"),e._uU(27),e.qZA(),e.TgZ(28,"td",12),e._uU(29),e.qZA(),e.TgZ(30,"td",12),e._uU(31),e.qZA(),e.TgZ(32,"td"),e._uU(33),e.ALo(34,"UOMUnitsMaster"),e.qZA()()()()()()(),e.TgZ(35,"div",13),e._UZ(36,"hr",14),e.qZA(),e.TgZ(37,"div",6)(38,"div",7)(39,"div",8)(40,"table",9)(41,"thead",10)(42,"tr",11)(43,"th"),e._uU(44,"FG Batch No"),e.qZA(),e.TgZ(45,"th"),e._uU(46,"FG Batch Date"),e.qZA(),e.TgZ(47,"th"),e._uU(48,"FG B/B Date"),e.qZA(),e.TgZ(49,"th"),e._uU(50,"Aging"),e.qZA(),e.TgZ(51,"th"),e._uU(52,"FGI Qty."),e.qZA(),e.TgZ(53,"th"),e._uU(54,"Disp. Qty."),e.qZA()()(),e.TgZ(55,"tbody"),e.YNc(56,ie,20,17,"tr",15),e.qZA()()()()(),e.TgZ(57,"div",13),e._UZ(58,"hr",14),e.qZA(),e.TgZ(59,"div",16)(60,"div",17)(61,"div",13)(62,"div",18)(63,"div",19)(64,"div",20),e._uU(65," Total Dispatch. Qty. "),e._UZ(66,"i",21),e.qZA(),e.TgZ(67,"input",22),e.NdJ("ngModelChange",function(a){return t.totalDispatchQty=a}),e.qZA()()(),e.TgZ(68,"div",23)(69,"div",19)(70,"div",20),e._uU(71," T/Batch No. "),e._UZ(72,"i",21),e.qZA(),e.TgZ(73,"input",24),e.NdJ("ngModelChange",function(a){return t.tBatchNo=a}),e.qZA()()(),e.TgZ(74,"div",25)(75,"button",26),e.NdJ("click",function(){return t.dismissModel()}),e._uU(76," Save & close "),e.qZA()()()()()()()),2&o&&(e.xp6(17),e.Oqu(e.lcZ(18,11,"SKU Name")),e.xp6(3),e.hij(" ",e.lcZ(21,13,"SKU Description")," "),e.xp6(7),e.Oqu(null==t.data?null:t.data.SKUNo),e.xp6(2),e.Oqu(null==t.data?null:t.data.SKUName),e.xp6(2),e.Oqu(null==t.data?null:t.data.SKUDescription),e.xp6(2),e.Oqu(e.lcZ(34,15,null==t.data?null:t.data.UOM)),e.xp6(23),e.Q6J("ngForOf",t.data.FGStockDetails),e.xp6(11),e.Q6J("ngModel",t.totalDispatchQty),e.xp6(6),e.Q6J("disabled",e.DdM(17,b).includes(t.action))("ngModel",t.tBatchNo),e.xp6(2),e.Q6J("disabled",e.DdM(18,b).includes(t.action)))},dependencies:[r.sg,r.O5,n.Fj,n.wV,n.JJ,n.On,r.JJ,r.uU,C.c,q.S],encapsulation:2}),c})();var S=d(16897);let G=(()=>{var i;class c{constructor(o,t,l,a){this.activeModal=o,this.validationService=t,this.modalService=l,this.toastService=a,this.customerShippingAddress={},this.action="",this.form=new n.nJ({line1:new n.p4(null),line2:new n.p4(null),line3:new n.p4(null),line4:new n.p4(null),pinCode:new n.p4(null),city:new n.p4(null),state:new n.p4(null),country:new n.p4(null)})}ngOnInit(){this.form.patchValue(this.customerShippingAddress),("view"==this.action||"cancel"==this.action||"approve"==this.action)&&this.form.disable()}}return(i=c).\u0275fac=function(o){return new(o||i)(e.Y36(g.Kz),e.Y36(S.RJ),e.Y36(g.FF),e.Y36(m.kl))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-drn-ship-to-address"]],inputs:{customerShippingAddress:"customerShippingAddress",action:"action"},decls:57,vars:1,consts:[[3,"formGroup"],[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid","mt-5","mb-3"],[1,"row"],[1,"col-12","px-0"],[1,"row","mb-4","px-5"],[1,"col-6"],[1,"form-label"],[1,"text-danger"],["type","text","formControlName","line1","readonly","",1,"form-control"],["type","text","formControlName","line2","readonly","",1,"form-control"],["type","text","formControlName","line3","readonly","",1,"form-control"],["type","text","formControlName","line4","readonly","",1,"form-control"],["type","text","formControlName","city","readonly","",1,"form-control"],["type","text","formControlName","state","readonly","",1,"form-control"],[1,"row","my-4","px-5"],["oninput","javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);","type","number","maxlength","6","formControlName","pinCode","readonly","",1,"form-control"],[1,"row","justify-content-between"],[1,"col"],["type","text","formControlName","country","readonly","",1,"form-control"]],template:function(o,t){1&o&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4,"Ship To Address"),e.qZA(),e.TgZ(5,"div")(6,"button",4),e.NdJ("click",function(){return t.activeModal.close(t.form.value)}),e._UZ(7,"i",5),e.qZA()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"label",11),e._uU(14," Address Line 1 "),e._UZ(15,"span",12),e.qZA(),e._UZ(16,"input",13),e.qZA(),e.TgZ(17,"div",10)(18,"label",11),e._uU(19," Address Line 2 "),e._UZ(20,"span",12),e.qZA(),e._UZ(21,"input",14),e.qZA()(),e.TgZ(22,"div",9)(23,"div",10)(24,"label",11),e._uU(25," Address Line 3 "),e._UZ(26,"span",12),e.qZA(),e._UZ(27,"input",15),e.qZA(),e.TgZ(28,"div",10)(29,"label",11),e._uU(30," Address Line 4 "),e._UZ(31,"span",12),e.qZA(),e._UZ(32,"input",16),e.qZA()(),e.TgZ(33,"div",9)(34,"div",10)(35,"label",11),e._uU(36," City/District "),e._UZ(37,"span",12),e.qZA(),e._UZ(38,"input",17),e.qZA(),e.TgZ(39,"div",10)(40,"label",11),e._uU(41," State/Province "),e._UZ(42,"span",12),e.qZA(),e._UZ(43,"input",18),e.qZA()(),e.TgZ(44,"div",19)(45,"div",10)(46,"label",11),e._uU(47," Pin Code "),e._UZ(48,"span",12),e.qZA(),e._UZ(49,"input",20),e.qZA(),e.TgZ(50,"div",10)(51,"div",21)(52,"div",22)(53,"label",11),e._uU(54,"Country "),e._UZ(55,"span",12),e.qZA(),e._UZ(56,"input",23),e.qZA()()()()()()()()()),2&o&&e.Q6J("formGroup",t.form)},dependencies:[n._Y,n.Fj,n.wV,n.JJ,n.JL,n.nD,n.sg,n.u],encapsulation:2}),c})();function ae(i,c){if(1&i&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&i){const s=c.$implicit;e.Q6J("value",s.value),e.xp6(1),e.hij(" ",s.label," ")}}function ne(i,c){if(1&i&&(e.TgZ(0,"div",18)(1,"select",32)(2,"option",20),e._uU(3,"Select Payment Terms"),e.qZA(),e.YNc(4,ae,2,2,"option",21),e.qZA()()),2&i){const s=e.oxw();e.xp6(2),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",s.SOTermsArr.paymentTermsArr)}}function le(i,c){1&i&&(e.TgZ(0,"div",18),e._UZ(1,"input",34),e.qZA())}function Y(i,c){if(1&i&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&i){const s=c.$implicit;e.Q6J("value",s.parameterName),e.xp6(1),e.hij(" ",s.parameterLabel," ")}}function L(i,c){if(1&i&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&i){const s=c.$implicit;e.Q6J("value",s.value),e.xp6(1),e.hij(" ",s.label," ")}}function ce(i,c){if(1&i&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&i){const s=c.$implicit;e.Q6J("value",s.value),e.xp6(1),e.hij(" ",s.label," ")}}function ue(i,c){1&i&&e._UZ(0,"hr",35)}function de(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.dismissModel())}),e._uU(1," Save "),e.qZA()}}const J=function(){return["create"]};let K=(()=>{var i;class c{get f(){return this.form.controls}constructor(o,t){this.activeModal=o,this.validationService=t,this.action="",this.POTerms={},this.SOTermsArr={},this.SOTermsData={},this.otherCharges={},this.clickCount=1,this.showSelect=!1,this.form=new n.nJ({paymentTerms:new n.p4(null,[n.kI.required]),frightTerms:new n.p4("FOR - Free On Road"),transporter:new n.p4(null,[n.kI.required]),destination:new n.p4(null,[n.kI.required]),modeOfTransport:new n.p4(null,[n.kI.required])})}ngOnInit(){this.SOTermsArr?.paymentTermsArr.some(t=>t.label==this.SOTermsData.changedPaymentTerms)||(this.showSelect=!0,this.clickCount=0),"create"==this.action&&(this.showSelect=!1,this.clickCount=1),this.form.patchValue(this.SOTermsData),["approval","rejection","view","generate","cancel"].includes(this.action)&&this.form.disable()}dismissModel(){this.validationService.checkErrors(this.form,v.RS)||this.activeModal.close(this.form.value)}enablePaymentTerms(){this.clickCount++,this.showSelect=this.clickCount%2==0}enableFreightTerms(){["create","edit"].includes(this.action)&&this.form.controls.frightTerms.enable()}}return(i=c).\u0275fac=function(o){return new(o||i)(e.Y36(g.Kz),e.Y36(S.RJ))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-drn-review-terms"]],inputs:{action:"action",POTerms:"POTerms",SOTermsArr:"SOTermsArr",SOTermsData:"SOTermsData",otherCharges:"otherCharges"},decls:78,vars:14,consts:[[3,"formGroup"],[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid"],[1,"row","justify-content-center"],[1,"col-10","px-5","mt-5"],[1,"row"],[1,"col-3","mt-1","pe-0"],[1,"form-label"],[1,"text-danger"],[1,"col-auto","mt-1","px-0"],[1,"fa","fa-caret-right","text-secondary"],["class","col-7 ps-0",4,"ngIf"],[1,"col-1","assetChange","mt-1","pointer",3,"click"],[1,"row","mt-5"],[1,"col-7","ps-0"],["type","text","formControlName","frightTerms",1,"form-select","fs-5"],["selected","","disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"col-1","ps-0"],[1,"form-label","text-nowrap"],[1,"fa","fa-caret-right","mt-1","text-secondary"],["type","text","formControlName","modeOfTransport",1,"form-select","fs-5"],["type","text","formControlName","transporter",1,"form-select","fs-5"],["type","text","formControlName","destination",1,"form-control"],[1,"col","px-0","mt-5","mb-4"],["class","line-border",4,"ngIf"],[1,"text-center","my-2"],["class","btn bg-primary px-5 mb-4","type","button",3,"click",4,"ngIf"],["type","text","formControlName","paymentTerms",1,"form-select","fs-5"],[3,"value"],["type","text","formControlName","paymentTerms",1,"form-control"],[1,"line-border"],["type","button",1,"btn","bg-primary","px-5","mb-4",3,"click"]],template:function(o,t){1&o&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4,"SO Terms"),e.qZA(),e.TgZ(5,"div")(6,"button",4),e.NdJ("click",function(){return t.activeModal.close(null)}),e._UZ(7,"i",5),e.qZA()()(),e.TgZ(8,"form",0)(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"label",11),e._uU(15,"Payment Terms "),e.TgZ(16,"span",12),e._uU(17,"*"),e.qZA()()(),e.TgZ(18,"div",13),e._UZ(19,"i",14),e.qZA(),e.YNc(20,ne,5,2,"div",15),e.YNc(21,le,2,0,"div",15),e.TgZ(22,"div",16),e.NdJ("click",function(){return t.enablePaymentTerms()}),e.qZA()(),e.TgZ(23,"div",17)(24,"div",10)(25,"label",11),e._uU(26," Freight Terms "),e.TgZ(27,"span",12),e._uU(28,"*"),e.qZA()()(),e.TgZ(29,"div",13),e._UZ(30,"i",14),e.qZA(),e.TgZ(31,"div",18)(32,"select",19)(33,"option",20),e._uU(34,"Select Freight Terms"),e.qZA(),e.YNc(35,Y,2,2,"option",21),e.qZA()(),e._UZ(36,"div",22),e.qZA(),e.TgZ(37,"div",17)(38,"div",10)(39,"label",23),e._uU(40,"Mode of transport "),e.TgZ(41,"span",12),e._uU(42,"*"),e.qZA()()(),e.TgZ(43,"div",13),e._UZ(44,"i",24),e.qZA(),e.TgZ(45,"div",18)(46,"select",25)(47,"option",20),e._uU(48,"Select Mode of transport"),e.qZA(),e.YNc(49,L,2,2,"option",21),e.qZA()()(),e.TgZ(50,"div",17)(51,"div",10)(52,"label",23),e._uU(53,"Transporter Name "),e.TgZ(54,"span",12),e._uU(55,"*"),e.qZA()()(),e.TgZ(56,"div",13),e._UZ(57,"i",14),e.qZA(),e.TgZ(58,"div",18)(59,"select",26)(60,"option",20),e._uU(61,"Select Transporter Name"),e.qZA(),e.YNc(62,ce,2,2,"option",21),e.qZA()()(),e.TgZ(63,"div",17)(64,"div",10)(65,"label",23),e._uU(66,"Destination/Port "),e.TgZ(67,"span",12),e._uU(68,"*"),e.qZA()()(),e.TgZ(69,"div",13),e._UZ(70,"i",14),e.qZA(),e.TgZ(71,"div",18),e._UZ(72,"input",27),e.qZA()()()(),e.TgZ(73,"div",9)(74,"div",28),e.YNc(75,ue,1,0,"hr",29),e.qZA()(),e.TgZ(76,"div",30),e.YNc(77,de,2,0,"button",31),e.qZA()()()()()),2&o&&(e.Q6J("formGroup",t.form),e.xp6(8),e.Q6J("formGroup",t.form),e.xp6(12),e.Q6J("ngIf",!t.showSelect),e.xp6(1),e.Q6J("ngIf",t.showSelect),e.xp6(12),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",t.SOTermsArr.freightTerms),e.xp6(12),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",t.SOTermsArr.modeOfTransport),e.xp6(11),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",t.SOTermsArr.transporterArr),e.xp6(13),e.Q6J("ngIf",e.DdM(12,J).includes(t.action)),e.xp6(2),e.Q6J("ngIf",e.DdM(13,J).includes(t.action)))},dependencies:[r.sg,r.O5,n._Y,n.YN,n.Kr,n.Fj,n.EJ,n.JJ,n.JL,n.sg,n.u],styles:[".fa-caret-right[_ngcontent-%COMP%]{font-size:2rem!important;margin-right:2rem!important;margin-left:2rem!important}.assetChange[_ngcontent-%COMP%]{background-color:transparent;background-image:url(Asset_change.a4234ac185c40591.svg);background-size:100% 100%;border:0;color:#fff;height:2.2rem;width:2.2rem}"]}),c})();var pe=d(83344);function me(i,c){if(1&i&&(e.TgZ(0,"option",29),e._uU(1),e.qZA()),2&i){const s=c.$implicit;e.Q6J("value",s.value),e.xp6(1),e.hij(" ",s.label," ")}}function he(i,c){if(1&i&&(e.TgZ(0,"option",29),e._uU(1),e.qZA()),2&i){const s=c.$implicit;e.Q6J("value",s.value),e.xp6(1),e.hij(" ",s.label," ")}}function V(i,c){1&i&&e._UZ(0,"hr",30)}function B(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"div",31)(1,"button",32),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.reset())}),e._uU(2,"Reset"),e.qZA(),e.TgZ(3,"button",33),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.dismissModel())}),e._uU(4," Save & Close "),e.qZA()()}}const _e=function(){return["create"]};let Ce=(()=>{var i;class c{constructor(o,t,l){this.activeModal=o,this.validationService=t,this.utilityService=l,this.ExportDetailsData={},this.exportDetailsArray=[],this.action="",this.customerCurrency="",this.form=new n.nJ({exportsInvoiceNo:new n.p4(null,[n.kI.required]),exportsInvoiceDate:new n.p4(this.utilityService.getTodayDate("YYYY-MM-DD"),[n.kI.required]),exportsInvoiceTotalValue:new n.p4(null,[n.kI.required]),exchangeRate:new n.p4(null,[n.kI.required]),modeOfTransport:new n.p4(null,[n.kI.required]),frightTerms:new n.p4(null,[n.kI.required]),destination:new n.p4(null,[n.kI.required]),finalDestination:new n.p4(null,[n.kI.required])})}ngOnInit(){this.form.patchValue(this.ExportDetailsData),"create"!=this.action&&this.form.disable()}reset(){this.form.patchValue(this.ExportDetailsData)}dismissModel(){this.validationService.checkErrors(this.form,v.OV)||this.activeModal.close(this.form.value)}}return(i=c).\u0275fac=function(o){return new(o||i)(e.Y36(g.Kz),e.Y36(S.RJ),e.Y36(m.tI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-drn-export-details"]],inputs:{ExportDetailsData:"ExportDetailsData",exportDetailsArray:"exportDetailsArray",action:"action",customerCurrency:"customerCurrency"},decls:80,vars:13,consts:[[3,"formGroup"],[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid","mt-4","mb-3"],[1,"row"],[1,"col-12","px-0"],[1,"row","mb-4","px-5"],[1,"col-3"],[1,"form-label"],[1,"text-danger"],["type","text","formControlName","exportsInvoiceNo",1,"form-control"],["type","date","formControlName","exportsInvoiceDate",1,"form-control"],[1,"d-flex"],[1,"input-group-text","text-secondary","combine-INR"],[1,"vr","ms-3"],["type","number","formControlName","exportsInvoiceTotalValue",1,"form-control","border-start-0"],["type","number","formControlName","exchangeRate",1,"form-control","border-start-0"],["type","text","formControlName","modeOfTransport",1,"form-select","fs-5"],["selected","","disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","frightTerms",1,"form-select","fs-5"],["type","text","formControlName","destination",1,"form-control"],["type","text","formControlName","finalDestination",1,"form-control"],[1,"col","px-0"],["class","line-border",4,"ngIf"],["class","text-center my-4",4,"ngIf"],[3,"value"],[1,"line-border"],[1,"text-center","my-4"],[1,"btn","btn-primary","px-5","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-3",3,"click"]],template:function(o,t){1&o&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4,"Export Details"),e.qZA(),e.TgZ(5,"div")(6,"button",4),e.NdJ("click",function(){return t.activeModal.close()}),e._UZ(7,"i",5),e.qZA()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"label",11),e._uU(14," Export Invoice No. "),e.TgZ(15,"span",12),e._uU(16,"*"),e.qZA()(),e._UZ(17,"input",13),e.qZA(),e.TgZ(18,"div",10)(19,"label",11),e._uU(20," Export Invoice Date "),e.TgZ(21,"span",12),e._uU(22,"*"),e.qZA()(),e._UZ(23,"input",14),e.qZA(),e.TgZ(24,"div",10)(25,"label",11),e._uU(26," Export Invoice Total Value "),e.TgZ(27,"span",12),e._uU(28,"*"),e.qZA()(),e.TgZ(29,"div",15)(30,"span",16),e._uU(31),e._UZ(32,"div",17),e.qZA(),e._UZ(33,"input",18),e.qZA()(),e.TgZ(34,"div",10)(35,"label",11),e._uU(36," Exchange Rate "),e.TgZ(37,"span",12),e._uU(38,"*"),e.qZA()(),e.TgZ(39,"div",15)(40,"span",16),e._uU(41),e.ALo(42,"companyCurrency"),e._UZ(43,"div",17),e.qZA(),e._UZ(44,"input",19),e.qZA()()(),e.TgZ(45,"div",9)(46,"div",10)(47,"label",11),e._uU(48," Mode of transport"),e.TgZ(49,"span",12),e._uU(50,"*"),e.qZA()(),e.TgZ(51,"select",20)(52,"option",21),e._uU(53,"Select Mode of transport"),e.qZA(),e.YNc(54,me,2,2,"option",22),e.qZA()(),e.TgZ(55,"div",10)(56,"label",11),e._uU(57," Freight Terms "),e.TgZ(58,"span",12),e._uU(59,"*"),e.qZA()(),e.TgZ(60,"select",23)(61,"option",21),e._uU(62,"Select Freight Terms"),e.qZA(),e.YNc(63,he,2,2,"option",22),e.qZA()(),e.TgZ(64,"div",10)(65,"label",11),e._uU(66," Port of Destination"),e.TgZ(67,"span",12),e._uU(68,"*"),e.qZA()(),e._UZ(69,"input",24),e.qZA(),e.TgZ(70,"div",10)(71,"label",11),e._uU(72," Final Destination "),e.TgZ(73,"span",12),e._uU(74,"*"),e.qZA()(),e._UZ(75,"input",25),e.qZA()(),e.TgZ(76,"div",7)(77,"div",26),e.YNc(78,V,1,0,"hr",27),e.qZA()(),e.YNc(79,B,5,0,"div",28),e.qZA()()()()()),2&o&&(e.Q6J("formGroup",t.form),e.xp6(31),e.hij(" ",t.customerCurrency," "),e.xp6(10),e.hij(" ",e.lcZ(42,9,"INR")," "),e.xp6(11),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",t.exportDetailsArray.modeOfTransport),e.xp6(7),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",t.exportDetailsArray.freightTerms),e.xp6(15),e.Q6J("ngIf",e.DdM(11,_e).includes(t.action)),e.xp6(1),e.Q6J("ngIf",e.DdM(12,_e).includes(t.action)))},dependencies:[r.sg,r.O5,n._Y,n.YN,n.Kr,n.Fj,n.wV,n.EJ,n.JJ,n.JL,n.sg,n.u,pe.f],encapsulation:2}),c})();var j=d(77203),H=d(50363),z=d(95346),ge=d(84231);function ye(i,c){if(1&i&&(e.TgZ(0,"option",57),e._uU(1),e.qZA()),2&i){const s=c.$implicit;e.Q6J("value",s.value),e.xp6(1),e.hij(" ",s.label," ")}}function fe(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td",58,59)(10,"span",60),e._uU(11),e.qZA()(),e.TgZ(12,"td",58,61)(14,"span",60),e._uU(15),e.qZA()(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"SalesUOMUnitMaster"),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.ALo(23,"number"),e.qZA(),e.TgZ(24,"td"),e._uU(25),e.ALo(26,"date"),e.qZA(),e.TgZ(27,"td",62)(28,"Button",63),e.NdJ("click",function(){const l=e.CHM(s).$implicit,a=e.oxw();return e.KtG(a.openFGStockModal(l))}),e._uU(29," Select "),e.qZA()(),e.TgZ(30,"td"),e._uU(31),e.ALo(32,"number"),e.qZA()()}if(2&i){const s=c.$implicit,o=e.MAs(9),t=e.MAs(13);e.xp6(2),e.Oqu(null==s?null:s.SONumber),e.xp6(2),e.Oqu(e.xi3(5,18,null==s?null:s.SODate,"dd-MM-YYYY")),e.xp6(3),e.Oqu(null==s?null:s.SKUNo),e.xp6(1),e.Udp("width",o.clientWidth),e.xp6(2),e.Q6J("positionTarget",o)("ngbTooltip",s.SKUName),e.xp6(1),e.hij(" ",null==s?null:s.SKUName," "),e.xp6(1),e.Udp("width",t.clientWidth),e.xp6(2),e.Q6J("positionTarget",t)("ngbTooltip",s.SKUDescription),e.xp6(1),e.hij(" ",null==s?null:s.SKUDescription," "),e.xp6(2),e.Oqu(e.lcZ(18,21,null==s?null:s.UOM)),e.xp6(3),e.Oqu(null==s?null:s.DRNLineNumber),e.xp6(2),e.Oqu(e.xi3(23,23,null==s?null:s.SOBalancedQty,".2-2")),e.xp6(3),e.Oqu(e.xi3(26,26,null==s?null:s.plannedDispatchDt,"dd-MM-YYYY")),e.xp6(6),e.hij(" ",e.xi3(32,29,null==s?null:s.dispatchQty,".2-2")," ")}}function $(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"button",64),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.openDRNReviewTermsModal())}),e._uU(1," Review Terms "),e.qZA()}}function X(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"button",65),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.openExportDetailsModal())}),e._uU(1," Export Details "),e.qZA()}}function De(i,c){1&i&&e._UZ(0,"div",66)}function Te(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"div",69)(1,"div",70)(2,"button",71),e.NdJ("click",function(){e.CHM(s);const t=e.oxw(2);return e.KtG(t.reset())}),e._uU(3,"Reset"),e.qZA(),e.TgZ(4,"button",72),e.NdJ("click",function(){e.CHM(s);const t=e.oxw(2);return e.KtG(t.ESCPreview())}),e._uU(5," Esc "),e.qZA(),e.TgZ(6,"button",73),e.NdJ("click",function(){e.CHM(s);const t=e.oxw(2);return e.KtG(t.preview())}),e._uU(7,"Preview"),e.qZA(),e.TgZ(8,"button",74),e.NdJ("click",function(){e.CHM(s);const t=e.oxw(2);return e.KtG(t.submit())}),e._uU(9," Save "),e.qZA()()()}if(2&i){const s=e.oxw(2);e.xp6(4),e.Q6J("disabled",!s.isESCPreview),e.xp6(4),e.Q6J("disabled",!s.isPreview)}}const W=function(){return["create"]};function ee(i,c){if(1&i&&(e.TgZ(0,"div",67),e.YNc(1,Te,10,2,"div",68),e.qZA()),2&i){const s=e.oxw();e.xp6(1),e.Q6J("ngIf",e.DdM(1,W).includes(s.action))}}function te(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"div",67)(1,"div",69)(2,"div",70)(3,"button",75),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.submit())}),e._uU(4,"Approve"),e.qZA()()()()}}function Se(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"div",76)(1,"button",75),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.submit())}),e._uU(2,"Save"),e.qZA()()}}function Ae(i,c){1&i&&(e.TgZ(0,"div",77)(1,"span",78),e._uU(2,"Reason for Cancellation"),e.qZA(),e._UZ(3,"input",79),e.qZA())}function Re(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"div",80)(1,"button",75),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.openCancelModal())}),e._uU(2,"Cancel"),e.qZA()()}}function oe(i,c){1&i&&(e.TgZ(0,"div",81)(1,"span",78),e._uU(2," Remark"),e.qZA(),e._UZ(3,"input",82),e.qZA())}function se(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"div",83)(1,"button",75),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.submit())}),e._uU(2,"Reject"),e.qZA()()}}const Ne=function(i,c,s,o){return{page:i,pageSize:c,collection:s,search:o,excelDisplay:"none"}},ve=function(){return["cancel","rejection"]},u=function(){return["view"]},Ze=function(){return["approval"]};let qe=(()=>{var i;class c{constructor(o,t,l,a,_,h,k,Ie){this.dispatchRequestNoteService=o,this.activatedRoute=t,this.spinner=l,this.toastService=a,this.validationService=_,this.modalService=h,this.utilityService=k,this.location=Ie,this.DRNDetailsArray=[],this.customerOptions=[],this.customers=[],this.page=1,this.pageSize=6,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.submitted=!1,this.isPreview=!1,this.action="create",this.ESCPreviewArr=[],this.shipToArr=[],this.isESCPreview=!1,this.statusArr={create:"Created",edit:"Created",approval:"Approved",cancel:"Cancelled",rejection:"Rejected"},this.customerCurrency="INR",this.masterData={autoIncrementNo:"",freightTermsOptions:[],modeOfTransportOptions:[],paymentTermsOptions:[],salesCategoryOptions:[],transporterOptions:[],customersOptions:[]},this.selectedCustomerDetails={},this.form=new n.nJ({_id:new n.p4(null),DRNNumber:new n.p4(null),DRNDate:new n.p4(""),salesCategory:new n.p4(null,[n.kI.required]),customer:new n.p4(null,[n.kI.required]),DRNDetails:new n.p4([]),remarks:new n.p4(null),DRNStatus:new n.p4("Created"),customerShippingAddress:new n.nJ({contactPersonName:new n.p4(null),line1:new n.p4(null),line2:new n.p4(null),line3:new n.p4(null),line4:new n.p4(null),pinCode:new n.p4(null),city:new n.p4(null),state:new n.p4(null),country:new n.p4(null)}),exportsInfo:new n.nJ({exportsInvoiceNo:new n.p4(null),exportsInvoiceDate:new n.p4(this.utilityService.getTodayDate("YYYY-MM-DD")),exportsInvoiceTotalValue:new n.p4(null),exchangeRate:new n.p4(null),finalDestination:new n.p4(null)}),paymentTerms:new n.p4(null),modeOfTransport:new n.p4(null,[n.kI.required]),frightTerms:new n.p4("FOR - Free On Road"),transporter:new n.p4(null),destination:new n.p4(null,[n.kI.required]),cancellationReason:new n.p4(null)})}get f(){return this.form.controls}get shipToAddress(){return this.form.get("customerShippingAddress")}get exportsInfo(){return this.form.get("exportsInfo")}trackByFn(o,t){return t?._id}submit(){if(this.submitted=!0,this.isPreview=!1,"cancel"==this.action&&!this.f.cancellationReason.value)return void this.toastService.warning("Reason for Cancellation is Required");if(this.form.enable(),this.validationService.checkErrors(this.form,v.HQ))return;if("rejection"==this.action&&!this.form.controls.remarks.value)return void this.toastService.warning("Reject Remark is Required");if(0==this.DRNDetailsArray.length)return void this.toastService.warning("Atleast one row is Required");let o=this.form.value;o.DRNDetails=this.DRNDetailsArray.filter(t=>t.dispatchQty>0),o._id?this.update(o):(delete o._id,this.create(o))}ngOnInit(){this.getInitialData()}update(o){this.spinner.show(),this.dispatchRequestNoteService.update(o._id,o).subscribe(t=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(t.message),this.location.back()})}create(o){this.spinner.show(),this.dispatchRequestNoteService.create(o).subscribe(t=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(t.message),this.location.back()})}ESCPreview(){this.search="",this.isPreview=!1,this.DRNDetailsArray=this.ESCPreviewArr,this.collection=this.DRNDetailsArray.length}preview(){this.search="",this.isESCPreview=!0,this.ESCPreviewArr=this.DRNDetailsArray,this.DRNDetailsArray=this.DRNDetailsArray.filter(o=>o.dispatchQty>0),this.DRNDetailsArray.length&&(this.isPreview=!0),this.collection=this.DRNDetailsArray.length}reset(){this.form.reset(),this.customerOptions=[],this.DRNDetailsArray=[],this.shipToArr=[],this.collection=this.DRNDetailsArray.length,this.getInitialData()}getInitialData(){this.spinner.show(),this.dispatchRequestNoteService.getAllMasterData({}).subscribe(o=>{this.masterData=o,this.form.controls.DRNNumber.setValue(this.masterData?.autoIncrementNo),this.form.controls.frightTerms.setValue("FOR - Free On Road"),this.f.DRNDate.setValue(this.utilityService.getTodayDate("YYYY-MM-DD")),this.form.controls.DRNStatus.setValue(this.statusArr[this.action]),this.activatedRoute.queryParams.pipe((0,F.z)(t=>(this.action=t.action,this.utilityService.accessDenied(this.action),t.id?this.dispatchRequestNoteService.getById(t.id):(0,I.of)({})))).subscribe(t=>{this.spinner.hide(),0!=Object.keys(t).length&&(this.DRNDetailsArray=t.DRNDetails,t.DRNDate&&(t.DRNDate=this.utilityService.getFormatDate(t.DRNDate,"YYYY-MM-DD")),t.exportsInfo&&t.exportsInfo.exportsInvoiceDate&&(t.exportsInfo.exportsInvoiceDate=this.utilityService.getFormatDate(t.exportsInfo.exportsInvoiceDate,"YYYY-MM-DD")),this.customerCurrency=this.masterData?.customersOptions.find(l=>l?.customerName==t?.customer?.customerName)?.customerCurrency,t.customer=t.customer._id,this.customerOptions=this.masterData?.customersOptions.filter(l=>l.salesCategory==t.customerCategory),this.collection=this.DRNDetailsArray.length,t.DRNStatus=this.statusArr[this.action],this.form.patchValue(t),("edit"==this.action||"view"==this.action||"rejection"==this.action||"approval"==this.action||"cancel"==this.action)&&(this.form.disable(),this.form.controls.remarks.enable(),this.f.cancellationReason.enable()))})})}eventHeader(o){switch(o.key){case"SEARCH":this.search=o.value,this.page=1;break;case"EXCEL":default:break;case"PAGE":this.page=o.value}}onSort({column:o,direction:t}){this.headers.forEach(l=>{l.sortable!==o&&(l.direction="")}),this.DRNDetailsArray=""===t||""===o?this.DRNDetailsArray:[...this.DRNDetailsArray].sort((l,a)=>{let _="string"==typeof l[o]?l[o].toLowerCase():l[o],h="string"==typeof a[o]?a[o].toLowerCase():a[o];const k=_<h?-1:_>h?1:0;return"asc"===t?k:-k})}customerValueChange(o){this.form.controls.paymentTerms.setValue(o?.customerPaymentTerms),this.shipToAddress.controls.contactPersonName.setValue(null),this.customerCurrency=o?.customerCurrency??"INR",this.shipToArr=o?.customerShippingAddress,this.spinner.show(),this.dispatchRequestNoteService.getDRNDetailsByCustomerId(o._id).subscribe(t=>{this.DRNDetailsArray=t,this.collection=this.DRNDetailsArray.length,this.spinner.hide()})}getCustomers(){this.f.customer.setValue(null),this.DRNDetailsArray=[],this.customerOptions=this.masterData?.customersOptions.filter(o=>o.customerCategory==this.f.salesCategory.value)}checkDispatchQty(o){let t=this.DRNDetailsArray.map(a=>a.DRNLineNumber).indexOf(o.DRNLineNumber);if(this.DRNDetailsArray.filter(a=>a.FGINId==o?.FGINId).map(a=>a.dispatchQty).reduce((a,_)=>a+_,0)>o?.FGINQty)return this.DRNDetailsArray[t].FGINMfgDate="",this.DRNDetailsArray[t].dispatchQty=0,this.DRNDetailsArray=[...this.DRNDetailsArray],void this.toastService.error("Dispatch Qty. should not be greater than FGIN Qty.");o.dispatchQty>o.SOBalancedQty&&(this.toastService.error("Dispatch Qty should not be greater then SO Balanced Qty"),this.DRNDetailsArray[t].dispatchQty=0),o.dispatchQty>o.FGINQty&&(this.toastService.error("Dispatch Qty should not be greater then FGIN Qty"),this.DRNDetailsArray[t].dispatchQty=0)}setFGINQty(o,t){let l=t.FGINOptions.find(h=>h._id==o.target.value),a=this.DRNDetailsArray.map(h=>h.DRNLineNumber).indexOf(t.DRNLineNumber);if(this.DRNDetailsArray.filter(h=>h.FGINId==l?._id).map(h=>h.dispatchQty).reduce((h,k)=>h+k,0)>l?.FGINQuantity)return this.DRNDetailsArray[a].FGINMfgDate="",void this.toastService.error("FGIN Qty should not be greater then Dispatch Qty of that batch.");this.DRNDetailsArray[a].FGINId=l?._id,this.DRNDetailsArray[a].FGINQty=l?.FGINQuantity,this.DRNDetailsArray[a].FGINMfgDate=l?.manufacturingDate}setShipToAddress(o){this.shipToAddress.patchValue(o)}openShipToAddressModal(){const o=this.modalService.open(G,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});o.componentInstance.action=this.action,o.componentInstance.customerShippingAddress=this.shipToAddress.value,o.result.then(t=>{t&&["create","edit"].includes(this.action)},t=>{})}openDRNReviewTermsModal(){const o=this.modalService.open(K,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});o.componentInstance.action=this.action,o.componentInstance.SOTermsArr={transporterArr:this.masterData?.transporterOptions,freightTerms:this.masterData?.freightTermsOptions,modeOfTransport:this.masterData?.modeOfTransportOptions,paymentTermsArr:this.masterData?.paymentTermsOptions},o.componentInstance.SOTermsData={paymentTerms:this.form.controls.paymentTerms.value,modeOfTransport:this.form.controls.modeOfTransport.value,frightTerms:this.form.controls.frightTerms.value,transporter:this.form.controls.transporter.value,destination:this.form.controls.destination.value},o.result.then(t=>{t&&["create","edit"].includes(this.action)&&this.form.patchValue(t)},t=>{})}openExportDetailsModal(){const o=this.modalService.open(Ce,{centered:!0,size:"xl",backdrop:"static",keyboard:!1});o.componentInstance.action=this.action,o.componentInstance.customerCurrency=this.customerCurrency,o.componentInstance.exportDetailsArray={freightTerms:this.masterData?.freightTermsOptions,modeOfTransport:this.masterData?.modeOfTransportOptions},o.componentInstance.ExportDetailsData={...this.exportsInfo.value,modeOfTransport:this.form.controls.modeOfTransport.value,frightTerms:this.form.controls.frightTerms.value,destination:this.form.controls.destination.value},o.result.then(t=>{t&&["create","edit"].includes(this.action)&&(this.form.patchValue(t),this.exportsInfo.patchValue(t))},t=>{})}openFGStockModal(o){let t=this.DRNDetailsArray.findIndex(a=>a.DRNLineNumber==o.DRNLineNumber&&a.SONumber==o.SONumber&&a.SKUNo==o.SKUNo);const l=this.modalService.open(re,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});l.componentInstance.action=this.action,l.componentInstance.data=o,l.componentInstance.totalDispatchQty=o.totalDispatchQty,l.componentInstance.tBatchNo=o.tBatchNo,l.result.then(a=>{a&&(this.DRNDetailsArray[t].FGStockDetails=a.FGStockDetails,this.DRNDetailsArray[t].tBatchNo=a.tBatchNo,this.DRNDetailsArray[t].totalDispatchQty=a.totalDispatchQty,this.DRNDetailsArray[t].dispatchQty=a.totalDispatchQty)},a=>{})}openCustomersDetailsModal(){const o=this.modalService.open(j.e7,{centered:!0,size:"xl",backdrop:"static",keyboard:!1});o.componentInstance.action=this.action,o.componentInstance.selectedCustomerDetails=this.selectedCustomerDetails,o.componentInstance.customerOptions=this.customerOptions,o.componentInstance.customer=this.form.controls.customer.value,o.result.then(t=>{t&&(console.log("success",t),this.selectedCustomerDetails=t?.selectedCustomerDetails,this.form.controls.customer.setValue(t?.selectedCustomerDetails?._id),this.customerValueChange(this.selectedCustomerDetails))},t=>{})}openCancelModal(){const o=this.modalService.open(j.er,{centered:!0,size:"sm",backdrop:"static",keyboard:!1});o.componentInstance.action=this.action,o.componentInstance.heading="DRN Cancellation",o.componentInstance.cancelText="Do You Want to Cancel DRN ?",o.result.then(t=>{"Yes"==t&&this.submit()},t=>{})}}return(i=c).\u0275fac=function(o){return new(o||i)(e.Y36(T.lM),e.Y36(p.gz),e.Y36(m.V),e.Y36(m.kl),e.Y36(S.RJ),e.Y36(g.FF),e.Y36(m.tI),e.Y36(r.Ye))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-dispatch-request-note-form"]],viewQuery:function(o,t){if(1&o&&e.Gf(f.j,5),2&o){let l;e.iGM(l=e.CRH())&&(t.headers=l)}},decls:109,vars:46,consts:[[1,"formCard","card",3,"formGroup"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,"form-body"],[1,"row","mb-2"],[1,"col-6"],[1,"row"],[1,"col-4","pe-0"],[1,"form-label","mb-0"],[1,"text-danger"],["type","text","formControlName","DRNNumber","readonly","",1,"form-control"],[1,"col-3","pe-0"],["type","date","formControlName","DRNDate","readonly","",1,"form-control"],[1,"col-5"],["formControlName","salesCategory",1,"form-select",3,"change"],["selected","","disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"col-3","ps-0","pe-5"],[1,"d-flex","align-items-center"],[1,"col-11"],["bindLabel","customerName","bindValue","_id","formControlName","customer",3,"items","clearable","change"],["id","basic-addon1",1,"input-group-text","bg-primary","pointer","col-auto","fs-4",2,"height","2.9rem",3,"click"],["aria-hidden","true",1,"fa","fa-search","text-white"],["formGroupName","customerShippingAddress",1,"col-3","ps-0"],[1,"form-label","mb-0","d-flex","justify-content-between"],["type","button",1,"btn","btn-primary","px-3","form-btn-sm","py-0","mb-1",3,"click"],["bindLabel","contactPersonName","bindValue","contactPersonName","formControlName","contactPersonName",3,"items","clearable","change"],[1,"row","line-border"],[1,""],[3,"data","dataChange"],[1,"table-responsive","mt-0","text-wrap",2,"min-height","22rem"],[1,"table","table-bordered","mt-0","table-sticky"],[1,"bg-info"],[1,"text-white"],["sortable","SONumber",3,"sort"],["sortable","SODate",3,"sort"],["sortable","SKUNo",3,"sort"],["sortable","SKUName",1,"text-start",3,"sort"],["sortable","SKUDescription",1,"text-start",3,"sort"],["sortable","UOM",3,"sort"],["sortable","SOBalancedQty",3,"sort"],["sortable","",3,"sort"],["sortable","dispatchQty",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"row","d-flex","justify-content-center"],[3,"ngClass"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["class","btn btn-primary px-3","type","button",3,"click",4,"ngIf"],[1,"plusIconSvg","btn","btn-primary","ms-1"],["class","col-7",4,"ngIf"],["class","col-7 text-end",4,"ngIf"],["class","d-flex justify-content-center",4,"ngIf"],["class","d-flex inputGroup col-6 text-center",4,"ngIf"],["class","content-end col-3",4,"ngIf"],["class","d-flex inputGroup col-3 text-center",4,"ngIf"],["class","col-6 text-end",4,"ngIf"],[3,"value"],[1,"text-start"],["SKUName",""],[1,"pointer",3,"positionTarget","ngbTooltip"],["SKUDescription",""],[1,"align-self-center"],[1,"btn","btn-primary","btn-sm",2,"--bs-btn-padding-y","0rem",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-primary","px-3",3,"click"],[1,"col-7"],[1,"col-7","text-end"],["class","col-md-auto",4,"ngIf"],[1,"col-md-auto"],[1,"d-grid","gap-2","d-md-block"],["type","button",1,"btn","btn-primary","px-5","me-4",3,"click"],["type","button",1,"btn","btn-primary","me-1",3,"disabled","click"],["type","button",1,"btn","btn-primary","px-4","me-4",3,"click"],["type","button",1,"btn","btn-primary","px-5",3,"disabled","click"],["type","button",1,"btn","btn-primary","px-5",3,"click"],[1,"d-flex","justify-content-center"],[1,"d-flex","inputGroup","col-6","text-center"],[1,"input-group-text","text-white","bg-primary"],["type","text","formControlName","cancellationReason",1,"form-control"],[1,"content-end","col-3"],[1,"d-flex","inputGroup","col-3","text-center"],["type","text","formControlName","remarks",1,"form-control"],[1,"col-6","text-end"]],template:function(o,t){1&o&&(e.TgZ(0,"Form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label"),e._uU(5),e.ALo(6,"titlecase"),e.qZA()()(),e.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"label",9),e._uU(13," DRN No. "),e._UZ(14,"span",10),e.qZA(),e._UZ(15,"input",11),e.qZA(),e.TgZ(16,"div",12)(17,"label",9),e._uU(18," DRN Date "),e._UZ(19,"span",10),e.qZA(),e._UZ(20,"input",13),e.qZA(),e.TgZ(21,"div",14)(22,"label",9),e._uU(23," Customer Category "),e.TgZ(24,"span",10),e._uU(25,"*"),e.qZA()(),e.TgZ(26,"select",15),e.NdJ("change",function(){return t.getCustomers()}),e.TgZ(27,"option",16),e._uU(28,"Select Category"),e.qZA(),e.YNc(29,ye,2,2,"option",17),e.qZA()()()(),e.TgZ(30,"div",18)(31,"label",9),e._uU(32," Customer Name/Bill To "),e.TgZ(33,"span",10),e._uU(34,"*"),e.qZA()(),e.TgZ(35,"div",19)(36,"div",20)(37,"ng-select",21),e.NdJ("change",function(a){return t.customerValueChange(a)}),e.qZA()(),e.TgZ(38,"div",22),e.NdJ("click",function(){return t.openCustomersDetailsModal()}),e._UZ(39,"i",23),e.qZA()()(),e.TgZ(40,"div",24)(41,"label",25),e._uU(42," Ship To "),e.TgZ(43,"span",10),e._uU(44,"*"),e.qZA(),e._UZ(45,"span")(46,"span")(47,"span")(48,"span")(49,"span")(50,"span")(51,"span")(52,"span")(53,"span")(54,"span")(55,"span")(56,"span"),e.TgZ(57,"button",26),e.NdJ("click",function(){return t.openShipToAddressModal()}),e._uU(58," Address "),e.qZA()(),e.TgZ(59,"ng-select",27),e.NdJ("change",function(a){return t.setShipToAddress(a)}),e.qZA()()()(),e._UZ(60,"hr",28),e.TgZ(61,"div",29)(62,"app-setting-header",30),e.NdJ("dataChange",function(a){return t.eventHeader(a)}),e.qZA()(),e.TgZ(63,"div",31)(64,"table",32)(65,"thead",33)(66,"tr",34)(67,"th",35),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(68,"SO No."),e.qZA(),e.TgZ(69,"th",36),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(70,"SO Date"),e.qZA(),e.TgZ(71,"th",37),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(72,"SKU No."),e.qZA(),e.TgZ(73,"th",38),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(74),e.ALo(75,"labelTranslate"),e.qZA(),e.TgZ(76,"th",39),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(77),e.ALo(78,"labelTranslate"),e.qZA(),e.TgZ(79,"th",40),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(80,"UoM"),e.qZA(),e.TgZ(81,"th",40),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(82,"D/S"),e.qZA(),e.TgZ(83,"th",41),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(84,"SO Bal Qty"),e.qZA(),e.TgZ(85,"th",40),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(86,"Plan Disp Dt"),e.qZA(),e.TgZ(87,"th",42),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(88,"FG Stock"),e.qZA(),e.TgZ(89,"th",43),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(90,"Disp. Qty."),e.qZA()()(),e.TgZ(91,"tbody"),e.YNc(92,fe,33,32,"tr",44),e.ALo(93,"slice"),e.ALo(94,"searchFi1ter"),e.qZA()()(),e._UZ(95,"hr",28),e.TgZ(96,"div",45)(97,"div",46),e.YNc(98,$,2,0,"button",47),e.YNc(99,X,2,0,"button",48),e._UZ(100,"button",49),e.qZA(),e.YNc(101,De,1,0,"div",50),e.YNc(102,ee,2,2,"div",51),e.YNc(103,te,5,0,"div",51),e.YNc(104,Se,3,0,"div",52),e.YNc(105,Ae,4,0,"div",53),e.YNc(106,Re,3,0,"div",54),e.YNc(107,oe,4,0,"div",55),e.YNc(108,se,3,0,"div",56),e.qZA()()()),2&o&&(e.Q6J("formGroup",t.form),e.xp6(5),e.hij(" ",e.lcZ(6,24,t.action)," DRN"),e.xp6(22),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",null==t.masterData?null:t.masterData.salesCategoryOptions),e.xp6(8),e.Q6J("items",t.customerOptions)("clearable",!1),e.xp6(22),e.Q6J("items",t.shipToArr)("clearable",!1),e.xp6(3),e.Q6J("data",e.l5B(37,Ne,t.page,t.pageSize,t.collection,t.search)),e.xp6(12),e.hij(" ",e.lcZ(75,26,"SKU Name")," "),e.xp6(3),e.hij(" ",e.lcZ(78,28,"SKU Description")," "),e.xp6(15),e.Q6J("ngForOf",e.Dn7(93,30,e.xi3(94,34,t.DRNDetailsArray,t.search),(t.page-1)*t.pageSize,(t.page-1)*t.pageSize+t.pageSize))("ngForTrackBy",t.trackByFn),e.xp6(5),e.Q6J("ngClass",e.DdM(42,ve).includes(t.action)?"col-3":"col-5"),e.xp6(1),e.Q6J("ngIf",!t.form.controls.salesCategory.value||(null==t.form.controls.salesCategory||null==t.form.controls.salesCategory.value?null:t.form.controls.salesCategory.value.includes("Domestic"))),e.xp6(1),e.Q6J("ngIf",null==t.form.controls.salesCategory||null==t.form.controls.salesCategory.value?null:t.form.controls.salesCategory.value.includes("Exports")),e.xp6(2),e.Q6J("ngIf",e.DdM(43,u).includes(t.action)),e.xp6(1),e.Q6J("ngIf",e.DdM(44,W).includes(t.action)),e.xp6(1),e.Q6J("ngIf",e.DdM(45,Ze).includes(t.action)),e.xp6(1),e.Q6J("ngIf","edit"==t.action),e.xp6(1),e.Q6J("ngIf","cancel"==t.action),e.xp6(1),e.Q6J("ngIf","cancel"==t.action),e.xp6(1),e.Q6J("ngIf","rejection"==t.action),e.xp6(1),e.Q6J("ngIf","rejection"==t.action))},dependencies:[r.mk,r.sg,r.O5,R.P,g._L,n.YN,n.Kr,n.Fj,n.EJ,n.JJ,n.JL,n.sg,n.u,n.x0,H.w9,f.j,r.OU,r.JJ,r.rS,r.uU,z.G,C.c,ge.Q],encapsulation:2}),c})();var be=d(56208),ke=d(65876);function Oe(i,c){if(1&i){const s=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",15,16)(9,"span",17),e._uU(10),e.qZA()(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td")(14,"div",18),e._UZ(15,"button",19),e.TgZ(16,"div",20)(17,"a",21),e.NdJ("click",function(){const l=e.CHM(s).$implicit,a=e.oxw();return e.KtG(a.navigateTo("../form",l,"cancel"))}),e._UZ(18,"i",22),e._uU(19," Cancel "),e.qZA()()()()()}if(2&i){const s=c.$implicit,o=e.MAs(8),t=e.oxw();e.xp6(2),e.Oqu(null==s?null:s.DRNNumber),e.xp6(2),e.Oqu(null==s?null:s.DRNDateS),e.xp6(2),e.Oqu(null==s?null:s.salesCategory),e.xp6(1),e.Udp("width",o.clientWidth),e.xp6(2),e.Q6J("positionTarget",o)("ngbTooltip",s.customerName),e.xp6(1),e.hij(" ",s.customerName," "),e.xp6(2),e.Oqu(s.DRNStatus),e.xp6(5),e.ekj("disable","Cancelled"==(null==s?null:s.DRNStatus)),e.Q6J("accessType",t.rolePermissionActions.approveAction)}}const xe=function(i,c,s,o){return{page:i,pageSize:c,collection:s,search:o,type:"list"}},Ue=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:Z},{path:"cancel_drn",component:(()=>{var i;class c{constructor(o,t,l,a,_,h){this.exportExcelService=o,this.dispatchRequestNoteService=t,this.router=l,this.spinner=a,this.activatedRoute=_,this.exportToPDFService=h,this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.rolePermissionActions=N.a1}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}navigateTo(o,t,l){this.router.navigate([o],{relativeTo:this.activatedRoute,queryParams:{id:t?._id,action:l}})}trackByFn(o,t){return t?._id}eventHeader(o){switch(o.key){case"SEARCH":this.search=o.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=o.value,this.getAll()}}getAll(o=!1,t=""){this.spinner.show();let l={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:o};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.dispatchRequestNoteService.getAllForCancel(l).subscribe(a=>{"EXCEL"==t?this.excelDownload(a.rows):"PDF"==t?this.pdfDownload(a.rows):(this.tableData=a.rows,this.collection=a.count,this.spinner.hide())})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}pdfDownload(o){let t=(0,D.Kr)(o);this.exportToPDFService.generatePdf(t.tableData,t.title)}excelDownload(o){this.exportExcelService.exportExcel((0,D.n8)(o))}onSort({column:o,direction:t}){this.headers.forEach(l=>{l.sortable!==o&&(l.direction="")}),this.column=o,this.direction="asc"==t?1:-1,this.getAll()}}return(i=c).\u0275fac=function(o){return new(o||i)(e.Y36(m.Ol),e.Y36(T.lM),e.Y36(p.F0),e.Y36(m.V),e.Y36(p.gz),e.Y36(m.$L))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-cancel-drn"]],viewQuery:function(o,t){if(1&o&&e.Gf(f.j,5),2&o){let l;e.iGM(l=e.CRH())&&(t.headers=l)}},decls:24,vars:8,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-info"],[1,"text-white"],["sortable","DRNNumber",3,"sort"],["sortable","DRNDateS",3,"sort"],["sortable","salesCategory",3,"sort"],["sortable","customerName",1,"text-start",3,"sort"],["sortable","DRNStatus",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["customerName",""],[1,"pointer",3,"positionTarget","ngbTooltip"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-close","fa-lg","text-primary"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"Cancellation DRN Summary"),e.qZA()(),e._UZ(4,"hr",3),e.TgZ(5,"div",4)(6,"app-setting-header",5),e.NdJ("dataChange",function(a){return t.eventHeader(a)}),e.qZA(),e.TgZ(7,"table",6)(8,"thead",7)(9,"tr",8)(10,"th",9),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(11,"DRN No."),e.qZA(),e.TgZ(12,"th",10),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(13,"DRN Date"),e.qZA(),e.TgZ(14,"th",11),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(15,"Customer Category"),e.qZA(),e.TgZ(16,"th",12),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(17,"Customer Name"),e.qZA(),e.TgZ(18,"th",13),e.NdJ("sort",function(a){return t.onSort(a)}),e._uU(19,"DRN Status"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Action"),e.qZA()()(),e.TgZ(22,"tbody"),e.YNc(23,Oe,20,12,"tr",14),e.qZA()()()()),2&o&&(e.xp6(6),e.Q6J("data",e.l5B(3,xe,t.page,t.pageSize,t.collection,t.search)),e.xp6(17),e.Q6J("ngForOf",t.tableData)("ngForTrackBy",t.trackByFn))},dependencies:[r.sg,R.P,g._L,f.j,A.J],encapsulation:2}),c})()},{path:"form",component:qe,resolve:{accessScreen:ke.x}}];let Fe=(()=>{var i;class c{}return(i=c).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[r.ez,p.Bz.forChild(Ue),be.m]}),c})()},13107:(O,y,d)=>{d.d(y,{t:()=>r});const r={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}}},28402:(O,y,d)=>{d.d(y,{J:()=>r});const r=({data:p,headers:f,widths:N,title:D})=>({tableData:{widths:N,headerRows:1,body:[f.map(T=>({text:T.header,style:"header"})),...p.map(T=>f.map(R=>({style:"subheader",text:T[R.key]})))]},title:D})},79250:(O,y,d)=>{d.d(y,{p3:()=>m,U$:()=>e,S$:()=>I,B6:()=>F,mx:()=>ue,mI:()=>ce,sb:()=>ie,PW:()=>b,Kr:()=>x,n8:()=>A,TP:()=>ne,_y:()=>ae,EY:()=>ve,X1:()=>Ne,zF:()=>ye,D$:()=>ge,ti:()=>Te,_g:()=>De,Rb:()=>me,xi:()=>pe,zm:()=>E,ji:()=>w});var r=d(13107),p=d(28402);let f=["*","*","*","*","*","*","*","*","*","*","*"],N="Book Sales Order",D=[{header:"SO No.",key:"SONumber",...r.t},{header:"SO Date",key:"SODateS",...r.t},{header:"Bill From Location",key:"billFromLocation",...r.t},{header:"Customer Category",key:"salesCategory",...r.t},{header:"Customer Name",key:"customerName",...r.t},{header:"PO Date.",key:"PODate",...r.t},{header:"Currency",key:"currency",...r.t},{header:"SO Type",key:"SOType",...r.t},{header:"SO Value",key:"SOTotalAmount",...r.t},{header:"Status",key:"SOStatus",...r.t}];const e=u=>({title:N,csvData:u,headers:D}),m=u=>(0,p.J)({data:u,headers:D,widths:f,title:N});let T=["*","*","*","*","*","*","*"],R="DispatchRequestNote Report",g=[{header:"DRN No.",key:"DRNNumber",...r.t},{header:"DRN Date",key:"DRNDateS",...r.t},{header:"Customer Category",key:"salesCategory",...r.t},{header:"Customer Name",key:"customerName",...r.t},{header:"DRN Status",key:"DRNStatus",...r.t}];const A=u=>({title:R,csvData:u,headers:g}),x=u=>(0,p.J)({data:u,headers:g,widths:T,title:R});let U=["*","*","*","*","*","*","*","*","*","*"],Z="Cancel SO",n=[{header:"SO No.",key:"SONumber",...r.t},{header:"SO Date",key:"SODateS",...r.t},{header:"PO No.",key:"PONumber",...r.t},{header:"Sales Category",key:"salesCategory",...r.t},{header:"Customer Name",key:"customerName",...r.t},{header:"Currency",key:"currency",...r.t},{header:"SO Value",key:"SOTotalAmount",...r.t},{header:"Status",key:"SOStatus",...r.t}];const F=u=>({title:Z,csvData:u,headers:n}),I=u=>(0,p.J)({data:u,headers:n,widths:U,title:Z});let v=["*","*","*","*","*","*","*","*","*","*","*","*"],C="Short SO Closing",q=[{header:"SO Date",key:"SODate",...r.t},{header:"SO #",key:"SONumber",...r.t},{header:"Line #",key:"SOLineNumber",...r.t},{header:"SKU #",key:"SKUNo",...r.t},{header:"SKU Name",key:"SKUName",...r.t},{header:"SKU Description",key:"SKUDescription",...r.t},{header:"Bal Qty",key:"balancedQty",...r.t},{header:"Customer Name",key:"customer",...r.t}];const w=u=>({title:C,csvData:u,headers:q}),E=u=>(0,p.J)({data:u,headers:q,widths:v,title:C});let M=["*","*","*","*","*","*","*","*","*"],Q="Direct Tax Invoice",P=[{header:"Invoice #",key:"DTINumber",...r.t},{header:"Invoice Date",key:"salesInvoiceDateS",...r.t},{header:"Invoice Value",key:"DTIValue",...r.t},{header:"Customer Name",key:"customerName",...r.t},{header:"Status",key:"DTIStatus",...r.t}];const b=u=>({title:Q,csvData:u,headers:P}),ie=u=>(0,p.J)({data:u,headers:P,widths:M,title:Q});let re=["*","*","*","*","*","*","*","*","*","*","*","*","*"],S="Proforma Invoice",G=[{header:"PI No.",key:"PINumber",...r.t},{header:"PI Date",key:"PIDateS",...r.t},{header:"Bill From Location",key:"billFromLocation",...r.t},{header:"Customer Category",key:"salesCategory",...r.t},{header:"Customer Name",key:"customerName",...r.t},{header:"PO No.",key:"PONumber",...r.t},{header:"PO Date",key:"PODate",...r.t},{header:"Currency",key:"currency",...r.t},{header:"PI Validity Date",key:"PIValidityDate",...r.t},{header:"PI Amount",key:"PITotalAmount",...r.t},{header:"PI Status",key:"PIStatus",...r.t}];const ae=u=>({title:S,csvData:u,headers:G}),ne=u=>(0,p.J)({data:u,headers:G,widths:re,title:S});let le=["*","*","*","*","*","*","*","*","*","*"],Y="Credit Note",L=[{header:"CN No.",key:"CNNumber",...r.t},{header:"CN Date",key:"CNDateS",...r.t},{header:"Customer Category",key:"salesCategory",...r.t},{header:"Customer Name",key:"customerName",...r.t},{header:"Debit Note No.",key:"invoiceNo",...r.t},{header:"Invoice Date",key:"invoiceDateS",...r.t},{header:"Currency",key:"currency",...r.t},{header:"Net CN Value",key:"netCNValue",...r.t},{header:"Reason For CN",key:"reasonForCN",...r.t},{header:"CN Status.",key:"CNStatus",...r.t}];const ce=u=>({title:Y,csvData:u,headers:L}),ue=u=>(0,p.J)({data:u,headers:L,widths:le,title:Y});let de=["*","*","*","*","*","*","*","*","*","*","*","*"],J="ServiceInvoice Report",K=[{header:"Invoice #",key:"serviceInvoiceNumber",...r.t},{header:"Invoice Date",key:"serviceInvoiceDate",...r.t},{header:"Customer Category",key:"customerCategory",...r.t},{header:"Customer Name",key:"customerName",...r.t},{header:"PO No.",key:"PONo",...r.t},{header:"PO Date",key:"PODate",...r.t},{header:"Currency",key:"currency",...r.t},{header:"Bill From Location",key:"billFromLocation",...r.t},{header:"Total Value",key:"totalValue",...r.t},{header:"Remarks",key:"remarks",...r.t},{header:"Status",key:"status",...r.t}];const pe=u=>({title:J,csvData:u,headers:K}),me=u=>(0,p.J)({data:u,headers:K,widths:de,title:J});let j=["*","*","*","*","*","*","*","*"],H="Sales Forecast",z=[{header:"FC No.",key:"FCNo",...r.t},{header:"FC Date",key:"FCDate",...r.t},{header:"Customer Category",key:"customerCategory",...r.t},{header:"Customer Name",key:"customerName",...r.t},{header:"Currency",key:"currency",...r.t},{header:"FC Type",key:"FCType",...r.t},{header:"FC Value",key:"netFCValue",...r.t},{header:"Status",key:"status",...r.t}];const ge=u=>({title:H,csvData:u,headers:z}),ye=u=>(0,p.J)({data:u,headers:z,widths:j,title:H});let fe=["*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"],$="Debit Note",X=[{header:"DN No.",key:"DNNumber",...r.t},{header:"DN Date",key:"DNDateS",...r.t},{header:"Sale Category",key:"salesCategory",...r.t},{header:"Customer Name",key:"customerName",...r.t},{header:"Invoice No.",key:"invoiceNo",...r.t},{header:"Invoice Date",key:"invoiceDateS",...r.t},{header:"Currency",key:"currency",...r.t},{header:"DN Net Value",key:"netDNValue",...r.t},{header:"Reason For Debit Note",key:"reasonForDN",...r.t},{header:"DN Status",key:"DNStatus",...r.t}];const De=u=>({title:$,csvData:u,headers:X}),Te=u=>(0,p.J)({data:u,headers:X,widths:fe,title:$});let Re=["*","*","*","*","*","*","*"],oe="Quotation Of SKU",se=[{header:"Qtn. No.",key:"quotationNo",...r.t},{header:"Rev No.",key:"revNo",...r.t},{header:"Qtn. Date",key:"quotationDate",...r.t},{header:"Customer Category",key:"customerCategory",...r.t},{header:"Customer Name",key:"customerName",...r.t},{header:"Ccy",key:"currency",...r.t},{header:"Status",key:"status",...r.t}];const Ne=u=>({title:oe,csvData:u,headers:se}),ve=u=>(0,p.J)({data:u,headers:se,widths:Re,title:oe})},49580:(O,y,d)=>{d.d(y,{D:()=>r});const r=[{message:"HSN Code should be of Max 8 & Min of 4 Characters is Required",key:"hsnCode"},{message:"Description of Goods is Required",key:"goodsDescription"},{message:"GST Rate % is Required",key:"gstRate"},{message:"IGST Rate % is Required",key:"igstRate"},{message:"CGST Rate % is Required",key:"cgstRate"},{message:"SGST Rate % is Required",key:"sgstRate"},{message:"UTGST Rate % is Required",key:"ugstRate"},{message:"Revision No. is Required",key:"revisionNo"},{message:"Revision Date is Required",key:"revisionDate"}]},43154:(O,y,d)=>{d.d(y,{tm:()=>R,Kb:()=>r,lR:()=>A,jH:()=>p,y5:()=>x,rL:()=>M,OV:()=>Z,HQ:()=>U,RS:()=>n,vc:()=>F,Nj:()=>C,rw:()=>q,Uh:()=>I,J4:()=>E,ff:()=>N,BC:()=>w,JY:()=>D,Dd:()=>v,Sy:()=>e,tH:()=>m,se:()=>g,RH:()=>T});const r=[{message:"Customer Name is Required",key:"customerName"},{message:"Mobile No. is Required",key:"mobileNo"},{message:"stateOfSupply is Required",key:"stateOfSupply"}],p=[{message:"Customer Code is Required",key:"customerCode"},{message:"Customer Name is Required",key:"customerName"},{message:"Sales Category is Required",key:"customerCategory"},{message:"PAN No. is Required",key:"customerPAN"},{message:"GSTIN is Required",key:"GSTIN"},{message:"GST Classification is Required",key:"GSTClassification"},{message:"Customer Category is Required",key:"customerType"},{message:"Customer Currency is Required",key:"customerCurrency"},{message:"Payment Terms is Required",key:"customerPaymentTerms"}];d(49580);const N=[{message:"SAC Code is Required",key:"sacCode"},{message:"Description of Service is Required",key:"serviceDescription"},{message:"GST Rate % is Required",key:"gstRate"},{message:"IGST Rate % is Required",key:"igstRate"},{message:"CGST Rate % is Required",key:"cgstRate"},{message:"SGST Rate % is Required",key:"sgstRate"},{message:"UTGST Rate % is Required",key:"ugstRate"},{message:"Revision Date is Required",key:"revisionNo"},{message:"Revision Date is Required",key:"revisionDate"}],D=[{message:"Service Description is Required",key:"serviceDescription"}],e=[{message:"SKU Stage is Required",key:"SKUStage"},{message:"Product Category is Required",key:"productCategory"},{message:"SKU No is Required",key:"SKUNo"},{message:"SKU Name is Required",key:"SKUName"},{message:"SKU Description is Required",key:"SKUDescription"},{message:"HSN Code is Required",key:"hsn"},{message:"Unit of Measurement is Required",key:"primaryUnit"}],m=[{message:"Shelf Life [Months] is required",key:"shelfLife"},{message:"Storage Temperature [\xb0C] is required",key:"storageTemp"},{message:"Storage Humidity [RH] is required",key:"storageHumidity"},{message:"Special Storage Instruction is required",key:"specialStorageInstruction"}],T=[{message:"Type is Required",key:"transporterType"}],R=[{message:"Bill From Location is Required",key:"billFromLocation"},{message:"Customer Category is Required",key:"salesCategory"},{message:"Customer Name is Required",key:"customer"},{message:"Purchase Order No. is Required",key:"PONumber"},{message:"Purchase Order Date is Required",key:"PODate"},{message:"Net SO Value is Required",key:"SOTotalAmount"},{message:"Status is Required",key:"SOStatus"},{message:"Customer Shipping Address is Required",key:"customerShippingAddress"},{message:"Freight Terms is Required",key:"frightTerms"},{message:"Transporter is Required",key:"transporter"},{message:"Destination is Required",key:"destination"}],g=[{message:"Freight Terms is Required",key:"frightTerms"},{message:"Transporter is Required",key:"transporter"},{message:"Mode of transport is Required",key:"modeOfTransport"},{message:"Destination is Required",key:"destination"}],A=[{message:"Customer Category is Required",key:"salesCategory"},{message:"Customer Name is Required",key:"customer"}],x=[{message:"Customer Category is Required",key:"salesCategory"},{message:"Customer Name is Required",key:"customer"},{message:"Payment Terms is Required",key:"paymentTerms"},{message:"Mode Of Transport is Required",key:"modeOfTransport"},{message:"Freight Terms is Required",key:"frightTerms"},{message:"Transporter Name is Required",key:"transporter"},{message:"Destination is Required",key:"destination"}],U=[{message:"Customer Category is Required",key:"salesCategory"},{message:"Customer Name is Required",key:"customer"},{message:"Fright Terms is Required",key:"frightTerms"},{message:"Destination Terms is Required",key:"destination"},{message:"Mode of Transport is Required",key:"modeOfTransport"}],Z=[{message:"Export Invoice No. is Required",key:"exportsInvoiceNo"},{message:"Export Invoice Date is Required",key:"exportsInvoiceDate"},{message:"Export Invoice Total Value is Required",key:"exportsInvoiceTotalValue"},{message:"Exchange Rate is Required",key:"exchangeRate"},{message:"Mode of Transport is Required",key:"modeOfTransport"},{message:"Fright Terms is Required",key:"frightTerms"},{message:"Port of Destination Terms is Required",key:"destination"},{message:"Final Destination Terms is Required",key:"finalDestination"}],n=[{message:"Payment Terms is Required",key:"paymentTerms"},{message:"Fright Terms is Required",key:"frightTerms"},{message:"Transporter Terms is Required",key:"transporter"},{message:"Destination Terms is Required",key:"destination"},{message:"Mode of Transport is Required",key:"modeOfTransport"}],F=[{message:"Supply Type is Required",key:"supplyType"},{message:"Sub Supply Type is Required",key:"subSupplyType"},{message:"Document Type is Required",key:"docType"},{message:"Document No. is Required of 16 Digits",key:"docNo"},{message:"Document Date is Required",key:"docDate"},{message:"From GSTIN is Required of 15 Digits",key:"fromGstin"},{message:"From Pin Code is Required",key:"fromPincode"},{message:"Act From State Code is Required",key:"actFromStateCode"},{message:"From State Code is Required",key:"fromStateCode"},{message:"To GSTIN is Required of 15 Digits",key:"toGstin"},{message:"To Pin Code is Required",key:"toPincode"},{message:"To State Code is Required",key:"toStateCode"},{message:"Act To State Code is Required",key:"actToStateCode"},{message:"Transaction Type is Required of 4 Digits",key:"transactionType"},{message:"Tot Inv Value is Required",key:"totInvValue"},{message:"Trans Distance is Required",key:"transDistance"}],I=[{message:"Bill From Location is Required",key:"billFromLocation"},{message:"Customer Category is Required",key:"salesCategory"},{message:"Customer Name is Required",key:"customer"},{message:"PO No. is Required",key:"PONumber"},{message:"Net SO Value is Required",key:"PITotalAmount"},{message:"Status is Required",key:"PIStatus"},{message:"Customer Shipping Address is Required",key:"customerShippingAddress"},{message:"Mode Of Transport is Required",key:"modeOfTransport"},{message:"frightTerms is Required",key:"frightTerms"},{message:"transporter is Required",key:"transporter"},{message:"destination is Required",key:"destination"}],v=[{message:"Invoice # is Required",key:"serviceInvoiceNumber"},{message:"Invoice Date is Required",key:"serviceInvoiceDate"},{message:"Customer/Sales Category is Required",key:"customerCategory"},{message:"Customer Name is Required",key:"customer"},{message:"Purchase Order No. is Required",key:"PONo"},{message:"Purchase Order Date is Required",key:"PODate"},{message:"Currency is Required",key:"currency"},{message:"Bill From Location is Required",key:"billFromLocation"}],C=[{message:"Product Category is Required",key:"productCategory"},{message:"HSN Code is Required",key:"HSN"},{message:"Description is Required",key:"description"},{message:"IGST Rate % is Required",key:"igstRate"},{message:"CGST Rate % is Required",key:"cgstRate"},{message:"SGST Rate % is Required",key:"sgstRate"}],q=[{message:"Order is Required",key:"order"},{message:"Payment Terms Description is Required",key:"paymentDescription"}],w=[{message:"Customer Category is Required",key:"customerCategory"},{message:"Customer Name is Required",key:"customer"},{message:"FC Type is Required",key:"FCType"},{message:"Net FC Value is Required",key:"netFCValue"}],E=[{message:"Quotation No. is Required",key:"quotationNo"},{message:"Customer Category is Required",key:"customerCategory"},{message:"Customer Name  is Required",key:"customerName"}],M=[{message:"Customer Name is Required",key:"customerName"}]}}]);