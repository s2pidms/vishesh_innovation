"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9426],{45925:(O,m,r)=>{r.r(m),r.d(m,{MaintenanceScheduleModule:()=>Q});var h=r(96814),p=r(1076),f=r(43818),v=r(25116),g=r(90133),e=r(65879),l=r(98977),_=r(10583),b=r(88059),T=r(37285),S=r(53421);function C(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",21,22)(5,"span",23),e._uU(6),e.qZA()(),e.TgZ(7,"td",21,24)(9,"span",23),e._uU(10),e.qZA()(),e.TgZ(11,"td",21,25)(13,"span",23),e._uU(14),e.qZA()(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td",21,26)(23,"span",23),e._uU(24),e.qZA()(),e.TgZ(25,"td")(26,"div",27),e._UZ(27,"button",28),e.TgZ(28,"div",29)(29,"a",30),e.NdJ("click",function(){const a=e.CHM(t).$implicit,o=e.oxw();return e.KtG(o.navigateTo("/default/maintenance/transactions/maintenance-schedule/form",null==a?null:a._id,"view"))}),e._UZ(30,"i",31),e._uU(31," View "),e.qZA(),e.TgZ(32,"a",30),e.NdJ("click",function(){const a=e.CHM(t).$implicit,o=e.oxw();return e.KtG(o.navigateTo("/default/maintenance/transactions/maintenance-schedule/form",null==a?null:a._id,"edit"))}),e._UZ(33,"i",32),e._uU(34," Edit "),e.qZA()()()()()}if(2&s){const t=d.$implicit,n=e.MAs(4),i=e.MAs(8),a=e.MAs(12),o=e.MAs(22),u=e.oxw();e.xp6(2),e.Oqu(null==t?null:t.scheduleCode),e.xp6(1),e.Udp("width",n.clientWidth),e.xp6(2),e.Q6J("ngbTooltip",t.scheduleName)("positionTarget",n),e.xp6(1),e.hij(" ",t.scheduleName," "),e.xp6(1),e.Udp("width",i.clientWidth),e.xp6(2),e.Q6J("ngbTooltip",t.equipment)("positionTarget",i),e.xp6(1),e.hij(" ",t.equipment," "),e.xp6(1),e.Udp("width",a.clientWidth),e.xp6(2),e.Q6J("ngbTooltip",t.maintenanceTask)("positionTarget",a),e.xp6(1),e.hij(" ",t.maintenanceTask," "),e.xp6(2),e.Oqu(null==t?null:t.frequency),e.xp6(2),e.Oqu(null==t?null:t.startDateS),e.xp6(2),e.Oqu(null==t?null:t.endDateS),e.xp6(1),e.Udp("width",o.clientWidth),e.xp6(2),e.Q6J("ngbTooltip",t.description)("positionTarget",o),e.xp6(1),e.hij(" ",t.description," "),e.xp6(5),e.Q6J("accessType",u.rolePermissionActions.viewAction),e.xp6(3),e.Q6J("accessType",u.rolePermissionActions.editAction)}}const A=function(s,d,t,n){return{page:s,pageSize:d,collection:t,search:n,type:"list"}};let D=(()=>{class s{constructor(t,n,i,a,o,u){this.exportExcelService=t,this.maintenanceScheduleCreationService=n,this.router=i,this.activatedRoute=a,this.spinner=o,this.exportToPDFService=u,this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.dataForExcel=[],this.rolePermissionActions=v.a1}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}navigateTo(t,n,i){this.router.navigate([t],{queryParams:{id:n,action:i}})}trackByFn(t,n){return n?._id}eventHeader(t){switch(t.key){case"SEARCH":this.search=t.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=t.value,this.getAll()}}getAll(t=!1,n=""){this.spinner.show();let i={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:t};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.maintenanceScheduleCreationService.getAll(i).subscribe(a=>{"EXCEL"==n?this.excelDownload(a.rows):"PDF"==n?this.pdfDownload(a.rows):(this.tableData=a.rows,this.collection=a.count),this.spinner.hide()})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}excelDownload(t){this.exportExcelService.exportExcel((0,g.hK)(t))}pdfDownload(t){let n=(0,g.BH)(t);this.exportToPDFService.generatePdf(n.tableData,n.title)}onSort({column:t,direction:n}){this.headers.forEach(i=>{i.sortable!==t&&(i.direction="")}),this.column=t,this.direction="asc"==n?1:-1,this.getAll()}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(l.Ol),e.Y36(_.fC),e.Y36(p.F0),e.Y36(p.gz),e.Y36(l.V),e.Y36(l.$L))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-maintenance-schedule-list"]],viewQuery:function(n,i){if(1&n&&e.Gf(f.j,5),2&n){let a;e.iGM(a=e.CRH())&&(i.headers=a)}},decls:34,vars:9,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],["appAccessControl","",1,"text-center",3,"accessType"],["type","button",1,"btn","btn-primary","btn-add",3,"click"],["aria-hidden","true",1,"fa","fa-plus-square","fa-lg","me-2"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","scheduleCode",3,"sort"],["sortable","scheduleName",1,"text-start",3,"sort"],["sortable","equipment",1,"text-start",3,"sort"],["sortable","maintenanceTask",1,"text-start",3,"sort"],["sortable","frequency",3,"sort"],["sortable","startDateS",3,"sort"],["sortable","endDateS",3,"sort"],["sortable","description",1,"text-start",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["scheduleName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["equipment",""],["maintenanceTask",""],["description",""],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"Maintenance Schedule Creation Summary"),e.qZA()(),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return i.navigateTo("/default/maintenance/transactions/maintenance-schedule/form",null,"create")}),e._UZ(6,"i",5),e._uU(7," Maintenance Schedule "),e.qZA()(),e._UZ(8,"hr",6),e.TgZ(9,"div",7)(10,"app-setting-header",8),e.NdJ("dataChange",function(o){return i.eventHeader(o)}),e.qZA(),e.TgZ(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th",12),e.NdJ("sort",function(o){return i.onSort(o)}),e._uU(15,"Schedule Code"),e.qZA(),e.TgZ(16,"th",13),e.NdJ("sort",function(o){return i.onSort(o)}),e._uU(17,"Schedule Name"),e.qZA(),e.TgZ(18,"th",14),e.NdJ("sort",function(o){return i.onSort(o)}),e._uU(19,"Equipment Name"),e.qZA(),e.TgZ(20,"th",15),e.NdJ("sort",function(o){return i.onSort(o)}),e._uU(21,"Maintenance Task Name"),e.qZA(),e.TgZ(22,"th",16),e.NdJ("sort",function(o){return i.onSort(o)}),e._uU(23,"Frequency"),e.qZA(),e.TgZ(24,"th",17),e.NdJ("sort",function(o){return i.onSort(o)}),e._uU(25,"Start Date"),e.qZA(),e.TgZ(26,"th",18),e.NdJ("sort",function(o){return i.onSort(o)}),e._uU(27,"End Date"),e.qZA(),e.TgZ(28,"th",19),e.NdJ("sort",function(o){return i.onSort(o)}),e._uU(29,"Description"),e.qZA(),e.TgZ(30,"th"),e._uU(31,"Action"),e.qZA()()(),e.TgZ(32,"tbody"),e.YNc(33,C,35,26,"tr",20),e.qZA()()()()),2&n&&(e.xp6(4),e.Q6J("accessType",i.rolePermissionActions.createAction),e.xp6(6),e.Q6J("data",e.l5B(4,A,i.page,i.pageSize,i.collection,i.search)),e.xp6(23),e.Q6J("ngForOf",i.tableData)("ngForTrackBy",i.trackByFn))},dependencies:[b.P,h.sg,T._L,f.j,S.J],encapsulation:2})}return s})();var c=r(60095),y=r(21631),U=r(22096),M=r(50363);function q(s,d){1&s&&e._UZ(0,"hr",21)}const Z=function(s){return{"d-none":s}};function x(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",22)(1,"button",23),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.reset())}),e._uU(2,"Reset"),e.qZA()()}if(2&s){const t=e.oxw();e.Q6J("ngClass",e.VKq(1,Z,"View"==t.action))}}function N(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",24)(1,"button",23),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e._uU(2,"Save"),e.qZA()()}if(2&s){const t=e.oxw();e.Q6J("ngClass",e.VKq(1,Z,"View"==t.action))}}const J=function(){return["view"]},w=function(){return["view","edit"]},F=function(){return["create","edit"]};let Y=(()=>{class s{constructor(t,n,i,a,o,u){this.router=t,this.activatedRoute=n,this.spinner=i,this.toastService=a,this.maintenanceScheduleCreationService=o,this.utilityService=u,this.submitted=!1,this.action="create",this.service=[],this.masterData={autoIncrementNo:"",frequencyOptions:[],equipmentListOptions:[],maintenanceTaskCodeOptions:[]},this.form=new c.nJ({_id:new c.p4(null),scheduleCode:new c.p4(null),scheduleName:new c.p4(null),equipment:new c.p4(null),maintenanceTask:new c.p4(null),frequency:new c.p4(null),startDate:new c.p4(null),endDate:new c.p4(null),description:new c.p4(null)})}get f(){return this.form.controls}ngOnInit(){this.getInitialData()}navigateTo(t,n,i){this.router.navigate([t],{queryParams:{id:n,action:i}})}reset(){this.form.reset(),this.getInitialData()}submit(){this.submitted=!0,this.form.enable();let t=this.form.value;t._id?this.update(t):(delete t._id,this.create(t))}create(t){this.spinner.show(),this.maintenanceScheduleCreationService.create(t).subscribe(n=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(n.message),this.router.navigate(["/default/maintenance/transactions/maintenance-schedule/list"])})}update(t){this.spinner.show(),this.maintenanceScheduleCreationService.update(t._id,t).subscribe(n=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(n.message),this.router.navigate(["/default/maintenance/transactions/maintenance-schedule/list"])})}getInitialData(){this.spinner.show(),this.maintenanceScheduleCreationService.getAllMasterData({}).subscribe(t=>{this.masterData=t,this.form.controls.scheduleCode.setValue(this.masterData?.autoIncrementNo),this.form.controls.startDate.setValue(this.utilityService.getTodayDate("YYYY-MM-DD")),this.form.controls.endDate.setValue(this.utilityService.getTodayDate("YYYY-MM-DD")),this.activatedRoute.queryParams.pipe((0,y.z)(n=>(this.action=n.action,this.utilityService.accessDenied(this.action),n.id?this.maintenanceScheduleCreationService.getById(n.id):(0,U.of)({})))).subscribe(n=>{this.spinner.hide(),0!=Object.keys(n).length&&(n.startDate&&(n.startDate=this.utilityService.getFormatDate(n.startDate,"YYYY-MM-DD")),n.endDate&&(n.endDate=this.utilityService.getFormatDate(n.endDate,"YYYY-MM-DD")),this.form.patchValue(n),"edit"!=this.action&&this.form.disable())})})}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(p.F0),e.Y36(p.gz),e.Y36(l.V),e.Y36(l.kl),e.Y36(_.fC),e.Y36(l.tI))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-maintenance-schedule-form"]],decls:54,vars:16,consts:[[1,"formCard","card",3,"formGroup"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,"form-body"],[1,"row"],[1,"col-md-3"],[1,"form-label"],[1,"text-danger"],["type","text","formControlName","scheduleCode","readonly","",1,"form-control"],["type","String","formControlName","scheduleName",1,"form-control"],["bindLabel","assetName","bindValue","_id","formControlName","equipment",3,"items","clearable"],["bindLabel","taskName","bindValue","_id","formControlName","maintenanceTask",3,"items","clearable"],["bindLabel","label","bindValue","value","formControlName","frequency",3,"items","clearable"],["type","date","formControlName","startDate",1,"form-control"],["type","date","formControlName","endDate",1,"form-control"],["type","text","formControlName","description",1,"form-control"],["class","row line-border",4,"ngIf"],[1,"d-flex","justify-content-center","mb-3"],["class","d-grid col-md-1 me-5",3,"ngClass",4,"ngIf"],["class","d-grid col-md-1",3,"ngClass",4,"ngIf"],[1,"row","line-border"],[1,"d-grid","col-md-1","me-5",3,"ngClass"],["type","button",1,"btn","btn-primary",3,"click"],[1,"d-grid","col-md-1",3,"ngClass"]],template:function(n,i){1&n&&(e.TgZ(0,"Form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label"),e._uU(5),e.ALo(6,"titlecase"),e.qZA()()(),e.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"label",7),e._uU(11," Schedule Code "),e._UZ(12,"span",8),e.qZA(),e._UZ(13,"input",9),e.qZA(),e.TgZ(14,"div",6)(15,"label",7),e._uU(16," Schedule Name "),e._UZ(17,"span",8),e.qZA(),e._UZ(18,"input",10),e.qZA(),e.TgZ(19,"div",6)(20,"label",7),e._uU(21," Equipment Name "),e._UZ(22,"span",8),e.qZA(),e._UZ(23,"ng-select",11),e.qZA(),e.TgZ(24,"div",6)(25,"label",7),e._uU(26," Maintenance Task Name "),e._UZ(27,"span",8),e.qZA(),e._UZ(28,"ng-select",12),e.qZA()(),e.TgZ(29,"div",5)(30,"div",6)(31,"label",7),e._uU(32," Frequency"),e._UZ(33,"span",8),e.qZA(),e._UZ(34,"ng-select",13),e.qZA(),e.TgZ(35,"div",6)(36,"label",7),e._uU(37," Start Date "),e._UZ(38,"span",8),e.qZA(),e._UZ(39,"input",14),e.qZA(),e.TgZ(40,"div",6)(41,"label",7),e._uU(42," End Date "),e._UZ(43,"span",8),e.qZA(),e._UZ(44,"input",15),e.qZA(),e.TgZ(45,"div",6)(46,"label",7),e._uU(47," Description "),e._UZ(48,"span",8),e.qZA(),e._UZ(49,"input",16),e.qZA()()(),e.YNc(50,q,1,0,"hr",17),e.TgZ(51,"div",18),e.YNc(52,x,3,3,"div",19),e.YNc(53,N,3,3,"div",20),e.qZA()()()),2&n&&(e.Q6J("formGroup",i.form),e.xp6(5),e.hij(" ",e.lcZ(6,11,i.action)," Maintenance Schedule Creation"),e.xp6(18),e.Q6J("items",i.masterData.equipmentListOptions)("clearable",!1),e.xp6(5),e.Q6J("items",i.masterData.maintenanceTaskCodeOptions)("clearable",!1),e.xp6(6),e.Q6J("items",i.masterData.frequencyOptions)("clearable",!1),e.xp6(16),e.Q6J("ngIf",!e.DdM(13,J).includes(i.action)),e.xp6(2),e.Q6J("ngIf",!e.DdM(14,w).includes(i.action)),e.xp6(1),e.Q6J("ngIf",e.DdM(15,F).includes(i.action)))},dependencies:[h.mk,h.O5,c.Fj,c.JJ,c.JL,c.sg,c.u,M.w9,h.rS],encapsulation:2})}return s})();var L=r(56208);const E=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:D},{path:"form",component:Y,resolve:{accessScreen:r(65876).x}}];let Q=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275mod=e.oAB({type:s});static#n=this.\u0275inj=e.cJS({imports:[L.m,h.ez,p.Bz.forChild(E)]})}return s})()}}]);