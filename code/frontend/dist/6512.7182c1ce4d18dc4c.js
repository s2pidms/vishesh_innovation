"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6512],{83187:(J,b,l)=>{l.r(b),l.d(b,{GIPPICToProductionModule:()=>pt});var g=l(96814),o=l(1076),P=l(43818),v=l(25116),I=l(17645),t=l(65879),T=l(99007),C=l(99328),Z=l(88059),k=l(53421);const A=function(){return["Approved","Rejected"]};function M(r,p){if(1&r){const n=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",19),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td")(14,"div",20),t._UZ(15,"button",21),t.TgZ(16,"div",22)(17,"a",23),t.NdJ("click",function(){const a=t.CHM(n).$implicit,u=t.oxw();return t.KtG(u.navigateTo("../form",a,"view"))}),t._UZ(18,"i",24),t._uU(19," View "),t.qZA(),t.TgZ(20,"a",23),t.NdJ("click",function(){const a=t.CHM(n).$implicit,u=t.oxw();return t.KtG(u.navigateTo("../form",a,"edit"))}),t._UZ(21,"i",25),t._uU(22," Edit "),t.qZA(),t.TgZ(23,"a",23),t.NdJ("click",function(){const a=t.CHM(n).$implicit,u=t.oxw();return t.KtG(u.navigateTo("../form",a,"approve"))}),t._UZ(24,"i",26),t._uU(25," Approve "),t.qZA(),t.TgZ(26,"a",23),t.NdJ("click",function(){const a=t.CHM(n).$implicit,u=t.oxw();return t.KtG(u.navigateTo("../form",a,"reject"))}),t._UZ(27,"i",27),t._uU(28," Reject "),t.qZA()()()()()}if(2&r){const n=p.$implicit,i=t.oxw();t.xp6(2),t.Oqu(null==n?null:n.goodsIssueNo),t.xp6(2),t.Oqu(null==n?null:n.goodsIssueDate),t.xp6(2),t.Oqu(null==n?null:n.goodsIssueTo),t.xp6(2),t.Oqu(null==n?null:n.jobCardNo),t.xp6(2),t.Oqu(null==n?null:n.updatedAt),t.xp6(2),t.Oqu(null==n?null:n.status),t.xp6(5),t.Q6J("accessType",i.rolePermissionActions.viewAction),t.xp6(3),t.ekj("disable",t.DdM(16,A).includes(n.status)),t.Q6J("accessType",i.rolePermissionActions.editAction),t.xp6(3),t.ekj("disable",t.DdM(17,A).includes(n.status)),t.Q6J("accessType",i.rolePermissionActions.approveAction),t.xp6(3),t.ekj("disable",t.DdM(18,A).includes(n.status)),t.Q6J("accessType",i.rolePermissionActions.approveAction)}}const h=function(r,p,n,i){return{page:r,pageSize:p,collection:n,search:i,type:"list"}};let f=(()=>{var r;class p{constructor(i,e,a,u,w,N,G){this.giPPICToProductionService=i,this.spinner=e,this.exportExcelService=a,this.toastService=u,this.activatedRoute=w,this.exportToPDFService=N,this.utilityService=G,this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.rolePermissionActions=v.a1}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}navigateTo(i,e,a){this.utilityService.navigateToForm({path:i,status:e.status,action:a,id:e._id,activatedRoute:this.activatedRoute})}trackByFn(i,e){return e?._id}getAll(i=!1,e=""){this.spinner.show();let a={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:i};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.giPPICToProductionService.getAll(a).subscribe(u=>{"EXCEL"==e?this.excelDownload(u.rows):"PDF"==e?this.pdfDownload(u.rows):(this.tableData=u.rows,this.collection=u.count),this.spinner.hide()})}update(i,e){"Approved"==i?.status&&(this.spinner.show(),this.giPPICToProductionService.update(i._id,{status:e}).subscribe(a=>{this.toastService.success(a.message),this.getAll(),this.spinner.hide()}))}eventHeader(i){switch(i.key){case"SEARCH":this.search=i.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=i.value,this.getAll()}}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}pdfDownload(i){let e=(0,I.Jk)(i);this.exportToPDFService.generatePdf(e.tableData,e.title)}excelDownload(i){this.exportExcelService.exportExcel((0,I.dM)(i))}onSort({column:i,direction:e}){this.headers.forEach(a=>{a.sortable!==i&&(a.direction="")}),this.column=i,this.direction="asc"==e?1:-1,this.getAll()}}return(r=p).\u0275fac=function(i){return new(i||r)(t.Y36(T.qI),t.Y36(C.V),t.Y36(C.Ol),t.Y36(C.kl),t.Y36(o.gz),t.Y36(C.$L),t.Y36(C.tI))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-gi-ppic-to-production-list"]],viewQuery:function(i,e){if(1&i&&t.Gf(P.j,5),2&i){let a;t.iGM(a=t.CRH())&&(e.headers=a)}},decls:30,vars:9,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],["appAccessControl","",1,"text-center",3,"accessType"],[1,"plusIconSvg","btn","btn-primary","me-1"],[1,"btn","bg-primary","btn-add","px-3",3,"click"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","goodsIssueNo",3,"sort"],["sortable","goodsIssueDate",3,"sort"],["sortable","goodsIssueTo",1,"text-start",3,"sort"],["sortable","jobCardNo",3,"sort"],["sortable","updatedAt",3,"sort"],["sortable","status",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-check","fa-lg","me-2","text-success"],["aria-hidden","true",1,"fa","fa-close","me-3","text-primary"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3,"Goods Issue Summary I PPIC to Production"),t.qZA()(),t.TgZ(4,"div",3),t._UZ(5,"button",4),t.TgZ(6,"button",5),t.NdJ("click",function(){return e.navigateTo("../form",{},"create")}),t._uU(7,"Goods Issue"),t.qZA()(),t._UZ(8,"hr",6),t.TgZ(9,"div",7)(10,"app-setting-header",8),t.NdJ("dataChange",function(u){return e.eventHeader(u)}),t.qZA(),t.TgZ(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th",12),t.NdJ("sort",function(u){return e.onSort(u)}),t._uU(15,"GI No."),t.qZA(),t.TgZ(16,"th",13),t.NdJ("sort",function(u){return e.onSort(u)}),t._uU(17,"GI Date"),t.qZA(),t.TgZ(18,"th",14),t.NdJ("sort",function(u){return e.onSort(u)}),t._uU(19,"GI Issue to Dept."),t.qZA(),t.TgZ(20,"th",15),t.NdJ("sort",function(u){return e.onSort(u)}),t._uU(21,"Job Card Ref."),t.qZA(),t.TgZ(22,"th",16),t.NdJ("sort",function(u){return e.onSort(u)}),t._uU(23,"Issued by"),t.qZA(),t.TgZ(24,"th",17),t.NdJ("sort",function(u){return e.onSort(u)}),t._uU(25,"Status"),t.qZA(),t.TgZ(26,"th"),t._uU(27,"Action"),t.qZA()()(),t.TgZ(28,"tbody"),t.YNc(29,M,29,19,"tr",18),t.qZA()()()()),2&i&&(t.xp6(4),t.Q6J("accessType",e.rolePermissionActions.createAction),t.xp6(6),t.Q6J("data",t.l5B(4,h,e.page,e.pageSize,e.collection,e.search)),t.xp6(19),t.Q6J("ngForOf",e.tableData)("ngForTrackBy",e.trackByFn))},dependencies:[g.sg,Z.P,P.j,k.J],encapsulation:2}),p})();var s=l(60095),c=l(21631),d=l(22096),m=l(37285),_=l(16897);const y=function(){return["view","approve","reject"]};let D=(()=>{var r;class p{get f(){return this.form.controls}constructor(i,e,a){this.activeModal=i,this.validationService=e,this.utilityService=a,this.remarksDetails={},this.action="",this.form=new s.nJ({PPICRemarksDetail:new s.nJ({PPICRemarks:new s.p4(null),issueBy:new s.p4(null),approvedBy:new s.p4(null),approvedDate:new s.p4(this.utilityService.getTodayDate("YYYY-MM-DD"))}),QARemarksDetail:new s.nJ({QARemark:new s.p4(null),checkedBy:new s.p4(null),approvedBy:new s.p4(null),approvedDate:new s.p4(this.utilityService.getTodayDate("YYYY-MM-DD"))})})}ngOnInit(){this.remarksDetails&&this.form.patchValue(this.remarksDetails),["view","approve","reject"].includes(this.action)&&this.form.disable()}dismissModel(){this.activeModal.close(this.form.value)}}return(r=p).\u0275fac=function(i){return new(i||r)(t.Y36(m.Kz),t.Y36(_.RJ),t.Y36(C.tI))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-gi-ppic-to-production-remarks"]],inputs:{remarksDetails:"remarksDetails",action:"action"},decls:75,vars:3,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,""],[3,"formGroup"],["formGroupName","PPICRemarksDetail"],[1,"mt-0","line-border-with-title"],[1,"px-5"],[1,"row","px-5"],[1,"col-12"],[1,"form-label","mb-1"],[1,"text-danger"],[1,"d-flex"],["type","text","formControlName","PPICRemarks",1,"form-control"],[1,"row","mt-4","px-5"],[1,"col-4"],["type","text","formControlName","issueBy",1,"form-control"],["type","text","formControlName","approvedBy",1,"form-control"],["type","date","formControlName","approvedDate",1,"form-control"],["formGroupName","QARemarksDetail"],[1,"line-border-with-title"],[1,"px-4"],["type","text","formControlName","QARemark",1,"form-control"],["type","text","formControlName","checkedBy",1,"form-control"],[1,"line-border","my-4"],[1,"col-12","d-flex","justify-content-center"],[1,"mb-4"],["type","button",1,"btn","bg-primary","px-4",3,"disabled","click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Remarks"),t.qZA(),t.TgZ(4,"div")(5,"button",3),t.NdJ("click",function(){return e.activeModal.close()}),t._UZ(6,"i",4),t.qZA()()(),t.TgZ(7,"div",5)(8,"form",6),t.ynx(9,7),t.TgZ(10,"div",8)(11,"span",9),t._uU(12," PPIC Remarks "),t.qZA()(),t.TgZ(13,"div",10)(14,"div",11)(15,"label",12),t._uU(16," PPIC Remarks "),t._UZ(17,"span",13),t.qZA(),t.TgZ(18,"div",14),t._UZ(19,"input",15),t.qZA()()(),t.TgZ(20,"div",16)(21,"div",17)(22,"label",12),t._uU(23,"Issue by "),t._UZ(24,"span",13),t.qZA(),t.TgZ(25,"div",14),t._UZ(26,"input",18),t.qZA()(),t.TgZ(27,"div",17)(28,"label",12),t._uU(29," Approved by "),t._UZ(30,"span",13),t.qZA(),t.TgZ(31,"div",14),t._UZ(32,"input",19),t.qZA()(),t.TgZ(33,"div",17)(34,"label",12),t._uU(35," Approval Date "),t._UZ(36,"span",13),t.qZA(),t.TgZ(37,"div",14),t._UZ(38,"input",20),t.qZA()()(),t.BQk(),t.ynx(39,21),t.TgZ(40,"div",22)(41,"span",23),t._uU(42," \xa0 QA/QC Remarks \xa0 "),t.qZA()(),t.TgZ(43,"div",10)(44,"div",11)(45,"label",12),t._uU(46," QA/QC Remarks "),t._UZ(47,"span",13),t.qZA(),t.TgZ(48,"div",14),t._UZ(49,"input",24),t.qZA()()(),t.TgZ(50,"div",16)(51,"div",17)(52,"label",12),t._uU(53,"Checked by "),t._UZ(54,"span",13),t.qZA(),t.TgZ(55,"div",14),t._UZ(56,"input",25),t.qZA()(),t.TgZ(57,"div",17)(58,"label",12),t._uU(59," Approved by "),t._UZ(60,"span",13),t.qZA(),t.TgZ(61,"div",14),t._UZ(62,"input",19),t.qZA()(),t.TgZ(63,"div",17)(64,"label",12),t._uU(65," Approval Date "),t._UZ(66,"span",13),t.qZA(),t.TgZ(67,"div",14),t._UZ(68,"input",20),t.qZA()()(),t.BQk(),t._UZ(69,"hr",26),t.qZA(),t.TgZ(70,"div",10)(71,"div",27)(72,"div",28)(73,"button",29),t.NdJ("click",function(){return e.dismissModel()}),t._uU(74," Save & Close "),t.qZA()()()()()()),2&i&&(t.xp6(8),t.Q6J("formGroup",e.form),t.xp6(65),t.Q6J("disabled",t.DdM(2,y).includes(e.action)))},dependencies:[s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,s.x0],encapsulation:2}),p})();var U=l(63375),q=l(61441),Q=l(50363),F=l(95346),R=l(59103);function O(r,p){if(1&r){const n=t.EpF();t.TgZ(0,"div",50),t.NdJ("click",function(){t.CHM(n);const e=t.oxw().$implicit,a=t.oxw();return t.KtG(a.setConversionOfUnit(e))}),t.qZA()}}function L(r,p){1&r&&t._UZ(0,"div",51)}function j(r,p){1&r&&t._UZ(0,"div",52)}function E(r,p){1&r&&t._UZ(0,"div",53)}function Y(r,p){1&r&&t._UZ(0,"div",54)}function K(r,p){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&r){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,n.issueQty,"1.2-2")," ")}}const B=function(){return{standalone:!0}};function z(r,p){if(1&r){const n=t.EpF();t.TgZ(0,"input",55),t.NdJ("ngModelChange",function(e){t.CHM(n);const a=t.oxw().$implicit;return t.KtG(a.issueQty=e)})("input",function(){t.CHM(n);const e=t.oxw().$implicit,a=t.oxw();return t.KtG(a.changeGIQty(e))}),t.qZA()}if(2&r){const n=t.oxw().$implicit;t.Q6J("ngModel",n.issueQty)("ngModelOptions",t.DdM(2,B))}}const S=function(){return["approve","reject","view","Acknowledged"]};function H(r,p){if(1&r&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td",25,36)(10,"span",37),t._uU(11),t.qZA()(),t.TgZ(12,"td",25,38)(14,"span",37),t._uU(15),t.qZA()(),t.TgZ(16,"td")(17,"div",39)(18,"span",40),t._uU(19),t.ALo(20,"UOMUnitsMaster"),t.qZA(),t.TgZ(21,"span",41),t.YNc(22,O,1,0,"div",42),t.YNc(23,L,1,0,"div",43),t.qZA()()(),t.TgZ(24,"td")(25,"span"),t._uU(26),t.ALo(27,"number"),t.qZA()(),t.TgZ(28,"td")(29,"div",44),t.YNc(30,j,1,0,"div",45),t.YNc(31,E,1,0,"div",46),t.YNc(32,Y,1,0,"div",47),t.qZA()(),t.TgZ(33,"td")(34,"div",44),t.YNc(35,K,3,4,"span",48),t.YNc(36,z,1,3,"input",49),t.qZA()()()),2&r){const n=p.$implicit,i=t.MAs(9),e=t.MAs(13),a=t.oxw();t.xp6(2),t.Oqu(n.MRNNumber),t.xp6(2),t.Oqu(t.xi3(5,24,n.MRNDate,"dd-MM-YYYY")),t.xp6(3),t.Oqu(n.itemCode),t.xp6(1),t.Udp("width",i.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",n.itemName)("positionTarget",i),t.xp6(1),t.hij(" ",n.itemName," "),t.xp6(1),t.Udp("width",e.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",n.itemDescription)("positionTarget",e),t.xp6(1),t.hij(" ",n.itemDescription," "),t.xp6(3),t.Q6J("ngbTooltip",n.conversionOfUnits)("ngClass",n.UOM==n.secondaryUnit?"text-primary pointer":"text-secondary pointer"),t.xp6(1),t.Oqu(t.lcZ(20,27,null==n?null:n.UOM)),t.xp6(3),t.Q6J("ngIf",n.secondaryUnit),t.xp6(1),t.Q6J("ngIf",!n.secondaryUnit),t.xp6(3),t.hij(" ",t.xi3(27,29,n.PPICQty,"1.2-2")," "),t.xp6(4),t.Q6J("ngIf","green"==n.aging),t.xp6(1),t.Q6J("ngIf","red"==n.aging),t.xp6(1),t.Q6J("ngIf","orange"==n.aging),t.xp6(3),t.Q6J("ngIf",t.DdM(32,S).includes(a.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(33,S).includes(a.action))}}function V(r,p){1&r&&(t.TgZ(0,"div",56)(1,"div",57)(2,"button",58),t._uU(3,"Rejection Remarks"),t.qZA(),t._UZ(4,"input",59),t.qZA()())}function W(r,p){if(1&r){const n=t.EpF();t.TgZ(0,"button",60),t.NdJ("click",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.reset())}),t._uU(1," Reset "),t.qZA()}}function $(r,p){if(1&r){const n=t.EpF();t.TgZ(0,"button",61),t.NdJ("click",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.ESCPreview())}),t._uU(1," Esc "),t.qZA()}if(2&r){const n=t.oxw();t.Q6J("disabled",!n.isESCPreview)}}function X(r,p){if(1&r){const n=t.EpF();t.TgZ(0,"button",62),t.NdJ("click",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.preview())}),t._uU(1," Preview "),t.qZA()}}function tt(r,p){if(1&r){const n=t.EpF();t.TgZ(0,"button",63),t.NdJ("click",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.submit())}),t._uU(1," Save "),t.qZA()}if(2&r){const n=t.oxw();t.Q6J("disabled",!n.isPreview)}}function et(r,p){if(1&r){const n=t.EpF();t.TgZ(0,"button",64),t.NdJ("click",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.submit())}),t._uU(1," Approve "),t.qZA()}}function ot(r,p){if(1&r){const n=t.EpF();t.TgZ(0,"button",64),t.NdJ("click",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.submit())}),t._uU(1," Reject "),t.qZA()}}function it(r,p){if(1&r){const n=t.EpF();t.TgZ(0,"button",64),t.NdJ("click",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.submit())}),t._uU(1," Acknowledged "),t.qZA()}}const nt=function(r,p,n,i){return{page:r,pageSize:p,collection:n,search:i,excelDisplay:"none"}},x=function(){return["reject","Acknowledged","approve","view"]},rt=function(){return["approve"]},st=function(){return["reject"]};let at=(()=>{var r;class p{constructor(i,e,a,u,w,N,G,ut){this.giPPICToProductionService=i,this.activatedRoute=e,this.spinner=a,this.toastService=u,this.validationService=w,this.modalService=N,this.utilityService=G,this.location=ut,this.itemCodes=[],this.isPreview=!1,this.submitted=!1,this.isESCPreview=!1,this.action="Awaiting Approval",this.page=1,this.pageSize=5,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.ESCPreviewArr=[],this.statusArr={create:"Awaiting Approval",edit:"Awaiting Approval",approve:"Approved",reject:"Rejected",Acknowledged:"Acknowledged"},this.selectedJobCardDetails={},this.masterData={autoIncrementNo:"",mergeList:[],goodsIssueToOptions:[],JCOptions:[]},this.form=new s.nJ({_id:new s.p4(null),goodsIssueNo:new s.p4(null,[s.kI.required]),goodsIssueDate:new s.p4([s.kI.required]),goodsIssueTo:new s.p4(null,[s.kI.required]),jobCard:new s.p4(null,[s.kI.required]),jobCardNo:new s.p4(null,[s.kI.required]),status:new s.p4("Awaiting Approval"),rejectionRemarks:new s.p4(null),MRNDetails:new s.p4([]),PPICRemarksDetail:new s.p4({}),QARemarksDetail:new s.p4({})})}get f(){return this.form.controls}get PPICRemarks(){return this.form.get("PPICRemarksDetail")}get QARemarks(){return this.form.get("QARemarksDetail")}ngOnInit(){this.getInitialData()}reset(){this.form.reset(),this.masterData.mergeList=[],this.collection=this.masterData.mergeList.length,this.getInitialData(),this.isESCPreview=!1}submit(){if(this.submitted=!0,this.form.enable(),"reject"==this.action&&!this.form.controls.rejectionRemarks.value)return void this.toastService.warning("Rejection Remarks is Required");if(this.validationService.checkErrors(this.form,U.h4))return;let i=this.form.value;i.MRNDetails=this.masterData.mergeList,i._id?this.update(i):(delete i._id,this.create(i))}trackByFn(i,e){return e?._id}create(i){this.spinner.show(),this.giPPICToProductionService.create(i).subscribe(e=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(e.message),this.location.back()})}update(i){this.spinner.show(),this.giPPICToProductionService.update(i._id,i).subscribe(e=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(e.message),this.location.back()})}getInitialData(){this.spinner.show(),this.giPPICToProductionService.getAllMasterData({}).subscribe(i=>{this.masterData=i,this.collection=this.masterData.mergeList.length,this.form.controls.goodsIssueNo.setValue(this.masterData?.autoIncrementNo),this.form.controls.status.setValue("Awaiting Approval"),this.form.controls.goodsIssueDate.setValue(this.utilityService.getTodayDate("YYYY-MM-DD")),this.activatedRoute.queryParams.pipe((0,c.z)(e=>(this.action=e.action,this.utilityService.accessDenied(this.action),e.id?this.giPPICToProductionService.getById(e.id):(0,d.of)({})))).subscribe(e=>{this.spinner.hide(),0!=Object.keys(e).length&&(e.goodsIssueDate&&(e.goodsIssueDate=e.goodsIssueDate.split("T")[0]),this.masterData.mergeList=e.MRNDetails,this.collection=this.masterData.mergeList.length,e.status=this.statusArr[this.action],this.form.patchValue(e),"edit"!=this.action&&this.form.disable(),"reject"==this.action&&(this.form.disable(),this.form.controls.rejectionRemarks.enable()))})})}changeGIQty(i){let e=this.masterData.mergeList.map(a=>a.WIP).indexOf(i.WIP);if(i.issueQty>i.PPICQty)return this.toastService.warning("Goods Issues Qty should not be grater than PPIC Qty!"),void(this.masterData.mergeList[e].issueQty=0)}setConversionOfUnit(i){if(["create","edit"].includes(this.action)){let e=this.masterData.mergeList.map(a=>a?.WIP+a?.SFG).indexOf(i?.WIP+i?.SFG);this.masterData.mergeList[e].UOM==i.secondaryUnit?(this.masterData.mergeList[e].UOM=i.primaryUnit,i.primaryToSecondaryConversion&&(this.masterData.mergeList[e].PPICQty=+i.PPICQty/+i.primaryToSecondaryConversion),i.secondaryToPrimaryConversion&&(this.masterData.mergeList[e].PPICQty=+i.PPICQty*+i.secondaryToPrimaryConversion),this.masterData.mergeList[e].issueQty=0,this.isPreview=!1):(this.masterData.mergeList[e].UOM=i.secondaryUnit,i.primaryToSecondaryConversion&&(this.masterData.mergeList[e].PPICQty=+i.PPICQty*+i.primaryToSecondaryConversion),i.secondaryToPrimaryConversion&&(this.masterData.mergeList[e].PPICQty=+i.PPICQty/+i.secondaryToPrimaryConversion),this.masterData.mergeList[e].issueQty=0,this.isPreview=!1)}}preview(){this.search="",this.isESCPreview=!0,this.ESCPreviewArr=this.masterData.mergeList,this.masterData.mergeList=this.masterData.mergeList.filter(i=>i.issueQty>0),0==this.masterData.mergeList.length?this.toastService.warning("At least One Row is Required!"):this.isPreview=!0,this.collection=this.masterData.mergeList.length}ESCPreview(){this.search="",this.isPreview=!1,this.masterData.mergeList=this.ESCPreviewArr,this.collection=this.masterData.mergeList.length}eventHeader(i){switch(i.key){case"SEARCH":this.search=i.value;break;case"EXCEL":default:break;case"PAGE":this.page=i.value}}openRemarksDetailsModal(){const i=this.modalService.open(D,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});i.componentInstance.action=this.action,i.componentInstance.remarksDetails={PPICRemarksDetail:this.PPICRemarks.value,QARemarksDetail:this.QARemarks.value},i.result.then(e=>{e&&this.form.patchValue(e)},e=>{})}setJobCardId(i){this.f.jobCard.setValue(i?._id)}openJobCardDetailsModal(){const i=this.modalService.open(q.Q,{centered:!0,size:"xl",backdrop:"static",keyboard:!1});i.componentInstance.action="edit"==this.action?"create":this.action,i.componentInstance.selectedJobCardDetails=this.selectedJobCardDetails,i.componentInstance.JCOptions=this.masterData.JCOptions,i.componentInstance.jobCard=this.form.controls.jobCard.value,i.result.then(e=>{e&&(this.selectedJobCardDetails=e?.selectedJobCardDetails,this.form.controls.jobCard.setValue(e?.selectedJobCardDetails?._id),this.form.controls.jobCardNo.setValue(e?.selectedJobCardDetails?.jobCardNo))},e=>{})}}return(r=p).\u0275fac=function(i){return new(i||r)(t.Y36(T.qI),t.Y36(o.gz),t.Y36(C.V),t.Y36(C.kl),t.Y36(_.RJ),t.Y36(m.FF),t.Y36(C.tI),t.Y36(g.Ye))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-gi-ppic-to-production-form"]],decls:79,vars:37,consts:[[1,"formCard","card",3,"formGroup"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,""],[1,"form-body"],[1,"row"],[1,"col-3","pe-5"],["for","",1,"form-label"],[1,"text-danger"],[1,"d-flex","align-items-center"],[1,"col-11"],["bindLabel","jobCardNo","bindValue","jobCardNo","formControlName","jobCardNo",3,"items","clearable","change"],["id","basic-addon1",1,"set-input-group-text","input-group-text","bg-primary","pointer","col-auto",2,"height","2.9rem",3,"click"],["aria-hidden","true",1,"fa","fa-search","text-white","fs-4"],[1,"col-3"],["type","text","formControlName","goodsIssueNo","readonly","",1,"form-control"],["type","date","formControlName","goodsIssueDate",1,"form-control"],["bindLabel","parameterName","bindValue","parameterLabel","formControlName","goodsIssueTo",3,"items","clearable"],[1,"row","line-border"],[3,"data","dataChange"],[1,"table-responsive",2,"min-height","20rem"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],[1,"text-start"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-6","d-flex"],["type","button",1,"btn","btn-primary","px-5",3,"click"],["class","px-5",4,"ngIf"],[1,"col-md-auto","ms-auto"],["type","button","class","btn bg-primary px-5 me-3",3,"click",4,"ngIf"],["type","button","class","btn btn-primary px-4 me-1",3,"disabled","click",4,"ngIf"],["type","button","class","btn bg-primary px-4 me-3",3,"click",4,"ngIf"],["type","button","class","btn bg-primary px-5",3,"disabled","click",4,"ngIf"],["type","button","class","btn bg-primary px-5",3,"click",4,"ngIf"],["itemName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["itemDescription",""],[1,"d-flex","justify-content-between","px-2"],["placement","top",3,"ngbTooltip","ngClass"],[1,"pointer","d-flex","align-items-center"],["class","unit-switch-rev",3,"click",4,"ngIf"],["class","unit-switch-gray",4,"ngIf"],[1,"d-flex","justify-content-center"],["class","flagGreen",4,"ngIf"],["class","flagRed",4,"ngIf"],["class","flagOrange",4,"ngIf"],[4,"ngIf"],["class","form-control form-control-sm w-25","type","number",3,"ngModel","ngModelOptions","ngModelChange","input",4,"ngIf"],[1,"unit-switch-rev",3,"click"],[1,"unit-switch-gray"],[1,"flagGreen"],[1,"flagRed"],[1,"flagOrange"],["type","number",1,"form-control","form-control-sm","w-25",3,"ngModel","ngModelOptions","ngModelChange","input"],[1,"px-5"],[1,"d-flex","align-items-center","text-nowrap"],["type","button",1,"btn","btn-primary","px-3"],["type","text","formControlName","rejectionRemarks",1,"form-control"],["type","button",1,"btn","bg-primary","px-5","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-4","me-1",3,"disabled","click"],["type","button",1,"btn","bg-primary","px-4","me-3",3,"click"],["type","button",1,"btn","bg-primary","px-5",3,"disabled","click"],["type","button",1,"btn","bg-primary","px-5",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5),t.ALo(6,"titlecase"),t.qZA()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"label",8),t._uU(11,"Job Card No. (Ref.) "),t.TgZ(12,"span",9),t._uU(13,"*"),t.qZA()(),t.TgZ(14,"div",10)(15,"div",11)(16,"ng-select",12),t.NdJ("change",function(u){return e.setJobCardId(u)}),t.qZA()(),t.TgZ(17,"div",13),t.NdJ("click",function(){return e.openJobCardDetailsModal()}),t._UZ(18,"i",14),t.qZA()()(),t.TgZ(19,"div",15)(20,"label",8),t._uU(21,"Goods Issue (GI) No. "),t.TgZ(22,"span",9),t._uU(23,"*"),t.qZA()(),t._UZ(24,"input",16),t.qZA(),t.TgZ(25,"div",15)(26,"label",8),t._uU(27,"Goods Issue (GI) Date "),t.TgZ(28,"span",9),t._uU(29,"*"),t.qZA()(),t._UZ(30,"input",17),t.qZA(),t.TgZ(31,"div",15)(32,"label",8),t._uU(33,"Goods Issue To "),t.TgZ(34,"span",9),t._uU(35,"*"),t.qZA()(),t._UZ(36,"ng-select",18),t.qZA()()(),t._UZ(37,"hr",19),t.TgZ(38,"app-setting-header",20),t.NdJ("dataChange",function(u){return e.eventHeader(u)}),t.qZA(),t.TgZ(39,"div",21)(40,"table",22)(41,"thead",23)(42,"tr",24)(43,"th"),t._uU(44,"MRN No."),t.qZA(),t.TgZ(45,"th"),t._uU(46,"MRN Date"),t.qZA(),t.TgZ(47,"th"),t._uU(48,"Item Code"),t.qZA(),t.TgZ(49,"th",25),t._uU(50,"Item Name"),t.qZA(),t.TgZ(51,"th",25),t._uU(52,"Item Description"),t.qZA(),t.TgZ(53,"th"),t._uU(54,"UoM"),t.qZA(),t.TgZ(55,"th"),t._uU(56,"PPIC Qty"),t.qZA(),t.TgZ(57,"th"),t._uU(58,"Aging"),t.qZA(),t.TgZ(59,"th"),t._uU(60,"Issue Qty."),t.qZA()()(),t.TgZ(61,"tbody"),t.YNc(62,H,37,34,"tr",26),t.ALo(63,"slice"),t.ALo(64,"searchFi1ter"),t.qZA()()(),t._UZ(65,"hr",19),t.TgZ(66,"div",6)(67,"div",27)(68,"button",28),t.NdJ("click",function(){return e.openRemarksDetailsModal()}),t._uU(69,"Remarks"),t.qZA(),t.YNc(70,V,5,0,"div",29),t.qZA(),t.TgZ(71,"div",30),t.YNc(72,W,2,0,"button",31),t.YNc(73,$,2,1,"button",32),t.YNc(74,X,2,0,"button",33),t.YNc(75,tt,2,1,"button",34),t.YNc(76,et,2,0,"button",35),t.YNc(77,ot,2,0,"button",35),t.YNc(78,it,2,0,"button",35),t.qZA()()()()),2&i&&(t.Q6J("formGroup",e.form),t.xp6(5),t.hij("Goods Issue (",t.lcZ(6,17,e.action),") I PPIC to Production"),t.xp6(11),t.Q6J("items",e.masterData.JCOptions)("clearable",!1),t.xp6(20),t.Q6J("items",e.masterData.goodsIssueToOptions)("clearable",!1),t.xp6(2),t.Q6J("data",t.l5B(26,nt,e.page,e.pageSize,e.collection,e.search)),t.xp6(24),t.Q6J("ngForOf",t.Dn7(63,19,t.xi3(64,23,e.masterData.mergeList,e.search),(e.page-1)*e.pageSize,(e.page-1)*e.pageSize+e.pageSize))("ngForTrackBy",e.trackByFn),t.xp6(8),t.Q6J("ngIf","reject"==e.action),t.xp6(2),t.Q6J("ngIf",!t.DdM(31,x).includes(e.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(32,x).includes(e.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(33,x).includes(e.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(34,x).includes(e.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(35,rt).includes(e.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(36,st).includes(e.action)),t.xp6(1),t.Q6J("ngIf","Acknowledged"==e.action))},dependencies:[g.mk,g.sg,g.O5,Z.P,m._L,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,s.On,Q.w9,g.OU,g.JJ,g.rS,g.uU,F.G,R.S],encapsulation:2}),p})();var ct=l(19964),lt=l(56208);const dt=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:f},{path:"form",component:at,resolve:{accessScreen:ct.xr}}];let pt=(()=>{var r;class p{}return(r=p).\u0275fac=function(i){return new(i||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[g.ez,o.Bz.forChild(dt),lt.m]}),p})()},61441:(J,b,l)=>{l.d(b,{Q:()=>M});var g=l(43818),o=l(65879),P=l(37285),v=l(96814),I=l(88059),t=l(95346);const T=function(){return["view","edit","rejection","reject","approval","approve","cancel"]};function C(h,f){if(1&h){const s=o.EpF();o.TgZ(0,"tr")(1,"td"),o._uU(2),o.qZA(),o.TgZ(3,"td"),o._uU(4),o.qZA(),o.TgZ(5,"td",26,27)(7,"span",28),o._uU(8),o.qZA()(),o.TgZ(9,"td",26,29)(11,"span",28),o._uU(12),o.qZA()(),o.TgZ(13,"td"),o._uU(14),o.qZA(),o.TgZ(15,"td"),o._uU(16),o.qZA(),o.TgZ(17,"td")(18,"input",30),o.NdJ("change",function(){const m=o.CHM(s).$implicit,_=o.oxw();return o.KtG(_.setSelectData(m))}),o.qZA()()()}if(2&h){const s=f.$implicit,c=f.index,d=o.MAs(6),m=o.MAs(10),_=o.oxw();o.xp6(2),o.Oqu(null==s?null:s.jobCardNo),o.xp6(2),o.Oqu(null==s?null:s.SKUNo),o.xp6(1),o.Udp("width",d.clientWidth),o.xp6(2),o.Q6J("ngbTooltip",s.SKUName)("positionTarget",d),o.xp6(1),o.hij(" ",s.SKUName," "),o.xp6(1),o.Udp("width",m.clientWidth),o.xp6(2),o.Q6J("ngbTooltip",s.SKUDescription)("positionTarget",m),o.xp6(1),o.hij(" ",s.SKUDescription," "),o.xp6(2),o.Oqu(null==s?null:s.UOM),o.xp6(2),o.Oqu(null==s?null:s.batchQty),o.xp6(2),o.MGl("name","formValue",_.JCOptions[c],""),o.Q6J("disabled",o.DdM(17,T).includes(_.action))("checked",s.select)}}function Z(h,f){1&h&&o._UZ(0,"hr",31)}function k(h,f){if(1&h){const s=o.EpF();o.TgZ(0,"div",32)(1,"button",33),o.NdJ("click",function(){o.CHM(s);const d=o.oxw();return o.KtG(d.dismissModel())}),o._uU(2,"Save & Close"),o.qZA()()}}const A=function(h,f,s,c){return{page:h,pageSize:f,collection:s,search:c,excelDisplay:"none"}};let M=(()=>{var h;class f{constructor(c){this.activeModal=c,this.action="edit",this.jobCard="",this.JCOptions=[],this.selectedJobCardDetails={},this.btnDisable=!1,this.page=1,this.pageSize=9,this.collection=0,this.search="",this.column="jobCardNo",this.direction=-1}ngOnInit(){this.jobCard&&(this.selectedJobCardDetails._id=this.jobCard,this.JCOptions=this.JCOptions?.map(c=>(c.select=!1,c._id==this.jobCard&&(c.select=!0),c))),this.collection=this.JCOptions?.length}setSelectData(c){this.selectedJobCardDetails=c}dismissModel(){let c={};c.selectedJobCardDetails=this.selectedJobCardDetails,this.activeModal.close(c)}eventHeader(c){switch(c.key){case"SEARCH":this.search=c.value;break;case"EXCEL":default:break;case"PAGE":this.page=c.value}}onSort({column:c,direction:d}){this.headers.forEach(m=>{m.sortable!==c&&(m.direction="")}),this.JCOptions=""===d||""===c?this.JCOptions:[...this.JCOptions].sort((m,_)=>{let y="string"==typeof m[c]?m[c].toLowerCase():m[c],D="string"==typeof _[c]?_[c].toLowerCase():_[c];const U=y<D?-1:y>D?1:0;return"asc"===d?U:-U})}}return(h=f).\u0275fac=function(c){return new(c||h)(o.Y36(P.Kz))},h.\u0275cmp=o.Xpm({type:h,selectors:[["app-job-card-details-modal"]],viewQuery:function(c,d){if(1&c&&o.Gf(g.j,5),2&c){let m;o.iGM(m=o.CRH())&&(d.headers=m)}},inputs:{action:"action",jobCard:"jobCard",JCOptions:"JCOptions",selectedJobCardDetails:"selectedJobCardDetails"},decls:39,vars:18,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,""],[1,"container-fluid"],[1,"row","justify-content-center"],[1,"col-12","px-0","mt-4"],[1,"px-5","mt-0"],[3,"data","dataChange"],[1,"table-responsive","px-5",2,"min-height","33rem"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],["sortable","jobCardNo",3,"sort"],["sortable","SKUNo",3,"sort"],["sortable","SKUName",1,"text-start",3,"sort"],["sortable","SKUDescription",1,"text-start",3,"sort"],["sortable","UOM",3,"sort"],["sortable","batchQty",3,"sort"],[4,"ngFor","ngForOf"],[1,"row"],[1,"col","px-0","mb-3"],["class","line-border",4,"ngIf"],["class","text-center mb-2",4,"ngIf"],[1,"text-start"],["SKUName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["SKUDescription",""],["type","radio",1,"form-check-input","pointer",3,"disabled","name","checked","change"],[1,"line-border"],[1,"text-center","mb-2"],["type","button",1,"btn","bg-primary","px-5","mb-4",3,"click"]],template:function(c,d){1&c&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2),o._uU(3,"Select Job Card"),o.qZA(),o.TgZ(4,"div")(5,"button",3),o.NdJ("click",function(){return d.activeModal.close()}),o._UZ(6,"i",4),o.qZA()()(),o.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"app-setting-header",10),o.NdJ("dataChange",function(_){return d.eventHeader(_)}),o.qZA()(),o.TgZ(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr",14)(17,"th",15),o.NdJ("sort",function(_){return d.onSort(_)}),o._uU(18,"Job Card No."),o.qZA(),o.TgZ(19,"th",16),o.NdJ("sort",function(_){return d.onSort(_)}),o._uU(20,"SKU No."),o.qZA(),o.TgZ(21,"th",17),o.NdJ("sort",function(_){return d.onSort(_)}),o._uU(22,"SKU Name"),o.qZA(),o.TgZ(23,"th",18),o.NdJ("sort",function(_){return d.onSort(_)}),o._uU(24," SKU Description "),o.qZA(),o.TgZ(25,"th",19),o.NdJ("sort",function(_){return d.onSort(_)}),o._uU(26,"UoM"),o.qZA(),o.TgZ(27,"th",20),o.NdJ("sort",function(_){return d.onSort(_)}),o._uU(28,"Batch Qty."),o.qZA(),o.TgZ(29,"th"),o._uU(30,"Select"),o.qZA()()(),o.TgZ(31,"tbody"),o.YNc(32,C,19,18,"tr",21),o.ALo(33,"slice"),o.ALo(34,"searchFi1ter"),o.qZA()()()()(),o.TgZ(35,"div",22)(36,"div",23),o.YNc(37,Z,1,0,"hr",24),o.qZA()(),o.YNc(38,k,3,0,"div",25),o.qZA()()()),2&c&&(o.xp6(12),o.Q6J("data",o.l5B(11,A,d.page,d.pageSize,d.collection,d.search)),o.xp6(20),o.Q6J("ngForOf",o.Dn7(33,4,o.xi3(34,8,d.JCOptions,d.search),(d.page-1)*d.pageSize,(d.page-1)*d.pageSize+d.pageSize)),o.xp6(5),o.Q6J("ngIf",!o.DdM(16,T).includes(d.action)),o.xp6(1),o.Q6J("ngIf",!o.DdM(17,T).includes(d.action)))},dependencies:[v.sg,v.O5,I.P,P._L,g.j,v.OU,t.G],encapsulation:2}),f})()},13107:(J,b,l)=>{l.d(b,{t:()=>g});const g={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}}},28402:(J,b,l)=>{l.d(b,{J:()=>g});const g=({data:o,headers:P,widths:v,title:I})=>({tableData:{widths:v,headerRows:1,body:[P.map(C=>({text:C.header,style:"header"})),...o.map(C=>P.map(Z=>({style:"subheader",text:C[Z.key]})))]},title:I})}}]);