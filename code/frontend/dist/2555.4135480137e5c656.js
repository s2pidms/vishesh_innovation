"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2555],{42555:(C,_,a)=>{a.r(_),a.d(_,{StockIssueToProductionModule:()=>mt});var d=a(96814),m=a(1076),l=a(60095),h=a(43818),v=a(21631),Z=a(22096),A=a(35469),t=a(65879),f=a(99007),p=a(98977),w=a(16897),I=a(88059),y=a(37285),q=a(95346),F=a(69205),P=a(59103);function J(s,u){if(1&s&&(t.TgZ(0,"option",34),t._uU(1),t.qZA()),2&s){const e=u.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",null==e?null:e.label," ")}}function M(s,u){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&s){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,null==e?null:e.issueQty,"1.2-2")," ")}}const R=function(){return{standalone:!0}};function O(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"input",40),t.NdJ("input",function(){t.CHM(e);const o=t.oxw().index,r=t.oxw();return t.KtG(r.setIssueQty(o))})("ngModelChange",function(o){t.CHM(e);const r=t.oxw().$implicit;return t.KtG(r.issueQty=o)}),t.qZA()}if(2&s){const e=t.oxw().$implicit;t.Q6J("ngModel",e.issueQty)("ngModelOptions",t.DdM(2,R))}}const S=function(){return["view","approve","reject"]};function Q(s,u){if(1&s&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",35)(6,"span",36),t._uU(7),t.ALo(8,"truncate"),t.qZA()(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.ALo(19,"number"),t.ALo(20,"number"),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.ALo(23,"UOMUnitsMaster"),t.qZA(),t.TgZ(24,"td"),t._uU(25),t.ALo(26,"number"),t.qZA(),t.TgZ(27,"td")(28,"div",37),t.YNc(29,M,3,4,"span",38),t.YNc(30,O,1,3,"input",39),t.qZA()()()),2&s){const e=u.$implicit,n=t.oxw();t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(2),t.Q6J("ngbTooltip",e.itemName),t.xp6(1),t.hij(" ",t.xi3(8,13,null==e?null:e.itemName,40)," "),t.xp6(3),t.Oqu(null==e?null:e.stage),t.xp6(2),t.Oqu("SFG-Roll"==(null==e?null:e.stage)?"mm x mtr":"mm x mm"),t.xp6(2),t.Oqu(null==e?null:e.width),t.xp6(2),t.Oqu(null==e?null:e.length),t.xp6(2),t.hij(" ","SFG-Sheet"==(null==e?null:e.stage)?t.xi3(19,16,null==e?null:e.sheetQty,"1.2-2"):t.xi3(20,19,null==e?null:e.qty,"1.2-2")," "),t.xp6(4),t.Oqu(t.lcZ(23,22,null==e?null:e.UOM)),t.xp6(3),t.Oqu(t.xi3(26,24,null==e?null:e.PPICIRQty,"0.2-2")),t.xp6(4),t.Q6J("ngIf",t.DdM(27,S).includes(n.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(28,S).includes(n.action))}}function E(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"button",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.reset())}),t._uU(1," Reset "),t.qZA()}}function L(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"button",48),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.ESCPreview())}),t._uU(1," Esc Preview "),t.qZA()}if(2&s){const e=t.oxw(2);t.Q6J("disabled",!e.isESCPreview)}}function Y(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"button",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.preview())}),t._uU(1," Preview "),t.qZA()}}function G(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.submit())}),t._uU(1," Save "),t.qZA()}if(2&s){const e=t.oxw(2);t.Q6J("disabled",!e.isPreview)}}function j(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.navigateTo())}),t._uU(1," Back "),t.qZA()}}function H(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.submit())}),t._uU(1," Approve "),t.qZA()}}function K(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"button",50),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.submit())}),t._uU(1," Save "),t.qZA()}}const b=function(){return["edit","approve","view"]},z=function(){return["view"]},B=function(){return["approve"]},X=function(){return["edit"]};function $(s,u){if(1&s&&(t.TgZ(0,"div",6)(1,"div",41)(2,"div",42),t.YNc(3,E,2,0,"button",43),t.YNc(4,L,2,1,"button",44),t.YNc(5,Y,2,0,"button",43),t.YNc(6,G,2,1,"button",45),t.YNc(7,j,2,0,"button",46),t.YNc(8,H,2,0,"button",46),t.YNc(9,K,2,0,"button",46),t.qZA()()()),2&s){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",!t.DdM(7,b).includes(e.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(8,b).includes(e.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(9,b).includes(e.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(10,b).includes(e.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(11,z).includes(e.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(12,B).includes(e.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(13,X).includes(e.action))}}function V(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"div",6)(1,"div",51)(2,"div",37)(3,"div",52)(4,"div",53)(5,"label"),t._uU(6,"Remark"),t.qZA()()(),t._UZ(7,"input",54),t.qZA()(),t.TgZ(8,"div",55)(9,"button",50),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.submit())}),t._uU(10,"Reject"),t.qZA()()()}}const W=function(s,u,e,n){return{page:s,pageSize:u,collection:e,search:n,excelDisplay:"none"}},D=function(){return["reject"]};let tt=(()=>{class s{trackByFn(e,n){return n?._id}constructor(e,n,o,r,i,g,T){this.stockIssueToProductionService=e,this.utilityService=n,this.activatedRoute=o,this.spinner=r,this.toastService=i,this.validationService=g,this.location=T,this.page=1,this.pageSize=5,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.stages=[],this.ESCPreviewArr=[],this.filterTableData=[],this.submitted=!1,this.action="create",this.isPreview=!1,this.isESCPreview=!1,this.statusArr={create:"Awaiting Approval",edit:"Awaiting Approval",approve:"Approved",reject:"Rejected"},this.masterData={autoIncrementNo:"",stage:[],SFGList:[]},this.form=new l.nJ({_id:new l.p4(null),stockIssueCode:new l.p4(null),issueDate:new l.p4(this.utilityService.getTodayDate("YYYY-MM-DD"),[l.kI.required]),stage:new l.p4(null,[l.kI.required]),department:new l.p4("Production",[l.kI.required]),jobCardNo:new l.p4(null),stockIssueDetails:new l.p4([]),remarks:new l.p4(null),status:new l.p4("Awaiting Approval")})}ngOnInit(){this.getInitialData()}get f(){return this.form.controls}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value;break;case"EXCEL":default:break;case"PAGE":this.page=e.value}}submit(){if(this.submitted=!0,this.form.enable(),"reject"==this.action&&!this.form.controls.remarks.value)return void this.toastService.warning("Remark is Required");if(this.validationService.checkErrors(this.form,A.vR))return;let e=this.form.value;e.stockIssueDetails=this.filterTableData,e._id?this.update(e):(delete e._id,this.create(e))}navigateTo(){this.location.back()}create(e){this.spinner.show(),this.stockIssueToProductionService.create(e).subscribe(n=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(n.message),this.location.back()})}update(e){this.spinner.show(),this.stockIssueToProductionService.update(e._id,e).subscribe(n=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(n.message),this.location.back()})}reset(){this.form.reset(),this.filterTableData=[],this.getInitialData(),this.collection=this.filterTableData.length}getInitialData(){this.spinner.show(),this.stockIssueToProductionService.getAllMasterData({}).subscribe(e=>{this.form.controls.stockIssueCode.setValue(e.autoIncrementNo),this.form.controls.department.setValue("Production"),this.form.controls.issueDate.setValue(this.utilityService.getTodayDate("YYYY-MM-DD")),this.form.controls.status.setValue(this.statusArr[this.action]),this.stages=e?.stage,this.tableData=e?.SFGList.map(n=>({MRN:n?.MRN,MRNNumber:n?.MRNNumber,item:n?.item,SFGId:n?._id,itemCode:n?.itemCode,itemName:n?.itemName,stage:n?.stage,width:n?.outputDetails?.width,length:n?.outputDetails?.length,sqmPerRoll:n?.outputDetails?.sqmPerRoll,sheetQty:n?.outputDetails?.sheetQty,qty:n?.outputDetails?.noOfSlits,UOM:n?.UOM,PPICIRQty:n?.outputDetails?.sqmTotal,issueQty:0})),this.activatedRoute.queryParams.pipe((0,v.z)(n=>(this.action=n.action,this.utilityService.accessDenied(this.action),n.id?this.stockIssueToProductionService.getById(n.id):(0,Z.of)({})))).subscribe(n=>{this.spinner.hide(),0!=Object.keys(n).length&&(n.issueDate&&(n.issueDate=this.utilityService.getFormatDate(n.issueDate,"YYYY-MM-DD")),n.status=this.statusArr[this.action],this.filterTableData=n?.stockIssueDetails,this.form.patchValue(n),"create"!=this.action&&(this.form.disable(),this.form.controls.remarks.enable()))})})}setStage(e){this.isESCPreview=!1,this.isPreview=!1,this.filterTableData=this.tableData,this.filterTableData=this.filterTableData.filter(n=>n.stage==e.target.value),this.collection=this.filterTableData.length}preview(){this.search="",this.ESCPreviewArr=this.filterTableData,this.filterTableData=this.filterTableData.filter(e=>e.issueQty>0),this.filterTableData.length&&(this.isPreview=!0,this.isESCPreview=!0),this.collection=this.filterTableData.length}ESCPreview(){this.search="",this.isPreview=!1,this.filterTableData=this.ESCPreviewArr,this.collection=this.filterTableData.length}setIssueQty(e){this.filterTableData[e+=(this.page-1)*this.pageSize].issueQty>+this.filterTableData[e].PPICIRQty.toFixed(2)&&(this.filterTableData[e].issueQty=0,this.toastService.warning("Issue Qty cannot be greater than PPIC-IR Qty. "))}onSort({column:e,direction:n}){this.headers.forEach(o=>{o.sortable!==e&&(o.direction="")}),this.filterTableData=""===n||""===e?this.filterTableData:[...this.filterTableData].sort((o,r)=>{let i="string"==typeof o[e]?o[e].toLowerCase():o[e],g="string"==typeof r[e]?r[e].toLowerCase():r[e];const T=i<g?-1:i>g?1:0;return"asc"===n?T:-T})}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(f.rj),t.Y36(p.tI),t.Y36(m.gz),t.Y36(p.V),t.Y36(p.kl),t.Y36(w.RJ),t.Y36(d.Ye))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-issue-to-production-form"]],viewQuery:function(n,o){if(1&n&&t.Gf(h.j,5),2&n){let r;t.iGM(r=t.CRH())&&(o.headers=r)}},decls:70,vars:24,consts:[[1,"formCard","card",3,"formGroup"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,""],[1,"form-body"],[1,"row"],[1,"col-md-3"],[1,"form-label","mb-0"],[1,"text-danger"],["type","date","formControlName","issueDate","readonly","",1,"form-control"],["formControlName","stage",1,"form-select",3,"change"],["value","null","selected","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","department","readonly","",1,"form-control"],["type","text","formControlName","jobCardNo",1,"form-control"],[1,"row","line-border"],[3,"data","dataChange"],[1,"table-responsive","mt-0","text-wrap",2,"min-height","21rem"],[1,"table","table-bordered","mt-0","table-sm"],[1,"bg-info"],[1,"text-white"],["sortable","MRNNumber",3,"sort"],["sortable","itemCode",3,"sort"],["sortable","itemName",1,"text-start",3,"sort"],["sortable","stage",3,"sort"],["sortable","unitConversion",3,"sort"],["sortable","width",3,"sort"],["sortable","length",3,"sort"],["sortable","UOM",3,"sort"],["sortable","PPICIRQty",3,"sort"],["sortable","issueQty",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","row",4,"ngIf"],[3,"value"],[1,"text-start"],["placement","right",1,"pointer",3,"ngbTooltip"],[1,"d-flex","justify-content-center"],[4,"ngIf"],["type","number","class","form-control form-control-xs w-25",3,"ngModel","ngModelOptions","input","ngModelChange",4,"ngIf"],["type","number",1,"form-control","form-control-xs","w-25",3,"ngModel","ngModelOptions","input","ngModelChange"],[1,"col","text-center"],[1,"d-grid","gap-2","d-md-block"],["type","button","class","btn btn-primary px-5 me-3",3,"click",4,"ngIf"],["type","button","class","btn btn-primary px-3 me-3",3,"disabled","click",4,"ngIf"],["class","btn btn-primary px-5","type","button",3,"disabled","click",4,"ngIf"],["class","btn btn-primary px-5","type","button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary","px-5","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-3","me-3",3,"disabled","click"],["type","button",1,"btn","btn-primary","px-5",3,"disabled","click"],["type","button",1,"btn","btn-primary","px-5",3,"click"],[1,"col-5","px-5"],[1,"col-form-label","text-nowrap","pt-0"],[1,"btn","btn-primary","py-1"],["type","text","formControlName","remarks",1,"form-control"],[1,"col-2","text-center","ms-0"]],template:function(n,o){1&n&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5),t.ALo(6,"titlecase"),t.qZA()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"label",8),t._uU(11," Issue Date"),t.TgZ(12,"span",9),t._uU(13,"*"),t.qZA()(),t._UZ(14,"input",10),t.qZA(),t.TgZ(15,"div",7)(16,"label",8),t._uU(17," Stage/Category "),t.TgZ(18,"span",9),t._uU(19,"*"),t.qZA()(),t.TgZ(20,"select",11),t.NdJ("change",function(i){return o.setStage(i)}),t.TgZ(21,"option",12),t._uU(22,"Select Category"),t.qZA(),t.YNc(23,J,2,2,"option",13),t.qZA()(),t.TgZ(24,"div",7)(25,"label",8),t._uU(26," Department"),t.TgZ(27,"span",9),t._uU(28,"*"),t.qZA()(),t._UZ(29,"input",14),t.qZA(),t.TgZ(30,"div",7)(31,"label",8),t._uU(32," Job Card No. (Optional)"),t._UZ(33,"span",9),t.qZA(),t._UZ(34,"input",15),t.qZA()()(),t._UZ(35,"hr",16),t.TgZ(36,"app-setting-header",17),t.NdJ("dataChange",function(i){return o.eventHeader(i)}),t.qZA(),t.TgZ(37,"div",18)(38,"table",19)(39,"thead",20)(40,"tr",21)(41,"th",22),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(42,"MRN No."),t.qZA(),t.TgZ(43,"th",23),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(44,"Item Code"),t.qZA(),t.TgZ(45,"th",24),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(46,"Item Name"),t.qZA(),t.TgZ(47,"th",25),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(48,"Stage"),t.qZA(),t.TgZ(49,"th",26),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(50,"W X L"),t.qZA(),t.TgZ(51,"th",27),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(52,"Width"),t.qZA(),t.TgZ(53,"th",28),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(54,"Length"),t.qZA(),t.TgZ(55,"th",25),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(56,"Qty (C)"),t.qZA(),t.TgZ(57,"th",29),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(58,"UoM"),t.qZA(),t.TgZ(59,"th",30),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(60,"PPIC-IR Qty."),t.qZA(),t.TgZ(61,"th",31),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(62,"Issue Qty."),t.qZA()()(),t.TgZ(63,"tbody"),t.YNc(64,Q,31,29,"tr",32),t.ALo(65,"slice"),t.ALo(66,"searchFi1ter"),t.qZA()()(),t._UZ(67,"hr",16),t.YNc(68,$,10,14,"div",33),t.YNc(69,V,11,0,"div",33),t.qZA()()),2&n&&(t.Q6J("formGroup",o.form),t.xp6(5),t.hij("Stock Issue to Production (",t.lcZ(6,8,o.action),")"),t.xp6(18),t.Q6J("ngForOf",o.stages),t.xp6(13),t.Q6J("data",t.l5B(17,W,o.page,o.pageSize,o.collection,o.search)),t.xp6(28),t.Q6J("ngForOf",t.Dn7(65,10,t.xi3(66,14,o.filterTableData,o.search),(o.page-1)*o.pageSize,(o.page-1)*o.pageSize+o.pageSize))("ngForTrackBy",o.trackByFn),t.xp6(4),t.Q6J("ngIf",!t.DdM(22,D).includes(o.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(23,D).includes(o.action)))},dependencies:[d.sg,d.O5,I.P,y._L,l._Y,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.JL,l.sg,l.u,l.On,h.j,d.OU,d.JJ,d.rS,q.G,F.W,P.S],encapsulation:2})}return s})();var et=a(25116),c=a(13107),nt=a(28402);let it=["*","*","*","*","*","*","*","*",,"*","*","*","*","*"],x="Stock Issue To Production",k=[{header:"Issue Dt.",key:"issueDate",...c.t},{header:"Department",key:"department",...c.t},{header:"Job Card No",key:"jobCardNo",...c.t},{header:"MRN No.",key:"MRNNumber",...c.t},{header:"Item Code",key:"itemCode",...c.t},{header:"Item Name",key:"itemName",...c.t},{header:"Stage",key:"stage",...c.t},{header:"W X L",key:"WxL",...c.t},{header:"Width",key:"width",...c.t},{header:"Length",key:"length",...c.t},{header:"Qty (C)",key:"qty",...c.t},{header:"UoM",key:"UOM",...c.t},{header:"Issue Qty.",key:"issueQty",...c.t}];var at=a(53421);function lt(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td",24,25)(9,"span",26),t._uU(10),t.qZA()(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.ALo(23,"UOMUnitsMaster"),t.qZA(),t.TgZ(24,"td"),t._uU(25),t.qZA(),t.TgZ(26,"td")(27,"div",27),t._UZ(28,"button",28),t.TgZ(29,"div",29)(30,"a",30),t.NdJ("click",function(){const r=t.CHM(e).$implicit,i=t.oxw();return t.KtG(i.navigateTo("../form",r,"view"))}),t._UZ(31,"i",31),t._uU(32," View "),t.qZA(),t.TgZ(33,"a",30),t.NdJ("click",function(){const r=t.CHM(e).$implicit,i=t.oxw();return t.KtG(i.navigateTo("../form",r,"edit"))}),t._UZ(34,"i",32),t._uU(35," Edit "),t.qZA(),t.TgZ(36,"a",30),t.NdJ("click",function(){const r=t.CHM(e).$implicit,i=t.oxw();return t.KtG(i.navigateTo("../form",r,"approve"))}),t._UZ(37,"i",33),t._uU(38," Approve "),t.qZA(),t.TgZ(39,"a",30),t.NdJ("click",function(){const r=t.CHM(e).$implicit,i=t.oxw();return t.KtG(i.navigateTo("../form",r,"reject"))}),t._UZ(40,"i",34),t._uU(41," Reject "),t.qZA()()()()()}if(2&s){const e=u.$implicit,n=t.MAs(8),o=t.oxw();t.xp6(2),t.Oqu(null==e?null:e.issueDate),t.xp6(2),t.Oqu(null==e?null:e.MRNNumber),t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("positionTarget",n)("ngbTooltip",e.itemName),t.xp6(1),t.hij(" ",e.itemName?e.itemName:null," "),t.xp6(2),t.Oqu(null==e?null:e.stage),t.xp6(2),t.Oqu("SFG-Roll"==(null==e?null:e.stage)?"mm x mtr":"mm x mm"),t.xp6(2),t.Oqu(null==e?null:e.width),t.xp6(2),t.Oqu(null==e?null:e.length),t.xp6(2),t.Oqu("SFG-Roll"==(null==e?null:e.stage)?null==e?null:e.qty:null==e?null:e.sheetQty),t.xp6(2),t.Oqu(t.lcZ(23,25,null==e?null:e.UOM)),t.xp6(3),t.Oqu(null==e?null:e.issueQty),t.xp6(5),t.Q6J("accessType",o.rolePermissionActions.viewAction),t.xp6(3),t.ekj("disable","Approved"===(null==e?null:e.status)||"Rejected"===(null==e?null:e.status)),t.Q6J("accessType",o.rolePermissionActions.editAction),t.xp6(3),t.ekj("disable","Approved"===(null==e?null:e.status)||"Rejected"===(null==e?null:e.status)),t.Q6J("accessType",o.rolePermissionActions.approveAction),t.xp6(3),t.ekj("disable","Approved"===(null==e?null:e.status)||"Rejected"===(null==e?null:e.status)),t.Q6J("accessType",o.rolePermissionActions.approveAction)}}const ut=function(s,u,e,n){return{page:s,pageSize:u,collection:e,search:n,type:"list"}};let ct=(()=>{class s{constructor(e,n,o,r,i,g,T){this.router=e,this.spinner=n,this.stockIssueToProductionService=o,this.exportExcelService=r,this.activatedRoute=i,this.storageService=g,this.exportToPDFService=T,this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.userData={},this.rolePermissionActions=et.a1}ngOnInit(){this.userData=this.storageService.get("IDMSAUser"),this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}navigateTo(e,n,o){return"Awaiting Approval"==n.status&&"edit"==o||"Awaiting Approval"==n.status&&"approve"==o||"Awaiting Approval"==n.status&&"reject"==o||"Approved"==n.status&&"view"==o||"Rejected"==n.status&&"view"==o||"Awaiting Approval"==n.status&&"view"==o||"create"==o?void this.router.navigate([e],{relativeTo:this.activatedRoute,queryParams:{id:n?._id,action:o}}):null}trackByFn(e,n){return n?._id}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=e.value,this.getAll()}}getAll(e=!1,n=""){this.spinner.show();let o={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:e};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.stockIssueToProductionService.getAll(o).subscribe(r=>{"EXCEL"==n?this.excelDownload(r.rows):"PDF"==n?this.pdfDownload(r.rows):(this.tableData=r.rows,this.collection=r.count),this.spinner.hide()})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}excelDownload(e){this.exportExcelService.exportExcel((s=>({title:x,csvData:s,headers:k}))(e))}pdfDownload(e){let n=(s=>(0,nt.J)({data:s,headers:k,widths:it,title:x}))(e);this.exportToPDFService.generatePdf(n.tableData,n.title)}onSort({column:e,direction:n}){this.headers.forEach(o=>{o.sortable!==e&&(o.direction="")}),this.column=e,this.direction="asc"==n?1:-1,this.getAll()}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(m.F0),t.Y36(p.V),t.Y36(f.rj),t.Y36(p.Ol),t.Y36(m.gz),t.Y36(p.V1),t.Y36(p.$L))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-issue-to-production-list"]],viewQuery:function(n,o){if(1&n&&t.Gf(h.j,5),2&n){let r;t.iGM(r=t.CRH())&&(o.headers=r)}},decls:41,vars:9,consts:[[1,"listCard","card"],[1,"table-header"],[1,"col"],[1,"heading"],["appAccessControl","",1,"text-center",3,"accessType"],["type","button",1,"btn","bg-primary","btn-add",3,"click"],["aria-hidden","true",1,"fa","fa-plus-square","fa-lg","mx-2"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","issueDate",3,"sort"],["sortable","MRNNumber",3,"sort"],["sortable","itemCode",3,"sort"],["sortable","itemName",1,"text-start",3,"sort"],["sortable","stage",3,"sort"],["sortable","width",3,"sort"],["sortable","length",3,"sort"],["sortable","qty",3,"sort"],["sortable","UOM",3,"sort"],["sortable","issueQty",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["SKUName",""],[1,"pointer",3,"positionTarget","ngbTooltip"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-check","fa-lg","me-2","text-success"],["aria-hidden","true",1,"fa","fa-close","me-3","text-primary"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),t._uU(4,"Summary of Stock Issue to Production"),t.qZA()()(),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return o.navigateTo("../form",{},"create")}),t._UZ(7,"i",6),t._uU(8," Create Stock Issue Entry to Production "),t.qZA()(),t._UZ(9,"hr",7),t.TgZ(10,"div",8)(11,"app-setting-header",9),t.NdJ("dataChange",function(i){return o.eventHeader(i)}),t.qZA(),t.TgZ(12,"table",10)(13,"thead",11)(14,"tr",12)(15,"th",13),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(16,"Issue Dt."),t.qZA(),t.TgZ(17,"th",14),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(18,"MRN No."),t.qZA(),t.TgZ(19,"th",15),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(20,"Item Code"),t.qZA(),t.TgZ(21,"th",16),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(22,"Item Name"),t.qZA(),t.TgZ(23,"th",17),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(24,"Stage"),t.qZA(),t.TgZ(25,"th",17),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(26,"W X L"),t.qZA(),t.TgZ(27,"th",18),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(28,"Width"),t.qZA(),t.TgZ(29,"th",19),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(30,"Length"),t.qZA(),t.TgZ(31,"th",20),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(32,"Qty (C)"),t.qZA(),t.TgZ(33,"th",21),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(34,"UoM"),t.qZA(),t.TgZ(35,"th",22),t.NdJ("sort",function(i){return o.onSort(i)}),t._uU(36,"Issue Qty."),t.qZA(),t.TgZ(37,"th"),t._uU(38,"Action"),t.qZA()()(),t.TgZ(39,"tbody"),t.YNc(40,lt,42,27,"tr",23),t.qZA()()()()),2&n&&(t.xp6(5),t.Q6J("accessType",o.rolePermissionActions.createAction),t.xp6(6),t.Q6J("data",t.l5B(4,ut,o.page,o.pageSize,o.collection,o.search)),t.xp6(29),t.Q6J("ngForOf",o.tableData)("ngForTrackBy",o.trackByFn))},dependencies:[d.sg,I.P,y._L,h.j,at.J,P.S],encapsulation:2})}return s})();var dt=a(56208);const _t=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:ct},{path:"form",component:tt,resolve:{accessScreen:a(65876).x}}];let mt=(()=>{class s{static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275mod=t.oAB({type:s});static#o=this.\u0275inj=t.cJS({imports:[d.ez,m.Bz.forChild(_t),dt.m]})}return s})()},13107:(C,_,a)=>{a.d(_,{t:()=>d});const d={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}}},28402:(C,_,a)=>{a.d(_,{J:()=>d});const d=({data:m,headers:l,widths:h,title:v})=>({tableData:{widths:h,headerRows:1,body:[l.map(t=>({text:t.header,style:"header"})),...m.map(t=>l.map(f=>({style:"subheader",text:t[f.key]})))]},title:v})}}]);