"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1956],{1956:(U,m,a)=>{a.r(m),a.d(m,{SubModuleManagementModule:()=>q});var c=a(96814),_=a(1076),e=a(65879),p=a(37285),u=a(98977),g=a(88059),d=a(60095),h=a(95346);function b(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",13),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"input",18),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).$implicit;return e.KtG(l.isChecked=n)}),e.qZA()()()}if(2&i){const t=r.$implicit,o=r.index,n=e.oxw();e.xp6(2),e.Oqu(1+o+(n.page-1)*n.pageSize),e.xp6(2),e.hij(" ",null==t?null:t.displayRoleName," "),e.xp6(2),e.Q6J("ngModel",t.isChecked)}}const M=function(i,r,t,o){return{page:i,pageSize:r,collection:t,search:o,excelDisplay:"none"}};let C=(()=>{class i{constructor(t,o){this.activeModal=t,this.toastService=o,this.action="",this.roles=[],this.roleNames=[],this.page=1,this.pageSize=6,this.collection=0,this.search="",this.column="createdAt",this.direction=-1}ngOnInit(){if(this.roleNames=this.roleNames.map(t=>(t.isChecked=!0,t)),this.collection=this.roleNames.length,this.roles&&this.roles.length>0)for(const t of this.roleNames)this.roles.includes(t._id)&&(t.isChecked=!1)}deleteTableRow(t){this.roleNames.length>1&&this.roleNames.splice(t+(this.page-1)*this.pageSize,1),this.collection=this.roleNames.length}addTableRow(t,o){o.role?(this.roleNames.push({role:""}),this.collection=this.roleNames.length):this.toastService.warning("Role is required")}dismissModel(){this.activeModal.close(this.roleNames.filter(t=>!t.isChecked).map(t=>t._id))}eventHeader(t){switch(t.key){case"SEARCH":this.search=t.value,this.page=1;break;case"EXCEL":default:break;case"PAGE":this.page=t.value}}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(p.Kz),e.Y36(u.kl))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-sub-module-roll"]],inputs:{action:"action",roles:"roles",roleNames:"roleNames"},decls:29,vars:14,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid"],[1,"row","mt-4"],[1,"px-5"],[3,"data","dataChange"],[1,"table-responsive","mt-0","text-wrap","px-5",2,"min-height","23rem"],[1,"table","table-bordered","mt-0","table-sm"],[1,"bg-info"],[1,"text-white"],[1,"text-start"],[4,"ngFor","ngForOf"],[1,"line-border"],[1,"text-center","mt-1","mb-3"],["type","button",1,"btn","bg-primary","px-5",3,"click"],["type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Add Role"),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return n.dismissModel()}),e._UZ(6,"i",4),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"app-setting-header",8),e.NdJ("dataChange",function(l){return n.eventHeader(l)}),e.qZA()(),e.TgZ(11,"div",9)(12,"table",10)(13,"thead",11)(14,"tr",12)(15,"th"),e._uU(16,"Sr No."),e.qZA(),e.TgZ(17,"th",13),e._uU(18,"Roles"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"Action"),e.qZA()()(),e.TgZ(21,"tbody"),e.YNc(22,b,7,3,"tr",14),e.ALo(23,"slice"),e.ALo(24,"searchFi1ter"),e.qZA()()(),e._UZ(25,"hr",15),e.TgZ(26,"div",16)(27,"button",17),e.NdJ("click",function(){return n.dismissModel()}),e._uU(28,"Save & Close"),e.qZA()()()()()),2&o&&(e.xp6(10),e.Q6J("data",e.l5B(9,M,n.page,n.pageSize,n.collection,n.search)),e.xp6(12),e.Q6J("ngForOf",e.Dn7(23,2,e.xi3(24,6,n.roleNames,n.search),(n.page-1)*n.pageSize,(n.page-1)*n.pageSize+n.pageSize)))},dependencies:[c.sg,g.P,d.Wl,d.JJ,d.On,c.OU,h.G],encapsulation:2})}return i})();var f=a(88354);function Z(i,r){if(1&i&&(e.TgZ(0,"option",20),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t._id),e.xp6(1),e.hij(" ",null==t?null:t.title," ")}}function v(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"tr",40)(1,"td")(2,"div",26)(3,"input",27),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).$implicit;return e.KtG(l.order=n)}),e.qZA()()(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td")(7,"div",26)(8,"input",28),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).$implicit;return e.KtG(l.displayName=n)}),e.qZA()()(),e.TgZ(9,"td")(10,"input",29),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).$implicit;return e.KtG(l.disabled=n)}),e.qZA()(),e.TgZ(11,"td")(12,"input",29),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).$implicit;return e.KtG(l.isDisplay=n)}),e.qZA()()()}if(2&i){const t=r.$implicit;e.xp6(3),e.Q6J("ngModel",t.order),e.xp6(2),e.hij(" ",t.title," "),e.xp6(3),e.Q6J("ngModel",t.displayName),e.xp6(2),e.Q6J("ngModel",t.disabled),e.xp6(2),e.Q6J("ngModel",t.isDisplay)}}function T(i,r){if(1&i&&(e.ynx(0,21),e.TgZ(1,"tr")(2,"td",36)(3,"div",37)(4,"table",38),e.YNc(5,v,13,5,"tr",39),e.qZA()()()(),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",t.items)}}function x(i,r){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr")(2,"td")(3,"div",26)(4,"input",27),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).$implicit;return e.KtG(l.order=n)}),e.qZA()()(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"div",26)(9,"input",28),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).$implicit;return e.KtG(l.displayName=n)}),e.qZA()()(),e.TgZ(10,"td")(11,"input",29),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).$implicit;return e.KtG(l.disabled=n)}),e.qZA()(),e.TgZ(12,"td")(13,"input",29),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).$implicit;return e.KtG(l.isDisplay=n)}),e.qZA()(),e.TgZ(14,"td")(15,"div",26)(16,"button",30),e.NdJ("click",function(){const s=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.openRollsModal(s))}),e._uU(17," Add Role "),e.qZA()()(),e.TgZ(18,"td")(19,"div",31),e._UZ(20,"button",32),e.TgZ(21,"div",33)(22,"a",34),e.NdJ("click",function(){const s=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.deleteModule(s._id))}),e._UZ(23,"i",35),e._uU(24," Delete "),e.qZA()()()()(),e.YNc(25,T,6,1,"ng-container",18),e.BQk()}if(2&i){const t=r.$implicit;e.xp6(4),e.Q6J("ngModel",t.order),e.xp6(2),e.hij(" ",t.title," "),e.xp6(3),e.Q6J("ngModel",t.displayName),e.xp6(2),e.Q6J("ngModel",t.disabled),e.xp6(2),e.Q6J("ngModel",t.isDisplay),e.xp6(12),e.Q6J("ngIf",t.items.length>0)}}function A(i,r){if(1&i&&(e.TgZ(0,"div",21)(1,"table",22)(2,"thead",23)(3,"tr",24)(4,"th"),e._uU(5,"Order"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Title"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Display Name"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Disabled"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Is Display"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Role"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Action"),e.qZA()()(),e.TgZ(18,"tbody"),e.YNc(19,x,26,6,"ng-container",25),e.qZA()()()),2&i){const t=e.oxw();e.xp6(19),e.Q6J("ngForOf",t.subModuleData)}}const S=function(i){return{"d-none":i}};function N(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",42)(1,"button",43),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.reset())}),e._uU(2,"Reset"),e.qZA(),e.TgZ(3,"button",44),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.submit())}),e._uU(4,"Save"),e.qZA()()}if(2&i){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(1,S,"View"==t.action))}}function y(i,r){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,N,5,3,"div",41),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf","view"!=t.action)}}let F=(()=>{class i{constructor(t,o,n,s,l){this.subModulesService=t,this.spinner=o,this.toastService=n,this.appGlobalService=s,this.modalService=l,this.submitted=!1,this.action="create",this.roles=[],this.moduleNames=[],this.tableData=[],this.roleNames=[],this.view="",this.type="",this.module="",this.subModuleData=[],this.existingRoles=[]}ngOnInit(){this.appGlobalService.getData(["menuItems"]).subscribe(t=>{this.moduleNames=t.menuItems})}reset(){this.type="",this.module="",this.subModuleData=[]}submit(){this.spinner.show(),this.subModuleData=this.subModuleData,this.subModulesService.update(this.subModuleData).subscribe(t=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(t.message),this.reset()})}deleteModule(t){this.spinner.show(),this.subModulesService.delete(t).subscribe(o=>{this.spinner.hide(),this.toastService.success(o.message),this.reset()})}getFilterData(){this.spinner.show(),this.subModulesService.getAll({menuID:this.module,tabType:this.type,display:null,subItemsFilter:"no"}).subscribe(o=>{this.subModuleData=o?.rows,this.roleNames=o?.roles.map(n=>(n.isChecked=!0,n))}),this.spinner.hide()}openRollsModal(t){const o=this.modalService.open(C,{centered:!0,backdrop:"static",keyboard:!1,size:"lg"});o.componentInstance.action=this.action,o.componentInstance.roleNames=this.roleNames,o.componentInstance.roles=t.roles,o.result.then(n=>{if(n){let s=this.subModuleData.map(l=>l._id).indexOf(t._id);console.log("success",n),this.subModuleData[s].roles=n}},n=>{})}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(f.M5),e.Y36(u.V),e.Y36(u.kl),e.Y36(u.P0),e.Y36(p.FF))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-sub-module-form"]],decls:39,vars:5,consts:[[1,"formCard","card","mb-4"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,"form-body"],[1,"row"],[1,"col"],[1,"form-label"],[1,"text-danger"],[1,"form-select",3,"ngModel","ngModelChange"],["value","null","selected","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["value","MASTER"],["value","TRANSACTION"],["value","REPORT"],[1,"col-auto","align-self-end","ps-3","pe-0"],["type","button",1,"btn","btn-primary",3,"click"],[1,"col-auto","align-self-end","ps-3"],["class","table-responsive",4,"ngIf"],[4,"ngIf"],[3,"value"],[1,"table-responsive"],[1,"table","table-bordered","mt-4"],[1,"bg-primary"],[1,"text-white"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center"],["type","number",1,"form-control","form-control-sm","w-25",3,"ngModel","ngModelChange"],["type","text",1,"form-control","form-control-smm","w-25",3,"ngModel","ngModelChange"],["type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"btn","btn-primary","py-0",3,"click"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["href","javascript:void(0)",3,"click"],["aria-hidden","true",1,"fa","fa-trash","me-2","text-primary"],["colspan","7"],[1,"card","sub-menu-card"],[1,"table","align-middle"],["class","",4,"ngFor","ngForOf"],[1,""],["class","d-grid gap-2 d-md-flex justify-content-md-center mb-3",3,"ngClass",4,"ngIf"],[1,"d-grid","gap-2","d-md-flex","justify-content-md-center","mb-3",3,"ngClass"],["type","button",1,"btn","bg-primary","px-5","me-3",3,"click"],["type","button",1,"btn","bg-primary","px-5",3,"click"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label"),e._uU(5,"Module "),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"label",7),e._uU(10," Module Name "),e.TgZ(11,"span",8),e._uU(12,"*"),e.qZA()(),e.TgZ(13,"select",9),e.NdJ("ngModelChange",function(l){return n.module=l}),e.TgZ(14,"option",10),e._uU(15,"Select Module Name"),e.qZA(),e.YNc(16,Z,2,2,"option",11),e.qZA()(),e.TgZ(17,"div",6)(18,"label",7),e._uU(19," Types "),e.TgZ(20,"span",8),e._uU(21,"*"),e.qZA()(),e.TgZ(22,"select",9),e.NdJ("ngModelChange",function(l){return n.type=l}),e.TgZ(23,"option",10),e._uU(24,"Select Type"),e.qZA(),e.TgZ(25,"option",12),e._uU(26,"Master"),e.qZA(),e.TgZ(27,"option",13),e._uU(28,"Transaction"),e.qZA(),e.TgZ(29,"option",14),e._uU(30,"Reports"),e.qZA()()(),e.TgZ(31,"div",15)(32,"button",16),e.NdJ("click",function(){return n.getFilterData()}),e._uU(33,"Apply Filter"),e.qZA()(),e.TgZ(34,"div",17)(35,"button",16),e.NdJ("click",function(){return n.reset()}),e._uU(36,"Reset Filter"),e.qZA()()()(),e.YNc(37,A,20,1,"div",18),e.YNc(38,y,2,1,"div",19),e.qZA()()),2&o&&(e.xp6(13),e.Q6J("ngModel",n.module),e.xp6(3),e.Q6J("ngForOf",n.moduleNames),e.xp6(6),e.Q6J("ngModel",n.type),e.xp6(15),e.Q6J("ngIf",n.subModuleData.length>0),e.xp6(1),e.Q6J("ngIf",n.subModuleData.length>0))},dependencies:[c.mk,c.sg,c.O5,d.YN,d.Kr,d.Fj,d.wV,d.Wl,d.EJ,d.JJ,d.On],styles:[".form-control-smm[_ngcontent-%COMP%]{margin:0!important;height:2.9rem!important;width:25rem!important;text-align:center!important;box-shadow:#00000059 0 2px 5px!important}.sub-menu-card[_ngcontent-%COMP%]{box-shadow:#11111a0d 0 1px,#11111a1a 0 0 8px;background-color:#e3f7ff!important}.sub-menu-card[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin:0}.sub-menu-card[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.1rem!important;max-width:28rem;word-wrap:break-word;border:.55px solid rgb(181,180,180)}"]})}return i})();var J=a(56208);const k=[{path:"form",component:F}];let q=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#n=this.\u0275inj=e.cJS({imports:[c.ez,_.Bz.forChild(k),J.m]})}return i})()}}]);