"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6191],{26191:(E,h,a)=>{a.r(h),a.d(h,{InventoryReportModule:()=>j});var p=a(96814),g=a(1076),_=a(43818),v=a(25116),I=a(31655),t=a(65879),y=a(73374),u=a(99328),f=a(88059),Z=a(37285),c=a(60095),b=a(50363),T=a(83344),A=a(59103);function N(i,l){if(1&i&&(t.TgZ(0,"option",46),t._uU(1),t.qZA()),2&i){const e=l.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.label," ")}}function C(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",47)(1,"label",7),t._uU(2,"Report Specific Search"),t.qZA(),t.TgZ(3,"ng-select",48),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.supplierId=n)}),t.qZA(),t.TgZ(4,"span",10),t._UZ(5,"img",11),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("items",e.suppliersArr)("clearable",!1)("ngModel",e.supplierId)}}function U(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",47)(1,"label",7),t._uU(2,"Report Specific Search"),t.qZA(),t.TgZ(3,"ng-select",49),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.itemId=n)}),t.qZA(),t.TgZ(4,"span",10),t._UZ(5,"img",11),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("items",e.itemsListArr)("clearable",!1)("ngModel",e.itemId)}}function x(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",47)(1,"label",7),t._uU(2,"Report Specific Search"),t.qZA(),t.TgZ(3,"ng-select",50),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.location=n)}),t.qZA(),t.TgZ(4,"span",10),t._UZ(5,"img",11),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("items",e.locationArr)("clearable",!1)("ngModel",e.location)}}function R(i,l){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"UOMUnitsMaster"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e?null:e.UOM)," ")}}function M(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",64),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,o=t.oxw();return t.KtG(o.setConversionOfUnit(n))}),t.qZA()}}function J(i,l){1&i&&t._UZ(0,"div",65)}function q(i,l){if(1&i&&(t.ynx(0),t.TgZ(1,"div",59)(2,"span",60),t._uU(3),t.ALo(4,"UOMUnitsMaster"),t.qZA(),t.TgZ(5,"span",61),t.YNc(6,M,1,0,"div",62),t.YNc(7,J,1,0,"div",63),t.qZA()(),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngbTooltip",e.conversionOfUnits)("ngClass",e.UOM==e.secondaryUnit?"text-primary pointer":"text-secondary pointer"),t.xp6(1),t.hij("",t.lcZ(4,5,null==e?null:e.UOM)," "),t.xp6(3),t.Q6J("ngIf",e.stdCostUom2&&e.stdCostUom1&&e.primaryUnit&&e.secondaryUnit),t.xp6(1),t.Q6J("ngIf",!(e.stdCostUom2&&e.stdCostUom1&&e.primaryUnit&&e.secondaryUnit))}}function D(i,l){1&i&&t._UZ(0,"div",66)}function S(i,l){1&i&&t._UZ(0,"div",67)}function O(i,l){1&i&&t._UZ(0,"div",68)}function Q(i,l){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",51,52)(5,"span",53),t._uU(6),t.qZA()(),t.TgZ(7,"td",51,54)(9,"span",53),t._uU(10),t.qZA()(),t.TgZ(11,"td"),t.YNc(12,R,3,3,"span",55),t.YNc(13,q,8,7,"ng-container",55),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.ALo(16,"number"),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.ALo(19,"number"),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.ALo(22,"number"),t.qZA(),t.TgZ(23,"td"),t._uU(24),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.ALo(27,"date"),t.qZA(),t.TgZ(28,"td")(29,"span",41),t.YNc(30,D,1,0,"div",56),t.YNc(31,S,1,0,"div",57),t.YNc(32,O,1,0,"div",58),t.qZA()(),t.TgZ(33,"td"),t._uU(34),t.qZA(),t.TgZ(35,"td"),t._uU(36),t.qZA(),t.TgZ(37,"td"),t._uU(38),t.qZA()()),2&i){const e=l.$implicit,r=t.MAs(4),n=t.MAs(8),o=t.oxw();t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",r.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",r),t.xp6(1),t.hij(" ",null==e?null:e.itemName," "),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",n),t.xp6(1),t.hij(" ",null==e?null:e.itemDescription," "),t.xp6(2),t.Q6J("ngIf",o.menuItemId==o.planningMenuItemId||o.menuItemId==o.productionMenuItemId),t.xp6(1),t.Q6J("ngIf",o.menuItemId==o.purchaseMenuItemId||o.menuItemId==o.storesMenuItemId),t.xp6(2),t.Oqu(t.xi3(16,24,null==e?null:e.closedIRQty,"1.2-2")),t.xp6(3),t.Oqu(t.xi3(19,27,null==e?null:e.purchaseRatINR,"1.2-2")),t.xp6(3),t.Oqu(t.xi3(22,30,null==e?null:e.lineValue,"1.2-2")),t.xp6(3),t.hij(" ",null==e?null:e.MRNNumber," "),t.xp6(2),t.Oqu(t.xi3(27,33,null==e?null:e.batchDate,"dd-MM-YYYY")),t.xp6(4),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status)),t.xp6(2),t.hij(" ",null==e?null:e.expiryDate," "),t.xp6(2),t.Oqu(null==e?null:e.supplierName),t.xp6(2),t.hij(" ",null==e?null:e.deliveryLocation," ")}}const d=function(i){return[i]},w=function(i,l,e,r){return{page:i,pageSize:l,collection:e,search:r,type:"list",pdfDisplay:!0}};let L=(()=>{class i{constructor(e,r,n,o,s,m,P){this.inventoryCorrectionService=e,this.exportToPDFService=r,this.spinner=n,this.exportExcelService=o,this.utilityService=s,this.activatedRoute=m,this.appGlobalService=P,this.page=1,this.pageSize=11,this.collection=0,this.column="itemCode",this.direction=1,this.search="",this.tableData=[],this.suppliersArr=[],this.locationArr=[],this.itemsListArr=[],this.toDate="",this.reportNameObj=v._X,this.reportNameArr=this.reportNameObj.getAllInventoryReportName(),this.reportName=this.reportNameObj.aodInventory,this.itemId="",this.supplierId="",this.location="",this.inventoryValue=0,this.rolePermissionActions=v.a1,this.accessType=this.rolePermissionActions.downloadAction,this.menuItemId="",this.menuItemName="",this.planningMenuItemId="64a6c1e33339d4dc9d8141a4",this.purchaseMenuItemId="64a6c1e33339d4dc9d8141a5",this.storesMenuItemId="64a6c1e33339d4dc9d8141a6",this.productionMenuItemId="64a6c1e33339d4dc9d8141a8"}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.menuItemId=this.appGlobalService.menuItemId,this.menuItemId==this.planningMenuItemId?this.menuItemName="Planning":this.menuItemId==this.purchaseMenuItemId||this.menuItemId==this.storesMenuItemId?this.menuItemName="Stores":this.menuItemId==this.productionMenuItemId&&(this.menuItemName="Production"),this.getFiscalDate(),this.getAll()}getFiscalDate(){let e=this.utilityService.getCurrentMonthDates();this.toDate=e.toDate}trackByFn(e,r){return r?._id}reset(){this.search="",this.getFiscalDate(),this.reportName=this.reportNameObj.aodInventory,this.supplierId="",this.itemId="",this.location="",this.getAll()}setReportName(){this.reportName==this.reportNameObj.aodInventoryBySupplier?(this.location="",this.itemId=""):this.reportName==this.reportNameObj.aodInventoryByLocation?(this.supplierId="",this.itemId=""):this.reportName==this.reportNameObj.aodInventoryByItem?(this.supplierId="",this.location=""):(this.location="",this.supplierId="")}setConversionOfUnit(e){let r=this.tableData.map(o=>o.itemLineNumber).indexOf(e.itemLineNumber);this.tableData[r].UOM==e.secondaryUnit?(this.tableData[r].UOM=e.primaryUnit,this.tableData[r].purchaseRatINR=e.stdCostUom1):(this.tableData[r].UOM=e.secondaryUnit,this.tableData[r].purchaseRatINR=e.stdCostUom2);let n=this.utilityService.setConversion({UOM:this.tableData[r].UOM,quantity:e.closedIRQty,primaryUnit:e.primaryUnit,secondaryUnit:e.secondaryUnit,primaryToSecondaryConversion:e.primaryToSecondaryConversion,secondaryToPrimaryConversion:e.secondaryToPrimaryConversion})||0;this.tableData[r].closedIRQty=+n}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=e.value,this.getAll()}}getAll(e=!1,r=""){this.spinner.show();let n={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:e,supplierId:this.supplierId,location:this.location,itemId:this.itemId,toDate:this.toDate,department:this.menuItemName};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.inventoryCorrectionService.getAllLocationSupplierItemWiseReports(n).subscribe(o=>{"EXCEL"==r?this.excelDownload(o.rows):"PDF"==r?this.pdfDownload(o.rows):(this.tableData=o?.rows?.map((s,m)=>(s.itemLineNumber=m+1,s)),this.suppliersArr=o.suppliersList,this.itemsListArr=o.itemsList,this.locationArr=o.locations,this.collection=o.count,this.inventoryValue=o?.totalAmounts?.value),this.spinner.hide()})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}pdfDownload(e){let r=(0,I.Jz)(e);this.exportToPDFService.generatePdf(r.tableData,r.title)}excelDownload(e){this.exportExcelService.exportExcel((0,I.CT)(e))}onSort({column:e,direction:r}){this.headers.forEach(n=>{n.sortable!==e&&(n.direction="")}),this.column=e,this.direction="asc"==r?1:-1,this.getAll()}static#t=this.\u0275fac=function(r){return new(r||i)(t.Y36(y.Ee),t.Y36(u.$L),t.Y36(u.V),t.Y36(u.Ol),t.Y36(u.tI),t.Y36(g.gz),t.Y36(u.P0))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-inventory-report"]],viewQuery:function(r,n){if(1&r&&t.Gf(_.j,5),2&r){let o;t.iGM(o=t.CRH())&&(n.headers=o)}},decls:76,vars:28,consts:[[1,"reportTablePage"],[1,"table-body","pb-0","shadow-none"],[1,"row","table-header"],[1,"col"],[1,"heading"],[1,"row","my-4"],[1,"col-3","ps-5","separate-row"],[1,"form-label"],[1,"form-select",3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"set-position"],["src","./assets/new_icons/redstroke.svg","alt","","height","27","width","8"],["class","col-3 separate-row",4,"ngIf"],[1,"col-3"],[1,"text-danger"],["type","date",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-3","align-self-end","separate-image"],[1,"image-position"],["type","button",1,"btn","btn-primary","px-4","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-4","ms-4",3,"click"],[1,"row","line-border"],[1,"table-responsive","mb-0"],[3,"data","dataChange"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],["sortable","itemCode",3,"sort"],["sortable","itemName",1,"text-start",3,"sort"],["sortable","itemDescription",1,"text-start",3,"sort"],["sortable","UOM",3,"sort"],["sortable","closedIRQty",3,"sort"],["sortable","purchaseRatINR",3,"sort"],["sortable","lineValue",3,"sort"],["sortable","MRNNumber",3,"sort"],["sortable","batchDate",3,"sort"],["sortable","expiryDate",3,"sort"],["sortable","supplierName",3,"sort"],["sortable","deliveryLocation",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"table-footer"],[1,"row","align-items-center","mt-3"],[1,"d-flex","justify-content-center"],[1,"col-form-label","text-nowrap","pe-1","pt-0","ms-3"],[1,"fa","fa-caret-right","fa-5x","mx-2"],["type","button",1,"btn","btn-info","py-1","ms-2"],["type","text","readonly","",1,"form-control",3,"value"],[3,"value"],[1,"col-3","separate-row"],["bindLabel","supplierName","bindValue","_id",3,"items","clearable","ngModel","ngModelChange"],["bindLabel","itemName","bindValue","_id",3,"items","clearable","ngModel","ngModelChange"],["bindLabel","label","bindValue","value",3,"items","clearable","ngModel","ngModelChange"],[1,"text-start"],["itemName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["itemDescription",""],[4,"ngIf"],["style","height: 1.8rem","class","flaggreen",4,"ngIf"],["style","height: 1.8rem","class","flagred",4,"ngIf"],["style","height: 1.8rem","class","flagYellow",4,"ngIf"],[1,"d-flex","justify-content-between","px-2"],["placement","top",3,"ngbTooltip","ngClass"],[1,"pointer","d-flex","align-items-center"],["class","unit-switch-rev",3,"click",4,"ngIf"],["class","unit-switch-gray",4,"ngIf"],[1,"unit-switch-rev",3,"click"],[1,"unit-switch-gray"],[1,"flaggreen",2,"height","1.8rem"],[1,"flagred",2,"height","1.8rem"],[1,"flagYellow",2,"height","1.8rem"]],template:function(r,n){if(1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5),t.qZA()()(),t.TgZ(6,"div",5)(7,"div",6)(8,"label",7),t._uU(9,"Report Name"),t.qZA(),t.TgZ(10,"select",8),t.NdJ("change",function(){return n.setReportName()})("ngModelChange",function(s){return n.reportName=s}),t.YNc(11,N,2,2,"option",9),t.qZA(),t.TgZ(12,"span",10),t._UZ(13,"img",11),t.qZA()(),t.YNc(14,C,6,3,"div",12),t.YNc(15,U,6,3,"div",12),t.YNc(16,x,6,3,"div",12),t.TgZ(17,"div",13)(18,"label",7),t._uU(19," As on Date "),t._UZ(20,"span",14),t.qZA(),t.TgZ(21,"input",15),t.NdJ("ngModelChange",function(s){return n.toDate=s}),t.qZA()(),t.TgZ(22,"div",16)(23,"span",17),t._UZ(24,"img",11),t.qZA(),t.TgZ(25,"button",18),t.NdJ("click",function(){return n.getAll()}),t._uU(26,"Apply Filter"),t.qZA(),t.TgZ(27,"button",19),t.NdJ("click",function(){return n.reset()}),t._uU(28,"Reset Filter"),t.qZA()()(),t._UZ(29,"hr",20),t.TgZ(30,"div",21)(31,"app-setting-header",22),t.NdJ("dataChange",function(s){return n.eventHeader(s)}),t.qZA(),t.TgZ(32,"table",23)(33,"thead",24)(34,"tr",25)(35,"th",26),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(36,"Item Code"),t.qZA(),t.TgZ(37,"th",27),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(38,"Item Name"),t.qZA(),t.TgZ(39,"th",28),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(40,"Item Description"),t.qZA(),t.TgZ(41,"th",29),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(42,"UoM"),t.qZA(),t.TgZ(43,"th",30),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(44,"Quantity"),t.qZA(),t.TgZ(45,"th",31),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(46,"Unit Rate"),t.qZA(),t.TgZ(47,"th",32),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(48,"Line Value"),t.qZA(),t.TgZ(49,"th",33),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(50,"MRN No."),t.qZA(),t.TgZ(51,"th",34),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(52,"Batch Date"),t.qZA(),t.TgZ(53,"th"),t._uU(54,"Aging"),t.qZA(),t.TgZ(55,"th",35),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(56,"B/B Date"),t.qZA(),t.TgZ(57,"th",36),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(58,"Supplier N'/Name"),t.qZA(),t.TgZ(59,"th",37),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(60,"Location"),t.qZA()()(),t.TgZ(61,"tbody"),t.YNc(62,Q,39,36,"tr",38),t.qZA()()(),t.TgZ(63,"div",39),t._UZ(64,"hr",20),t.TgZ(65,"div",40)(66,"div",13)(67,"div",41)(68,"div",42),t._uU(69," Inventory Value "),t._UZ(70,"i",43),t.TgZ(71,"button",44),t._uU(72),t.ALo(73,"companyCurrency"),t.qZA()(),t._UZ(74,"input",45),t.ALo(75,"number"),t.qZA()()()()()()),2&r){let o;t.xp6(5),t.hij("Inventory Report (IR) - ",null!==(o=n.menuItemName)&&void 0!==o?o:"Stores",""),t.xp6(5),t.Q6J("ngModel",n.reportName),t.xp6(1),t.Q6J("ngForOf",n.reportNameArr),t.xp6(3),t.Q6J("ngIf",t.VKq(17,d,n.reportNameObj.aodInventoryBySupplier).includes(n.reportName)),t.xp6(1),t.Q6J("ngIf",t.VKq(19,d,n.reportNameObj.aodInventoryByItem).includes(n.reportName)),t.xp6(1),t.Q6J("ngIf",t.VKq(21,d,n.reportNameObj.aodInventoryByLocation).includes(n.reportName)),t.xp6(5),t.Q6J("ngModel",n.toDate),t.xp6(10),t.Q6J("data",t.l5B(23,w,n.page,n.pageSize,n.collection,n.search)),t.xp6(31),t.Q6J("ngForOf",n.tableData)("ngForTrackBy",n.trackByFn),t.xp6(10),t.Oqu(t.lcZ(73,12,"INR")),t.xp6(2),t.Q6J("value",t.xi3(75,14,n.inventoryValue,"1.2-2"))}},dependencies:[p.mk,p.sg,p.O5,f.P,Z._L,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.On,b.w9,_.j,p.JJ,p.uU,T.f,A.S],styles:[".fa[_ngcontent-%COMP%]{font-size:1.6rem!important}"]})}return i})();var F=a(56208);const Y=[{path:"",component:L}];let j=(()=>{class i{static#t=this.\u0275fac=function(r){return new(r||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[p.ez,g.Bz.forChild(Y),F.m]})}return i})()}}]);