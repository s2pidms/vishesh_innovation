"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9794],{60449:(f,u,r)=>{r.r(u),r.d(u,{TicketDetailsModule:()=>y});var c=r(96814),T=r(1076),h=r(43818),m=r(25116),g=r(36144),t=r(65879),_=r(32197),l=r(2742),D=r(88059),Z=r(37285),p=r(60095);function b(a,d){if(1&a&&(t.TgZ(0,"option",33),t._uU(1),t.qZA()),2&a){const e=d.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function A(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td",34,35)(9,"span",36),t._uU(10),t.qZA()(),t.TgZ(11,"td",34,37)(13,"span",36),t._uU(14),t.qZA()(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t.TgZ(17,"td")(18,"img",38),t.NdJ("click",function(){const n=t.CHM(e).$implicit,o=t.oxw();return t.KtG(o.navigateTo(null==n?null:n._id,"print"))}),t.qZA()()()}if(2&a){const e=d.$implicit,s=t.MAs(8),i=t.MAs(12);t.xp6(2),t.Oqu(null==e?null:e.issueNumber),t.xp6(2),t.Oqu(null==e?null:e.issueDate),t.xp6(2),t.Oqu(null==e?null:e.issueTitle),t.xp6(1),t.Udp("width",s.clientWidth),t.xp6(2),t.Q6J("positionTarget",s)("ngbTooltip",e.issueDescription),t.xp6(1),t.hij(" ",e.issueDescription," "),t.xp6(1),t.Udp("width",i.clientWidth),t.xp6(2),t.Q6J("positionTarget",i)("ngbTooltip",e.issueResolution),t.xp6(1),t.hij(" ",e.issueResolution," "),t.xp6(2),t.hij(" ",null==e?null:e.issueStatus," ")}}const v=function(a,d,e,s){return{page:a,pageSize:d,collection:e,search:s,type:"list",pdfDisplay:!0}};let C=(()=>{class a{constructor(e,s,i,n,o,U){this.supportService=e,this.menuTitleService=s,this.exportExcelService=i,this.spinner=n,this.utilityService=o,this.exportToPDFService=U,this.page=1,this.pageSize=12,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.issueStatus="",this.fromDate=this.utilityService.getCurrentMonthDates().fromDate,this.toDate=this.utilityService.getCurrentMonthDates().toDate,this.issueStatusArr=m._1}ngOnInit(){this.getAll(),this.menuTitleService.set({title:"Ticket Details",subTitle:null,type:null})}trackByFn(e,s){return s?._id}navigateTo(e,s){window.open(`${window.location.origin}/#/print/ticket_details?id=${e}&action=${s}`,"_blank")}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=e.value,this.getAll()}}reset(){this.fromDate=this.utilityService.getCurrentMonthDates().fromDate,this.toDate=this.utilityService.getCurrentMonthDates().toDate,this.issueStatus="",this.getAll()}getAll(e=!1,s=""){this.spinner.show();let i={dummy:"1",page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:e,fromDate:this.fromDate,toDate:this.toDate,status:this.issueStatus};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.supportService.getAllReports(i).subscribe(n=>{"EXCEL"==s?this.excelDownload(n.rows):"PDF"==s?this.pdfDownload(n.rows):(this.tableData=n.rows,this.collection=n.count),this.spinner.hide()})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}excelDownload(e){this.exportExcelService.exportExcel((0,g.a_)(e))}pdfDownload(e){let s=(0,g.PT)(e);this.exportToPDFService.generatePdf(s.tableData,s.title)}onSort({column:e,direction:s}){this.headers.forEach(i=>{i.sortable!==e&&(i.direction="")}),this.column=e,this.direction="asc"==s?1:-1,this.getAll()}static#t=this.\u0275fac=function(s){return new(s||a)(t.Y36(_.a),t.Y36(l.Uh),t.Y36(l.Ol),t.Y36(l.V),t.Y36(l.tI),t.Y36(l.$L))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-ticket-details"]],viewQuery:function(s,i){if(1&s&&t.Gf(h.j,5),2&s){let n;t.iGM(n=t.CRH())&&(i.headers=n)}},decls:59,vars:12,consts:[[1,"reportTablePage","m-0"],[1,"table-body","pb-0","shadow-none"],[1,"row","table-header"],[1,"col"],[1,"heading"],[1,"row","my-4"],[1,"col-3","ps-5","separate-row"],[1,"form-label"],[1,"text-danger"],[1,"form-select",3,"ngModel","ngModelChange"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"set-position"],["src","./assets/new_icons/redstroke.svg","alt","","height","27","width","8"],[1,"col-3"],["type","date",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-3","align-self-end","separate-image"],[1,"image-position"],["type","button",1,"btn","btn-primary","px-4","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-4","ms-4",3,"click"],[1,"row","line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],["sortable","issueNumber",3,"sort"],["sortable","issueDate",3,"sort"],["sortable","issueTitle",3,"sort"],["sortable","issueDescription",1,"text-start",3,"sort"],["sortable","issueResolution",1,"text-start",3,"sort"],["sortable","issueStatus",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"value"],[1,"text-start"],["issueDescription",""],[1,"pointer",3,"positionTarget","ngbTooltip"],["issueResolution",""],["src","./assets/images/file_pdf.png","width","20rem","alt","",1,"pointer",3,"click"]],template:function(s,i){1&s&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5,"Ticket Details Report"),t.qZA()()(),t.TgZ(6,"div",5)(7,"div",6)(8,"label",7),t._uU(9,"Ticket Status"),t.TgZ(10,"span",8),t._uU(11,"*"),t.qZA()(),t.TgZ(12,"select",9),t.NdJ("ngModelChange",function(o){return i.issueStatus=o}),t.TgZ(13,"option",10),t._uU(14,"Select Ticket Status"),t.qZA(),t.YNc(15,b,2,2,"option",11),t.qZA(),t.TgZ(16,"span",12),t._UZ(17,"img",13),t.qZA()(),t.TgZ(18,"div",14)(19,"label",7),t._uU(20,"From Date"),t.TgZ(21,"span",8),t._uU(22,"*"),t.qZA()(),t.TgZ(23,"input",15),t.NdJ("ngModelChange",function(o){return i.fromDate=o}),t.qZA()(),t.TgZ(24,"div",14)(25,"label",7),t._uU(26,"To Date"),t.TgZ(27,"span",8),t._uU(28,"*"),t.qZA()(),t.TgZ(29,"input",15),t.NdJ("ngModelChange",function(o){return i.toDate=o}),t.qZA()(),t.TgZ(30,"div",16)(31,"span",17),t._UZ(32,"img",13),t.qZA(),t.TgZ(33,"button",18),t.NdJ("click",function(){return i.getAll()}),t._uU(34,"Apply Filter"),t.qZA(),t.TgZ(35,"button",19),t.NdJ("click",function(){return i.reset()}),t._uU(36,"Reset Filter"),t.qZA()()(),t._UZ(37,"hr",20),t.TgZ(38,"div",21)(39,"app-setting-header",22),t.NdJ("dataChange",function(o){return i.eventHeader(o)}),t.qZA(),t.TgZ(40,"table",23)(41,"thead",24)(42,"tr",25)(43,"th",26),t.NdJ("sort",function(o){return i.onSort(o)}),t._uU(44,"Ticket #"),t.qZA(),t.TgZ(45,"th",27),t.NdJ("sort",function(o){return i.onSort(o)}),t._uU(46,"Date"),t.qZA(),t.TgZ(47,"th",28),t.NdJ("sort",function(o){return i.onSort(o)}),t._uU(48,"Title"),t.qZA(),t.TgZ(49,"th",29),t.NdJ("sort",function(o){return i.onSort(o)}),t._uU(50,"Description"),t.qZA(),t.TgZ(51,"th",30),t.NdJ("sort",function(o){return i.onSort(o)}),t._uU(52,"Ticket Resolution"),t.qZA(),t.TgZ(53,"th",31),t.NdJ("sort",function(o){return i.onSort(o)}),t._uU(54,"Status"),t.qZA(),t.TgZ(55,"th"),t._uU(56,"Action"),t.qZA()()(),t.TgZ(57,"tbody"),t.YNc(58,A,19,14,"tr",32),t.qZA()()()()()),2&s&&(t.xp6(12),t.Q6J("ngModel",i.issueStatus),t.xp6(3),t.Q6J("ngForOf",i.issueStatusArr),t.xp6(8),t.Q6J("ngModel",i.fromDate),t.xp6(6),t.Q6J("ngModel",i.toDate),t.xp6(10),t.Q6J("data",t.l5B(7,v,i.page,i.pageSize,i.collection,i.search)),t.xp6(19),t.Q6J("ngForOf",i.tableData)("ngForTrackBy",i.trackByFn))},dependencies:[c.sg,D.P,Z._L,p.YN,p.Kr,p.Fj,p.EJ,p.JJ,p.On,h.j],encapsulation:2})}return a})();var k=r(56208);const S=[{path:"",component:C}];let y=(()=>{class a{static#t=this.\u0275fac=function(s){return new(s||a)};static#e=this.\u0275mod=t.oAB({type:a});static#i=this.\u0275inj=t.cJS({imports:[c.ez,k.m,T.Bz.forChild(S)]})}return a})()},13107:(f,u,r)=>{r.d(u,{t:()=>c});const c={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}}},28402:(f,u,r)=>{r.d(u,{J:()=>c});const c=({data:T,headers:h,widths:m,title:g})=>({tableData:{widths:m,headerRows:1,body:[h.map(l=>({text:l.header,style:"header"})),...T.map(l=>h.map(D=>({style:"subheader",text:l[D.key]})))]},title:g})}}]);