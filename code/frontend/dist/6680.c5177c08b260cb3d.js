"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6680],{16680:(L,h,r)=>{r.r(h),r.d(h,{AttendanceReviewModule:()=>N});var p=r(96814),g=r(1076),f=r(43818),v=r(25116),e=r(65879),m=r(37285),c=r(2742),l=r(60095);let A=(()=>{class s{constructor(t,a){this.activeModal=t,this.utilityService=a,this.attendanceData={}}ngOnInit(){}setAttendance(){this.attendanceData.LOPDiff=this.attendanceData.monthDays-(this.attendanceData.paidLeaves+this.attendanceData.presentDays+this.attendanceData.weeklyOff+this.attendanceData.ODDays+this.attendanceData.paidHolidays)}dismissModel(){this.activeModal.close(this.attendanceData)}static#e=this.\u0275fac=function(a){return new(a||s)(e.Y36(m.Kz),e.Y36(c.tI))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-attendance-review-edit-model"]],inputs:{attendanceData:"attendanceData"},decls:52,vars:7,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,""],[1,"row","my-4","px-5"],[1,"col-3"],[1,"form-label","mb-1"],[1,"text-danger"],["type","number","readonly","",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"col-3","ps-0"],["type","number",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"col-4","pe-3"],[1,"col-4","px-3"],[1,"col-4","ps-3"],["type","number",1,"form-control",3,"ngModel","ngModelChange"],[1,"line-border","my-4"],[1,"row","px-5"],[1,"ps-0","d-flex","justify-content-center"],[1,"mb-4"],["type","button",1,"btn","bg-primary","px-2",3,"click"]],template:function(a,n){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Update Attendance Review"),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return n.activeModal.close()}),e._UZ(6,"i",4),e.qZA()()(),e.TgZ(7,"div",5),e.ynx(8),e.TgZ(9,"div",6)(10,"div",7)(11,"label",8),e._uU(12," Month Days "),e._UZ(13,"span",9),e.qZA(),e.TgZ(14,"input",10),e.NdJ("ngModelChange",function(o){return n.attendanceData.monthDays=o})("input",function(){return n.setAttendance()}),e.qZA()(),e.TgZ(15,"div",11)(16,"label",8),e._uU(17," Weekly Off "),e._UZ(18,"span",9),e.qZA(),e.TgZ(19,"input",12),e.NdJ("ngModelChange",function(o){return n.attendanceData.weeklyOff=o})("input",function(){return n.setAttendance()}),e.qZA()(),e.TgZ(20,"div",11)(21,"label",8),e._uU(22," Paid Holidays "),e._UZ(23,"span",9),e.qZA(),e.TgZ(24,"input",12),e.NdJ("ngModelChange",function(o){return n.attendanceData.paidHolidays=o})("input",function(){return n.setAttendance()}),e.qZA()(),e.TgZ(25,"div",11)(26,"label",8),e._uU(27," Paid Leaves/Comp off "),e._UZ(28,"span",9),e.qZA(),e.TgZ(29,"input",12),e.NdJ("ngModelChange",function(o){return n.attendanceData.paidLeaves=o})("input",function(){return n.setAttendance()}),e.qZA()()(),e.TgZ(30,"div",6)(31,"div",13)(32,"label",8),e._uU(33," OD Days "),e._UZ(34,"span",9),e.qZA(),e.TgZ(35,"input",12),e.NdJ("ngModelChange",function(o){return n.attendanceData.ODDays=o})("input",function(){return n.setAttendance()}),e.qZA()(),e.TgZ(36,"div",14)(37,"label",8),e._uU(38," Present Days "),e._UZ(39,"span",9),e.qZA(),e.TgZ(40,"input",12),e.NdJ("ngModelChange",function(o){return n.attendanceData.presentDays=o})("input",function(){return n.setAttendance()}),e.qZA()(),e.TgZ(41,"div",15)(42,"label",8),e._uU(43," LOP/Diff "),e._UZ(44,"span",9),e.qZA(),e.TgZ(45,"input",16),e.NdJ("ngModelChange",function(o){return n.attendanceData.LOPDiff=o}),e.qZA()()(),e.BQk(),e._UZ(46,"hr",17),e.TgZ(47,"div",18)(48,"div",19)(49,"div",20)(50,"button",21),e.NdJ("click",function(){return n.dismissModel()}),e._uU(51,"Save & Close"),e.qZA()()()()()()),2&a&&(e.xp6(14),e.Q6J("ngModel",n.attendanceData.monthDays),e.xp6(5),e.Q6J("ngModel",n.attendanceData.weeklyOff),e.xp6(5),e.Q6J("ngModel",n.attendanceData.paidHolidays),e.xp6(5),e.Q6J("ngModel",n.attendanceData.paidLeaves),e.xp6(6),e.Q6J("ngModel",n.attendanceData.ODDays),e.xp6(5),e.Q6J("ngModel",n.attendanceData.presentDays),e.xp6(5),e.Q6J("ngModel",n.attendanceData.LOPDiff))},dependencies:[l.Fj,l.wV,l.JJ,l.On],encapsulation:2})}return s})();var y=r(68187),D=r(88059),Z=r(53421),T=r(95346);function C(s,d){if(1&s&&(e.TgZ(0,"option",36),e._uU(1),e.ALo(2,"date"),e.qZA()),2&s){const t=d.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",e.xi3(2,2,t.value,"MMMM YYYY")," ")}}function b(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.paidLeaves)}}function w(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"input",47),e.NdJ("ngModelChange",function(n){e.CHM(t);const i=e.oxw().$implicit;return e.KtG(i.paidLeaves=n)})("input",function(){e.CHM(t);const n=e.oxw().$implicit,i=e.oxw();return e.KtG(i.setLOP(n._id,n))}),e.qZA()}if(2&s){const t=e.oxw().$implicit;e.Q6J("ngModel",t.paidLeaves)}}function M(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.presentDays)}}function O(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"input",47),e.NdJ("ngModelChange",function(n){e.CHM(t);const i=e.oxw().$implicit;return e.KtG(i.presentDays=n)})("input",function(){e.CHM(t);const n=e.oxw().$implicit,i=e.oxw();return e.KtG(i.setLOP(n._id,n))}),e.qZA()}if(2&s){const t=e.oxw().$implicit;e.Q6J("ngModel",t.presentDays)}}const J=function(){return["Approved",null]};function U(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"a",44),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,i=e.oxw();return e.KtG(i.openAttendanceModal(n))}),e._UZ(1,"i",45),e._uU(2," Update "),e.qZA()}if(2&s){const t=e.oxw().$implicit,a=e.oxw();e.ekj("disable",e.DdM(3,J).includes(t.status)),e.Q6J("accessType",a.rolePermissionActions.editAction)}}function R(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",37),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"div",38),e.YNc(13,b,2,1,"span",39),e.YNc(14,w,1,1,"input",40),e.qZA()(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td")(18,"div",38),e.YNc(19,M,2,1,"span",39),e.YNc(20,O,1,1,"input",40),e.qZA()(),e.TgZ(21,"td"),e._uU(22),e.qZA(),e.TgZ(23,"td"),e._uU(24),e.qZA(),e.TgZ(25,"td")(26,"div",41),e._UZ(27,"button",42),e.TgZ(28,"div",43)(29,"a",44),e.NdJ("click",function(){const i=e.CHM(t).$implicit,o=e.oxw();return e.KtG(o.flag=i._id)}),e._UZ(30,"i",45),e._uU(31," Edit "),e.qZA(),e.YNc(32,U,3,4,"a",46),e.qZA()()()()}if(2&s){const t=d.$implicit,a=e.oxw();e.xp6(2),e.Oqu(null==t?null:t.employeeCode),e.xp6(2),e.Oqu(null==t?null:t.employeeName),e.xp6(2),e.Oqu(null==t?null:t.monthDays),e.xp6(2),e.Oqu(null==t?null:t.weeklyOff),e.xp6(2),e.Oqu(null==t?null:t.paidHolidays),e.xp6(3),e.Q6J("ngIf",t.status&&!("Draft"==t.status&&t._id==a.flag)),e.xp6(1),e.Q6J("ngIf",!t.status||"Draft"==t.status&&t._id==a.flag),e.xp6(2),e.Oqu(null==t?null:t.ODDays),e.xp6(3),e.Q6J("ngIf",t.status&&!("Draft"==t.status&&t._id==a.flag)),e.xp6(1),e.Q6J("ngIf",!t.status||"Draft"==t.status&&t._id==a.flag),e.xp6(2),e.Oqu(null==t?null:t.LOPDiff),e.xp6(2),e.Oqu(null==t?null:t.status),e.xp6(5),e.Q6J("accessType",a.rolePermissionActions.editAction),e.xp6(3),e.Q6J("ngIf",a.user==a.superAdminId)}}const q=function(s,d,t,a){return{page:s,pageSize:d,collection:t,search:a}};let k=(()=>{class s{constructor(t,a,n,i,o,u,_){this.router=t,this.spinner=a,this.attendanceService=n,this.toastService=i,this.exportExcelService=o,this.modalService=u,this.storageService=_,this.page=1,this.pageSize=9,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.originTableData=[],this.user={},this.fromDate="",this.toDate="",this.attendanceForMonthYear=null,this.submitted=!1,this.date=new Date,this.flag=-1,this.month=new Date(this.date.getFullYear(),this.date.getMonth()+1,1).toISOString().slice(0,7),this.monthOptions=[{value:new Date(this.date.getFullYear(),this.date.getMonth()+1,1).toISOString().slice(0,7)},{value:new Date(this.date.getFullYear(),this.date.getMonth(),1).toISOString().slice(0,7)},{value:new Date(this.date.getFullYear(),this.date.getMonth()-1,1).toISOString().slice(0,7)}],this.btnFlag=!0,this.rolePermissionActions=v.a1,this.superAdminId="64a687b4e9143bffd820fb3d"}ngOnInit(){this.user=this.storageService.get("IDMSAUser")?.roles?.find(t=>t==this.superAdminId)}trackByFn(t,a){return a?._id}reset(){this.attendanceForMonthYear=null,this.tableData=[],this.collection=this.tableData.length}setLOP(t,a){let n=this.tableData.map(i=>i._id).indexOf(t);this.tableData[n].LOPDiff=a.monthDays-(a.paidLeaves+a.presentDays+a.weeklyOff+a.ODDays+a.paidHolidays)}create(t){this.spinner.show(),this.tableData=this.tableData.map(a=>(a.status=t,a)),this.attendanceService.create(this.tableData).subscribe(a=>{this.spinner.hide(),this.submitted=!1,this.tableData=[],this.attendanceForMonthYear=null,this.flag=-1,this.toastService.success(a.message)})}navigateTo(t,a,n){this.router.navigate([t],{queryParams:{id:a,action:n}})}eventHeader(t){switch(t.key){case"SEARCH":this.search=t.value,this.flag=-1;break;case"EXCEL":this.excelDownload(this.tableData);break;case"PAGE":this.page=t.value}}getAllData(){this.spinner.show(),this.attendanceService.getAllMasterData(this.attendanceForMonthYear).subscribe(t=>{this.tableData=t.attendanceOfMonth,this.collection=t.attendanceOfMonth.length,this.btnFlag=this.tableData.every(a=>"Approved"==a.status),this.spinner.hide()})}openAttendanceModal(t){if("Draft"==t?.status){let a=this.tableData.map(i=>i.employeeId).indexOf(t.employeeId);const n=this.modalService.open(A,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});n.componentInstance.attendanceData={monthDays:t.monthDays,weeklyOff:t.weeklyOff,paidHolidays:t.paidHolidays,paidLeaves:t.paidLeaves,ODDays:t.ODDays,presentDays:t.presentDays,LOPDiff:t.LOPDiff},n.result.then(i=>{i&&(this.tableData[a].weeklyOff=i.weeklyOff,this.tableData[a].paidHolidays=i.paidHolidays,this.tableData[a].paidLeaves=i.paidLeaves,this.tableData[a].ODDays=i.ODDays,this.tableData[a].presentDays=i.presentDays,this.tableData[a].LOPDiff=i.LOPDiff)},i=>{})}}onSort({column:t,direction:a}){this.headers.forEach(n=>{n.sortable!==t&&(n.direction="")}),this.tableData=""===a||""===t?this.tableData:[...this.tableData].sort((n,i)=>{let o="string"==typeof n[t]?n[t].toLowerCase():n[t],u="string"==typeof i[t]?i[t].toLowerCase():i[t];const _=o<u?-1:o>u?1:0;return"asc"===a?_:-_})}excelDownload(t){let a={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}},n={title:"Attendance Review",csvData:t,headers:[{header:"Employee Code",key:"employeeCode",...a},{header:"Employee Name",key:"employeeName",...a},{header:"Month Days",key:"monthDays",...a},{header:"Weekly Off",key:"weeklyOff",...a},{header:"Paid Holidays",key:"paidHolidays",...a},{header:"Paid Leaves",key:"paidLeaves",...a},{header:"OD Days",key:"ODDays",...a},{header:"Present Days",key:"presentDays",...a},{header:"LOP/Diff",key:"LOPDiff",...a},{header:"Status",key:"status",...a}]};this.exportExcelService.exportExcel(n)}static#e=this.\u0275fac=function(a){return new(a||s)(e.Y36(g.F0),e.Y36(c.V),e.Y36(y.VG),e.Y36(c.kl),e.Y36(c.Ol),e.Y36(m.FF),e.Y36(c.V1))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-attendance-review"]],viewQuery:function(a,n){if(1&a&&e.Gf(f.j,5),2&a){let i;e.iGM(i=e.CRH())&&(n.headers=i)}},decls:58,vars:21,consts:[[1,"listCard","card","mb-4"],[1,"table-header"],[1,"heading"],[1,"row","justify-content-center","mt-4"],[1,"col-4"],[1,"row"],[1,"col-6","mt-1","pe-1"],[1,"form-label","text-nowrap"],[1,"text-danger"],[1,"col-1","ps-3","pe-0"],[1,"fa","fa-caret-right","mt-1","text-secondary"],[1,"col-5","ps-0"],[1,"form-select",3,"ngModel","ngModelChange","change"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"row","mt-3","line-border"],[1,"table-responsive",2,"min-height","33rem"],[3,"data","dataChange"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],["sortable","employeeCode",3,"sort"],["sortable","employeeName",1,"text-start",3,"sort"],["sortable","monthDays",3,"sort"],["sortable","weeklyOff",3,"sort"],["sortable","paidHolidays",3,"sort"],["sortable","paidLeaves",3,"sort"],["sortable","ODDays",3,"sort"],["sortable","presentDays",3,"sort"],["sortable","LOPDiff",3,"sort"],["sortable","isActive",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"line-border"],["appAccessControl","",1,"text-center","mt-3",3,"accessType"],["type","button",1,"btn","bg-primary","px-5","mx-2",3,"click"],["type","button",1,"btn","bg-primary","px-5","mx-2",3,"disabled","click"],[3,"value"],[1,"text-start"],[1,"d-flex","justify-content-center"],[4,"ngIf"],["class","form-control form-control-sm w-25","type","number",3,"ngModel","ngModelChange","input",4,"ngIf"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"],["appAccessControl","","href","javascript:void(0)",3,"disable","accessType","click",4,"ngIf"],["type","number",1,"form-control","form-control-sm","w-25",3,"ngModel","ngModelChange","input"]],template:function(a,n){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"Attendance Review"),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),e._uU(9,"Attendance for Month'Year"),e._UZ(10,"span",8),e.qZA()(),e.TgZ(11,"div",9),e._UZ(12,"i",10),e.qZA(),e.TgZ(13,"div",11)(14,"select",12),e.NdJ("ngModelChange",function(o){return n.attendanceForMonthYear=o})("change",function(){return n.getAllData()}),e.TgZ(15,"option",13),e._uU(16,"Select Month"),e.qZA(),e.YNc(17,C,3,5,"option",14),e.qZA()()()()(),e._UZ(18,"hr",15),e.TgZ(19,"div",16)(20,"app-setting-header",17),e.NdJ("dataChange",function(o){return n.eventHeader(o)}),e.qZA(),e.TgZ(21,"table",18)(22,"thead",19)(23,"tr",20)(24,"th",21),e.NdJ("sort",function(o){return n.onSort(o)}),e._uU(25,"Employee Code"),e.qZA(),e.TgZ(26,"th",22),e.NdJ("sort",function(o){return n.onSort(o)}),e._uU(27,"Employee Name"),e.qZA(),e.TgZ(28,"th",23),e.NdJ("sort",function(o){return n.onSort(o)}),e._uU(29,"Month Days"),e.qZA(),e.TgZ(30,"th",24),e.NdJ("sort",function(o){return n.onSort(o)}),e._uU(31,"Weekly Off"),e.qZA(),e.TgZ(32,"th",25),e.NdJ("sort",function(o){return n.onSort(o)}),e._uU(33,"Paid Holidays"),e.qZA(),e.TgZ(34,"th",26),e.NdJ("sort",function(o){return n.onSort(o)}),e._uU(35,"Paid Leaves/Comp off"),e.qZA(),e.TgZ(36,"th",27),e.NdJ("sort",function(o){return n.onSort(o)}),e._uU(37,"OD Days"),e.qZA(),e.TgZ(38,"th",28),e.NdJ("sort",function(o){return n.onSort(o)}),e._uU(39,"Present Days"),e.qZA(),e.TgZ(40,"th",29),e.NdJ("sort",function(o){return n.onSort(o)}),e._uU(41,"LOP/Diff"),e.qZA(),e.TgZ(42,"th",30),e.NdJ("sort",function(o){return n.onSort(o)}),e._uU(43,"Status"),e.qZA(),e.TgZ(44,"th"),e._uU(45,"Action"),e.qZA()()(),e.TgZ(46,"tbody"),e.YNc(47,R,33,14,"tr",31),e.ALo(48,"slice"),e.ALo(49,"searchFi1ter"),e.qZA()()(),e._UZ(50,"hr",32),e.TgZ(51,"div",33)(52,"button",34),e.NdJ("click",function(){return n.reset()}),e._uU(53,"Reset"),e.qZA(),e.TgZ(54,"button",35),e.NdJ("click",function(){return n.create("Draft")}),e._uU(55," Save "),e.qZA(),e.TgZ(56,"button",35),e.NdJ("click",function(){return n.create("Approved")}),e._uU(57," Approve "),e.qZA()()()),2&a&&(e.xp6(14),e.Q6J("ngModel",n.attendanceForMonthYear),e.xp6(1),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",n.monthOptions),e.xp6(3),e.Q6J("data",e.l5B(16,q,n.page,n.pageSize,n.collection,n.search)),e.xp6(27),e.Q6J("ngForOf",e.Dn7(48,9,e.xi3(49,13,n.tableData,n.search),(n.page-1)*n.pageSize,(n.page-1)*n.pageSize+n.pageSize))("ngForTrackBy",n.trackByFn),e.xp6(4),e.Q6J("accessType",n.rolePermissionActions.createAction),e.xp6(3),e.Q6J("disabled",n.btnFlag),e.xp6(2),e.Q6J("disabled",n.btnFlag))},dependencies:[p.sg,p.O5,D.P,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.On,f.j,Z.J,p.OU,p.uU,T.G],styles:[".fa-caret-right[_ngcontent-%COMP%]{font-size:2rem!important;margin-right:4rem!important}"]})}return s})();var S=r(56208);const x=[{path:"",redirectTo:"attendance-review",pathMatch:"full"},{path:"attendance-review",component:k}];let N=(()=>{class s{static#e=this.\u0275fac=function(a){return new(a||s)};static#t=this.\u0275mod=e.oAB({type:s});static#n=this.\u0275inj=e.cJS({imports:[p.ez,g.Bz.forChild(x),S.m]})}return s})()}}]);