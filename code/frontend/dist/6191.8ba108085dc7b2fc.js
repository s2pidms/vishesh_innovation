"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6191],{26191:(B,g,l)=>{l.r(g),l.d(g,{InventoryReportModule:()=>P});var p=l(96814),_=l(1076),v=l(43818),I=l(25116),y=l(31655),t=l(65879),f=l(73374),c=l(2742),Z=l(88059),b=l(37285),u=l(60095),T=l(50363),A=l(83344),C=l(59103);function N(i,a){if(1&i&&(t.TgZ(0,"option",46),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.label," ")}}function U(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",47)(1,"label",7),t._uU(2,"Report Specific Search"),t.qZA(),t.TgZ(3,"ng-select",48),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.supplierId=n)}),t.qZA(),t.TgZ(4,"span",10),t._UZ(5,"img",11),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("items",e.suppliersArr)("clearable",!1)("ngModel",e.supplierId)}}function R(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",47)(1,"label",7),t._uU(2,"Report Specific Search"),t.qZA(),t.TgZ(3,"ng-select",49),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.itemId=n)}),t.qZA(),t.TgZ(4,"span",10),t._UZ(5,"img",11),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("items",e.itemsListArr)("clearable",!1)("ngModel",e.itemId)}}function x(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",47)(1,"label",7),t._uU(2,"Report Specific Search"),t.qZA(),t.TgZ(3,"ng-select",50),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.location=n)}),t.qZA(),t.TgZ(4,"span",10),t._UZ(5,"img",11),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("items",e.locationArr)("clearable",!1)("ngModel",e.location)}}function M(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"UOMUnitsMaster"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e?null:e.UOM)," ")}}function J(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",64),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,o=t.oxw();return t.KtG(o.setConversionOfUnit(n))}),t.qZA()}}function q(i,a){1&i&&t._UZ(0,"div",65)}function D(i,a){if(1&i&&(t.ynx(0),t.TgZ(1,"div",59)(2,"span",60),t._uU(3),t.ALo(4,"UOMUnitsMaster"),t.qZA(),t.TgZ(5,"span",61),t.YNc(6,J,1,0,"div",62),t.YNc(7,q,1,0,"div",63),t.qZA()(),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngbTooltip",e.conversionOfUnits)("ngClass",e.UOM==e.secondaryUnit?"text-primary pointer":"text-secondary pointer"),t.xp6(1),t.hij("",t.lcZ(4,5,null==e?null:e.UOM)," "),t.xp6(3),t.Q6J("ngIf",e.stdCostUom2&&e.stdCostUom1&&e.primaryUnit&&e.secondaryUnit),t.xp6(1),t.Q6J("ngIf",!(e.stdCostUom2&&e.stdCostUom1&&e.primaryUnit&&e.secondaryUnit))}}function S(i,a){1&i&&t._UZ(0,"div",66)}function O(i,a){1&i&&t._UZ(0,"div",67)}function Q(i,a){1&i&&t._UZ(0,"div",68)}function w(i,a){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",51,52)(5,"span",53),t._uU(6),t.qZA()(),t.TgZ(7,"td",51,54)(9,"span",53),t._uU(10),t.qZA()(),t.TgZ(11,"td"),t.YNc(12,M,3,3,"span",55),t.YNc(13,D,8,7,"ng-container",55),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.ALo(16,"number"),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.ALo(19,"number"),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.ALo(22,"number"),t.qZA(),t.TgZ(23,"td"),t._uU(24),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.ALo(27,"date"),t.qZA(),t.TgZ(28,"td")(29,"span",41),t.YNc(30,S,1,0,"div",56),t.YNc(31,O,1,0,"div",57),t.YNc(32,Q,1,0,"div",58),t.qZA()(),t.TgZ(33,"td"),t._uU(34),t.qZA(),t.TgZ(35,"td"),t._uU(36),t.qZA(),t.TgZ(37,"td"),t._uU(38),t.qZA()()),2&i){const e=a.$implicit,r=t.MAs(4),n=t.MAs(8),o=t.oxw();t.xp6(2),t.Oqu(null==e?null:e.itemCode),t.xp6(1),t.Udp("width",r.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",r),t.xp6(1),t.hij(" ",null==e?null:e.itemName," "),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",n),t.xp6(1),t.hij(" ",null==e?null:e.itemDescription," "),t.xp6(2),t.Q6J("ngIf",o.menuItemId==o.planningMenuItemId||o.menuItemId==o.productionMenuItemId),t.xp6(1),t.Q6J("ngIf",o.menuItemId==o.purchaseMenuItemId||o.menuItemId==o.storesMenuItemId),t.xp6(2),t.Oqu(t.xi3(16,24,null==e?null:e.closedIRQty,"1.2-2")),t.xp6(3),t.Oqu(t.xi3(19,27,null==e?null:e.purchaseRatINR,"1.2-2")),t.xp6(3),t.Oqu(t.xi3(22,30,null==e?null:e.lineValue,"1.2-2")),t.xp6(3),t.hij(" ",null==e?null:e.MRNNumber," "),t.xp6(2),t.Oqu(t.xi3(27,33,null==e?null:e.batchDate,"dd-MM-YYYY")),t.xp6(4),t.Q6J("ngIf","green"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","red"==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf","orange"==(null==e?null:e.status)),t.xp6(2),t.hij(" ",null==e?null:e.expiryDate," "),t.xp6(2),t.Oqu(null==e?null:e.supplierName),t.xp6(2),t.hij(" ",null==e?null:e.deliveryLocation," ")}}const m=function(i){return[i]},L=function(i,a,e,r){return{page:i,pageSize:a,collection:e,search:r,type:"list",pdfDisplay:!0}};let F=(()=>{var i;class a{constructor(r,n,o,s,d,h,E){this.inventoryCorrectionService=r,this.exportToPDFService=n,this.spinner=o,this.exportExcelService=s,this.utilityService=d,this.activatedRoute=h,this.appGlobalService=E,this.page=1,this.pageSize=11,this.collection=0,this.column="itemCode",this.direction=1,this.search="",this.tableData=[],this.suppliersArr=[],this.locationArr=[],this.itemsListArr=[],this.toDate="",this.reportNameObj=I._X,this.reportNameArr=this.reportNameObj.getAllInventoryReportName(),this.reportName=this.reportNameObj.aodInventory,this.itemId="",this.supplierId="",this.location="",this.inventoryValue=0,this.rolePermissionActions=I.a1,this.accessType=this.rolePermissionActions.downloadAction,this.menuItemId="",this.menuItemName="",this.planningMenuItemId="64a6c1e33339d4dc9d8141a4",this.purchaseMenuItemId="64a6c1e33339d4dc9d8141a5",this.storesMenuItemId="64a6c1e33339d4dc9d8141a6",this.productionMenuItemId="64a6c1e33339d4dc9d8141a8"}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.menuItemId=this.appGlobalService.menuItemId,this.menuItemId==this.planningMenuItemId?this.menuItemName="Planning":this.menuItemId==this.purchaseMenuItemId||this.menuItemId==this.storesMenuItemId?this.menuItemName="Stores":this.menuItemId==this.productionMenuItemId&&(this.menuItemName="Production"),this.getFiscalDate(),this.getAll()}getFiscalDate(){let r=this.utilityService.getCurrentMonthDates();this.toDate=r.toDate}trackByFn(r,n){return n?._id}reset(){this.search="",this.getFiscalDate(),this.reportName=this.reportNameObj.aodInventory,this.supplierId="",this.itemId="",this.location="",this.getAll()}setReportName(){this.reportName==this.reportNameObj.aodInventoryBySupplier?(this.location="",this.itemId=""):this.reportName==this.reportNameObj.aodInventoryByLocation?(this.supplierId="",this.itemId=""):this.reportName==this.reportNameObj.aodInventoryByItem?(this.supplierId="",this.location=""):(this.location="",this.supplierId="")}setConversionOfUnit(r){let n=this.tableData.map(s=>s.itemLineNumber).indexOf(r.itemLineNumber);this.tableData[n].UOM==r.secondaryUnit?(this.tableData[n].UOM=r.primaryUnit,this.tableData[n].purchaseRatINR=r.stdCostUom1):(this.tableData[n].UOM=r.secondaryUnit,this.tableData[n].purchaseRatINR=r.stdCostUom2);let o=this.utilityService.setConversion({UOM:this.tableData[n].UOM,quantity:r.closedIRQty,primaryUnit:r.primaryUnit,secondaryUnit:r.secondaryUnit,primaryToSecondaryConversion:r.primaryToSecondaryConversion,secondaryToPrimaryConversion:r.secondaryToPrimaryConversion})||0;this.tableData[n].closedIRQty=+o}eventHeader(r){switch(r.key){case"SEARCH":this.search=r.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=r.value,this.getAll()}}getAll(r=!1,n=""){this.spinner.show();let o={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:r,supplierId:this.supplierId,location:this.location,itemId:this.itemId,toDate:this.toDate,department:this.menuItemName};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.inventoryCorrectionService.getAllLocationSupplierItemWiseReports(o).subscribe(s=>{"EXCEL"==n?this.excelDownload(s.rows):"PDF"==n?this.pdfDownload(s.rows):(this.tableData=s?.rows?.map((d,h)=>(d.itemLineNumber=h+1,d)),this.suppliersArr=s.suppliersList,this.itemsListArr=s.itemsList,this.locationArr=s.locations,this.collection=s.count,this.inventoryValue=s?.totalAmounts?.value),this.spinner.hide()})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}pdfDownload(r){let n=(0,y.Jz)(r);this.exportToPDFService.generatePdf(n.tableData,n.title)}excelDownload(r){this.exportExcelService.exportExcel((0,y.CT)(r))}onSort({column:r,direction:n}){this.headers.forEach(o=>{o.sortable!==r&&(o.direction="")}),this.column=r,this.direction="asc"==n?1:-1,this.getAll()}}return(i=a).\u0275fac=function(r){return new(r||i)(t.Y36(f.Ee),t.Y36(c.$L),t.Y36(c.V),t.Y36(c.Ol),t.Y36(c.tI),t.Y36(_.gz),t.Y36(c.P0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-inventory-report"]],viewQuery:function(r,n){if(1&r&&t.Gf(v.j,5),2&r){let o;t.iGM(o=t.CRH())&&(n.headers=o)}},decls:76,vars:28,consts:[[1,"reportTablePage"],[1,"table-body","pb-0","shadow-none"],[1,"row","table-header"],[1,"col"],[1,"heading"],[1,"row","my-4"],[1,"col-3","ps-5","separate-row"],[1,"form-label"],[1,"form-select",3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"set-position"],["src","./assets/new_icons/redstroke.svg","alt","","height","27","width","8"],["class","col-3 separate-row",4,"ngIf"],[1,"col-3"],[1,"text-danger"],["type","date",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-3","align-self-end","separate-image"],[1,"image-position"],["type","button",1,"btn","btn-primary","px-4","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-4","ms-4",3,"click"],[1,"row","line-border"],[1,"table-responsive","mb-0"],[3,"data","dataChange"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],["sortable","itemCode",3,"sort"],["sortable","itemName",1,"text-start",3,"sort"],["sortable","itemDescription",1,"text-start",3,"sort"],["sortable","UOM",3,"sort"],["sortable","closedIRQty",3,"sort"],["sortable","purchaseRatINR",3,"sort"],["sortable","lineValue",3,"sort"],["sortable","MRNNumber",3,"sort"],["sortable","batchDate",3,"sort"],["sortable","expiryDate",3,"sort"],["sortable","supplierName",3,"sort"],["sortable","deliveryLocation",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"table-footer"],[1,"row","align-items-center","mt-3"],[1,"d-flex","justify-content-center"],[1,"col-form-label","text-nowrap","pe-1","pt-0","ms-3"],[1,"fa","fa-caret-right","fa-5x","mx-2"],["type","button",1,"btn","btn-info","py-1","ms-2"],["type","text","readonly","",1,"form-control",3,"value"],[3,"value"],[1,"col-3","separate-row"],["bindLabel","supplierName","bindValue","_id",3,"items","clearable","ngModel","ngModelChange"],["bindLabel","itemName","bindValue","_id",3,"items","clearable","ngModel","ngModelChange"],["bindLabel","label","bindValue","value",3,"items","clearable","ngModel","ngModelChange"],[1,"text-start"],["itemName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["itemDescription",""],[4,"ngIf"],["style","height: 1.8rem","class","flaggreen",4,"ngIf"],["style","height: 1.8rem","class","flagred",4,"ngIf"],["style","height: 1.8rem","class","flagYellow",4,"ngIf"],[1,"d-flex","justify-content-between","px-2"],["placement","top",3,"ngbTooltip","ngClass"],[1,"pointer","d-flex","align-items-center"],["class","unit-switch-rev",3,"click",4,"ngIf"],["class","unit-switch-gray",4,"ngIf"],[1,"unit-switch-rev",3,"click"],[1,"unit-switch-gray"],[1,"flaggreen",2,"height","1.8rem"],[1,"flagred",2,"height","1.8rem"],[1,"flagYellow",2,"height","1.8rem"]],template:function(r,n){if(1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5),t.qZA()()(),t.TgZ(6,"div",5)(7,"div",6)(8,"label",7),t._uU(9,"Report Name"),t.qZA(),t.TgZ(10,"select",8),t.NdJ("change",function(){return n.setReportName()})("ngModelChange",function(s){return n.reportName=s}),t.YNc(11,N,2,2,"option",9),t.qZA(),t.TgZ(12,"span",10),t._UZ(13,"img",11),t.qZA()(),t.YNc(14,U,6,3,"div",12),t.YNc(15,R,6,3,"div",12),t.YNc(16,x,6,3,"div",12),t.TgZ(17,"div",13)(18,"label",7),t._uU(19," As on Date "),t._UZ(20,"span",14),t.qZA(),t.TgZ(21,"input",15),t.NdJ("ngModelChange",function(s){return n.toDate=s}),t.qZA()(),t.TgZ(22,"div",16)(23,"span",17),t._UZ(24,"img",11),t.qZA(),t.TgZ(25,"button",18),t.NdJ("click",function(){return n.getAll()}),t._uU(26,"Apply Filter"),t.qZA(),t.TgZ(27,"button",19),t.NdJ("click",function(){return n.reset()}),t._uU(28,"Reset Filter"),t.qZA()()(),t._UZ(29,"hr",20),t.TgZ(30,"div",21)(31,"app-setting-header",22),t.NdJ("dataChange",function(s){return n.eventHeader(s)}),t.qZA(),t.TgZ(32,"table",23)(33,"thead",24)(34,"tr",25)(35,"th",26),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(36,"Item Code"),t.qZA(),t.TgZ(37,"th",27),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(38,"Item Name"),t.qZA(),t.TgZ(39,"th",28),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(40,"Item Description"),t.qZA(),t.TgZ(41,"th",29),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(42,"UoM"),t.qZA(),t.TgZ(43,"th",30),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(44,"Quantity"),t.qZA(),t.TgZ(45,"th",31),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(46,"Unit Rate"),t.qZA(),t.TgZ(47,"th",32),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(48,"Line Value"),t.qZA(),t.TgZ(49,"th",33),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(50,"MRN No."),t.qZA(),t.TgZ(51,"th",34),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(52,"Batch Date"),t.qZA(),t.TgZ(53,"th"),t._uU(54,"Aging"),t.qZA(),t.TgZ(55,"th",35),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(56,"B/B Date"),t.qZA(),t.TgZ(57,"th",36),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(58,"Supplier N'/Name"),t.qZA(),t.TgZ(59,"th",37),t.NdJ("sort",function(s){return n.onSort(s)}),t._uU(60,"Location"),t.qZA()()(),t.TgZ(61,"tbody"),t.YNc(62,w,39,36,"tr",38),t.qZA()()(),t.TgZ(63,"div",39),t._UZ(64,"hr",20),t.TgZ(65,"div",40)(66,"div",13)(67,"div",41)(68,"div",42),t._uU(69," Inventory Value "),t._UZ(70,"i",43),t.TgZ(71,"button",44),t._uU(72),t.ALo(73,"companyCurrency"),t.qZA()(),t._UZ(74,"input",45),t.ALo(75,"number"),t.qZA()()()()()()),2&r){let o;t.xp6(5),t.hij("Inventory Report (IR) - ",null!==(o=n.menuItemName)&&void 0!==o?o:"Stores",""),t.xp6(5),t.Q6J("ngModel",n.reportName),t.xp6(1),t.Q6J("ngForOf",n.reportNameArr),t.xp6(3),t.Q6J("ngIf",t.VKq(17,m,n.reportNameObj.aodInventoryBySupplier).includes(n.reportName)),t.xp6(1),t.Q6J("ngIf",t.VKq(19,m,n.reportNameObj.aodInventoryByItem).includes(n.reportName)),t.xp6(1),t.Q6J("ngIf",t.VKq(21,m,n.reportNameObj.aodInventoryByLocation).includes(n.reportName)),t.xp6(5),t.Q6J("ngModel",n.toDate),t.xp6(10),t.Q6J("data",t.l5B(23,L,n.page,n.pageSize,n.collection,n.search)),t.xp6(31),t.Q6J("ngForOf",n.tableData)("ngForTrackBy",n.trackByFn),t.xp6(10),t.Oqu(t.lcZ(73,12,"INR")),t.xp6(2),t.Q6J("value",t.xi3(75,14,n.inventoryValue,"1.2-2"))}},dependencies:[p.mk,p.sg,p.O5,Z.P,b._L,u.YN,u.Kr,u.Fj,u.EJ,u.JJ,u.On,T.w9,v.j,p.JJ,p.uU,A.f,C.S],styles:[".fa[_ngcontent-%COMP%]{font-size:1.6rem!important}"]}),a})();var Y=l(56208);const j=[{path:"",component:F}];let P=(()=>{var i;class a{}return(i=a).\u0275fac=function(r){return new(r||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.ez,_.Bz.forChild(j),Y.m]}),a})()}}]);