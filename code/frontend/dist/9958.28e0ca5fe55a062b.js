"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9958],{89958:(ut,T,c)=>{c.r(T),c.d(T,{RaiseTicketModule:()=>at});var d=c(96814),_=c(1076),h=c(43818),t=c(65879),v=c(32197),p=c(2742),b=c(88059),u=c(37285);function k(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",18,19)(7,"span",20),t._uU(8),t.qZA()(),t.TgZ(9,"td",18,21)(11,"span",20),t._uU(12),t.qZA()(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td")(16,"div",22),t._UZ(17,"button",23),t.TgZ(18,"div",24)(19,"a",25),t.NdJ("click",function(){const n=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.navigateTo("/default/supports/master/raise-ticket/raise-ticket-form",n,"view"))}),t._UZ(20,"i",26),t._uU(21," View "),t.qZA(),t.TgZ(22,"a",25),t.NdJ("click",function(){const n=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.navigateTo("/default/supports/master/raise-ticket/raise-ticket-form",n,"edit"))}),t._UZ(23,"i",27),t._uU(24," Edit "),t.qZA()()()()()}if(2&o){const e=l.$implicit,i=t.MAs(6),s=t.MAs(10);t.xp6(2),t.Oqu(e.issueNumber),t.xp6(2),t.Oqu(e.issueDate),t.xp6(1),t.Udp("width",i.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.issueDescription)("positionTarget",i),t.xp6(1),t.hij(" ",e.issueDescription," "),t.xp6(1),t.Udp("width",s.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.issueResolution)("positionTarget",s),t.xp6(1),t.hij(" ",e.issueResolution," "),t.xp6(2),t.Oqu(e.issueStatus),t.xp6(8),t.ekj("disable","Closed"==(null==e?null:e.issueStatus))}}const y=function(o,l,e,i){return{page:o,pageSize:l,collection:e,search:i}};let C=(()=>{class o{constructor(e,i,s,n,a){this.supportService=e,this.router=i,this.spinner=s,this.menuTitleService=n,this.exportExcelService=a,this.page=1,this.pageSize=8,this.collection=0,this.column="issueNumber",this.direction=-1,this.search="",this.tableData=[]}ngOnInit(){this.getAll(),this.menuTitleService.set({title:"Raise a Ticket",subTitle:null,type:null})}navigateTo(e,i,s){if("Closed"==i?.issueStatus&&"edit"==s)return null;this.router.navigate([e],{queryParams:{id:i?._id,action:s}})}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value,this.getAll();break;case"EXCEL":this.getAll(!0);break;case"PAGE":this.page=e.value,this.getAll()}}getAll(e=!1){this.spinner.show();let i={dummy:"1",page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:e};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.supportService.getAll(i).subscribe(s=>{e?this.excelDownload(s.rows):(this.tableData=s.rows,this.collection=s.count,this.spinner.hide())})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}trackByFn(e,i){return i?._id}excelDownload(e){let i={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}},s={title:"Raise a Ticket",csvData:e,headers:[{header:"Ticket#",key:"issueNumber",...i},{header:"Ticket Date",key:"issueDate",...i},{header:"Title",key:"issueTitle",...i},{header:"Sub Module Name",key:"subModuleName",...i},{header:"Ticket Type",key:"ticketType",...i},{header:"Priority",key:"priority",...i},{header:"Severity",key:"severity",...i},{header:"Description",key:"issueDescription",...i},{header:"Resolution",key:"issueResolution",...i},{header:"Status",key:"issueStatus",...i}]};this.exportExcelService.exportExcel(s)}onSort({column:e,direction:i}){this.headers.forEach(s=>{s.sortable!==e&&(s.direction="")}),this.column=e,this.direction="asc"==i?1:-1,this.getAll()}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(v.a),t.Y36(_.F0),t.Y36(p.V),t.Y36(p.Uh),t.Y36(p.Ol))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-raise-ticket-list"]],viewQuery:function(i,s){if(1&i&&t.Gf(h.j,5),2&i){let n;t.iGM(n=t.CRH())&&(s.headers=n)}},decls:28,vars:8,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],[1,"text-center"],["type","button",1,"btn","btn-primary","btn-add",3,"click"],["aria-hidden","true",1,"fa","fa-plus-square","fa-lg","me-2"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","issueNumber",3,"sort"],["sortable","createdAt",3,"sort"],["sortable","issueDescription",1,"text-start",3,"sort"],["sortable","issueResolution",1,"text-start",3,"sort"],["sortable","issueStatus",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["issueDescription",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["issueResolution",""],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["href","javascript:void(0)",3,"click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3,"Ticket Summary"),t.qZA()(),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return s.navigateTo("/default/supports/master/raise-ticket/raise-ticket-form",null,"create")}),t._UZ(6,"i",5),t._uU(7," Generate Ticket "),t.qZA()(),t._UZ(8,"hr",6),t.TgZ(9,"div",7)(10,"app-setting-header",8),t.NdJ("dataChange",function(a){return s.eventHeader(a)}),t.qZA(),t.TgZ(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th",12),t.NdJ("sort",function(a){return s.onSort(a)}),t._uU(15,"Ticket#"),t.qZA(),t.TgZ(16,"th",13),t.NdJ("sort",function(a){return s.onSort(a)}),t._uU(17,"Ticket Date"),t.qZA(),t.TgZ(18,"th",14),t.NdJ("sort",function(a){return s.onSort(a)}),t._uU(19,"Description"),t.qZA(),t.TgZ(20,"th",15),t.NdJ("sort",function(a){return s.onSort(a)}),t._uU(21,"Resolution"),t.qZA(),t.TgZ(22,"th",16),t.NdJ("sort",function(a){return s.onSort(a)}),t._uU(23,"Status"),t.qZA(),t.TgZ(24,"th"),t._uU(25,"Action"),t.qZA()()(),t.TgZ(26,"tbody"),t.YNc(27,k,25,15,"tr",17),t.qZA()()()()),2&i&&(t.xp6(10),t.Q6J("data",t.l5B(3,y,s.page,s.pageSize,s.collection,s.search)),t.xp6(17),t.Q6J("ngForOf",s.tableData)("ngForTrackBy",s.trackByFn))},dependencies:[d.sg,b.P,u._L,h.j],encapsulation:2})}return o})();var r=c(60095),A=c(21631),D=c(22096),w=c(25116),R=c(95346),x=c(69205);function S(o,l){if(1&o&&(t.TgZ(0,"span",21),t._uU(1),t.ALo(2,"truncate"),t.qZA()),2&o){const e=t.oxw().$implicit;t.Q6J("ngbTooltip",e.issueDescription),t.xp6(1),t.hij(" ",e.issueDescription?t.xi3(2,2,e.issueDescription,40):"-"," ")}}function U(o,l){if(1&o&&(t.TgZ(0,"span",21),t._uU(1),t.ALo(2,"truncate"),t.qZA()),2&o){const e=t.oxw().$implicit;t.Q6J("ngbTooltip",e.issueResolution),t.xp6(1),t.hij(" ",e.issueResolution?t.xi3(2,2,e.issueResolution,40):"-"," ")}}function N(o,l){if(1&o&&(t.TgZ(0,"a",22),t._UZ(1,"i",23),t.qZA()),2&o){const e=t.oxw().$implicit;t.Q6J("href",e.url,t.LSH)}}const Z=function(){return["Open","Reopened"]};function M(o,l){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td",18),t.YNc(9,S,3,5,"span",19),t.YNc(10,U,3,5,"span",19),t.qZA(),t.TgZ(11,"td"),t.YNc(12,N,2,1,"a",20),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA()()),2&o){const e=l.$implicit;t.xp6(2),t.Oqu(t.xi3(3,7,e.issueDate,"dd-MM-YYYY")),t.xp6(3),t.Oqu(e.action),t.xp6(2),t.Oqu(e.issueStatus),t.xp6(2),t.Q6J("ngIf",t.DdM(10,Z).includes(e.issueStatus)),t.xp6(1),t.Q6J("ngIf",!t.DdM(11,Z).includes(e.issueStatus)),t.xp6(2),t.Q6J("ngIf",e.url),t.xp6(2),t.Oqu(e.raisedBy)}}const q=function(o,l,e,i){return{page:o,pageSize:l,collection:e,search:i,excelDisplay:"none"}};let J=(()=>{class o{constructor(e){this.activeModal=e,this.page=1,this.pageSize=8,this.collection=0,this.column="issueNumber",this.direction=-1,this.search="",this.historyData=[]}ngOnInit(){this.collection=this.historyData.length}onSort({column:e,direction:i}){this.headers.forEach(s=>{s.sortable!==e&&(s.direction="")}),this.historyData=""===i||""===e?this.historyData:[...this.historyData].sort((s,n)=>{let a="string"==typeof s[e]?s[e].toLowerCase():s[e],g="string"==typeof n[e]?n[e].toLowerCase():n[e];const f=a<g?-1:a>g?1:0;return"asc"===i?f:-f})}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value;break;case"EXCEL":default:break;case"PAGE":this.page=e.value}}trackByFn(e,i){return i?._id}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(u.Kz))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-view-ticket-history"]],viewQuery:function(i,s){if(1&i&&t.Gf(h.j,5),2&i){let n;t.iGM(n=t.CRH())&&(s.headers=n)}},inputs:{historyData:"historyData"},decls:30,vars:15,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"row","px-5"],[1,"table-responsive",2,"min-height","38rem"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","issueDate",3,"sort"],["sortable","action",3,"sort"],["sortable","issueStatus",3,"sort"],["sortable","issueDescription",1,"text-start",3,"sort"],["sortable","url",3,"sort"],["sortable","raisedBy",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["class","pointer","placement","right",3,"ngbTooltip",4,"ngIf"],["target","_blank",3,"href",4,"ngIf"],["placement","right",1,"pointer",3,"ngbTooltip"],["target","_blank",3,"href"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Review History"),t.qZA(),t.TgZ(4,"div")(5,"button",3),t.NdJ("click",function(){return s.activeModal.close()}),t._UZ(6,"i",4),t.qZA()()()(),t.TgZ(7,"div",0)(8,"div",5)(9,"div",6)(10,"app-setting-header",7),t.NdJ("dataChange",function(a){return s.eventHeader(a)}),t.qZA(),t.TgZ(11,"table",8)(12,"thead",9)(13,"tr",10)(14,"th",11),t.NdJ("sort",function(a){return s.onSort(a)}),t._uU(15,"Date"),t.qZA(),t.TgZ(16,"th",12),t.NdJ("sort",function(a){return s.onSort(a)}),t._uU(17,"Action"),t.qZA(),t.TgZ(18,"th",13),t.NdJ("sort",function(a){return s.onSort(a)}),t._uU(19,"Status"),t.qZA(),t.TgZ(20,"th",14),t.NdJ("sort",function(a){return s.onSort(a)}),t._uU(21," Description/Resolution "),t.qZA(),t.TgZ(22,"th",15),t.NdJ("sort",function(a){return s.onSort(a)}),t._uU(23,"Attachment"),t.qZA(),t.TgZ(24,"th",16),t.NdJ("sort",function(a){return s.onSort(a)}),t._uU(25,"User"),t.qZA()()(),t.TgZ(26,"tbody"),t.YNc(27,M,15,12,"tr",17),t.ALo(28,"slice"),t.ALo(29,"searchFi1ter"),t.qZA()()()()()),2&i&&(t.xp6(10),t.Q6J("data",t.l5B(10,q,s.page,s.pageSize,s.collection,s.search)),t.xp6(17),t.Q6J("ngForOf",t.Dn7(28,3,t.xi3(29,7,s.historyData,s.search),(s.page-1)*s.pageSize,(s.page-1)*s.pageSize+s.pageSize))("ngForTrackBy",s.trackByFn))},dependencies:[d.sg,d.O5,b.P,u._L,h.j,d.OU,d.uU,R.G,x.W],encapsulation:2})}return o})(),F=(()=>{class o{constructor(e,i){this.activeModal=e,this.toastService=i,this.action="",this.issueDescription={},this.saveData=new t.vpe,this.btnDisable=!1,this.page=1,this.pageSize=4,this.collection=0,this.search="",this.column="createdAt",this.direction=-1}ngOnInit(){}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value;break;case"EXCEL":default:break;case"PAGE":this.page=e.value}}reset(){this.issueDescription=this.issueDescription}dismissModel(){this.saveData.emit({data:this.issueDescription,key:"issueDescription"}),this.toastService.success("Remarks Saved")}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(u.Kz),t.Y36(p.kl))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-ticket-description-modal"]],inputs:{action:"action",issueDescription:"issueDescription"},outputs:{saveData:"saveData"},decls:15,vars:1,consts:[[1,"modelPage"],[1,""],[1,"container-fluid"],[1,"row",2,"min-height","28.5rem"],[1,"row","px-5","mt-4","mb-5","form-page"],[1,"col-2"],[1,"col-8","card-form"],[1,"row"],[1,"col-12","px-0"],[1,"form-header","mb-1"],[1,"col","ps-3","heading"],[1,"col","pt-2","px-3"],["rows","11","readonly","",1,"form-control","form-text-area",3,"ngModel","ngModelChange"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._UZ(5,"div",5),t.TgZ(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10),t._uU(11,"Ticket Description"),t.qZA()(),t.TgZ(12,"div",11)(13,"textarea",12),t.NdJ("ngModelChange",function(a){return s.issueDescription=a}),t.qZA()()()()(),t._UZ(14,"div",5),t.qZA()()()()()),2&i&&(t.xp6(13),t.Q6J("ngModel",s.issueDescription))},dependencies:[r.Fj,r.JJ,r.On],encapsulation:2})}return o})(),Y=(()=>{class o{constructor(e,i){this.activeModal=e,this.toastService=i,this.action="",this.issueResolution={},this.saveData=new t.vpe,this.btnDisable=!1,this.page=1,this.pageSize=4,this.collection=0,this.search="",this.column="createdAt",this.direction=-1}ngOnInit(){}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value;break;case"EXCEL":default:break;case"PAGE":this.page=e.value}}reset(){this.issueResolution=this.issueResolution}dismissModel(){this.saveData.emit({data:this.issueResolution,key:"issueResolution"}),this.toastService.success("Remarks Saved")}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(u.Kz),t.Y36(p.kl))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-ticket-resolution-modal"]],inputs:{action:"action",issueResolution:"issueResolution"},outputs:{saveData:"saveData"},decls:15,vars:1,consts:[[1,"modelPage"],[1,""],[1,"container-fluid"],[1,"row",2,"min-height","28.5rem"],[1,"row","px-5","mt-4","mb-5","form-page"],[1,"col-2"],[1,"col-8","card-form"],[1,"row"],[1,"col-12","px-0"],[1,"form-header","mb-1"],[1,"col","ps-3","heading"],[1,"col","pt-2","px-3"],["rows","11","readonly","",1,"form-control","form-text-area",3,"ngModel","ngModelChange"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._UZ(5,"div",5),t.TgZ(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10),t._uU(11,"Ticket Resolution"),t.qZA()(),t.TgZ(12,"div",11)(13,"textarea",12),t.NdJ("ngModelChange",function(a){return s.issueResolution=a}),t.qZA()()()()(),t._UZ(14,"div",5),t.qZA()()()()()),2&i&&(t.xp6(13),t.Q6J("ngModel",s.issueResolution))},dependencies:[r.Fj,r.JJ,r.On],encapsulation:2})}return o})();function O(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"app-ticket-description-modal",15),t.NdJ("saveData",function(s){t.CHM(e);const n=t.oxw();return t.KtG(n.saveData(s))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("issueDescription",e.issueDescription)("action",e.action)}}function I(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"app-ticket-resolution-modal",16),t.NdJ("saveData",function(s){t.CHM(e);const n=t.oxw();return t.KtG(n.saveData(s))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("issueResolution",e.issueResolution)("action",e.action)}}let Q=(()=>{class o{constructor(e){this.activeModal=e,this.action="edit",this.issueDescription={},this.issueResolution={},this.storage={},this.bomDimData={},this.isPreview=!1,this.resetData=[],this.ESCPreviewArr=[],this.btnDisable=!1,this.page=1,this.pageSize=8,this.collection=0,this.search="",this.column="createdAt",this.direction=-1,this.isESCPreview=!1,this.attributes="dimensions",this.active=1}ngOnInit(){}saveData(e){"issueDescription"==e.key&&(this.issueDescription=e.data),"issueResolution"==e.key&&(this.issueResolution=e.data)}dismissModel(){let e={};e.issueDescription=this.issueDescription,e.issueResolution=this.issueResolution,this.activeModal.close(e)}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(u.Kz))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-view-resolution-comments"]],viewQuery:function(i,s){if(1&i&&t.Gf(h.j,5),2&i){let n;t.iGM(n=t.CRH())&&(s.headers=n)}},inputs:{action:"action",issueDescription:"issueDescription",issueResolution:"issueResolution",storage:"storage",bomDimData:"bomDimData"},decls:22,vars:4,consts:[[1,"modelPage",2,"min-height","53.7rem"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid","mt-5","mb-3"],[1,"row"],[1,"col-12","px-0"],["ngbNav","",1,"nav-pills","tabs-card","row","justify-content-start","ms-5","align-items-end",3,"activeId","activeIdChange"],["nav","ngbNav"],[1,"col-auto","px-0","d-grid","btn-border-radius",3,"ngbNavItem"],["ngbNavLink","",1,"mb-0","ps-4","pe-5","pt-1"],["ngbNavContent",""],[1,"line-border","mt-0"],[1,"mt-2",3,"ngbNavOutlet"],[3,"issueDescription","action","saveData"],[3,"issueResolution","action","saveData"]],template:function(i,s){if(1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"View Resolution Comments"),t.qZA(),t.TgZ(4,"div")(5,"button",3),t.NdJ("click",function(){return s.dismissModel()}),t._UZ(6,"i",4),t.qZA()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"ul",8,9),t.NdJ("activeIdChange",function(a){return s.active=a}),t.TgZ(12,"li",10)(13,"a",11),t._uU(14,"Ticket Description "),t.qZA(),t.YNc(15,O,1,2,"ng-template",12),t.qZA(),t.TgZ(16,"li",10)(17,"a",11),t._uU(18,"Ticket Resolution "),t.qZA(),t.YNc(19,I,1,2,"ng-template",12),t.qZA()(),t._UZ(20,"hr",13)(21,"div",14),t.qZA()()()()),2&i){const n=t.MAs(11);t.xp6(10),t.Q6J("activeId",s.active),t.xp6(2),t.Q6J("ngbNavItem",1),t.xp6(4),t.Q6J("ngbNavItem",2),t.xp6(5),t.Q6J("ngbNavOutlet",n)}},dependencies:[u.uN,u.Pz,u.nv,u.Is,u.Vx,u.tO,u.Dy,F,Y],styles:[".tabs-card[_ngcontent-%COMP%]{box-shadow:none;display:flex;justify-content:center;text-align:center;background-color:transparent}.tabs-card[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{display:grid!important}.tabs-card[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{flex:1 0;font-weight:500;font-size:1.4rem;border-radius:2px;margin-bottom:1rem;color:var(--bs-white)!important;background-color:#fd99d5!important;border:1px solid var(--bs-white)}.tabs-card[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{color:var(--bs-white)!important;background-color:var(--bs-primary)!important;border:1px solid var(--bs-white)}.tabs-card[_ngcontent-%COMP%]   .btn-border-radius[_ngcontent-%COMP%]{clip-path:polygon(0 0,85% 0,100% 100%,0% 100%)!important;width:16rem!important;height:2.6rem!important}"]})}return o})();var V=c(25866),H=c(50363);function L(o,l){1&o&&t.GkF(0)}function E(o,l){if(1&o&&(t.TgZ(0,"option",33),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.Q6J("value",e.title),t.xp6(1),t.hij(" ",e.title," ")}}function P(o,l){if(1&o&&(t.TgZ(0,"option",33),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.label," ")}}function j(o,l){if(1&o&&(t.TgZ(0,"option",33),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.label," ")}}function z(o,l){if(1&o&&(t.TgZ(0,"option",33),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.label," ")}}function G(o,l){1&o&&(t.TgZ(0,"div",34)(1,"label",9),t._uU(2,"Ticket Resolution"),t._UZ(3,"span",10),t.qZA(),t._UZ(4,"textarea",35),t.qZA())}function B(o,l){1&o&&(t.TgZ(0,"div",29)(1,"label",9),t._uU(2,"Raised By"),t._UZ(3,"span",10),t.qZA(),t._UZ(4,"input",36),t.qZA())}function K(o,l){if(1&o&&(t.TgZ(0,"option",33),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function $(o,l){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"label",9),t._uU(2," Status"),t.TgZ(3,"span",10),t._uU(4,"*"),t.qZA()(),t.TgZ(5,"select",37),t.NdJ("change",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.setFormField())}),t.TgZ(6,"option",38),t._uU(7,"Select Module Name"),t.qZA(),t.YNc(8,K,2,2,"option",18),t.qZA(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(8),t.Q6J("ngForOf",e.issueStatus)}}function X(o,l){1&o&&(t.ynx(0),t.TgZ(1,"label",9),t._uU(2," Closed on"),t.TgZ(3,"span",10),t._uU(4,"*"),t.qZA()(),t._UZ(5,"input",39),t.BQk())}function W(o,l){1&o&&(t.TgZ(0,"div",29)(1,"label",9),t._uU(2,"Raised By"),t._UZ(3,"span",10),t.qZA(),t._UZ(4,"input",36),t.qZA())}function tt(o,l){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",40),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.openRevisionReview())}),t._uU(2,"History"),t.qZA(),t.TgZ(3,"button",41),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.openViewResolutionComments())}),t._uU(4," View Resolution Comments "),t.qZA(),t.BQk()}}function et(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",42)(1,"div",43)(2,"button",44),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.reset())}),t._uU(3,"Reset"),t.qZA()(),t.TgZ(4,"div",45)(5,"button",46),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.submit())}),t._uU(6,"Save"),t.qZA()()()}}const m=function(){return["edit","view"]},it=function(){return["view"]};let st=(()=>{class o{get f(){return this.form.controls}constructor(e,i,s,n,a,g,f,rt,lt,ct){this.supportService=e,this.router=i,this.activatedRoute=s,this.spinner=n,this.menuTitleService=a,this.toastService=g,this.utilityService=f,this.appGlobalService=rt,this.storageService=lt,this.modalService=ct,this.submitted=!1,this.action="create",this.issueAttachmentFile=null,this.subModuleNames=[],this.priority=[],this.severity=[],this.ticketType=[],this.moduleList=[],this.menuItems=[],this.issueStatus=w._1,this.subModuleList=[],this.historyData=[],this.userName="",this.form=new r.nJ({_id:new r.p4(null),issueNumber:new r.p4(null),issueTitle:new r.p4(null),subModuleName:new r.p4(null),menuItemId:new r.p4(null),issueDescription:new r.p4(null),issueResolution:new r.p4(null),issueAttachment:new r.p4(null),issueDate:new r.p4(this.utilityService.getTodayDate("YYYY-MM-DD")),ticketType:new r.p4(null),priority:new r.p4(null),severity:new r.p4(null),issueStatus:new r.p4(null),url:new r.p4(null),raisedBy:new r.p4(null),closedOn:new r.p4(null)})}ngOnInit(){this.getInitialData(),this.appGlobalService.getData(["menuItems"]).subscribe(e=>{this.menuItems=e.menuItems}),this.userName=this.storageService.get("IDMSAUser")?.name,this.f.raisedBy.setValue(this.userName)}reset(){this.getInitialData(),this.form.reset()}submit(){if(this.submitted=!0,this.form.enable(),this.form.invalid)return void this.toastService.warning("Please fill all required field !");let e=this.form.value,i=new FormData;i.append("key","issueAttachment");for(let s=0;s<Object.keys(e).length;s++){const n=Object.keys(e)[s];e[n]&&i.append(n,e[n])}this.issueAttachmentFile&&i.append("issueAttachment",this.issueAttachmentFile,this.issueAttachmentFile.name),e._id?this.update(e._id,i):(delete e._id,this.create(i))}create(e){this.spinner.show(),this.supportService.create(e).subscribe(i=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(i.message),this.router.navigate(["/default/supports/master/raise-ticket/raise-ticket-list"])})}update(e,i){this.spinner.show(),this.supportService.update(e,i).subscribe(s=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(s.message),this.router.navigate(["/default/supports/master/raise-ticket/raise-ticket-list"])})}getInitialData(){this.spinner.show(),this.supportService.getAllMasterData({}).subscribe(e=>{this.form.controls.issueNumber.setValue(e.autoIncrementNo),this.priority=e.priority,this.severity=e.severity,this.ticketType=e.ticketType,this.moduleList=e.moduleList,this.activatedRoute.queryParams.pipe((0,A.z)(i=>(this.action=i.action,i.id?this.supportService.getById(i.id):(0,D.of)({})))).subscribe(i=>{0!=Object.keys(i).length&&(i.issueDate&&(i.issueDate=i.issueDate.split("T")[0]),i.oldHistory&&i.oldHistory.length&&(this.historyData=i.oldHistory),i.menuItemId&&this.supportService.getAllSubModuleListByMenuId(i.menuItemId).subscribe(s=>{this.subModuleNames=s}),this.form.patchValue(i),"Open"!=i.issueStatus&&(this.form.disable(),this.form.controls.issueStatus.enable(),this.form.controls.issueResolution.enable(),this.form.controls.issueDescription.enable()),"Closed"==i.issueStatus?i.closedOn&&this.form.controls.closedOn.setValue(this.utilityService.getFormatDate(i.closedOn,"YYYY-MM-DD")):this.setFormField(),"view"==this.action&&this.form.disable())}),this.menuTitleService.set({title:"Ticket",subTitle:null,type:null})}),this.spinner.hide()}setFormField(){let i=this.form.controls.closedOn.value;"Closed"==this.form.controls.issueStatus.value?(this.form.controls.closedOn.enable(),(!i||"undefined"==i)&&this.form.controls.closedOn.setValue(this.utilityService.getTodayDate("YYYY-MM-DD"))):(i||!i||"undefined"==i)&&(this.form.controls.closedOn.setValue(null),this.form.controls.closedOn.disable())}setModule(e){this.supportService.getAllSubModuleListByMenuId(e._id).subscribe(i=>{this.subModuleNames=i,this.form.controls.menuItemId.setValue(e._id)})}openRevisionReview(){this.historyData.length>0&&(this.modalService.open(J,{centered:!0,size:"xl",backdrop:"static",keyboard:!1}).componentInstance.historyData=this.historyData)}openViewResolutionComments(){const e=this.modalService.open(Q,{centered:!0,size:"xl",backdrop:"static",keyboard:!1});e.componentInstance.action=this.action,e.componentInstance.issueDescription=this.form.controls.issueDescription.value,e.componentInstance.issueResolution=this.form.controls.issueResolution.value,e.result.then(i=>{i&&["create","edit"].includes(this.action)&&(this.form.controls.issueDescription.setValue(i.issueDescription),this.form.controls.issueResolution.setValue(i.issueResolution))},i=>{})}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(v.a),t.Y36(_.F0),t.Y36(_.gz),t.Y36(p.V),t.Y36(p.Uh),t.Y36(p.kl),t.Y36(p.tI),t.Y36(p.P0),t.Y36(p.V1),t.Y36(u.FF))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-raise-ticket-form"]],decls:89,vars:39,consts:[[1,"formCard","card",3,"formGroup"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,"form-body"],[1,"row","mb-4"],[1,"col-md-4"],[1,"row"],[1,"col-6"],[1,"form-label"],[1,"text-danger"],["formControlName","issueNumber","type","text","readonly","",1,"form-control"],["formControlName","issueDate","readonly","","type","date",1,"form-control"],[4,"ngIf"],[3,"ngClass"],["bindLabel","title","bindValue","title","formControlName","issueTitle",3,"items","clearable","change"],["formControlName","subModuleName",1,"form-select"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["formControlName","ticketType",1,"form-select"],["selected","","disabled","",3,"value"],["formControlName","priority",1,"form-select"],["formControlName","severity",1,"form-select"],["formControlName","issueDescription","rows","3",1,"form-control","form-text-area"],["class","col-md-6 mb-4",4,"ngIf"],[1,"col-md-6","px-0"],[3,"fileName","url","label","file","fileChange"],[1,"col-md-6"],["class","col-4",4,"ngIf"],[1,"col-4"],[1,"row","line-border"],[1,"row","mb-0"],["class","d-flex justify-content-end mb-3",4,"ngIf"],[3,"value"],[1,"col-md-6","mb-4"],["formControlName","issueResolution","rows","3",1,"form-control","form-text-area"],["formControlName","raisedBy","type","text","readonly","",1,"form-control"],["formControlName","issueStatus",1,"form-select",3,"change"],["value","","disabled",""],["formControlName","closedOn","type","date",1,"form-control"],[1,"btn","btn-primary","px-4","me-4","mb-3",3,"click"],[1,"btn","btn-primary","px-4","mb-3",3,"click"],[1,"d-flex","justify-content-end","mb-3"],[1,"d-grid","col-md-2","me-5"],["type","button",1,"btn","btn-primary",3,"click"],[1,"d-grid","col-md-2"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(i,s){1&i&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label"),t._uU(5),t.ALo(6,"titlecase"),t.qZA()()(),t.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"label",9),t._uU(13,"Ticket#"),t.TgZ(14,"span",10),t._uU(15,"*"),t.qZA()(),t._UZ(16,"input",11),t.qZA(),t.TgZ(17,"div",8)(18,"label",9),t._uU(19," Date"),t.TgZ(20,"span",10),t._uU(21,"*"),t.qZA()(),t._UZ(22,"input",12),t.qZA()()(),t.YNc(23,L,1,0,"ng-container",13),t.TgZ(24,"div",14)(25,"label",9),t._uU(26,"Module Name"),t.TgZ(27,"span",10),t._uU(28,"*"),t.qZA()(),t.TgZ(29,"ng-select",15),t.NdJ("change",function(a){return s.setModule(a)}),t.qZA()(),t.TgZ(30,"div",14)(31,"label",9),t._uU(32," Sub Module Name"),t.TgZ(33,"span",10),t._uU(34,"*"),t.qZA()(),t.TgZ(35,"select",16)(36,"option",17),t._uU(37,"Select Sub Module Name"),t.qZA(),t.YNc(38,E,2,2,"option",18),t.qZA()()(),t.TgZ(39,"div",5)(40,"div",6)(41,"label",9),t._uU(42," Ticket Type"),t._UZ(43,"span",10),t.qZA(),t.TgZ(44,"select",19)(45,"option",20),t._uU(46,"Select Ticket Type"),t.qZA(),t.YNc(47,P,2,2,"option",18),t.qZA()(),t.TgZ(48,"div",6)(49,"label",9),t._uU(50," Ticket Priority "),t._UZ(51,"span",10),t.qZA(),t.TgZ(52,"select",21)(53,"option",20),t._uU(54,"Select Ticket Priority"),t.qZA(),t.YNc(55,j,2,2,"option",18),t.qZA()(),t.TgZ(56,"div",6)(57,"label",9),t._uU(58," Ticket Severity "),t._UZ(59,"span",10),t.qZA(),t.TgZ(60,"select",22)(61,"option",20),t._uU(62,"Select Ticket Severity"),t.qZA(),t.YNc(63,z,2,2,"option",18),t.qZA()()(),t.TgZ(64,"div",5)(65,"div",14)(66,"label",9),t._uU(67,"Ticket Description"),t.TgZ(68,"span",10),t._uU(69,"*"),t.qZA()(),t._UZ(70,"textarea",23),t.qZA(),t.YNc(71,G,5,0,"div",24),t.qZA(),t.TgZ(72,"div",5)(73,"div",25)(74,"app-file-upload",26),t.NdJ("fileChange",function(a){return s.issueAttachmentFile=a}),t.qZA()(),t.TgZ(75,"div",27)(76,"div",7),t.YNc(77,B,5,0,"div",28),t.TgZ(78,"div",29),t.YNc(79,$,9,1,"ng-container",13),t.qZA(),t.TgZ(80,"div",29),t.YNc(81,X,6,0,"ng-container",13),t.qZA(),t.YNc(82,W,5,0,"div",28),t.qZA()()()(),t._UZ(83,"hr",30),t.TgZ(84,"div",31)(85,"div",8),t.YNc(86,tt,5,0,"ng-container",13),t.qZA(),t.TgZ(87,"div",8),t.YNc(88,et,7,0,"div",32),t.qZA()()()()),2&i&&(t.Q6J("formGroup",s.form),t.xp6(5),t.hij("Ticket [",t.lcZ(6,27,s.action),"]"),t.xp6(18),t.Q6J("ngIf",t.DdM(29,m).includes(s.action)),t.xp6(1),t.Q6J("ngClass",(t.DdM(30,m).includes(s.action),"col-md-4  ")),t.xp6(5),t.Q6J("items",s.moduleList)("clearable",!1),t.xp6(1),t.Q6J("ngClass",(t.DdM(31,m).includes(s.action),"col-md-4")),t.xp6(6),t.Q6J("value",""),t.xp6(2),t.Q6J("ngForOf",s.subModuleNames),t.xp6(7),t.Q6J("value",""),t.xp6(2),t.Q6J("ngForOf",s.ticketType),t.xp6(6),t.Q6J("value",""),t.xp6(2),t.Q6J("ngForOf",s.priority),t.xp6(6),t.Q6J("value",""),t.xp6(2),t.Q6J("ngForOf",s.severity),t.xp6(2),t.Q6J("ngClass",t.DdM(32,m).includes(s.action)?"col-md-6 mb-3":"col-md-12 mb-3"),t.xp6(6),t.Q6J("ngIf",t.DdM(33,m).includes(s.action)),t.xp6(3),t.Q6J("fileName",s.form.controls.issueAttachment.value)("url",s.form.controls.url.value)("label","Attachment")("file",s.issueAttachmentFile),t.xp6(3),t.Q6J("ngIf",t.DdM(34,m).includes(s.action)),t.xp6(2),t.Q6J("ngIf",t.DdM(35,m).includes(s.action)),t.xp6(2),t.Q6J("ngIf",t.DdM(36,m).includes(s.action)),t.xp6(1),t.Q6J("ngIf","create"===s.action),t.xp6(4),t.Q6J("ngIf",t.DdM(37,m).includes(s.action)),t.xp6(2),t.Q6J("ngIf",!t.DdM(38,it).includes(s.action)))},dependencies:[d.mk,d.sg,d.O5,V.Y,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.sg,r.u,H.w9,d.rS],encapsulation:2})}return o})();var ot=c(56208);const nt=[{path:"",redirectTo:"raise-ticket-list",pathMatch:"full"},{path:"raise-ticket-list",component:C},{path:"raise-ticket-form",component:st}];let at=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#i=this.\u0275inj=t.cJS({imports:[d.ez,_.Bz.forChild(nt),ot.m]})}return o})()}}]);