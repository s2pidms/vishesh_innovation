"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6512],{83187:(x,C,l)=>{l.r(C),l.d(C,{GIPPICToProductionModule:()=>dt});var g=l(96814),o=l(1076),b=l(43818),v=l(25116),Z=l(17645),t=l(65879),P=l(99007),h=l(98977),I=l(88059),J=l(53421);const A=function(){return["Approved","Rejected"]};function k(s,m){if(1&s){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",19),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td")(14,"div",20),t._UZ(15,"button",21),t.TgZ(16,"div",22)(17,"a",23),t.NdJ("click",function(){const a=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.navigateTo("../form",a,"view"))}),t._UZ(18,"i",24),t._uU(19," View "),t.qZA(),t.TgZ(20,"a",23),t.NdJ("click",function(){const a=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.navigateTo("../form",a,"edit"))}),t._UZ(21,"i",25),t._uU(22," Edit "),t.qZA(),t.TgZ(23,"a",23),t.NdJ("click",function(){const a=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.navigateTo("../form",a,"approve"))}),t._UZ(24,"i",26),t._uU(25," Approve "),t.qZA(),t.TgZ(26,"a",23),t.NdJ("click",function(){const a=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.navigateTo("../form",a,"reject"))}),t._UZ(27,"i",27),t._uU(28," Reject "),t.qZA()()()()()}if(2&s){const e=m.$implicit,i=t.oxw();t.xp6(2),t.Oqu(null==e?null:e.goodsIssueNo),t.xp6(2),t.Oqu(null==e?null:e.goodsIssueDate),t.xp6(2),t.Oqu(null==e?null:e.goodsIssueTo),t.xp6(2),t.Oqu(null==e?null:e.jobCardNo),t.xp6(2),t.Oqu(null==e?null:e.updatedAt),t.xp6(2),t.Oqu(null==e?null:e.status),t.xp6(5),t.Q6J("accessType",i.rolePermissionActions.viewAction),t.xp6(3),t.ekj("disable",t.DdM(16,A).includes(e.status)),t.Q6J("accessType",i.rolePermissionActions.editAction),t.xp6(3),t.ekj("disable",t.DdM(17,A).includes(e.status)),t.Q6J("accessType",i.rolePermissionActions.approveAction),t.xp6(3),t.ekj("disable",t.DdM(18,A).includes(e.status)),t.Q6J("accessType",i.rolePermissionActions.approveAction)}}const f=function(s,m,e,i){return{page:s,pageSize:m,collection:e,search:i,type:"list"}};let T=(()=>{class s{constructor(e,i,n,a,d,M,w){this.giPPICToProductionService=e,this.spinner=i,this.exportExcelService=n,this.toastService=a,this.activatedRoute=d,this.exportToPDFService=M,this.utilityService=w,this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.rolePermissionActions=v.a1}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}navigateTo(e,i,n){this.utilityService.navigateToForm({path:e,status:i.status,action:n,id:i._id,activatedRoute:this.activatedRoute})}trackByFn(e,i){return i?._id}getAll(e=!1,i=""){this.spinner.show();let n={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:e};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.giPPICToProductionService.getAll(n).subscribe(a=>{"EXCEL"==i?this.excelDownload(a.rows):"PDF"==i?this.pdfDownload(a.rows):(this.tableData=a.rows,this.collection=a.count),this.spinner.hide()})}update(e,i){"Approved"==e?.status&&(this.spinner.show(),this.giPPICToProductionService.update(e._id,{status:i}).subscribe(n=>{this.toastService.success(n.message),this.getAll(),this.spinner.hide()}))}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=e.value,this.getAll()}}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}pdfDownload(e){let i=(0,Z.Jk)(e);this.exportToPDFService.generatePdf(i.tableData,i.title)}excelDownload(e){this.exportExcelService.exportExcel((0,Z.dM)(e))}onSort({column:e,direction:i}){this.headers.forEach(n=>{n.sortable!==e&&(n.direction="")}),this.column=e,this.direction="asc"==i?1:-1,this.getAll()}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(P.qI),t.Y36(h.V),t.Y36(h.Ol),t.Y36(h.kl),t.Y36(o.gz),t.Y36(h.$L),t.Y36(h.tI))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-gi-ppic-to-production-list"]],viewQuery:function(i,n){if(1&i&&t.Gf(b.j,5),2&i){let a;t.iGM(a=t.CRH())&&(n.headers=a)}},decls:30,vars:9,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],["appAccessControl","",1,"text-center",3,"accessType"],[1,"plusIconSvg","btn","btn-primary","me-1"],[1,"btn","bg-primary","btn-add","px-3",3,"click"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","goodsIssueNo",3,"sort"],["sortable","goodsIssueDate",3,"sort"],["sortable","goodsIssueTo",1,"text-start",3,"sort"],["sortable","jobCardNo",3,"sort"],["sortable","updatedAt",3,"sort"],["sortable","status",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-check","fa-lg","me-2","text-success"],["aria-hidden","true",1,"fa","fa-close","me-3","text-primary"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3,"Goods Issue Summary I PPIC to Production"),t.qZA()(),t.TgZ(4,"div",3),t._UZ(5,"button",4),t.TgZ(6,"button",5),t.NdJ("click",function(){return n.navigateTo("../form",{},"create")}),t._uU(7,"Goods Issue"),t.qZA()(),t._UZ(8,"hr",6),t.TgZ(9,"div",7)(10,"app-setting-header",8),t.NdJ("dataChange",function(d){return n.eventHeader(d)}),t.qZA(),t.TgZ(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th",12),t.NdJ("sort",function(d){return n.onSort(d)}),t._uU(15,"GI No."),t.qZA(),t.TgZ(16,"th",13),t.NdJ("sort",function(d){return n.onSort(d)}),t._uU(17,"GI Date"),t.qZA(),t.TgZ(18,"th",14),t.NdJ("sort",function(d){return n.onSort(d)}),t._uU(19,"GI Issue to Dept."),t.qZA(),t.TgZ(20,"th",15),t.NdJ("sort",function(d){return n.onSort(d)}),t._uU(21,"Job Card Ref."),t.qZA(),t.TgZ(22,"th",16),t.NdJ("sort",function(d){return n.onSort(d)}),t._uU(23,"Issued by"),t.qZA(),t.TgZ(24,"th",17),t.NdJ("sort",function(d){return n.onSort(d)}),t._uU(25,"Status"),t.qZA(),t.TgZ(26,"th"),t._uU(27,"Action"),t.qZA()()(),t.TgZ(28,"tbody"),t.YNc(29,k,29,19,"tr",18),t.qZA()()()()),2&i&&(t.xp6(4),t.Q6J("accessType",n.rolePermissionActions.createAction),t.xp6(6),t.Q6J("data",t.l5B(4,f,n.page,n.pageSize,n.collection,n.search)),t.xp6(19),t.Q6J("ngForOf",n.tableData)("ngForTrackBy",n.trackByFn))},dependencies:[g.sg,I.P,b.j,J.J],encapsulation:2})}return s})();var r=l(60095),_=l(21631),c=l(22096),u=l(37285),p=l(16897);const y=function(){return["view","approve","reject"]};let D=(()=>{class s{get f(){return this.form.controls}constructor(e,i,n){this.activeModal=e,this.validationService=i,this.utilityService=n,this.remarksDetails={},this.action="",this.form=new r.nJ({PPICRemarksDetail:new r.nJ({PPICRemarks:new r.p4(null),issueBy:new r.p4(null),approvedBy:new r.p4(null),approvedDate:new r.p4(this.utilityService.getTodayDate("YYYY-MM-DD"))}),QARemarksDetail:new r.nJ({QARemark:new r.p4(null),checkedBy:new r.p4(null),approvedBy:new r.p4(null),approvedDate:new r.p4(this.utilityService.getTodayDate("YYYY-MM-DD"))})})}ngOnInit(){this.remarksDetails&&this.form.patchValue(this.remarksDetails),["view","approve","reject"].includes(this.action)&&this.form.disable()}dismissModel(){this.activeModal.close(this.form.value)}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(u.Kz),t.Y36(p.RJ),t.Y36(h.tI))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-gi-ppic-to-production-remarks"]],inputs:{remarksDetails:"remarksDetails",action:"action"},decls:75,vars:3,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,""],[3,"formGroup"],["formGroupName","PPICRemarksDetail"],[1,"mt-0","line-border-with-title"],[1,"px-5"],[1,"row","px-5"],[1,"col-12"],[1,"form-label","mb-1"],[1,"text-danger"],[1,"d-flex"],["type","text","formControlName","PPICRemarks",1,"form-control"],[1,"row","mt-4","px-5"],[1,"col-4"],["type","text","formControlName","issueBy",1,"form-control"],["type","text","formControlName","approvedBy",1,"form-control"],["type","date","formControlName","approvedDate",1,"form-control"],["formGroupName","QARemarksDetail"],[1,"line-border-with-title"],[1,"px-4"],["type","text","formControlName","QARemark",1,"form-control"],["type","text","formControlName","checkedBy",1,"form-control"],[1,"line-border","my-4"],[1,"col-12","d-flex","justify-content-center"],[1,"mb-4"],["type","button",1,"btn","bg-primary","px-4",3,"disabled","click"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Remarks"),t.qZA(),t.TgZ(4,"div")(5,"button",3),t.NdJ("click",function(){return n.activeModal.close()}),t._UZ(6,"i",4),t.qZA()()(),t.TgZ(7,"div",5)(8,"form",6),t.ynx(9,7),t.TgZ(10,"div",8)(11,"span",9),t._uU(12," PPIC Remarks "),t.qZA()(),t.TgZ(13,"div",10)(14,"div",11)(15,"label",12),t._uU(16," PPIC Remarks "),t._UZ(17,"span",13),t.qZA(),t.TgZ(18,"div",14),t._UZ(19,"input",15),t.qZA()()(),t.TgZ(20,"div",16)(21,"div",17)(22,"label",12),t._uU(23,"Issue by "),t._UZ(24,"span",13),t.qZA(),t.TgZ(25,"div",14),t._UZ(26,"input",18),t.qZA()(),t.TgZ(27,"div",17)(28,"label",12),t._uU(29," Approved by "),t._UZ(30,"span",13),t.qZA(),t.TgZ(31,"div",14),t._UZ(32,"input",19),t.qZA()(),t.TgZ(33,"div",17)(34,"label",12),t._uU(35," Approval Date "),t._UZ(36,"span",13),t.qZA(),t.TgZ(37,"div",14),t._UZ(38,"input",20),t.qZA()()(),t.BQk(),t.ynx(39,21),t.TgZ(40,"div",22)(41,"span",23),t._uU(42," \xa0 QA/QC Remarks \xa0 "),t.qZA()(),t.TgZ(43,"div",10)(44,"div",11)(45,"label",12),t._uU(46," QA/QC Remarks "),t._UZ(47,"span",13),t.qZA(),t.TgZ(48,"div",14),t._UZ(49,"input",24),t.qZA()()(),t.TgZ(50,"div",16)(51,"div",17)(52,"label",12),t._uU(53,"Checked by "),t._UZ(54,"span",13),t.qZA(),t.TgZ(55,"div",14),t._UZ(56,"input",25),t.qZA()(),t.TgZ(57,"div",17)(58,"label",12),t._uU(59," Approved by "),t._UZ(60,"span",13),t.qZA(),t.TgZ(61,"div",14),t._UZ(62,"input",19),t.qZA()(),t.TgZ(63,"div",17)(64,"label",12),t._uU(65," Approval Date "),t._UZ(66,"span",13),t.qZA(),t.TgZ(67,"div",14),t._UZ(68,"input",20),t.qZA()()(),t.BQk(),t._UZ(69,"hr",26),t.qZA(),t.TgZ(70,"div",10)(71,"div",27)(72,"div",28)(73,"button",29),t.NdJ("click",function(){return n.dismissModel()}),t._uU(74," Save & Close "),t.qZA()()()()()()),2&i&&(t.xp6(8),t.Q6J("formGroup",n.form),t.xp6(65),t.Q6J("disabled",t.DdM(2,y).includes(n.action)))},dependencies:[r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,r.x0],encapsulation:2})}return s})();var S=l(63375),q=l(61441),G=l(50363),Q=l(95346),O=l(59103);function F(s,m){if(1&s){const e=t.EpF();t.TgZ(0,"div",50),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.setConversionOfUnit(n))}),t.qZA()}}function R(s,m){1&s&&t._UZ(0,"div",51)}function L(s,m){1&s&&t._UZ(0,"div",52)}function j(s,m){1&s&&t._UZ(0,"div",53)}function E(s,m){1&s&&t._UZ(0,"div",54)}function Y(s,m){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&s){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.issueQty,"1.2-2")," ")}}const K=function(){return{standalone:!0}};function B(s,m){if(1&s){const e=t.EpF();t.TgZ(0,"input",55),t.NdJ("ngModelChange",function(n){t.CHM(e);const a=t.oxw().$implicit;return t.KtG(a.issueQty=n)})("input",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.changeGIQty(n))}),t.qZA()}if(2&s){const e=t.oxw().$implicit;t.Q6J("ngModel",e.issueQty)("ngModelOptions",t.DdM(2,K))}}const N=function(){return["approve","reject","view","Acknowledged"]};function z(s,m){if(1&s&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td",25,36)(10,"span",37),t._uU(11),t.qZA()(),t.TgZ(12,"td",25,38)(14,"span",37),t._uU(15),t.qZA()(),t.TgZ(16,"td")(17,"div",39)(18,"span",40),t._uU(19),t.ALo(20,"UOMUnitsMaster"),t.qZA(),t.TgZ(21,"span",41),t.YNc(22,F,1,0,"div",42),t.YNc(23,R,1,0,"div",43),t.qZA()()(),t.TgZ(24,"td")(25,"span"),t._uU(26),t.ALo(27,"number"),t.qZA()(),t.TgZ(28,"td")(29,"div",44),t.YNc(30,L,1,0,"div",45),t.YNc(31,j,1,0,"div",46),t.YNc(32,E,1,0,"div",47),t.qZA()(),t.TgZ(33,"td")(34,"div",44),t.YNc(35,Y,3,4,"span",48),t.YNc(36,B,1,3,"input",49),t.qZA()()()),2&s){const e=m.$implicit,i=t.MAs(9),n=t.MAs(13),a=t.oxw();t.xp6(2),t.Oqu(e.MRNNumber),t.xp6(2),t.Oqu(t.xi3(5,24,e.MRNDate,"dd-MM-YYYY")),t.xp6(3),t.Oqu(e.itemCode),t.xp6(1),t.Udp("width",i.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemName)("positionTarget",i),t.xp6(1),t.hij(" ",e.itemName," "),t.xp6(1),t.Udp("width",n.clientWidth),t.xp6(2),t.Q6J("ngbTooltip",e.itemDescription)("positionTarget",n),t.xp6(1),t.hij(" ",e.itemDescription," "),t.xp6(3),t.Q6J("ngbTooltip",e.conversionOfUnits)("ngClass",e.UOM==e.secondaryUnit?"text-primary pointer":"text-secondary pointer"),t.xp6(1),t.Oqu(t.lcZ(20,27,null==e?null:e.UOM)),t.xp6(3),t.Q6J("ngIf",e.secondaryUnit),t.xp6(1),t.Q6J("ngIf",!e.secondaryUnit),t.xp6(3),t.hij(" ",t.xi3(27,29,e.PPICQty,"1.2-2")," "),t.xp6(4),t.Q6J("ngIf","green"==e.aging),t.xp6(1),t.Q6J("ngIf","red"==e.aging),t.xp6(1),t.Q6J("ngIf","orange"==e.aging),t.xp6(3),t.Q6J("ngIf",t.DdM(32,N).includes(a.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(33,N).includes(a.action))}}function H(s,m){1&s&&(t.TgZ(0,"div",56)(1,"div",57)(2,"button",58),t._uU(3,"Rejection Remarks"),t.qZA(),t._UZ(4,"input",59),t.qZA()())}function V(s,m){if(1&s){const e=t.EpF();t.TgZ(0,"button",60),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.reset())}),t._uU(1," Reset "),t.qZA()}}function W(s,m){if(1&s){const e=t.EpF();t.TgZ(0,"button",61),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.ESCPreview())}),t._uU(1," Esc "),t.qZA()}if(2&s){const e=t.oxw();t.Q6J("disabled",!e.isESCPreview)}}function $(s,m){if(1&s){const e=t.EpF();t.TgZ(0,"button",62),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.preview())}),t._uU(1," Preview "),t.qZA()}}function X(s,m){if(1&s){const e=t.EpF();t.TgZ(0,"button",63),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.submit())}),t._uU(1," Save "),t.qZA()}if(2&s){const e=t.oxw();t.Q6J("disabled",!e.isPreview)}}function tt(s,m){if(1&s){const e=t.EpF();t.TgZ(0,"button",64),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.submit())}),t._uU(1," Approve "),t.qZA()}}function et(s,m){if(1&s){const e=t.EpF();t.TgZ(0,"button",64),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.submit())}),t._uU(1," Reject "),t.qZA()}}function ot(s,m){if(1&s){const e=t.EpF();t.TgZ(0,"button",64),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.submit())}),t._uU(1," Acknowledged "),t.qZA()}}const it=function(s,m,e,i){return{page:s,pageSize:m,collection:e,search:i,excelDisplay:"none"}},U=function(){return["reject","Acknowledged","approve","view"]},nt=function(){return["approve"]},rt=function(){return["reject"]};let st=(()=>{class s{constructor(e,i,n,a,d,M,w,pt){this.giPPICToProductionService=e,this.activatedRoute=i,this.spinner=n,this.toastService=a,this.validationService=d,this.modalService=M,this.utilityService=w,this.location=pt,this.itemCodes=[],this.isPreview=!1,this.submitted=!1,this.isESCPreview=!1,this.action="Awaiting Approval",this.page=1,this.pageSize=5,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.ESCPreviewArr=[],this.statusArr={create:"Awaiting Approval",edit:"Awaiting Approval",approve:"Approved",reject:"Rejected",Acknowledged:"Acknowledged"},this.selectedJobCardDetails={},this.masterData={autoIncrementNo:"",mergeList:[],goodsIssueToOptions:[],JCOptions:[]},this.form=new r.nJ({_id:new r.p4(null),goodsIssueNo:new r.p4(null,[r.kI.required]),goodsIssueDate:new r.p4([r.kI.required]),goodsIssueTo:new r.p4(null,[r.kI.required]),jobCard:new r.p4(null,[r.kI.required]),jobCardNo:new r.p4(null,[r.kI.required]),status:new r.p4("Awaiting Approval"),rejectionRemarks:new r.p4(null),MRNDetails:new r.p4([]),PPICRemarksDetail:new r.p4({}),QARemarksDetail:new r.p4({})})}get f(){return this.form.controls}get PPICRemarks(){return this.form.get("PPICRemarksDetail")}get QARemarks(){return this.form.get("QARemarksDetail")}ngOnInit(){this.getInitialData()}reset(){this.form.reset(),this.masterData.mergeList=[],this.collection=this.masterData.mergeList.length,this.getInitialData(),this.isESCPreview=!1}submit(){if(this.submitted=!0,this.form.enable(),"reject"==this.action&&!this.form.controls.rejectionRemarks.value)return void this.toastService.warning("Rejection Remarks is Required");if(this.validationService.checkErrors(this.form,S.h4))return;let e=this.form.value;e.MRNDetails=this.masterData.mergeList,e._id?this.update(e):(delete e._id,this.create(e))}trackByFn(e,i){return i?._id}create(e){this.spinner.show(),this.giPPICToProductionService.create(e).subscribe(i=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(i.message),this.location.back()})}update(e){this.spinner.show(),this.giPPICToProductionService.update(e._id,e).subscribe(i=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(i.message),this.location.back()})}getInitialData(){this.spinner.show(),this.giPPICToProductionService.getAllMasterData({}).subscribe(e=>{this.masterData=e,this.collection=this.masterData.mergeList.length,this.form.controls.goodsIssueNo.setValue(this.masterData?.autoIncrementNo),this.form.controls.status.setValue("Awaiting Approval"),this.form.controls.goodsIssueDate.setValue(this.utilityService.getTodayDate("YYYY-MM-DD")),this.activatedRoute.queryParams.pipe((0,_.z)(i=>(this.action=i.action,this.utilityService.accessDenied(this.action),i.id?this.giPPICToProductionService.getById(i.id):(0,c.of)({})))).subscribe(i=>{this.spinner.hide(),0!=Object.keys(i).length&&(i.goodsIssueDate&&(i.goodsIssueDate=i.goodsIssueDate.split("T")[0]),this.masterData.mergeList=i.MRNDetails,this.collection=this.masterData.mergeList.length,i.status=this.statusArr[this.action],this.form.patchValue(i),"edit"!=this.action&&this.form.disable(),"reject"==this.action&&(this.form.disable(),this.form.controls.rejectionRemarks.enable()))})})}changeGIQty(e){let i=this.masterData.mergeList.map(n=>n.WIP).indexOf(e.WIP);if(e.issueQty>e.PPICQty)return this.toastService.warning("Goods Issues Qty should not be grater than PPIC Qty!"),void(this.masterData.mergeList[i].issueQty=0)}setConversionOfUnit(e){if(["create","edit"].includes(this.action)){let i=this.masterData.mergeList.map(n=>n?.WIP+n?.SFG).indexOf(e?.WIP+e?.SFG);this.masterData.mergeList[i].UOM==e.secondaryUnit?(this.masterData.mergeList[i].UOM=e.primaryUnit,e.primaryToSecondaryConversion&&(this.masterData.mergeList[i].PPICQty=+e.PPICQty/+e.primaryToSecondaryConversion),e.secondaryToPrimaryConversion&&(this.masterData.mergeList[i].PPICQty=+e.PPICQty*+e.secondaryToPrimaryConversion),this.masterData.mergeList[i].issueQty=0,this.isPreview=!1):(this.masterData.mergeList[i].UOM=e.secondaryUnit,e.primaryToSecondaryConversion&&(this.masterData.mergeList[i].PPICQty=+e.PPICQty*+e.primaryToSecondaryConversion),e.secondaryToPrimaryConversion&&(this.masterData.mergeList[i].PPICQty=+e.PPICQty/+e.secondaryToPrimaryConversion),this.masterData.mergeList[i].issueQty=0,this.isPreview=!1)}}preview(){this.search="",this.isESCPreview=!0,this.ESCPreviewArr=this.masterData.mergeList,this.masterData.mergeList=this.masterData.mergeList.filter(e=>e.issueQty>0),0==this.masterData.mergeList.length?this.toastService.warning("At least One Row is Required!"):this.isPreview=!0,this.collection=this.masterData.mergeList.length}ESCPreview(){this.search="",this.isPreview=!1,this.masterData.mergeList=this.ESCPreviewArr,this.collection=this.masterData.mergeList.length}eventHeader(e){switch(e.key){case"SEARCH":this.search=e.value;break;case"EXCEL":default:break;case"PAGE":this.page=e.value}}openRemarksDetailsModal(){const e=this.modalService.open(D,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});e.componentInstance.action=this.action,e.componentInstance.remarksDetails={PPICRemarksDetail:this.PPICRemarks.value,QARemarksDetail:this.QARemarks.value},e.result.then(i=>{i&&this.form.patchValue(i)},i=>{})}setJobCardId(e){this.f.jobCard.setValue(e?._id)}openJobCardDetailsModal(){const e=this.modalService.open(q.Q,{centered:!0,size:"xl",backdrop:"static",keyboard:!1});e.componentInstance.action="edit"==this.action?"create":this.action,e.componentInstance.selectedJobCardDetails=this.selectedJobCardDetails,e.componentInstance.JCOptions=this.masterData.JCOptions,e.componentInstance.jobCard=this.form.controls.jobCard.value,e.result.then(i=>{i&&(this.selectedJobCardDetails=i?.selectedJobCardDetails,this.form.controls.jobCard.setValue(i?.selectedJobCardDetails?._id),this.form.controls.jobCardNo.setValue(i?.selectedJobCardDetails?.jobCardNo))},i=>{})}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(P.qI),t.Y36(o.gz),t.Y36(h.V),t.Y36(h.kl),t.Y36(p.RJ),t.Y36(u.FF),t.Y36(h.tI),t.Y36(g.Ye))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-gi-ppic-to-production-form"]],decls:79,vars:37,consts:[[1,"formCard","card",3,"formGroup"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,""],[1,"form-body"],[1,"row"],[1,"col-3","pe-5"],["for","",1,"form-label"],[1,"text-danger"],[1,"d-flex","align-items-center"],[1,"col-11"],["bindLabel","jobCardNo","bindValue","jobCardNo","formControlName","jobCardNo",3,"items","clearable","change"],["id","basic-addon1",1,"set-input-group-text","input-group-text","bg-primary","pointer","col-auto",2,"height","2.9rem",3,"click"],["aria-hidden","true",1,"fa","fa-search","text-white","fs-4"],[1,"col-3"],["type","text","formControlName","goodsIssueNo","readonly","",1,"form-control"],["type","date","formControlName","goodsIssueDate",1,"form-control"],["bindLabel","parameterName","bindValue","parameterLabel","formControlName","goodsIssueTo",3,"items","clearable"],[1,"row","line-border"],[3,"data","dataChange"],[1,"table-responsive",2,"min-height","20rem"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],[1,"text-start"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-6","d-flex"],["type","button",1,"btn","btn-primary","px-5",3,"click"],["class","px-5",4,"ngIf"],[1,"col-md-auto","ms-auto"],["type","button","class","btn bg-primary px-5 me-3",3,"click",4,"ngIf"],["type","button","class","btn btn-primary px-4 me-1",3,"disabled","click",4,"ngIf"],["type","button","class","btn bg-primary px-4 me-3",3,"click",4,"ngIf"],["type","button","class","btn bg-primary px-5",3,"disabled","click",4,"ngIf"],["type","button","class","btn bg-primary px-5",3,"click",4,"ngIf"],["itemName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["itemDescription",""],[1,"d-flex","justify-content-between","px-2"],["placement","top",3,"ngbTooltip","ngClass"],[1,"pointer","d-flex","align-items-center"],["class","unit-switch-rev",3,"click",4,"ngIf"],["class","unit-switch-gray",4,"ngIf"],[1,"d-flex","justify-content-center"],["class","flagGreen",4,"ngIf"],["class","flagRed",4,"ngIf"],["class","flagOrange",4,"ngIf"],[4,"ngIf"],["class","form-control form-control-sm w-25","type","number",3,"ngModel","ngModelOptions","ngModelChange","input",4,"ngIf"],[1,"unit-switch-rev",3,"click"],[1,"unit-switch-gray"],[1,"flagGreen"],[1,"flagRed"],[1,"flagOrange"],["type","number",1,"form-control","form-control-sm","w-25",3,"ngModel","ngModelOptions","ngModelChange","input"],[1,"px-5"],[1,"d-flex","align-items-center","text-nowrap"],["type","button",1,"btn","btn-primary","px-3"],["type","text","formControlName","rejectionRemarks",1,"form-control"],["type","button",1,"btn","bg-primary","px-5","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-4","me-1",3,"disabled","click"],["type","button",1,"btn","bg-primary","px-4","me-3",3,"click"],["type","button",1,"btn","bg-primary","px-5",3,"disabled","click"],["type","button",1,"btn","bg-primary","px-5",3,"click"]],template:function(i,n){1&i&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),t._uU(5),t.ALo(6,"titlecase"),t.qZA()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"label",8),t._uU(11,"Job Card No. (Ref.) "),t.TgZ(12,"span",9),t._uU(13,"*"),t.qZA()(),t.TgZ(14,"div",10)(15,"div",11)(16,"ng-select",12),t.NdJ("change",function(d){return n.setJobCardId(d)}),t.qZA()(),t.TgZ(17,"div",13),t.NdJ("click",function(){return n.openJobCardDetailsModal()}),t._UZ(18,"i",14),t.qZA()()(),t.TgZ(19,"div",15)(20,"label",8),t._uU(21,"Goods Issue (GI) No. "),t.TgZ(22,"span",9),t._uU(23,"*"),t.qZA()(),t._UZ(24,"input",16),t.qZA(),t.TgZ(25,"div",15)(26,"label",8),t._uU(27,"Goods Issue (GI) Date "),t.TgZ(28,"span",9),t._uU(29,"*"),t.qZA()(),t._UZ(30,"input",17),t.qZA(),t.TgZ(31,"div",15)(32,"label",8),t._uU(33,"Goods Issue To "),t.TgZ(34,"span",9),t._uU(35,"*"),t.qZA()(),t._UZ(36,"ng-select",18),t.qZA()()(),t._UZ(37,"hr",19),t.TgZ(38,"app-setting-header",20),t.NdJ("dataChange",function(d){return n.eventHeader(d)}),t.qZA(),t.TgZ(39,"div",21)(40,"table",22)(41,"thead",23)(42,"tr",24)(43,"th"),t._uU(44,"MRN No."),t.qZA(),t.TgZ(45,"th"),t._uU(46,"MRN Date"),t.qZA(),t.TgZ(47,"th"),t._uU(48,"Item Code"),t.qZA(),t.TgZ(49,"th",25),t._uU(50,"Item Name"),t.qZA(),t.TgZ(51,"th",25),t._uU(52,"Item Description"),t.qZA(),t.TgZ(53,"th"),t._uU(54,"UoM"),t.qZA(),t.TgZ(55,"th"),t._uU(56,"PPIC Qty"),t.qZA(),t.TgZ(57,"th"),t._uU(58,"Aging"),t.qZA(),t.TgZ(59,"th"),t._uU(60,"Issue Qty."),t.qZA()()(),t.TgZ(61,"tbody"),t.YNc(62,z,37,34,"tr",26),t.ALo(63,"slice"),t.ALo(64,"searchFi1ter"),t.qZA()()(),t._UZ(65,"hr",19),t.TgZ(66,"div",6)(67,"div",27)(68,"button",28),t.NdJ("click",function(){return n.openRemarksDetailsModal()}),t._uU(69,"Remarks"),t.qZA(),t.YNc(70,H,5,0,"div",29),t.qZA(),t.TgZ(71,"div",30),t.YNc(72,V,2,0,"button",31),t.YNc(73,W,2,1,"button",32),t.YNc(74,$,2,0,"button",33),t.YNc(75,X,2,1,"button",34),t.YNc(76,tt,2,0,"button",35),t.YNc(77,et,2,0,"button",35),t.YNc(78,ot,2,0,"button",35),t.qZA()()()()),2&i&&(t.Q6J("formGroup",n.form),t.xp6(5),t.hij("Goods Issue (",t.lcZ(6,17,n.action),") I PPIC to Production"),t.xp6(11),t.Q6J("items",n.masterData.JCOptions)("clearable",!1),t.xp6(20),t.Q6J("items",n.masterData.goodsIssueToOptions)("clearable",!1),t.xp6(2),t.Q6J("data",t.l5B(26,it,n.page,n.pageSize,n.collection,n.search)),t.xp6(24),t.Q6J("ngForOf",t.Dn7(63,19,t.xi3(64,23,n.masterData.mergeList,n.search),(n.page-1)*n.pageSize,(n.page-1)*n.pageSize+n.pageSize))("ngForTrackBy",n.trackByFn),t.xp6(8),t.Q6J("ngIf","reject"==n.action),t.xp6(2),t.Q6J("ngIf",!t.DdM(31,U).includes(n.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(32,U).includes(n.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(33,U).includes(n.action)),t.xp6(1),t.Q6J("ngIf",!t.DdM(34,U).includes(n.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(35,nt).includes(n.action)),t.xp6(1),t.Q6J("ngIf",t.DdM(36,rt).includes(n.action)),t.xp6(1),t.Q6J("ngIf","Acknowledged"==n.action))},dependencies:[g.mk,g.sg,g.O5,I.P,u._L,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.sg,r.u,r.On,G.w9,g.OU,g.JJ,g.rS,g.uU,Q.G,O.S],encapsulation:2})}return s})();var at=l(19964),ct=l(56208);const lt=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:T},{path:"form",component:st,resolve:{accessScreen:at.xr}}];let dt=(()=>{class s{static#t=this.\u0275fac=function(i){return new(i||s)};static#e=this.\u0275mod=t.oAB({type:s});static#o=this.\u0275inj=t.cJS({imports:[g.ez,o.Bz.forChild(lt),ct.m]})}return s})()},61441:(x,C,l)=>{l.d(C,{Q:()=>k});var g=l(43818),o=l(65879),b=l(37285),v=l(96814),Z=l(88059),t=l(95346);const P=function(){return["view","edit","rejection","reject","approval","approve","cancel"]};function h(f,T){if(1&f){const r=o.EpF();o.TgZ(0,"tr")(1,"td"),o._uU(2),o.qZA(),o.TgZ(3,"td"),o._uU(4),o.qZA(),o.TgZ(5,"td",26,27)(7,"span",28),o._uU(8),o.qZA()(),o.TgZ(9,"td",26,29)(11,"span",28),o._uU(12),o.qZA()(),o.TgZ(13,"td"),o._uU(14),o.qZA(),o.TgZ(15,"td"),o._uU(16),o.qZA(),o.TgZ(17,"td")(18,"input",30),o.NdJ("change",function(){const u=o.CHM(r).$implicit,p=o.oxw();return o.KtG(p.setSelectData(u))}),o.qZA()()()}if(2&f){const r=T.$implicit,_=T.index,c=o.MAs(6),u=o.MAs(10),p=o.oxw();o.xp6(2),o.Oqu(null==r?null:r.jobCardNo),o.xp6(2),o.Oqu(null==r?null:r.SKUNo),o.xp6(1),o.Udp("width",c.clientWidth),o.xp6(2),o.Q6J("ngbTooltip",r.SKUName)("positionTarget",c),o.xp6(1),o.hij(" ",r.SKUName," "),o.xp6(1),o.Udp("width",u.clientWidth),o.xp6(2),o.Q6J("ngbTooltip",r.SKUDescription)("positionTarget",u),o.xp6(1),o.hij(" ",r.SKUDescription," "),o.xp6(2),o.Oqu(null==r?null:r.UOM),o.xp6(2),o.Oqu(null==r?null:r.batchQty),o.xp6(2),o.MGl("name","formValue",p.JCOptions[_],""),o.Q6J("disabled",o.DdM(17,P).includes(p.action))("checked",r.select)}}function I(f,T){1&f&&o._UZ(0,"hr",31)}function J(f,T){if(1&f){const r=o.EpF();o.TgZ(0,"div",32)(1,"button",33),o.NdJ("click",function(){o.CHM(r);const c=o.oxw();return o.KtG(c.dismissModel())}),o._uU(2,"Save & Close"),o.qZA()()}}const A=function(f,T,r,_){return{page:f,pageSize:T,collection:r,search:_,excelDisplay:"none"}};let k=(()=>{class f{constructor(r){this.activeModal=r,this.action="edit",this.jobCard="",this.JCOptions=[],this.selectedJobCardDetails={},this.btnDisable=!1,this.page=1,this.pageSize=9,this.collection=0,this.search="",this.column="jobCardNo",this.direction=-1}ngOnInit(){this.jobCard&&(this.selectedJobCardDetails._id=this.jobCard,this.JCOptions=this.JCOptions?.map(r=>(r.select=!1,r._id==this.jobCard&&(r.select=!0),r))),this.collection=this.JCOptions?.length}setSelectData(r){this.selectedJobCardDetails=r}dismissModel(){let r={};r.selectedJobCardDetails=this.selectedJobCardDetails,this.activeModal.close(r)}eventHeader(r){switch(r.key){case"SEARCH":this.search=r.value;break;case"EXCEL":default:break;case"PAGE":this.page=r.value}}onSort({column:r,direction:_}){this.headers.forEach(c=>{c.sortable!==r&&(c.direction="")}),this.JCOptions=""===_||""===r?this.JCOptions:[...this.JCOptions].sort((c,u)=>{let p="string"==typeof c[r]?c[r].toLowerCase():c[r],y="string"==typeof u[r]?u[r].toLowerCase():u[r];const D=p<y?-1:p>y?1:0;return"asc"===_?D:-D})}static#t=this.\u0275fac=function(_){return new(_||f)(o.Y36(b.Kz))};static#e=this.\u0275cmp=o.Xpm({type:f,selectors:[["app-job-card-details-modal"]],viewQuery:function(_,c){if(1&_&&o.Gf(g.j,5),2&_){let u;o.iGM(u=o.CRH())&&(c.headers=u)}},inputs:{action:"action",jobCard:"jobCard",JCOptions:"JCOptions",selectedJobCardDetails:"selectedJobCardDetails"},decls:39,vars:18,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,""],[1,"container-fluid"],[1,"row","justify-content-center"],[1,"col-12","px-0","mt-4"],[1,"px-5","mt-0"],[3,"data","dataChange"],[1,"table-responsive","px-5",2,"min-height","33rem"],[1,"table","table-bordered","table-sticky"],[1,"bg-primary"],[1,"text-white"],["sortable","jobCardNo",3,"sort"],["sortable","SKUNo",3,"sort"],["sortable","SKUName",1,"text-start",3,"sort"],["sortable","SKUDescription",1,"text-start",3,"sort"],["sortable","UOM",3,"sort"],["sortable","batchQty",3,"sort"],[4,"ngFor","ngForOf"],[1,"row"],[1,"col","px-0","mb-3"],["class","line-border",4,"ngIf"],["class","text-center mb-2",4,"ngIf"],[1,"text-start"],["SKUName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["SKUDescription",""],["type","radio",1,"form-check-input","pointer",3,"disabled","name","checked","change"],[1,"line-border"],[1,"text-center","mb-2"],["type","button",1,"btn","bg-primary","px-5","mb-4",3,"click"]],template:function(_,c){1&_&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2),o._uU(3,"Select Job Card"),o.qZA(),o.TgZ(4,"div")(5,"button",3),o.NdJ("click",function(){return c.activeModal.close()}),o._UZ(6,"i",4),o.qZA()()(),o.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"app-setting-header",10),o.NdJ("dataChange",function(p){return c.eventHeader(p)}),o.qZA()(),o.TgZ(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr",14)(17,"th",15),o.NdJ("sort",function(p){return c.onSort(p)}),o._uU(18,"Job Card No."),o.qZA(),o.TgZ(19,"th",16),o.NdJ("sort",function(p){return c.onSort(p)}),o._uU(20,"SKU No."),o.qZA(),o.TgZ(21,"th",17),o.NdJ("sort",function(p){return c.onSort(p)}),o._uU(22,"SKU Name"),o.qZA(),o.TgZ(23,"th",18),o.NdJ("sort",function(p){return c.onSort(p)}),o._uU(24," SKU Description "),o.qZA(),o.TgZ(25,"th",19),o.NdJ("sort",function(p){return c.onSort(p)}),o._uU(26,"UoM"),o.qZA(),o.TgZ(27,"th",20),o.NdJ("sort",function(p){return c.onSort(p)}),o._uU(28,"Batch Qty."),o.qZA(),o.TgZ(29,"th"),o._uU(30,"Select"),o.qZA()()(),o.TgZ(31,"tbody"),o.YNc(32,h,19,18,"tr",21),o.ALo(33,"slice"),o.ALo(34,"searchFi1ter"),o.qZA()()()()(),o.TgZ(35,"div",22)(36,"div",23),o.YNc(37,I,1,0,"hr",24),o.qZA()(),o.YNc(38,J,3,0,"div",25),o.qZA()()()),2&_&&(o.xp6(12),o.Q6J("data",o.l5B(11,A,c.page,c.pageSize,c.collection,c.search)),o.xp6(20),o.Q6J("ngForOf",o.Dn7(33,4,o.xi3(34,8,c.JCOptions,c.search),(c.page-1)*c.pageSize,(c.page-1)*c.pageSize+c.pageSize)),o.xp6(5),o.Q6J("ngIf",!o.DdM(16,P).includes(c.action)),o.xp6(1),o.Q6J("ngIf",!o.DdM(17,P).includes(c.action)))},dependencies:[v.sg,v.O5,Z.P,b._L,g.j,v.OU,t.G],encapsulation:2})}return f})()},13107:(x,C,l)=>{l.d(C,{t:()=>g});const g={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}}},28402:(x,C,l)=>{l.d(C,{J:()=>g});const g=({data:o,headers:b,widths:v,title:Z})=>({tableData:{widths:v,headerRows:1,body:[b.map(h=>({text:h.header,style:"header"})),...o.map(h=>b.map(I=>({style:"subheader",text:h[I.key]})))]},title:Z})}}]);