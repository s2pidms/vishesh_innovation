"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5753],{27178:(A,f,r)=>{r.r(f),r.d(f,{LeaveApplicationModule:()=>B});var d=r(96814),m=r(1076),v=r(43818),D=r(25116),g=r(27991),e=r(65879),u=r(98977),h=r(68187),y=r(88059),Z=r(53421);function C(s,c){if(1&s){const o=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",22),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td")(20,"div",23),e._UZ(21,"button",24),e.TgZ(22,"div",25)(23,"a",26),e.NdJ("click",function(){const i=e.CHM(o).$implicit,n=e.oxw();return e.KtG(n.navigateTo("../la-form",i,"view"))}),e._UZ(24,"i",27),e._uU(25," View "),e.qZA(),e.TgZ(26,"a",26),e.NdJ("click",function(){const i=e.CHM(o).$implicit,n=e.oxw();return e.KtG(n.navigateTo("../la-form",i,"edit"))}),e._UZ(27,"i",28),e._uU(28," Edit "),e.qZA(),e.TgZ(29,"a",26),e.NdJ("click",function(){const i=e.CHM(o).$implicit,n=e.oxw();return e.KtG(n.navigateTo("../la-form",i,"approve"))}),e._UZ(30,"i",29),e._uU(31," Approve "),e.qZA(),e.TgZ(32,"a",26),e.NdJ("click",function(){const i=e.CHM(o).$implicit,n=e.oxw();return e.KtG(n.navigateTo("../la-form",i,"cancel"))}),e._UZ(33,"i",30),e._uU(34," Cancel "),e.qZA()()()()()}if(2&s){const o=c.$implicit,a=e.oxw();e.xp6(2),e.Oqu(null==o?null:o.applicationDateS),e.xp6(2),e.Oqu(null==o?null:o.empCode),e.xp6(2),e.Oqu(null==o?null:o.empFullName),e.xp6(2),e.Oqu(null==o?null:o.fromDateS),e.xp6(2),e.Oqu(null==o?null:o.toDateS),e.xp6(2),e.Oqu(null==o?null:o.leaveType),e.xp6(2),e.Oqu(null==o?null:o.leaveDays),e.xp6(2),e.Oqu(null==o?null:o.resumptionDateS),e.xp6(2),e.Oqu(null==o?null:o.status),e.xp6(5),e.Q6J("accessType",a.rolePermissionActions.viewAction),e.xp6(3),e.ekj("disable","Submitted"!==o.status),e.Q6J("accessType",a.rolePermissionActions.editAction),e.xp6(3),e.ekj("disable","Submitted"!==o.status&&"Adjusted"!==o.status),e.Q6J("accessType",a.rolePermissionActions.approveAction),e.xp6(3),e.ekj("disable","Cancelled"===o.status||"Approved"===o.status),e.Q6J("accessType",a.rolePermissionActions.approveAction)}}const q=function(s,c,o,a){return{page:s,pageSize:c,collection:o,search:a,type:"list"}};let T=(()=>{var s;class c{constructor(a,t,i,n,p,_){this.exportExcelService=a,this.leaveService=t,this.activatedRoute=i,this.spinner=n,this.exportToPDFService=p,this.utilityService=_,this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.rolePermissionActions=D.a1}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}trackByFn(a,t){return t?._id}navigateTo(a,t,i){this.utilityService.navigateToForm({path:a,status:t.status,action:i,id:t._id,activatedRoute:this.activatedRoute})}eventHeader(a){switch(a.key){case"SEARCH":this.search=a.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=a.value,this.getAll()}}getAll(a=!1,t=""){this.spinner.show();let i={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:a,status:["Deleted","Availed"]};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.leaveService.getAll(i).subscribe(n=>{"EXCEL"==t?this.excelDownload(n.rows):"PDF"==t?this.pdfDownload(n.rows):(this.tableData=n.rows,this.collection=n.count),this.spinner.hide()})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}excelDownload(a){this.exportExcelService.exportExcel((0,g.P7)(a))}pdfDownload(a){let t=(0,g.m6)(a);this.exportToPDFService.generatePdf(t.tableData,t.title)}onSort({column:a,direction:t}){this.headers.forEach(i=>{i.sortable!==a&&(i.direction="")}),this.column=a,this.direction="asc"==t?1:-1,this.getAll()}}return(s=c).\u0275fac=function(a){return new(a||s)(e.Y36(u.Ol),e.Y36(h.FL),e.Y36(m.gz),e.Y36(u.V),e.Y36(u.$L),e.Y36(u.tI))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-leave-application-list"]],viewQuery:function(a,t){if(1&a&&e.Gf(v.j,5),2&a){let i;e.iGM(i=e.CRH())&&(t.headers=i)}},decls:36,vars:9,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],["appAccessControl","",1,"text-center",3,"accessType"],[1,"plusIconSvg","btn","btn-primary","me-1"],["type","button",1,"btn","btn-primary","btn-add","px-4",3,"click"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","applicationDate",3,"sort"],["sortable","empCode",3,"sort"],["sortable","empFullName",1,"text-start",3,"sort"],["sortable","fromDate",3,"sort"],["sortable","toDate",3,"sort"],["sortable","leaveType",3,"sort"],["sortable","leaveDays",3,"sort"],["sortable","resumptionDate",3,"sort"],["sortable","status",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-check","fa-lg","me-2","text-success"],["aria-hidden","true",1,"fa","fa-close","me-2","text-primary"]],template:function(a,t){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"Leave Application Summary"),e.qZA()(),e.TgZ(4,"div",3),e._UZ(5,"button",4),e.TgZ(6,"button",5),e.NdJ("click",function(){return t.navigateTo("../la-form",{},"create")}),e._uU(7," Leave Application "),e.qZA()(),e._UZ(8,"hr",6),e.TgZ(9,"div",7)(10,"app-setting-header",8),e.NdJ("dataChange",function(n){return t.eventHeader(n)}),e.qZA(),e.TgZ(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th",12),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(15,"Application Dt."),e.qZA(),e.TgZ(16,"th",13),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(17,"Employee Code"),e.qZA(),e.TgZ(18,"th",14),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(19,"Employee Name"),e.qZA(),e.TgZ(20,"th",15),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(21,"From Date"),e.qZA(),e.TgZ(22,"th",16),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(23,"To Date"),e.qZA(),e.TgZ(24,"th",17),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(25,"Leave Type"),e.qZA(),e.TgZ(26,"th",18),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(27,"Leave Days"),e.qZA(),e.TgZ(28,"th",19),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(29,"Resumption Dt."),e.qZA(),e.TgZ(30,"th",20),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(31,"Status"),e.qZA(),e.TgZ(32,"th"),e._uU(33,"Action"),e.qZA()()(),e.TgZ(34,"tbody"),e.YNc(35,C,35,19,"tr",21),e.qZA()()()()),2&a&&(e.xp6(4),e.Q6J("accessType",t.rolePermissionActions.createAction),e.xp6(6),e.Q6J("data",e.l5B(4,q,t.page,t.pageSize,t.collection,t.search)),e.xp6(25),e.Q6J("ngForOf",t.tableData)("ngForTrackBy",t.trackByFn))},dependencies:[d.sg,y.P,v.j,Z.J],encapsulation:2}),c})();var l=r(60095),Y=r(68934),F=r(21631),U=r(22096),x=r(77609),w=r(16897),J=r(37285),k=r(50363);function N(s,c){1&s&&(e.TgZ(0,"div",4)(1,"div",45)(2,"label",28),e._uU(3," Remarks for Cancellation "),e.TgZ(4,"span",11),e._uU(5,"*"),e.qZA()(),e._UZ(6,"input",46),e.qZA()())}function M(s,c){if(1&s){const o=e.EpF();e.TgZ(0,"div",50)(1,"button",51),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.submit())}),e._uU(2),e.qZA()()}if(2&s){const o=e.oxw(2);e.xp6(2),e.lnq(" ","edit"==o.action||"create"==o.action||"view"==o.action?"Send For Approval":null," ","approve"==o.action?"Approve":null," ","cancel"==o.action?"Cancel":null," ")}}function O(s,c){if(1&s){const o=e.EpF();e.TgZ(0,"div",52)(1,"button",51),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.openCancelModal())}),e._uU(2," Cancel "),e.qZA()()}}function E(s,c){if(1&s&&(e.TgZ(0,"div",47),e.YNc(1,M,3,3,"div",48),e.YNc(2,O,3,0,"div",49),e.qZA()),2&s){const o=e.oxw();e.xp6(1),e.Q6J("ngIf","cancelLeave"!=o.action),e.xp6(1),e.Q6J("ngIf","cancelLeave"==o.action)}}const R=function(){return["view"]};let b=(()=>{var s;class c{get f(){return this.form.controls}constructor(a,t,i,n,p,_,z,G){this.leaveAppService=a,this.activatedRoute=t,this.spinner=i,this.toastService=n,this.validationService=p,this.utilityService=_,this.modalService=z,this.location=G,this.submitted=!1,this.action="create",this.privilageLeave=0,this.casualLeave=0,this.sickLeaveSL=0,this.leaveDays=0,this.statusOptions={create:"Submitted",edit:"Submitted",approve:"Approved",cancel:"Cancelled",cancelLeave:"Cancelled"},this.masterData={autoIncrementNo:"",employeesOptions:[],allHolidaysOptions:[]},this.form=new l.nJ({_id:new l.p4,leavesApplicationNumber:new l.p4("",[l.kI.required]),applicationDate:new l.p4(this.utilityService.getTodayDate("DD-MM-YYYY"),[l.kI.required]),employeeId:new l.p4(null),leaveType:new l.p4("",[l.kI.required]),fromDate:new l.p4(this.utilityService.getTodayDate("YYYY-MM-DD"),[l.kI.required]),toDate:new l.p4("",[l.kI.required]),fromSession:new l.p4("First"),toSession:new l.p4("Second"),leaveDays:new l.p4(0,[l.kI.required]),halfDay:new l.p4(""),reasonForLeave:new l.p4("",[l.kI.required]),resumptionDate:new l.p4("",[l.kI.required]),status:new l.p4("Submitted"),cancelReason:new l.p4(null)})}ngOnInit(){this.getInitialData()}reset(){this.form.reset(),this.getInitialData()}submit(){if(this.submitted=!0,this.validationService.checkErrors(this.form,Y.eP))return;let a=this.form.value;a._id?this.update(a._id):(delete a._id,this.create(a))}create(a){this.spinner.show(),this.form.value.applicationDate=this.form.value.applicationDate.split("-").reverse().join("-"),this.leaveAppService.create(a).subscribe(t=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(t.message),this.location.back()})}update(a){this.spinner.show(),this.form.value.applicationDate=this.form.value.applicationDate.split("-").reverse().join("-"),this.leaveAppService.update(a,this.form.value).subscribe(t=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(t.message),this.location.back()})}cancel(){if(this.form.enable(),console.log("this.form.value",this.form.value),"cancelLeave"==this.action&&!this.form.controls.cancelReason.value)return this.toastService.warning("Remarks for Cancellation is Required"),this.form.disable(),void("cancelLeave"==this.action&&this.f.cancelReason.enable());let a=this.form.value;a.applicationDate=a.applicationDate.split("-").reverse().join("-"),this.spinner.show(),this.leaveAppService.updateOnCancel(a._id,a).subscribe(t=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(t.message),this.location.back()})}getInitialData(){this.spinner.show(),this.leaveAppService.getAllMasterData({}).subscribe(a=>{this.masterData=a,this.form.controls.leavesApplicationNumber.setValue(this.masterData?.autoIncrementNo),this.form.controls.fromDate.setValue(this.utilityService.getTodayDate("YYYY-MM-DD")),this.form.controls.applicationDate.setValue(this.utilityService.getTodayDate("DD-MM-YYYY")),this.activatedRoute.queryParams.pipe((0,F.z)(t=>(this.action=t.action,this.utilityService.accessDenied(this.action),t.id?this.leaveAppService.getById(t.id):(0,U.of)({})))).subscribe(t=>{this.spinner.hide(),0!=Object.keys(t).length&&(t.applicationDate&&(t.applicationDate=this.utilityService.getFormatDate(t.applicationDate,"DD-MM-YYYY")),t.fromDate&&(t.fromDate=this.utilityService.getFormatDate(t.fromDate,"YYYY-MM-DD")),t.toDate&&(t.toDate=this.utilityService.getFormatDate(t.toDate,"YYYY-MM-DD")),t.resumptionDate&&(t.resumptionDate=this.utilityService.getFormatDate(t.resumptionDate,"YYYY-MM-DD")),t.status=this.statusOptions[this.action],this.form.patchValue(t),this.getPaidLeavesById(),"edit"!=this.action&&(this.form.disable(),"cancelLeave"==this.action&&this.f.cancelReason.enable()))})})}changeFromSession(){let a=this.form.controls.fromSession.value,t=this.form.controls.toSession.value,p=this.form.controls.leaveDays;this.form.controls.fromDate.value==this.form.controls.toDate.value?a==t?(p.setValue(.5),this.leaveDays=p.value):("Second"==a&&"First"==t&&(p.setValue(0),this.leaveDays=p.value),p.setValue(1),this.leaveDays=p.value):"First"==a?(p.setValue(p.value+.5),this.leaveDays=p.value):(p.setValue(p.value-.5),this.leaveDays=p.value),this.checkValidation()}setHalfDayHandler(){let a=this.form.controls.toDate.value,t=this.form.controls.toSession.value;if(!this.form.controls.toDate.value)return this.toastService.warning("Please Select To Date !!"),void this.form.controls.toSession.setValue(null);if("Second"==this.form.controls.fromSession.value&&(this.leaveDays-=.5),"First"==t)this.form.controls.leaveDays.setValue(this.form.controls.leaveDays.value-.5),this.leaveDays-=.5,this.form.controls.resumptionDate.setValue(this.utilityService.getFormatDate(a,"YYYY-MM-DD"));else{this.form.controls.leaveDays.setValue(this.form.controls.leaveDays.value+.5);let i=this.utilityService.getIncrementedDate(a,1,"days");this.getResumptionDate(i)}}setFromSession(){this.form.controls.fromSession.setValue("First");let a=this.form.controls.fromDate.value,t=this.form.controls.toDate.value;if(t){if(a>t)return this.toastService.warning("ToDate should be greater than fromDate !!"),void this.form.controls.fromDate.setValue(null);this.leaveDays=this.utilityService.getDiffDate(t,a,"days");let i=this.utilityService.getFormatDate(a,"YYYY-MM-DD");this.getDaysLeaves(t,i)}}getPaidLeavesById(){this.leaveAppService.getPaidLeavesById(this.f.employeeId.value).subscribe(t=>{this.casualLeave=t.casualLeaveCL,this.privilageLeave=t.privilegeLeavePL,this.sickLeaveSL=t.sickLeaveSL})}setLeaveType(a,t){a>0&&this.form.controls.leaveType.setValue(t),"Advance Leaves"==t&&this.form.controls.leaveType.setValue(t)}setDatesHandler(){if(!this.form.controls.fromDate.value)return void this.toastService.warning("Please Select from Date !!");let a=this.form.controls.fromDate.value,t=this.form.controls.toDate.value;if(a>t)return this.toastService.warning("ToDate should be greater than fromDate !!"),void this.form.controls.toDate.setValue(null);this.form.controls.toSession.setValue("Second"),this.leaveDays=this.utilityService.getDiffDate(t,a,"days");let i=this.utilityService.getFormatDate(a,"YYYY-MM-DD");this.getDaysLeaves(t,i);let n=this.utilityService.getIncrementedDate(t,1,"days");this.getResumptionDate(n)}getResumptionDate(a){this.getHolidaysOfEmp().some(i=>this.utilityService.getFormatDate(i.holidayDate,"YYYY-MM-DD")==this.utilityService.getFormatDate(a,"YYYY-MM-DD"))||"Sunday"==this.utilityService.getFormatDate(a,"dddd")?(a=this.utilityService.getIncrementedDate(a,1,"days"),this.getResumptionDate(a)):this.form.controls.resumptionDate.setValue(this.utilityService.getFormatDate(a,"YYYY-MM-DD"))}getDaysLeaves(a,t){let i=this.getHolidaysOfEmp();if(i.some(n=>this.utilityService.getFormatDate(n.holidayDate,"YYYY-MM-DD")==this.utilityService.getFormatDate(a,"YYYY-MM-DD"))||"Sunday"==this.utilityService.getFormatDate(a,"dddd"))return this.toastService.warning("To Date shouldn't be Holiday or Sunday !"),void this.form.controls.toDate.setValue(null);this.utilityService.getFormatDate(a,"YYYY-MM-DD")!=this.utilityService.getFormatDate(t,"YYYY-MM-DD")?((i.some(n=>this.utilityService.getFormatDate(n.holidayDate,"YYYY-MM-DD")==this.utilityService.getFormatDate(t,"YYYY-MM-DD"))||"Sunday"==this.utilityService.getFormatDate(t,"dddd"))&&(this.leaveDays-=1),t=this.utilityService.getIncrementedDate(t,1,"days"),this.getDaysLeaves(a,t)):(this.leaveDays>1?(this.form.controls.halfDay.setValue(null),this.form.controls.halfDay.disable()):this.form.controls.halfDay.enable(),"Second"==this.form.controls.fromSession.value&&(this.leaveDays-=.5),"First"==this.form.controls.toSession.value&&(this.leaveDays-=.5),this.form.controls.leaveDays.setValue(this.leaveDays),this.checkValidation())}getHolidaysOfEmp(){let a=this.masterData?.employeesOptions.find(i=>i.value==this.form.controls.employeeId.value),t=[];return t=["work","factory"].some(i=>a?.joiningLocation?.toLowerCase().includes(i))?this.masterData.allHolidaysOptions.filter(i=>["Factory","Office & Factory"].includes(i.holidayLocation)):this.masterData.allHolidaysOptions.filter(i=>["Office","Office & Factory"].includes(i.holidayLocation)),t}checkValidation(){let a=this.form.controls.leaveType.value;return"Paid Leaves"==a&&this.leaveDays>this.casualLeave||"Compensatory Off"==a&&this.leaveDays>this.privilageLeave?(this.toastService.warning(`Leave Days should not be greater than ${a}`),this.leaveDays=0,this.form.controls.leaveDays.setValue(this.leaveDays),void this.form.controls.toDate.setValue(null)):"Advance Leaves"==a&&this.leaveDays>this.sickLeaveSL?(this.toastService.warning("Leaves Days Should not be greater than Advance Leaves!"),this.leaveDays=0,this.form.controls.leaveDays.setValue(this.leaveDays),void this.form.controls.toDate.setValue(null)):void 0}openCancelModal(){if("cancelLeave"==this.action&&!this.form.controls.cancelReason.value)return this.toastService.warning("Remarks for Cancellation is Required"),this.form.disable(),void("cancelLeave"==this.action&&this.f.cancelReason.enable());const a=this.modalService.open(x.er,{centered:!0,size:"sm",backdrop:"static",keyboard:!1});a.componentInstance.action=this.action,a.componentInstance.heading="Leave Cancellation",a.componentInstance.cancelText="Do you want to Cancel Approved Leave ?",a.result.then(t=>{"Yes"==t&&this.cancel()},t=>{})}}return(s=c).\u0275fac=function(a){return new(a||s)(e.Y36(h.FL),e.Y36(m.gz),e.Y36(u.V),e.Y36(u.kl),e.Y36(w.RJ),e.Y36(u.tI),e.Y36(J.FF),e.Y36(d.Ye))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-leave-application-form"]],decls:131,vars:19,consts:[[1,"container-fluid"],[1,"row","justify-content-center","form-page"],[1,"col-10","leave-app_container"],[3,"formGroup"],[1,"row"],[1,"col-6"],[1,"card-form","mb-5"],[1,"row","bg-info","text-white","text-center","mb-2","mx-0","px-4"],[1,"col","fs-4","my-1"],[1,"row","justify-content-center","mb-4","px-4","mx-2"],[1,"form-label","mt-3"],[1,"text-danger"],["bindLabel","label","bindValue","value","formControlName","employeeId",3,"items","multiple","clearable","change"],[1,"row","pb-4","px-5","mx-2"],[1,"table"],[1,"bg-secondary","section"],[1,"section"],[1,"section","px-5"],[1,"section","p-0"],[1,"d-grid"],["type","button",1,"btn","bg-primary","px-4",3,"disabled","click"],["type","button",1,"btn","d-grid","bg-primary","px-4",3,"disabled","click"],[1,"row","justify-content-center","mb-4","mx-1"],[1,"col","bg-light","leave-app_empty-box"],[1,"card-form"],[1,"row","bg-info","text-white","text-center","mb-4","mx-0"],[1,"row","justify-content-center","pb-3","px-4","mb-2"],[1,"col","ms-4","me-1","mb-3"],[1,"form-label"],["type","text","formControlName","leaveType","readonly","",1,"form-control"],[1,"col","ms-1","me-4","mb-3"],["type","text","formControlName","applicationDate","readonly","",1,"form-control"],[1,"w-100","mb-2"],["type","date","formControlName","fromDate",1,"form-control",3,"change"],["formControlName","fromSession",1,"form-select",3,"change"],["disabled","",3,"value"],[3,"value"],["type","date","formControlName","toDate",1,"form-control",3,"change"],["formControlName","toSession",1,"form-select",3,"change"],["type","text","formControlName","leaveDays","readonly","",1,"form-control"],["type","date","formControlName","resumptionDate","readonly","",1,"form-control"],[1,"col","mx-4"],["type","text","formControlName","reasonForLeave",1,"form-control"],["class","row",4,"ngIf"],["class","row justify-content-center",4,"ngIf"],[1,"col","mx-5"],["type","text","formControlName","cancelReason",1,"form-control"],[1,"row","justify-content-center"],["class","d-grid col-md-5 mb-3",4,"ngIf"],["class","d-grid col-md-5 mb-2 mt-4",4,"ngIf"],[1,"d-grid","col-md-5","mb-3"],["type","button",1,"btn","bg-primary",3,"click"],[1,"d-grid","col-md-5","mb-2","mt-4"]],template:function(a,t){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8),e._uU(9,"Employee Leave Summary"),e.qZA()(),e.TgZ(10,"div",9)(11,"label",10),e._uU(12," Employee Name "),e.TgZ(13,"span",11),e._uU(14,"*"),e.qZA()(),e.TgZ(15,"div")(16,"ng-select",12),e.NdJ("change",function(){return t.getPaidLeavesById()}),e.qZA()()(),e.TgZ(17,"div",13)(18,"table",14)(19,"thead",15)(20,"tr")(21,"td",16),e._uU(22,"Leave Type"),e.qZA(),e.TgZ(23,"td",17),e._uU(24,"Balance"),e.qZA(),e.TgZ(25,"td",17),e._uU(26,"Action"),e.qZA()()(),e.TgZ(27,"tbody",16)(28,"tr",16)(29,"td",16),e._uU(30,"Paid Leave [PL]"),e.qZA(),e.TgZ(31,"td",16),e._uU(32),e.qZA(),e.TgZ(33,"td",18)(34,"div",19)(35,"button",20),e.NdJ("click",function(){return t.setLeaveType(t.casualLeave,"Paid Leaves")}),e._uU(36," Apply "),e.qZA()()()(),e.TgZ(37,"tr",16)(38,"td",16),e._uU(39,"Comp. Off [C/Off]"),e.qZA(),e.TgZ(40,"td",16),e._uU(41),e.qZA(),e.TgZ(42,"td",18)(43,"div",19)(44,"button",20),e.NdJ("click",function(){return t.setLeaveType(t.privilageLeave,"Compensatory Off")}),e._uU(45," Apply "),e.qZA()()()(),e.TgZ(46,"tr",16)(47,"td",16),e._uU(48,"Advance Leaves [AL]"),e.qZA(),e.TgZ(49,"td",16),e._uU(50),e.qZA(),e.TgZ(51,"td",18)(52,"div",19)(53,"button",21),e.NdJ("click",function(){return t.setLeaveType(t.sickLeaveSL,"Advance Leaves")}),e._uU(54," Apply "),e.qZA()()()()()()()(),e.TgZ(55,"div",22),e._UZ(56,"div",23),e.qZA()(),e.TgZ(57,"div",5)(58,"div",24)(59,"div",25)(60,"div",8),e._uU(61,"Leave Application"),e.qZA()(),e.TgZ(62,"div",26)(63,"div",27)(64,"label",28),e._uU(65," Leave Type "),e.TgZ(66,"span",11),e._uU(67,"*"),e.qZA()(),e._UZ(68,"input",29),e.qZA(),e.TgZ(69,"div",30)(70,"label",28),e._uU(71," Application Date "),e.TgZ(72,"span",11),e._uU(73,"*"),e.qZA()(),e._UZ(74,"input",31),e.qZA(),e._UZ(75,"div",32),e.TgZ(76,"div",27)(77,"label",28),e._uU(78," From Date "),e.TgZ(79,"span",11),e._uU(80,"*"),e.qZA()(),e.TgZ(81,"input",33),e.NdJ("change",function(){return t.setFromSession()}),e.qZA()(),e.TgZ(82,"div",30)(83,"label",28),e._uU(84," From Session "),e.qZA(),e.TgZ(85,"select",34),e.NdJ("change",function(){return t.changeFromSession()}),e.TgZ(86,"option",35),e._uU(87,"Select Session"),e.qZA(),e.TgZ(88,"option",36),e._uU(89,"First"),e.qZA(),e.TgZ(90,"option",36),e._uU(91,"Second"),e.qZA()()(),e._UZ(92,"div",32),e.TgZ(93,"div",27)(94,"label",28),e._uU(95," To Date "),e.TgZ(96,"span",11),e._uU(97,"*"),e.qZA()(),e.TgZ(98,"input",37),e.NdJ("change",function(){return t.setDatesHandler()}),e.qZA()(),e.TgZ(99,"div",30)(100,"label",28),e._uU(101," To Session "),e.qZA(),e.TgZ(102,"select",38),e.NdJ("change",function(){return t.setHalfDayHandler()}),e.TgZ(103,"option",35),e._uU(104,"Select Session"),e.qZA(),e.TgZ(105,"option",36),e._uU(106,"First"),e.qZA(),e.TgZ(107,"option",36),e._uU(108,"Second"),e.qZA()()(),e._UZ(109,"div",32),e.TgZ(110,"div",27)(111,"label",28),e._uU(112," Leave Days "),e.TgZ(113,"span",11),e._uU(114,"*"),e.qZA()(),e._UZ(115,"input",39),e.qZA(),e.TgZ(116,"div",30)(117,"label",28),e._uU(118," Resumption Date "),e.TgZ(119,"span",11),e._uU(120,"*"),e.qZA()(),e._UZ(121,"input",40),e.qZA(),e._UZ(122,"div",32),e.TgZ(123,"div",41)(124,"label",28),e._uU(125," Reason For Leave "),e.TgZ(126,"span",11),e._uU(127,"*"),e.qZA()(),e._UZ(128,"input",42),e.qZA()(),e.YNc(129,N,7,0,"div",43),e.YNc(130,E,3,2,"div",44),e.qZA()()()()()()()),2&a&&(e.xp6(3),e.Q6J("formGroup",t.form),e.xp6(13),e.Q6J("items",t.masterData.employeesOptions)("multiple",!1)("clearable",!1),e.xp6(16),e.Oqu(t.casualLeave),e.xp6(3),e.Q6J("disabled","approve"==t.action),e.xp6(6),e.Oqu(t.privilageLeave),e.xp6(3),e.Q6J("disabled","approve"==t.action),e.xp6(6),e.Oqu(t.sickLeaveSL),e.xp6(3),e.Q6J("disabled","approve"==t.action),e.xp6(33),e.Q6J("value",null),e.xp6(2),e.Q6J("value","First"),e.xp6(2),e.Q6J("value","Second"),e.xp6(13),e.Q6J("value",null),e.xp6(2),e.Q6J("value","First"),e.xp6(2),e.Q6J("value","Second"),e.xp6(22),e.Q6J("ngIf","cancelLeave"==t.action),e.xp6(1),e.Q6J("ngIf",!e.DdM(18,R).includes(t.action)))},dependencies:[d.O5,l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,l.sg,l.u,k.w9],encapsulation:2}),c})();var L=r(65876);function I(s,c){if(1&s){const o=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",18),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td")(20,"div",19),e._UZ(21,"button",20),e.TgZ(22,"div",21)(23,"a",22),e.NdJ("click",function(){const i=e.CHM(o).$implicit,n=e.oxw();return e.KtG(n.navigateTo("../la-form",i,"cancelLeave"))}),e._UZ(24,"i",23),e._uU(25," Cancel "),e.qZA()()()()()}if(2&s){const o=c.$implicit,a=e.oxw();e.xp6(2),e.Oqu(null==o?null:o.applicationDateS),e.xp6(2),e.Oqu(null==o?null:o.empCode),e.xp6(2),e.Oqu(null==o?null:o.empFullName),e.xp6(2),e.Oqu(null==o?null:o.fromDateS),e.xp6(2),e.Oqu(null==o?null:o.toDateS),e.xp6(2),e.Oqu(null==o?null:o.leaveType),e.xp6(2),e.Oqu(null==o?null:o.leaveDays),e.xp6(2),e.Oqu(null==o?null:o.resumptionDateS),e.xp6(2),e.Oqu(null==o?null:o.status),e.xp6(5),e.ekj("disable","Cancelled"===o.status),e.Q6J("accessType",a.rolePermissionActions.viewAction)}}const P=function(s,c,o,a){return{page:s,pageSize:c,collection:o,search:a,type:"list"}};let S=(()=>{var s;class c{constructor(a,t,i,n,p,_){this.exportExcelService=a,this.leaveService=t,this.router=i,this.activatedRoute=n,this.spinner=p,this.exportToPDFService=_,this.page=1,this.pageSize=8,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.tableData=[],this.rolePermissionActions=D.a1}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}trackByFn(a,t){return t?._id}navigateTo(a,t,i){if("Cancelled"==t.status&&"cancelLeave"==i)return null;this.router.navigate([a],{relativeTo:this.activatedRoute,queryParams:{id:t?._id,action:i}})}eventHeader(a){switch(a.key){case"SEARCH":this.search=a.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=a.value,this.getAll()}}getAll(a=!1,t=""){this.spinner.show();let i={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:a,status:["Submitted","Recommend","Availed","Cancelled","Rejected","Deleted","Adjusted"]};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.leaveService.getAll(i).subscribe(n=>{"EXCEL"==t?this.excelDownload(n.rows):"PDF"==t?this.pdfDownload(n.rows):(this.tableData=n.rows,this.collection=n.count),this.spinner.hide()})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}excelDownload(a){this.exportExcelService.exportExcel((0,g.v9)(a))}pdfDownload(a){let t=(0,g.fZ)(a);this.exportToPDFService.generatePdf(t.tableData,t.title)}onSort({column:a,direction:t}){this.headers.forEach(i=>{i.sortable!==a&&(i.direction="")}),this.column=a,this.direction="asc"==t?1:-1,this.getAll()}}return(s=c).\u0275fac=function(a){return new(a||s)(e.Y36(u.Ol),e.Y36(h.FL),e.Y36(m.F0),e.Y36(m.gz),e.Y36(u.V),e.Y36(u.$L))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-cancel-leave-list"]],viewQuery:function(a,t){if(1&a&&e.Gf(v.j,5),2&a){let i;e.iGM(i=e.CRH())&&(t.headers=i)}},decls:31,vars:8,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-primary"],[1,"text-white"],["sortable","applicationDate",3,"sort"],["sortable","empCode",3,"sort"],["sortable","empFullName",1,"text-start",3,"sort"],["sortable","fromDate",3,"sort"],["sortable","toDate",3,"sort"],["sortable","leaveType",3,"sort"],["sortable","leaveDays",3,"sort"],["sortable","resumptionDate",3,"sort"],["sortable","status",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa","fa-times","fa-lg","me-2","text-primary"]],template:function(a,t){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3," Cancel Leave Summary"),e.qZA()(),e.TgZ(4,"div",3)(5,"app-setting-header",4),e.NdJ("dataChange",function(n){return t.eventHeader(n)}),e.qZA(),e.TgZ(6,"table",5)(7,"thead",6)(8,"tr",7)(9,"th",8),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(10,"Application Dt."),e.qZA(),e.TgZ(11,"th",9),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(12,"Employee Code"),e.qZA(),e.TgZ(13,"th",10),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(14,"Employee Name"),e.qZA(),e.TgZ(15,"th",11),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(16,"From Date"),e.qZA(),e.TgZ(17,"th",12),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(18,"To Date"),e.qZA(),e.TgZ(19,"th",13),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(20,"Leave Type"),e.qZA(),e.TgZ(21,"th",14),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(22,"Leave Days"),e.qZA(),e.TgZ(23,"th",15),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(24,"Resumption Dt."),e.qZA(),e.TgZ(25,"th",16),e.NdJ("sort",function(n){return t.onSort(n)}),e._uU(26,"Status"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Action"),e.qZA()()(),e.TgZ(29,"tbody"),e.YNc(30,I,26,12,"tr",17),e.qZA()()()()),2&a&&(e.xp6(5),e.Q6J("data",e.l5B(3,P,t.page,t.pageSize,t.collection,t.search)),e.xp6(25),e.Q6J("ngForOf",t.tableData)("ngForTrackBy",t.trackByFn))},dependencies:[d.sg,y.P,v.j,Z.J],encapsulation:2}),c})();const V=[{path:"",redirectTo:"la-list",pathMatch:"full"},{path:"la-list",component:T},{path:"cancel_leave_list",component:S},{path:"la-form",component:b,resolve:{accessScreen:L.x}}];let Q=(()=>{var s;class c{}return(s=c).\u0275fac=function(a){return new(a||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m.Bz.forChild(V),m.Bz]}),c})();var H=r(56208);const j=[{path:"",redirectTo:"leave-application-list",pathMatch:"full"},{path:"leave-application-list",component:T},{path:"cancel_leave_list",component:S},{path:"leave-application-form",component:b,resolve:{accessScreen:L.x}}];let B=(()=>{var s;class c{}return(s=c).\u0275fac=function(a){return new(a||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[d.ez,Q,m.Bz.forChild(j),H.m]}),c})()},13107:(A,f,r)=>{r.d(f,{t:()=>d});const d={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}}},28402:(A,f,r)=>{r.d(f,{J:()=>d});const d=({data:m,headers:v,widths:D,title:g})=>({tableData:{widths:D,headerRows:1,body:[v.map(h=>({text:h.header,style:"header"})),...m.map(h=>v.map(y=>({style:"subheader",text:h[y.key]})))]},title:g})}}]);