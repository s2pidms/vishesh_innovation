"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3564],{53564:(f,h,n)=>{n.r(h),n.d(h,{CostSheetForDskuModule:()=>V});var o=n(96814),p=n(1076),S=n(43818),D=n(25116),_=n(29391),e=n(65879),m=n(98977),g=n(78212),C=n(88059),y=n(37285),K=n(53421),x=n(69205),b=n(83344);function k(i,u){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",22,23)(5,"span",24),e._uU(6),e.ALo(7,"truncate"),e.qZA()(),e.TgZ(8,"td",22,25)(10,"span",24),e._uU(11),e.ALo(12,"truncate"),e.qZA()(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td",26)(16,"div",27)(17,"span",28),e._uU(18),e.ALo(19,"companyCurrency"),e._UZ(20,"div",29),e.qZA(),e.TgZ(21,"span",30),e._uU(22),e.ALo(23,"number"),e.qZA()()(),e.TgZ(24,"td",26)(25,"div",27)(26,"span",28),e._uU(27),e.ALo(28,"companyCurrency"),e._UZ(29,"div",29),e.qZA(),e.TgZ(30,"span",30),e._uU(31),e.ALo(32,"number"),e.qZA()()(),e.TgZ(33,"td",26)(34,"div",27)(35,"span",28),e._uU(36),e.ALo(37,"companyCurrency"),e._UZ(38,"div",29),e.qZA(),e.TgZ(39,"span",30),e._uU(40),e.ALo(41,"number"),e.qZA()()(),e.TgZ(42,"td",26)(43,"div",27)(44,"span",28),e._uU(45),e.ALo(46,"companyCurrency"),e._UZ(47,"div",29),e.qZA(),e.TgZ(48,"span",30),e._uU(49),e.ALo(50,"number"),e.qZA()()(),e.TgZ(51,"td",26)(52,"div",27)(53,"span",28),e._uU(54),e.ALo(55,"companyCurrency"),e._UZ(56,"div",29),e.qZA(),e.TgZ(57,"span",30),e._uU(58),e.ALo(59,"number"),e.qZA()()(),e.TgZ(60,"td")(61,"div",31),e._UZ(62,"button",32),e.TgZ(63,"div",33)(64,"a",34),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.navigateTo("../form",a,"view"))}),e._UZ(65,"i",35),e._uU(66," View "),e.qZA(),e.TgZ(67,"a",34),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.navigateTo("../form",a,"edit"))}),e._UZ(68,"i",36),e._uU(69," Edit "),e.qZA()()()()()}if(2&i){const t=u.$implicit,s=e.MAs(4),r=e.MAs(9),a=e.oxw();e.xp6(2),e.Oqu(t.DSKUNo),e.xp6(1),e.Udp("width",s.clientWidth),e.xp6(2),e.Q6J("ngbTooltip",t.DSKUName)("positionTarget",s),e.xp6(1),e.hij(" ",t.DSKUName?e.xi3(7,24,t.DSKUName,30):null," "),e.xp6(2),e.Udp("width",r.clientWidth),e.xp6(2),e.Q6J("ngbTooltip",t.DSKUDescription)("positionTarget",r),e.xp6(1),e.hij(" ",t.DSKUDescription?e.xi3(12,27,t.DSKUDescription,30):null," "),e.xp6(3),e.Oqu(t.UOM),e.xp6(4),e.hij(" ",e.lcZ(19,30,"INR")," "),e.xp6(4),e.hij(" ",e.xi3(23,32,null==t?null:t.costOfGoodsSold,"1.2-2")," "),e.xp6(5),e.hij(" ",e.lcZ(28,35,"INR")," "),e.xp6(4),e.hij(" ",e.xi3(32,37,null==t?null:t.operatingExpenses,"1.2-2")," "),e.xp6(5),e.hij(" ",e.lcZ(37,40,"INR")," "),e.xp6(4),e.hij(" ",e.xi3(41,42,null==t?null:t.totalCostOfOperation,"1.2-2")," "),e.xp6(5),e.hij(" ",e.lcZ(46,45,"INR")," "),e.xp6(4),e.hij(" ",e.xi3(50,47,null==t?null:t.profit,"1.2-2")," "),e.xp6(5),e.hij(" ",e.lcZ(55,50,"INR")," "),e.xp6(4),e.hij(" ",e.xi3(59,52,null==t?null:t.sellingPrice,"1.2-2")," "),e.xp6(6),e.Q6J("accessType",a.rolePermissionActions.viewAction),e.xp6(3),e.Q6J("accessType",a.rolePermissionActions.editAction)}}const R=function(i,u,t,s){return{page:i,pageSize:u,collection:t,search:s,type:"list"}};let H=(()=>{class i{constructor(t,s,r,a,l,M){this.exportExcelService=t,this.router=s,this.spinner=r,this.activatedRoute=a,this.costSheetForDSKUService=l,this.exportToPDFService=M,this.page=1,this.pageSize=8,this.collection=0,this.column="processId",this.direction=-1,this.search="",this.tableData=[],this.rolePermissionActions=D.a1}ngOnInit(){this.page=Number(this.activatedRoute.snapshot.queryParamMap.get("page")??1),this.getAll()}getAll(t=!1,s=""){this.spinner.show();let r={page:this.page,pageSize:this.pageSize,search:this.search,column:this.column,direction:this.direction,excel:t};this.subscription&&this.subscription.unsubscribe(),this.subscription=this.costSheetForDSKUService.getAll(r).subscribe(a=>{"EXCEL"==s?this.excelDownload(a.rows):"PDF"==s?this.pdfDownload(a.rows):(this.tableData=a.rows,this.collection=a.count),this.spinner.hide()})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}navigateTo(t,s,r){this.router.navigate([t],{relativeTo:this.activatedRoute,queryParams:{id:s?._id,action:r}})}eventHeader(t){switch(t.key){case"SEARCH":this.search=t.value,this.getAll();break;case"PDF":this.getAll(!0,"PDF");break;case"EXCEL":this.getAll(!0,"EXCEL");break;case"PAGE":this.page=t.value,this.getAll()}}trackByFn(t,s){return s?._id}pdfDownload(t){let s=(0,_.c)(t);this.exportToPDFService.generatePdf(s.tableData,s.title)}excelDownload(t){this.exportExcelService.exportExcel((0,_.nj)(t))}onSort({column:t,direction:s}){this.headers.forEach(r=>{r.sortable!==t&&(r.direction="")}),this.column=t,this.direction="asc"==s?1:-1,this.getAll()}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(m.Ol),e.Y36(p.F0),e.Y36(m.V),e.Y36(p.gz),e.Y36(g.q7),e.Y36(m.$L))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-cost-sheet-for-dsku-list"]],viewQuery:function(s,r){if(1&s&&e.Gf(S.j,5),2&s){let a;e.iGM(a=e.CRH())&&(r.headers=a)}},decls:36,vars:9,consts:[[1,"listCard","card"],[1,"table-header"],[1,"heading"],["appAccessControl","",1,"text-center",3,"accessType"],[1,"plusIconSvg","btn","btn-primary","me-1"],["type","button",1,"btn","btn-primary","btn-add","px-3",3,"click"],[1,"line-border"],[1,"table-responsive"],[3,"data","dataChange"],[1,"table","table-bordered"],[1,"bg-secondary"],[1,"text-white"],["sortable","DSKUNo",3,"sort"],["sortable","DSKUName",1,"text-start",3,"sort"],["sortable","DSKUDescription",1,"text-start",3,"sort"],["sortable","UOM",3,"sort"],["sortable","costOfGoodsSold",3,"sort"],["sortable","operatingExpenses",3,"sort"],["sortable","totalCostOfOperation",3,"sort"],["sortable","profit",3,"sort"],["sortable","sellingPrice",3,"sort"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-start"],["DSKUName",""],[1,"pointer",3,"ngbTooltip","positionTarget"],["DSKUDescription",""],[1,"py-0","text-center"],[1,"d-flex","justify-content-start","align-items-center"],[1,"input-group-text","text-secondary","combine-INR","border","border-0"],[1,"vr","ms-3"],[1,"total-cost-color"],[1,"dropdown"],[1,"dropbtn"],[1,"dropdown-content"],["appAccessControl","","href","javascript:void(0)",3,"accessType","click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","me-2","text-primary"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg","me-2","text-primary"]],template:function(s,r){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"D-SKU Cost Sheet Summary "),e.qZA()(),e.TgZ(4,"div",3),e._UZ(5,"button",4),e.TgZ(6,"button",5),e.NdJ("click",function(){return r.navigateTo("../form",{},"create")}),e._uU(7," D-SKU Cost Sheet "),e.qZA()(),e._UZ(8,"hr",6),e.TgZ(9,"div",7)(10,"app-setting-header",8),e.NdJ("dataChange",function(l){return r.eventHeader(l)}),e.qZA(),e.TgZ(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th",12),e.NdJ("sort",function(l){return r.onSort(l)}),e._uU(15,"D-SKU No."),e.qZA(),e.TgZ(16,"th",13),e.NdJ("sort",function(l){return r.onSort(l)}),e._uU(17,"D-SKU Name"),e.qZA(),e.TgZ(18,"th",14),e.NdJ("sort",function(l){return r.onSort(l)}),e._uU(19,"D-SKU Description"),e.qZA(),e.TgZ(20,"th",15),e.NdJ("sort",function(l){return r.onSort(l)}),e._uU(21,"UoM"),e.qZA(),e.TgZ(22,"th",16),e.NdJ("sort",function(l){return r.onSort(l)}),e._uU(23,"COGS"),e.qZA(),e.TgZ(24,"th",17),e.NdJ("sort",function(l){return r.onSort(l)}),e._uU(25,"Opex"),e.qZA(),e.TgZ(26,"th",18),e.NdJ("sort",function(l){return r.onSort(l)}),e._uU(27,"Total COO"),e.qZA(),e.TgZ(28,"th",19),e.NdJ("sort",function(l){return r.onSort(l)}),e._uU(29,"Profit"),e.qZA(),e.TgZ(30,"th",20),e.NdJ("sort",function(l){return r.onSort(l)}),e._uU(31,"Selling Price"),e.qZA(),e.TgZ(32,"th"),e._uU(33,"Action"),e.qZA()()(),e.TgZ(34,"tbody"),e.YNc(35,k,70,55,"tr",21),e.qZA()()()()),2&s&&(e.xp6(4),e.Q6J("accessType",r.rolePermissionActions.createAction),e.xp6(6),e.Q6J("data",e.l5B(4,R,r.page,r.pageSize,r.collection,r.search)),e.xp6(25),e.Q6J("ngForOf",r.tableData)("ngForTrackBy",r.trackByFn))},dependencies:[o.sg,C.P,y._L,S.j,K.J,o.JJ,x.W,b.f],encapsulation:2})}return i})();var c=n(60095),F=n(21631),T=n(22096);const A=function(i,u,t){return{"bg-yellow-color form-control px-2 form-control-cd-sm":i,"bg-magenta-color form-control px-2 form-control-cd-sm":u,"form-control px-2 form-control-cd-sm":t}};function q(i,u){if(1&i){const t=e.EpF();e.TgZ(0,"span")(1,"input",23),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw().$implicit;return e.KtG(a.costPerUnit=r)})("input",function(){e.CHM(t);const r=e.oxw().$implicit,a=e.oxw();return e.KtG(a.setCostSheetData(r.costHead))}),e.qZA()()}if(2&i){const t=e.oxw().$implicit,s=e.oxw();e.xp6(1),e.Q6J("ngClass",e.kEZ(2,A,t.costHead==s.SKUCostParticulars.operatingOpex,t.costHead==s.SKUCostParticulars.profit,t.costHead))("ngModel",t.costPerUnit)}}function O(i,u){if(1&i&&(e.TgZ(0,"span",24),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.costPerUnit," ")}}const U=function(i,u){return[i,u]},v=function(i,u,t,s){return{"py-0":i,"bg-yellow-color":u,"bg-magenta-color":t,"bg-pink-color":s}},N=function(i,u,t,s){return{"bg-yellow-color input-group-text text-secondary combine-INR border border-0 border-0":i,"bg-magenta-color input-group-text text-secondary combine-INR border border-0 border-0":u,"bg-pink-color input-group-text text-secondary combine-INR border border-0 border-0":t,"input-group-text text-secondary combine-INR border border-0 border-0":s}};function E(i,u){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",12),e._uU(4),e.qZA(),e.TgZ(5,"td",19)(6,"div",20)(7,"span",19),e._uU(8),e.ALo(9,"companyCurrency"),e._UZ(10,"div",21),e.qZA(),e.YNc(11,q,2,6,"span",18),e.YNc(12,O,2,1,"span",22),e.qZA()(),e.TgZ(13,"td"),e._uU(14),e.qZA()()),2&i){const t=u.$implicit,s=e.oxw();e.xp6(2),e.hij(" ",t.srNo," "),e.xp6(2),e.hij(" ",t.costHead," "),e.xp6(1),e.Q6J("ngClass",e.l5B(13,v,t.costHead,t.costHead==s.SKUCostParticulars.operatingOpex,t.costHead==s.SKUCostParticulars.profit,e.WLB(10,U,s.SKUCostParticulars.totalCostOfOperation,s.SKUCostParticulars.sellingPrice).includes(t.costHead))),e.xp6(2),e.Q6J("ngClass",e.l5B(21,N,t.costHead==s.SKUCostParticulars.operatingOpex,t.costHead==s.SKUCostParticulars.profit,e.WLB(18,U,s.SKUCostParticulars.totalCostOfOperation,s.SKUCostParticulars.sellingPrice).includes(t.costHead),t.costHead)),e.xp6(1),e.hij(" ",e.lcZ(9,8,"INR")," "),e.xp6(3),e.Q6J("ngIf",e.WLB(26,U,s.SKUCostParticulars.operatingOpex,s.SKUCostParticulars.profit).includes(t.costHead)),e.xp6(1),e.Q6J("ngIf",!e.WLB(29,U,s.SKUCostParticulars.operatingOpex,s.SKUCostParticulars.profit).includes(t.costHead)),e.xp6(2),e.hij(" ",t.percentage," ")}}function w(i,u){1&i&&e._UZ(0,"hr",25)}function J(i,u){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.reset())}),e._uU(2,"Reset"),e.qZA(),e.TgZ(3,"button",27),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.dismissModel())}),e._uU(4,"Save & Close"),e.qZA()()}}let Z=(()=>{class i{constructor(t){this.activeModal=t,this.action="create",this.costDetailsArr=[],this.oldCostDetailsArr=[],this.sellingPrice=0,this.SKUCostParticulars=D.oN}ngOnInit(){this.oldCostDetailsArr=JSON.parse(JSON.stringify(this.costDetailsArr))}dismissModel(){this.activeModal.close(this.costDetailsArr)}reset(){this.costDetailsArr=JSON.parse(JSON.stringify(this.oldCostDetailsArr))}getPercentage(t){return this.sellingPrice=this.setCostHead(this.SKUCostParticulars.sellingPrice),+(100*t/this.sellingPrice).toFixed(2)}setCostSheetData(t){this.costDetailsArr=this.costDetailsArr.map(s=>(t!=this.SKUCostParticulars.profit&&s.costHead==this.SKUCostParticulars.totalCostOfOperation&&(s.costPerUnit=+(this.setCostHead(this.SKUCostParticulars.costOfGoodsSold)+this.setCostHead(this.SKUCostParticulars.operatingOpex)).toFixed(2)),s.costHead==this.SKUCostParticulars.sellingPrice&&(s.costPerUnit=+(this.setCostHead(this.SKUCostParticulars.totalCostOfOperation)+this.setCostHead(this.SKUCostParticulars.profit)).toFixed(2)),s)),this.updateCostSheetPercentage()}updateCostSheetPercentage(){this.costDetailsArr=this.costDetailsArr.map(t=>(t.percentage=this.getPercentage(t.costPerUnit),t))}setCostHead(t){return+(this.costDetailsArr.find(r=>r.costHead==t)?.costPerUnit||0).toFixed(2)}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(y.Kz))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-cost-sheet-for-dsku-details"]],viewQuery:function(s,r){if(1&s&&e.Gf(S.j,5),2&s){let a;e.iGM(a=e.CRH())&&(r.headers=a)}},inputs:{action:"action",costDetailsArr:"costDetailsArr"},decls:28,vars:3,consts:[[1,"modelPage"],[1,"modal-header"],[1,"heading"],["type","button","aria-label","Close",1,"btn","btn-cross","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times-circle"],[1,"container-fluid","mt-5","px-0"],[1,"row","px-5","justify-content-center"],[1,"col-12","mb-2"],[1,"table-responsive","mt-0","text-wrap"],[1,"table","table-bordered","mt-0","table-sm"],[1,"bg-info"],[1,"text-white","text-center"],[1,"text-start"],[2,"width","12rem"],[4,"ngFor","ngForOf"],["class","line-border px-0",4,"ngIf"],[1,"row","my-4","px-5"],[1,"col-12","d-flex","justify-content-center"],[4,"ngIf"],[3,"ngClass"],[1,"d-flex","justify-content-start","align-items-center"],[1,"vr","ms-3"],["class","ps-2",4,"ngIf"],["type","number",3,"ngClass","ngModel","ngModelChange","input"],[1,"ps-2"],[1,"line-border","px-0"],["type","button",1,"btn","btn-primary","px-5","me-3",3,"click"],["type","button",1,"btn","btn-primary","px-3",3,"click"]],template:function(s,r){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Cost Details"),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return r.activeModal.close()}),e._UZ(6,"i",4),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"table",9)(12,"thead",10)(13,"tr",11)(14,"th"),e._uU(15,"SN"),e.qZA(),e.TgZ(16,"th",12),e._uU(17,"Particulars/Cost Head"),e.qZA(),e.TgZ(18,"th",13),e._uU(19,"Cost/Unit"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"%"),e.qZA()()(),e.TgZ(22,"tbody"),e.YNc(23,E,15,32,"tr",14),e.qZA()()()()(),e.YNc(24,w,1,0,"hr",15),e.TgZ(25,"div",16)(26,"div",17),e.YNc(27,J,5,0,"div",18),e.qZA()()()()),2&s&&(e.xp6(23),e.Q6J("ngForOf",r.costDetailsArr),e.xp6(1),e.Q6J("ngIf","view"!==r.action),e.xp6(3),e.Q6J("ngIf","view"!==r.action))},dependencies:[o.mk,o.sg,o.O5,c.Fj,c.wV,c.JJ,c.On,b.f],styles:[".form-control-cd-sm[_ngcontent-%COMP%]{margin:0!important;height:2.4rem!important;width:8rem!important;text-align:start!important}"]})}return i})();var P=n(62576),L=n(16897),I=n(50363);function d(i,u){if(1&i){const t=e.EpF();e.TgZ(0,"div",33)(1,"button",34),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.reset())}),e._uU(2,"Reset"),e.qZA(),e.TgZ(3,"button",35),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.submit())}),e._uU(4,"Save"),e.qZA()()}}let j=(()=>{class i{constructor(t,s,r,a,l,M,Y,z){this.activatedRoute=t,this.spinner=s,this.toastService=r,this.costSheetForDSKUService=a,this.validationService=l,this.modalService=M,this.location=Y,this.utilityService=z,this.oldAssetAllocationData=[],this.DSKUList=[],this.costDetailsArr=[],this.submitted=!1,this.action="create",this.masterData={autoIncrementNo:"",categoryOptions:[]},this.form=new c.nJ({_id:new c.p4(null),DSKUCostSheetNo:new c.p4(null),productCategory:new c.p4(null,[c.kI.required]),DSKU:new c.p4(null),DSKUNo:new c.p4(null,[c.kI.required]),DSKUName:new c.p4(null,[c.kI.required]),DSKUDescription:new c.p4(null),UOM:new c.p4(null),sellingPrice:new c.p4(null,[c.kI.required]),DSKUCostDetails:new c.p4([])})}ngOnInit(){this.getInitialData()}get f(){return this.form.controls}reset(){this.form.reset(),this.DSKUList=[],this.getInitialData()}submit(){if(this.submitted=!0,this.validationService.checkErrors(this.form,P.nb))return;if(1==this.costDetailsArr.filter(r=>["Direct Material","Direct Labour","Direct Expenses","Profit"].includes(r.costHead)).some(r=>r.costPerUnit<=0))return void this.toastService.warning("Ensure Direct Material, Direct Labour, Direct Expenses, and Profit values are greater than 0");this.form.enable();let s=this.form.value;s.DSKUCostDetails=this.costDetailsArr,s._id?this.update(s):(delete s._id,this.create(s))}create(t){this.spinner.show(),this.costSheetForDSKUService.create(t).subscribe(s=>{this.submitted=!1,this.spinner.hide(),this.toastService.success(s.message),this.location.back()})}update(t){this.spinner.show(),this.costSheetForDSKUService.update(t._id,t).subscribe(s=>{this.spinner.hide(),this.submitted=!1,this.toastService.success(s.message),this.location.back()})}getInitialData(){this.spinner.show(),this.costSheetForDSKUService.getAllMasterData({}).subscribe(t=>{this.masterData=t,this.form.controls.DSKUCostSheetNo.setValue(this.masterData.autoIncrementNo),this.activatedRoute.queryParams.pipe((0,F.z)(s=>(this.action=s.action,this.utilityService.accessDenied(this.action),s.id?this.costSheetForDSKUService.getById(s.id):(0,T.of)({})))).subscribe(s=>{this.spinner.hide(),0!=Object.keys(s).length&&(this.costDetailsArr=s.DSKUCostDetails,this.form.patchValue(s),this.form.controls.productCategory.disable(),this.form.controls.DSKUNo.disable(),this.form.controls.DSKUName.disable(),"view"==this.action&&this.form.disable())})})}getDSKUData(){this.DSKUList=[],this.form.controls.DSKU.setValue(null),this.form.controls.DSKUNo.setValue(null),this.form.controls.DSKUName.setValue(null),this.form.controls.DSKUDescription.setValue(null),this.form.controls.UOM.setValue(null),this.form.controls.sellingPrice.setValue(null);let t=this.form.controls.productCategory.value;this.spinner.show(),this.costSheetForDSKUService.getDSKUInCostSheet({category:t}).subscribe(s=>{s&&(this.DSKUList=s),this.spinner.hide()})}setDSKUDetails(t){this.form.controls.DSKU.setValue(t?._id),this.form.controls.DSKUNo.setValue(t?.dSKUNo),this.form.controls.DSKUName.setValue(t?.SKUName),this.form.controls.DSKUDescription.setValue(t?.SKUDescription),this.form.controls.UOM.setValue(t?.primaryUnit),this.costSheetForDSKUService.getDSKUCostSheetDetailsByDSKUId(t?._id).subscribe(s=>{s&&(this.costDetailsArr=s),this.spinner.hide()})}setSellingPrice(){let t=this.costDetailsArr.find(s=>"Selling Price"==s.costHead)?.costPerUnit||0;this.form.controls.sellingPrice.setValue(+t.toFixed(2))}openCostDetailsModal(){if(!this.form.controls.DSKUNo.value)return void this.toastService.warning("First Select D-SKU");const t=this.modalService.open(Z,{centered:!0,size:"lg",backdrop:"static",keyboard:!1});t.componentInstance.action=this.action,t.componentInstance.costDetailsArr=this.costDetailsArr,t.componentInstance.oldAssetAllocationData=this.oldAssetAllocationData,t.result.then(s=>{s&&(this.costDetailsArr=s,this.setSellingPrice())},s=>{})}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(p.gz),e.Y36(m.V),e.Y36(m.kl),e.Y36(g.q7),e.Y36(L.RJ),e.Y36(y.FF),e.Y36(o.Ye),e.Y36(m.tI))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-cost-sheet-for-dsku-form"]],decls:60,vars:11,consts:[[1,"formCard","card",3,"formGroup"],[1,"set-remaining-margin"],[1,"row","form-header"],[1,"col","heading"],[1,"form-body"],[1,"row"],[1,"col-5"],[1,"col-8"],[1,"form-label"],[1,"text-danger"],["bindLabel","productCategory","bindValue","productCategory","formControlName","productCategory",3,"items","clearable","change"],[1,"col-4","ps-0"],["bindLabel","dSKUNo","bindValue","dSKUNo","formControlName","DSKUNo",3,"items","clearable","change"],[1,"col-7","ps-0"],[1,"col-5","pe-1"],["bindLabel","SKUName","bindValue","SKUName","formControlName","DSKUName",3,"items","clearable","change"],[1,"col-5","ps-4"],["type","text","formControlName","DSKUDescription","readonly","",1,"form-control"],[1,"col-2","ps-0"],["type","text","formControlName","UOM","readonly","",1,"form-control"],[1,"row","line-border"],[1,"col-2","pe-0"],["type","button",1,"btn","btn-primary","px-3","me-1",3,"click"],[1,"plusIconSvg","btn","btn-primary"],[1,"col-3","ps-3"],[1,"d-flex","align-items-center"],[1,"col-form-label","text-nowrap"],[1,"fa","fa-caret-right","fs-3","mx-2"],[1,"d-flex"],[1,"input-group-text","text-secondary","combine-INR"],[1,"vr","ms-3"],["type","number","formControlName","sellingPrice","readonly","",1,"form-control","border-start-0"],["class","col-7 text-end",4,"ngIf"],[1,"col-7","text-end"],["type","button",1,"btn","btn-primary","px-5","me-5",3,"click"],["type","button",1,"btn","btn-primary","px-5",3,"click"]],template:function(s,r){1&s&&(e.TgZ(0,"Form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label"),e._uU(5," D-SKU Cost Sheet"),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",5)(10,"div",7)(11,"label",8),e._uU(12,"Product Category "),e.TgZ(13,"span",9),e._uU(14,"*"),e.qZA()(),e.TgZ(15,"ng-select",10),e.NdJ("change",function(){return r.getDSKUData()}),e.qZA()(),e.TgZ(16,"div",11)(17,"label",8),e._uU(18,"D-SKU No. "),e.TgZ(19,"span",9),e._uU(20,"*"),e.qZA()(),e.TgZ(21,"ng-select",12),e.NdJ("change",function(l){return r.setDSKUDetails(l)}),e.qZA()()()(),e.TgZ(22,"div",13)(23,"div",5)(24,"div",14)(25,"label",8),e._uU(26,"D-SKU Name "),e.TgZ(27,"span",9),e._uU(28,"*"),e.qZA()(),e.TgZ(29,"ng-select",15),e.NdJ("change",function(l){return r.setDSKUDetails(l)}),e.qZA()(),e.TgZ(30,"div",16)(31,"label",8),e._uU(32," D-SKU Description "),e._UZ(33,"span",9),e.qZA(),e._UZ(34,"input",17),e.qZA(),e.TgZ(35,"div",18)(36,"label",8),e._uU(37," UoM "),e._UZ(38,"span",9),e.qZA(),e._UZ(39,"input",19),e.qZA()()()()(),e._UZ(40,"hr",20),e.TgZ(41,"div",5)(42,"div",21)(43,"button",22),e.NdJ("click",function(){return r.openCostDetailsModal()}),e._uU(44," Cost Details "),e.qZA(),e._UZ(45,"button",23),e.qZA(),e.TgZ(46,"div",24)(47,"div",25)(48,"div",26),e._uU(49," Selling Price"),e.TgZ(50,"span",9),e._uU(51,"*"),e.qZA(),e._UZ(52,"i",27),e.qZA(),e.TgZ(53,"div",28)(54,"span",29),e._uU(55),e.ALo(56,"companyCurrency"),e._UZ(57,"div",30),e.qZA(),e._UZ(58,"input",31),e.qZA()()(),e.YNc(59,d,5,0,"div",32),e.qZA()()()),2&s&&(e.Q6J("formGroup",r.form),e.xp6(15),e.Q6J("items",r.masterData.categoryOptions)("clearable",!1),e.xp6(6),e.Q6J("items",r.DSKUList)("clearable",!1),e.xp6(8),e.Q6J("items",r.DSKUList)("clearable",!1),e.xp6(26),e.hij(" ",e.lcZ(56,9,"INR")," "),e.xp6(4),e.Q6J("ngIf","view"!==r.action))},dependencies:[o.O5,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,I.w9,b.f],encapsulation:2})}return i})();var Q=n(19964),G=n(56208);const B=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:H},{path:"form",component:j,resolve:{accessScreen:Q.xr}}];let V=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.oAB({type:i});static#s=this.\u0275inj=e.cJS({imports:[o.ez,p.Bz.forChild(B),G.m]})}return i})()},29391:(f,h,n)=>{n.d(h,{c:()=>O,nj:()=>q,On:()=>x,hl:()=>K,lI:()=>m,ZA:()=>e,_c:()=>I,bc:()=>L,ck:()=>w,Lk:()=>E});var o=n(13107),p=n(28402);let S=["*","*","*","*","*","*","*","*","*"],D="NPD Review for Feasibility",_=[{header:"NPD No",key:"NPDNo",...o.t},{header:"NPD Date",key:"NPDDate",...o.t},{header:"Project Name",key:"projectName",...o.t},{header:"Product Code",key:"productCategory",...o.t},{header:"Customer Name",key:"name",...o.t},{header:"EDD",key:"expectedDeliveryDate",...o.t},{header:"Inputs",key:"customerInputs",...o.t},{header:"T",key:"technicalReview",...o.t},{header:"E",key:"economicReview",...o.t},{header:"L",key:"legalReview",...o.t},{header:"O",key:"operationalReview",...o.t},{header:"S",key:"schedulingReview",...o.t},{header:"Status",key:"status",...o.t}];const e=d=>({title:D,csvData:d,headers:_}),m=d=>(0,p.J)({data:d,headers:_,widths:S,title:D});let g=["*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"],C="NPD Request",y=[{header:"NPD. NO",key:"NPDNo",...o.t},{header:"NPD. Date",key:"NPDDate",...o.t},{header:"Customer/Prospect Name",key:"name",...o.t},{header:"Project Name",key:"projectName",...o.t},{header:"Product Code",key:"productCategory",...o.t},{header:"Product Brief",key:"productBrief",...o.t},{header:"Build Stage",key:"buildStage",...o.t},{header:"Order Type",key:"orderType",...o.t},{header:"Monthly off-take Quantity",key:"monthlyOffTakeQty",...o.t},{header:"Development Charges",key:"developmentCharges",...o.t},{header:"Quantity [Requested]",key:"requestedQty",...o.t},{header:"EDD",key:"expectedDeliveryDate",...o.t},{header:"Validation Required",key:"validationRequired",...o.t},{header:"NPD Requested by/Coordinator",key:"NPDRequestedBy",...o.t},{header:"Remark",key:"remarks",...o.t},{header:"Status",key:"status",...o.t}];const K=d=>({title:C,csvData:d,headers:y}),x=d=>(0,p.J)({data:d,headers:y,widths:g,title:C});let F=["*","*","*","*","*","*","*","*","*","*","*","*"],T="D-SKU Cost Sheet",A=[{header:"D-SKU No",key:"DSKUNo",...o.t},{header:"D-SKU Name",key:"DSKUName",...o.t},{header:"D-SKU Description",key:"DSKUDescription",...o.t},{header:"UoM",key:"UOM",...o.t},{header:"COGS",key:"costOfGoodsSold",...o.t},{header:"OPEX",key:"operatingExpenses",...o.t},{header:"Total COO",key:"totalCostOfOperation",...o.t},{header:"Profit",key:"profit",...o.t},{header:"Selling Price",key:"sellingPrice",...o.t}];const q=d=>({title:T,csvData:d,headers:A}),O=d=>(0,p.J)({data:d,headers:A,widths:F,title:T});let U=["*","*","*","*","*","*","*"],v="SampleRequest Report",N=[{header:"SR No.",key:"sampleReqNo",...o.t},{header:"SR Date",key:"SRDate",...o.t},{header:"Sales Category",key:"salesCategory",...o.t},{header:"Customer Name",key:"customerName",...o.t},{header:"Currency",key:"currency",...o.t},{header:"SR Total Amount",key:"SRTotalAmount",...o.t},{header:"SR Status",key:"SRStatus",...o.t}];const E=d=>({title:v,csvData:d,headers:N}),w=d=>(0,p.J)({data:d,headers:N,widths:U,title:v});let J=["*","*","*","*","*","*","*","*"],Z="Sample Job Card Creation",P=[{header:"JC No.",key:"jobCardNo",...o.t},{header:"JC Date",key:"jobCardDate",...o.t},{header:"SKU No.",key:"SKUNo",...o.t},{header:"SKU Name",key:"SKUName",...o.t},{header:"SKU Description",key:"SKUDescription",...o.t},{header:"Batch Qty.",key:"batchQty",...o.t},{header:"Customer Nick Name",key:"customerNickName",...o.t},{header:"Status",key:"status",...o.t}];const L=d=>({title:Z,csvData:d,headers:P}),I=d=>(0,p.J)({data:d,headers:P,widths:J,title:Z})},13107:(f,h,n)=>{n.d(h,{t:()=>o});const o={width:24,style:{alignment:{vertical:"middle",horizontal:"center",wrapText:!0}}}},28402:(f,h,n)=>{n.d(h,{J:()=>o});const o=({data:p,headers:S,widths:D,title:_})=>({tableData:{widths:D,headerRows:1,body:[S.map(g=>({text:g.header,style:"header"})),...p.map(g=>S.map(C=>({style:"subheader",text:g[C.key]})))]},title:_})},62576:(f,h,n)=>{n.d(h,{Qj:()=>D,nb:()=>m,UB:()=>e,rz:()=>o,aJ:()=>_,JD:()=>p,wG:()=>g});const o=[{message:"NPD No. is Required",key:"NPD"}],p=[{message:"Customer/Prospect Name is Required",key:"referenceModel"},{message:"Product Category is Required",key:"productCategory"},{message:"Project Name is Required",key:"projectName"},{message:"Product Brief is Required",key:"productBrief"},{message:"Build Stage is Required",key:"buildStage"},{message:"Order Type is Required",key:"orderType"},{message:"Development Charges is Required",key:"developmentCharges"},{message:"Quantity [Requested] is Required",key:"requestedQty"},{message:"Expected Delivery Date [EDD] is Required",key:"expectedDeliveryDate"},{message:"Validation Required is Required",key:"validationRequired"},{message:"NPD Requested by/Coordinator is Required",key:"NPDRequestedBy"}];n(84982);const D=[{message:"Order is Required",key:"order"},{message:"Name is Required",key:"name"},{message:"Status is Required",key:"status"}],_=[{message:"SKU Stage is Required",key:"SKUStage"},{message:"Product Category is Required",key:"productCategory"},{message:"HSN Code is Required",key:"HSNCode"},{message:"D-SKU No. is Required",key:"dSKUNo"},{message:"D-SKU Name is Required",key:"SKUName"},{message:"D-SKU Description is Required",key:"SKUDescription"},{message:"Unit of Measurement is Required",key:"primaryUnit"}],e=[{message:"Product Category is Required",key:"productCategory"},{message:"D-SKU No. is Required",key:"DSKUNo"},{message:"D-SKU Name is Required",key:"DSKUName"},{message:"Total Labour Cost/Unit is Required",key:"totalLabourCostPerUnit"},{message:"Total Asset Cost/Unit is Required",key:"totalAssetCostPerUnit"},{message:"Total Tooling Cost/Unit is Required",key:"totalToolingCostPerUnit"}],m=[{message:"Product Category is Required",key:"productCategory"},{message:"D-SKU No. is Required",key:"DSKUNo"},{message:"D-SKU Name is Required",key:"DSKUName"},{message:"Selling Price is Required",key:"sellingPrice"}],g=[{message:"Bill From Location is Required",key:"billFromLocation"},{message:"Customer Category is Required",key:"salesCategory"},{message:"Customer Name is Required",key:"customer"},{message:"Net SO Value is Required",key:"SRTotalAmount"},{message:"Status is Required",key:"SRStatus"},{message:"Customer Shipping Address is Required",key:"customerShippingAddress"},{message:"Fright Terms is Required",key:"frightTerms"},{message:"Transporter is Required",key:"transporter"},{message:"Destination is Required",key:"destination"}]},84982:(f,h,n)=>{n.d(h,{$:()=>o});const o=[{message:"Prospect Name is Required",key:"prospectName"},{message:"Customer category Name is Required",key:"customerCategory"},{message:"Ccy is Required",key:"currency"}]}}]);