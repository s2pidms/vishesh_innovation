<Form class="px-2" [formGroup]="form" class="formCard card">
    <div class="set-remaining-margin">
        <div class="row form-header">
            <div class="col heading">
                <label>{{ action | titlecase }} NPD Details</label>
            </div>
        </div>
        <div class="form-body">
            <div class="row">
                <div class="col">
                    <div class="row">
                        <div class="col-6 pe-3">
                            <label class="form-label"> NPD No. <span class="text-danger"></span> </label>
                            <input type="text" class="form-control" formControlName="NPDNo" readonly />
                        </div>
                        <div class="col-6 ps-0">
                            <label class="form-label"> NPD Date <span class="text-danger"></span> </label>
                            <input type="date" class="form-control" formControlName="NPDDate" />
                        </div>
                    </div>
                </div>
                <div class="col-3 pe-5">
                    <label class="form-label">
                        Customer/Prospect Name
                        <span class="text-danger">*</span>
                    </label>

                    <div class="d-flex align-items-center">
                        <div class="col-11">
                            <ng-select
                                [items]="masterData.customers"
                                bindLabel="name"
                                bindValue="_id"
                                [clearable]="false"
                                (change)="setReference($event)"
                                formControlName="reference"
                            >
                            </ng-select>
                        </div>
                        <div
                            style="height: 2.9rem"
                            class="input-group-text bg-primary pointer col-auto fs-4"
                            id="basic-addon1"
                            (click)="openCustomersDetailsModal()"
                        >
                            <i class="fa fa-search text-white" aria-hidden="true"></i>
                        </div>
                    </div>
                </div>
                <div class="col-3">
                    <label class="form-label d-flex justify-content-between"
                        >Project/Part Name<span class="text-danger">*</span><span></span><span></span><span></span
                        ><span></span><span></span><span></span
                        ><button (click)="openVariantsModal()" type="button" class="btn btn-primary form-btn-sm py-0">
                            Variants
                        </button>
                    </label>
                    <input type="text" class="form-control" formControlName="projectName" />
                </div>
                <div class="col-3 pe-5">
                    <label class="form-label">
                        Product Category
                        <span class="text-danger">*</span>
                    </label>
                    <div class="d-flex align-items-center">
                        <div class="col-11">
                            <ng-select
                                [items]="masterData.productCategory"
                                bindLabel="label"
                                bindValue="value"
                                formControlName="productCategory"
                                [clearable]="false"
                            >
                            </ng-select>
                        </div>
                        <div
                            style="height: 2.9rem"
                            class="input-group-text bg-primary pointer fs-4 col-auto"
                            id="basic-addon1"
                            (click)="openProductCategoryModal()"
                        >
                            <i class="fa fa-search text-white" aria-hidden="true"></i>
                        </div>
                    </div>
                    <!-- <select formControlName="productCategory" class="form-select">
                            <option [value]="null" selected disabled>Select Product Category</option>
                            <option *ngFor="let c of masterData.productCategory" [value]="c.value">
                                {{ c.label }}
                            </option>
                        </select> -->
                </div>
            </div>
        </div>

        <hr class="row line-border" />

        <div class="row">
            <div class="col form-group">
                <label class="form-label">
                    Product Brief <span class="text-danger"></span>
                    [General Product information/Functional & Performance requirements/specification and application]
                </label>
                <textarea class="form-control form-text-area" formControlName="productBrief" rows="5"></textarea>
            </div>
        </div>

        <div class="row">
            <div class="col">
                <label class="form-label">
                    Build Stage
                    <span class="text-danger">*</span>
                </label>
                <select formControlName="buildStage" class="form-select">
                    <option [value]="null" selected disabled>Select Build Stage</option>
                    <option *ngFor="let c of masterData.buildStage" [value]="c.value">
                        {{ c.label }}
                    </option>
                </select>
            </div>
            <div class="col">
                <label class="form-label mb-1 d-flex justify-content-between">
                    Order Type
                    <span class="text-danger">*</span><span></span><span></span><span></span><span></span><span></span
                    ><span></span><span></span><span></span>
                    <button (click)="openOffTakeQtyModal()" type="button" class="btn btn-primary form-btn-sm py-0">
                        Offtake Qty
                    </button>
                </label>
                <select formControlName="orderType" class="form-select" (change)="setMonthlyOffTake($event)">
                    <option [value]="null" selected disabled>Select Order Type</option>
                    <option *ngFor="let c of masterData.orderType" [value]="c.value">
                        {{ c.label }}
                    </option>
                </select>
            </div>
            <div class="col">
                <label class="form-label">Quantity [Requested] <span class="text-danger">*</span> </label>
                <input type="number" class="form-control" formControlName="requestedQty" />
            </div>
            <div class="col">
                <label class="form-label">Expected Delivery Date [EDD] <span class="text-danger">*</span></label>
                <input type="date" class="form-control" formControlName="expectedDeliveryDate" />
            </div>
        </div>
        <div class="row">
            <div class="col">
                <label class="form-label"> Expected Production Start Date<span class="text-danger">*</span> </label>
                <input type="date" class="form-control" formControlName="expProductionStartDate" />
            </div>
            <div class="col">
                <label class="form-label">
                    Development Charges
                    <span class="text-danger">*</span>
                </label>
                <select formControlName="developmentCharges" class="form-select">
                    <option [value]="null" selected disabled>Select Development Charges</option>
                    <option *ngFor="let c of masterData.developmentCharges" [value]="c.value">
                        {{ c.label }}
                    </option>
                </select>
            </div>
            <div class="col">
                <label class="form-label">
                    Validation Required
                    <span class="text-danger">*</span>
                </label>
                <select formControlName="validationRequired" class="form-select">
                    <option [value]="null" selected disabled>Select Validation Required</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="col">
                <label class="form-label">NPD Requested by/Coordinator <span class="text-danger">*</span></label>
                <input type="text" class="form-control" formControlName="NPDRequestedBy" readonly />
            </div>
        </div>
        <hr class="row line-border" />
        <div class="row my-4 justify-content-between">
            <div class="col">
                <button class="btn bg-primary" type="button" (click)="openCustomerInputChecklist()">
                    Customer Input Checklist
                </button>
            </div>
            <div class="col">
                <button class="btn bg-primary" type="button" (click)="openUploadDocsModal()">Upload Docs</button>
            </div>
            <div class="col-3">
                <div>
                    <div class="d-flex" *ngIf="action == 'edit'">
                        <div class="col-form-label text-nowrap">
                            Status <span class="text-danger pe-2">*</span>
                            <span>&#9654;</span>
                        </div>
                        <select class="form-select statusSelectBorder mx-2" formControlName="status">
                            <option [value]="null" selected disabled>Select Status</option>
                            <option [value]="'Awaiting Review'">Awaiting Review</option>
                            <option [value]="'Put On Hold'">Put On Hold</option>
                            <option [value]="'Terminate'">Terminate</option>
                        </select>
                        <span class="input-group-text statusSpanHeight">
                            <div *ngIf="form.value['status'] == 'Awaiting Review'" class="statusActive"></div>
                            <div *ngIf="form.value['status'] == 'Put On Hold'" class="statusYellow"></div>
                            <div *ngIf="form.value['status'] == 'Terminate'" class="statusInActive"></div>
                        </span>
                    </div>
                </div>
            </div>
            <div class="col-3 text-start">
                <div *ngIf="action == 'edit'">
                    <div class="d-flex">
                        <div class="col-form-label text-nowrap">
                            Remarks <span class="text-danger pe-2">*</span>
                            <span>&#9654;</span>
                        </div>
                        <input class="form-control mx-2" type="text" formControlName="remarks" />
                    </div>
                </div>
            </div>
            <div *ngIf="action != 'view'" class="col-1 ps-0 text-end">
                <button class="btn btn-primary ps-3" type="button" (click)="submit()">Save &nbsp;</button>
            </div>
            <div *ngIf="action == 'view'" class="col-1 ps-2 text-end">
                <button class="btn btn-primary px-4" type="button" (click)="goBack()">Back</button>
            </div>
        </div>
    </div>
</Form>
